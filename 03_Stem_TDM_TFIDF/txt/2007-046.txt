BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2007-046
Estimation with the Nested Logit Model: Specifications and Software Particularities
Nadja Silberhorn* Yasemin Boztu* Lutz Hildebrandt*
* Humboldt-Universit‰t zu Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

Estimation with the Nested Logit Model: Specifications and Software Particularities1
Nadja Silberhorn, Yasemin Boztug, Lutz Hildebrandt Institute of Marketing, Humboldt University Berlin Spandauer Straﬂe 1, 10099 Berlin {silberhorn,boztug,hildebr}@wiwi.hu-berlin.de
Abstract The paper discusses the nested logit model for choices between a set of mutually exclusive alternatives (e.g. brand choice, strategy decisions, modes of transportation, etc.). Due to the ability of the nested logit model to allow and account for similarities between pairs of alternatives, the model has become very popular for the empirical analysis of choice decisions. However the fact that there are two different specifications of the nested logit model (with different outcomes) has not received adequate attention. The utility maximization nested logit (UMNL) model and the non-normalized nested logit (NNNL) model have different properties, influencing the estimation results in a different manner. This paper introduces distinct specifications of the nested logit model and indicates particularities arising from model estimation. The effects of using various software packages on the estimation results of a nested logit model are shown using simulated data sets for an artificial decision situation.
Keywords: nested logit model, utility maximization nested logit, nonnormalized nested logit, simulation study
JEL-Codes: C13, C51, C87, M31
1 Introduction
For modelling discrete choice decisions, e.g. brand choice, in the context of random utility theory usually the multinomial logit model (MNL) (Guadagni
1Financial support by the Deutsche Forschungsgemeinschaft (DFG) through the research project #BO1952/1 and the SFB 649 "Economic Risk" is gratefully acknowledged.
1

and Little, 1983) is used. This has some well known limitations (McFadden, 1974). The MNL assumes proportional substitution patterns (Independence of Irrelevant Alternatives, IIA). To overcome this restrictive assumption, one possible alternative is to use the nested logit model for estimation in practical applications (Guadagni and Little, 1998; de Dios Ortu¥zar, 2001). The nested logit model admits more general substitution patterns and nevertheless remains, in contrast to the probit model as another alternative to overcome the aforementioned restrictive assumptions, analytically tractable. The existence of two unequal forms of the nested logit model has been underresearched so far. The utility maximization nested logit (UMNL) model and the non-normalized nested logit (NNNL) model have different properties which impact the estimation results. In many publications, the specification used is not explicitly mentioned. Both in simulation studies and in model estimations with real data, the implemented nested logit model specification within the software needs to be considered. If there are only alternative-specific coefficients in the model, the nested logit specification chosen can be accommodated merely by a nest-specific rescaling of the estimated coefficients obtained from the NNNL software before interpretation. As soon as a generic coefficient enters the model, the nonnormalized nested logit model is not consistent with random utility theory without imposing restrictions on the scale parameters. Our contribution lies therein to use simulated data to demonstrate the differences in software implementations. Section 2 introduces the nested logit model and its application in marketing. In Section 3.1 the nested logit model is presented in general, whereas Section 3.2 introduces the two different forms of the nested logit model. In Section 3.3 their consistency with random utility theory is revised. Section 4 goes into detail regarding the particularities in model estimation with NNNL software. This addressed difficulty is clarified with a simulation study in Section 5. Section 6 concludes with a summary.
2 Discrete Choice Models
Utility-based choice or choice based on the relative attractiveness of competing alternatives from a set of mutually exclusive alternatives is called a discrete choice situation. Discrete choice models are interpreted in terms of an underlying behavioral model, the so called random utility maximization (RUM) model. The decision-maker chooses the alternative with the highest
2

utility. Characteristics of the choice alternatives and of the decision-maker determine the alternatives' utilities. The latter do not have a direct utility contribution per se, but serve as proxies for consumer heterogeneity. Modelling discrete consumer decisions is characterized by a trade-off between flexibility and ease of the estimation (Munizaga and Alvarez-Daziano, 2001). On the one hand, probit models assume a more realistic situation by allowing a correlation structure of the error terms. However, the estimation of these models can become very complex because of the underlying multidimensional integrals. On the other hand, there are logit models which are distinguished by closed choice probabilities but, due to restrictive substitution patterns i.e. the above mentioned IIA assumption, are often not very realistic. Nevertheless, because of its ease in estimation logit models are favored. Their estimation is usually based on the multinomial logit (MNL) model. To overcome the restrictive substitution assumptions between alternatives, various extensions of the MNL exist, all with the general solution of allowing correlations between the alternatives' error terms. The idea of the nested logit model lies in the grouping of similar alternatives into nests, creating a hierarchical structure of the alternatives (Ben-Akiva and Lerman, 1985; Train, 2003). The error terms of alternatives within a nest are correlated with each other, and the error terms of alternatives in different nests are uncorrelated. The nested logit approach is predominantly used in the field of transportation research and logistics (Train, 1980; Bhat, 1997; Knapp et al., 2001), but can also be appropriate for marketing issues (Kannan and Wright, 1991; Chintagunta, 1993; Chintagunta and Vilcassim, 1998; Guadagni and Little, 1998; Chib et al., 2004). The nested logit model is the most often used hierarchical model in marketing (Su¥arez et al., 2004) and can be used for modelling in any situation where subsets of alternatives share unobservable utility components (Ben-Akiva and Lerman, 1985). This is usually the case in the field of marketing, especially in brand choice modelling (Kamakura et al., 1996; Ailawadi and Neslin, 1998; Guadagni and Little, 1998; Sun et al., 2003; Chib et al., 2004), where brands are nested, for example, regarding manufacturer (Anderson and de Palma, 1992); in a purchase incidence decision (Chintagunta, 1993; Chintagunta and Vilcassim, 1998); or regarding brand type (Baltas et al., 1997). Another important point to make is that the nested logit model is a combination of standard logit models. Marginal and conditional choice decisions are combined by a nesting structure (Hensher et al., 2005). The only goal of this process is to accommodate the violation of the IIA-assumption.
3

The nested logit model differs from the standard logit model in that the error components of the choice alternatives do not necessarily need to have the same distribution. Thus the nested logit model accounts for the fact that each alternative may have specific information in its unobservable utility component, which plays a role in the decision process. Subsets of alternatives may have similar information content, such that correlations between pairs of alternatives may exist (Hensher et al., 2005). The classification of alternatives regarding their similarities into nests and the thus resulting tree structure does not have anything in common with a stochastic valuation of alternatives within the scope of a decision tree. Nested logit models do not define the process of decision-finding, but account for differences in variances in the unobservable utility components (Hensher et al., 2005).

3 The Specification of the Nested Logit Model

3.1 General Model Formulation

This article focuses on the example of a two-level nested logit model (see

Figure 1). In this case, the choice probability Pim of an alternative i within nest m results from the product of the marginal choice probability Pm for nest m (Level 2) and the conditional choice probability Pi|m for alternative i within nest m (Level 1). Both the marginal and the conditional choice

probability have the form of standard logit models. The inclusive value IVm as the expected utility of nest m connects the two decision levels and carries

the impact of lower level decisions into higher levels.

The random utility Uim of alternative im results from the sum of a marginal utility component Um from Level 2 and a conditional utility component Ui|m from Level 1, which both consist of a deterministic part V and a stochastic

part .

Uim = Um + Ui|m = (Vm + m) + (Vi|m + i|m)

(1)

The error terms m and i|m are independent of each other. The error terms i|m are identically and independently distributed (i.i.d.) extreme-value with scale parameter µm. This can be interpreted as a measure of the correlation of the alternatives' errors within nest m (Heiss, 2002). The compound error
term im is the sum of two stochastic error terms m and i|m, coming from the upper and lower level respectively. The compound error terms im are distributed such that the sum of Um and Ui|m, the maximum of the Ui|m, is

4

Nest 1

Level 2

Nest 2

Level 1
Alternative Alternative Alternative Alternative 11 12 21 22 Figure 1: Tree structure of a nested logit model

distributed extreme-value with scale parameter m (Ben-Akiva and Lerman,

1985; Hunt, 2000).

V ar(i|m)

=

2 6 µm2

(2)

V ar(im)

=

V ar(m

+

i|m)

=

2 6 m2

.

(3)

The scale parameters µ and  describe the variances of the unobservable

errors. Unconsidered utility components can variously impact the random

components. This leads to different variances, which are explicitly accounted

for by the introduction of these scale parameters. Each elemental alterna-

tive im has its own scale parameter µim. But as these need to be equal for all alternatives within a nest, the differentiation by i is redundant. The

alternative-specific scale parameters µim are replaced by nest-specific scale parameters µm. The scale parameters m are associated with the upper level, so that there is no need to replace them.

The compound unobservable utility components im contain variance components both from the lower and the upper decision level. Thus the variances

on the upper level cannot be smaller than those on the lower level. Therefore

the scale parameters need to satisfy the following condition (Carrasco and

de Dios Ortu¥zar, 2002; Hensher et al., 2005):

m < µm .

(4)

5

3.2 Different Nested Logit Model Specifications
Koppelman and Wen (1998a,b), Hunt (2000), Heiss (2002), and Train (2003) point to the existence of different nested logit model specifications and the issues arising from this regarding different estimation results. The non-normalized nested logit (NNNL) model was derived from the standard logit model to relax the IIA-assumption. The elementary NNNL form is not consistent with utility maximization theory (Koppelman and Wen, 1998b). On the other hand, the utility maximization nested logit (UMNL) model, which was derived from McFadden's Generalized Extreme Value (GEV) theory (McFadden, 1978, 1981), is consistent with the utility maximization theory (Koppelman and Wen, 1998b). The difference between these nested logit model specifications lies in the explicit scaling of the deterministic utility component in the UMNL form. In the case of generic coefficients, this means for the NNNL specification that the estimated parameters are indeed constant for all alternatives but not the hidden "true" parameters. The reason lies in the implicit nest-specific scaling within the NNNL specification (Heiss, 2002). Table 1 compares the two specifications (Koppelman and Wen, 1998a; Hunt, 2000). The letters m and n represent the nests on Level 2, with m=n , and the letters i and j denote the elemental alternatives on Level 1, with i=j . The set of all elemental alternatives within nest m is called Cm.
Due to identification problems, one of the scale parameters in the util-

Table 1: Specifications of the nested logit model

Pm Pi|m I Vm

UMNL utility maximization nested logit

exp

(m

Vm

+

m µm

I Vm )

n

exp

(n

Vn

+

n µn

I Vn )

exp (µm Vi|m)

exp (µm Vj|m)

jCm

ln exp (µm Vj|m)

jCm

NNNL non-normalized nested logit

exp

(Vm

+

1 µm

I Vm )

n

exp (Vn +

1 µn

I Vn )

exp (Vi|m)

exp (Vj|m)

jCm

ln exp (Vj|m)

jCm

6

ity maximization nested logit (UMNL) specification needs to be normal-
ized to 1 (Daly, 2001; Hunt, 2000). A normalization on the lower Level
1 (µm = µn = 1) leads to the RU1 UMNL model; a normalization on the upper Level 2 (m = n = 1) results in the RU2 UMNL model (Hensher et al., 2005).

3.3 Testing the Nested Logit Models Regarding Consistency with Random Utility Theory

To be consistent with utility maximization theory, each alternative's choice

probability must not change when adding a constant term a to each alterna-

tive's deterministic utility component (Koppelman and Wen, 1998b).

Formally, this means that the new deterministic utility component Vin|mew results from the sum of the old deterministic utility component Vi|m and a

constant term a.

Vin|mew = Vi|m + a

(5)

To be theory-consistent, the new choice probability (Pinmew) has to be equal to the old choice probability (Pim) for alternative im:

Pinmew = Pim

(6)

The procedure of testing for theory consistency is shown as an example with
the non-normalized nested logit (NNNL) specification. The new inclusive value (IVmnew) is compared with the old inclusive value (IVm), the new conditional choice probability (Pin|mew) is compared with the old conditional choice probability (Pi|m), and the new marginal choice probability (Pmnew) is com-

7

pared with the old marginal choice probability (Pm).

IVmnew = ln

exp Vj|m + a

jCm

= ln

exp (Vj|m) exp (a)

jCm

= ln exp (a)

exp (Vj|m)

jCm

= ln (exp (a)) + ln

exp (Vj|m)

jCm

= a + ln

exp (Vj|m)

jCm

= a + IVm

Pin|mew =

exp (Vi|m + a) exp (Vj|m + a)

jCm

= exp (Vi|m) exp (a) exp (Vj|m) exp (a)
jCm

=

exp (Vi|m) exp (a)

exp (a)

exp (Vj|m)

jCm

=

exp (Vi|m) exp (Vj|m)

jCm

= Pi|m

(7) (8)

8

Pmnew = = =

exp (Vm

+

1 µm

IVm )

n

exp (Vn

+

1 µn

I Vn )

exp (Vm

+

1 µm

(a

+

I Vm ))

n

exp (Vn

+

1 µn

(a

+

I Vn ))

exp (Vm) exp

a µm

exp

1 µm

I Vm

exp (Vn) exp
n

a µn

exp

1 µn

I Vn

only if µm = µn = µ holds, then

=

exp

a µ

exp (Vm) exp

1 µ

I Vm

exp

a µ

exp (Vn) exp

1 µ

I Vn

n

=

exp (Vm

+

1 µ

I Vm )

n

exp (Vn

+

1 µ

I Vn )

= Pm

(9)

Analogous to this procedure, consistency with random utility theory can be
tested for the Level 1 normalized (µm = µn = 1) utility maximization nested logit (RU1 UMNL) model and the Level 2 normalized (m = n = 1) utility maximization nested logit (RU2 UMNL) model.
Table 2 summarizes the results. In the NNNL and the RU1 UMNL specification, the new inclusive value IVmnew equals the sum of the old inclusive value IVm and the added constant term a. In the RU2 UMNL model, the added constant term a is additionally scaled with the scale parameter µm. While the new choice probability Pin|mew does not differ from the old choice probability Pi|m in all three nested logit specifications, the new choice probability Pmnew on the upper level differs from the old one. Without imposing restrictions,
just the RU2 UMNL specification satisfies the demand of consistency with
utility theory. Only in the RU2 form does the choice probability Pim equal the choice probability Pinmew after adding a term a to the utility component Vi|m. In the RU1 UMNL specification, consistency can only be reached by imposing the restriction m = n = . As shown in (9), consistency with random utility theory can be ensured in the NNNL form by imposing the

9

Table 2: Nested logit specifications and utility maximization

Vin|mew I Vmnew Pin|mew Pmnew Pinmew

NNNL non-normalized nested logit
Vi|m + a IVm + a Pi|m = Pm = Pim

UMNL utility maximization nested logit RU1 RU2 (µm = µn = 1) (m = n = 1)

Vi|m + a
IVm + a Pi|m
= Pm = Pim

Vi|m + a
IVm + a µm Pi|m
Pm Pim

restriction µm = µn = µ. The new choice probability of an alternative im results as the product of the new marginal choice probability Pmnew and the new conditional choice probability Pin|mew. Because of the generally not theory-consistent results on the level of the marginal choice probabilities in the non-normalized nested logit (NNNL) and the Level 1 normalized utility maximization nested logit (RU1 UMNL) specification, only the Level 2 normalized utility maximization nested logit (RU2 UMNL) specification satisfies condition (6).
4 Estimation of Nested Logit Models
Before estimating a nested logit model with a specific software package, the implemented nested logit model specification (utility maximization nested logit or non-normalized nested logit) needs to be investigated. The software packages SAS R (SAS, 2004) and ALOGIT R (see Carrasco and de Dios Ortu¥zar (2002)) use the non-normalized nested logit (NNNL) specification for model estimation. STATA R (Heiss, 2002), LIMDEP R (Hunt, 2000; Hensher and Greene, 2002) and GAUSS R (Carrasco and de Dios Ortu¥zar, 2002) offer the possibility to choose between the nonnormalized nested logit (NNNL) and the utility maximization nested logit (UMNL) specification.
10

generic coefficients

without generic coefficients

no equality constraint on IV-parameters

equality constraint on IV-parameters

red
NNNL (A)

red/ green
UMNL NNNL (B) (C)

green

green

UMNL NNNL UMNL

(D) (E)

(F)

Figure 2: Overview of different model types with color indication of theory consistency

In case only NNNL software is available, there are several particularities in model estimation to take into consideration. The crucial point is whether there are only alternative-specific coefficients in the model, or also at least one generic coefficient. Generic coefficients are constant for all alternatives. A variation on the utility contribution could be reached via alternative-specific values of the corresponding variables. Moreover, Hunt (2000) points to the peculiarities of partially degenerate model structures. Nests with only one elemental alternative are called degenerate nests. For further and detailed information regarding the estimation procedure when degenerate nests enter the model, the reader is referred to the literature (Hunt, 2000; Heiss, 2002; Hensher et al., 2005).

4.1 Alternative-Specific Coefficients
If there are no generic coefficients in the model (Models E and F in Figure 2), the non-normalized nested logit (NNNL) and the utility maximization
11

nested logit (UMNL) specification are equivalent (Heiss, 2002). To speak

with the colors of traffic-lights, the Models E and F have green light re-

garding their consistency with random utility theory. But the coefficients

estimated with NNNL software are to be re-scaled with the according esti-

mated IV-parameter. Only then a correct interpretation is possible. It must

be taken into account which alternative belongs to which nest. The estimated

alternative-specific coefficient i|m has to be scaled with the corresponding

nest-specific

IV-parameter

1 µm

.

iU|mMNL = iN|mNNL 

1 NNNL µm

(10)

The Models E and F are not focused on in detail, because in marketing models usually at least one variable with a generic coefficient, i. e. one exogenous variable with a constant coefficient for all alternatives, enters the model. Typically in modelling purchase decisions, this is the variable "price" as one of the central marketing-mix elements.

4.2 Generic Coefficients
Random utility maximizing models can generally not be estimated with nonnormalized nested logit (NNNL) software when generic coefficients enter the model (Model A in Figure 2). When it comes to consistency with random utility theory, the "lights are red". If utility maximization nested logit (UMNL) software is used in the case of generic coefficients in the model (Model B in Figure 2), a distinction between the RU1 and RU2 normalization has to be made (see Section 3.2). The RU1 normalization leads to a model specification that is not consistent with random utility theory (red lights), whereas the RU2 normalization results in a theory-consistent specification (see Table 2) and gets green light. If an equality constraint is put on the IVparameters when generic coefficients are present in the model, both NNNL software (Model C in Figure 2) and UMNL software (Model D in Figure 2) can be used to estimate a model consistent with random utility theory (green lights for both). As can be seen from Table 1, only in the utility maximization nested logit (UMNL) specification are the deterministic utility components Vm and Vi|m scaled explicitly with the parameters m and µm respectively. Table 3 refers to this with an example of the conditional deterministic utility component.

12

The conditional deterministic utility component Vi|m results as the product of a generic coefficient  and the alternative-specific values of the vector of
the exogenous variables Xi.

Table 3: Scaling of the deterministic utility component

NNNL non-normalized nested logit
Vi|m =  Xi

UMNL utility maximization nested logit
µm Vi|m = µm  Xi

Contrary to the explicit scaling in the UMNL specification, the coefficients

in the NNNL specification are automatically and implicitly nest-specifically

scaled. The coefficients estimated in the NNNL model are thus not the "true"

coefficients. In fact the estimated coefficients are constant for all alternatives,

but not the hidden "true" coefficients. And this is a violation of the defini-

tion of generic coefficients.

By imposing restrictions it can be guaranteed that, even when using NNNL

software, parameters consistent with random utility can be estimated (Model

C in Figure 2). It has to be assured that the coefficients in each nest are

scaled equally. The IV-parameters have thus to be constrained to be equal

for all nests. But, of course, each restriction on the parameter estimates

means a loss of information in the data.

Studies have shown that the restricted form of the non-normalized nested

logit (NNNL) model (Model C in Figure 2) reproduces the estimation results

of the restrictive Level 1 normalized utility maximization nested logit (RU1

UMNL) form (Model D in Figure 2) (Hunt, 2000; Heiss, 2002; Hensher and

Greene, 2002). Re-scaling the parameter estimates in the restrictive NNNL

model with the estimated IV-parameter results in the parameter estimates

of the restrictive Level 2 normalized utility maximization nested logit (RU2

UMNL) model.

NNNLres = RU1res

(11)

NNNLres  IVNNNLres = RU2res

(12)

Koppelman and Wen (1998a) have shown a second possibility to guarantee the consistency with utility maximizing theory without imposing restrictions

13

on the IV-parameters. First, additional dummy nests below the lowest level are to be introduced into the model, and second, the thus additionally estimated scale parameters have to be defined in such a way that "the product of all the ratios of scale parameters between levels must be identical from the root to all elemental alternatives" (Hensher and Greene (2002), p. 13).

5 Simulation Study with a Software Comparison

An appropriate way to test model validity is to conduct a simulation study where the true parameters are known and correlations are determined. When the sample size is large, the estimated parameters should be very close to the true parameters (Cameron and Trivedi, 2005). As was shown in Section 3.3, without imposing restrictions, only the Level 2 normalized utility maximization nested logit (RU2 UMNL) specification is consistent with random utility theory. In the following, four simulated data sets (each having n = 4, 000 observations) are generated with the software SAS R 9.1.3. In this simulation study the coffee market is simulated in a very simplistic manner. The simulated market consists of only two brands A and B, where both offer variants containing caffeine and decaffeinated. Figure 3 shows the nest structure of this discrete choice situation.
According to Equation (1), the random utility Uim of each alternative im results from the sum of a marginal utility component Um from Level 2 and a conditional utility component Ui|m from Level 1, which both consist of a deterministic part V and a stochastic part . In this study, the deterministic marginal utility component Vm is neglected. It is often hard to find any variables that are nest- rather than alternative-specific. But even if a nestspecific variable does exist, specifying this variable for the nest or for all alternatives within this nest does not make a difference (Heiss, 2002). The stochastic marginal utility component m, which captures all unobservable and omitted effects, must be integrated into the model despite the nonexistence of the deterministic marginal utility component Vm. Consequently, the overall utility for this simulation study arises from

Uim = Vi|m + (i|m + m) .

(13)

14

Brand A

Level 2
m=1,2

Brand B

Level 1
i=1,2,3,4

containing decaffeinated containing decaffeinated

caffeine

caffeine

Figure 3: Two-level nested logit model

Furthermore, the explanatory variables price (PRI), promotion (PRO), and

age of the decision maker (AGE) are included in the model. Alternative-

specific constants (ASC) are neglected in this simulation study, but must

be integrated in the model when estimating with real data. The underlying

deterministic conditional utility component for this simulation study is as

follows

Vi|m = i|m AGEh + pri P RIi|m + pro P ROi|m .

(14)

The variables PRI and PRO are such with generic coefficients (see section 4.2), i. e. they have a constant coefficient  for all alternatives. The alternative containing caffein in nest Brand A (cc|A) is declared as reference point, and its alternative-specific coefficient K|A is set to zero. For the simulation of the data sets, the following assumptions are made:

∑ age

≠ AGE=1: p=0.15 ≠ AGE=2: p=0.20 ≠ AGE=3: p=0.30 ≠ AGE=4: p=0.20 ≠ AGE=5: p=0.15

∑ price

15

≠ normal with [2 .79 ; 0 .20 2 ]

∑ promotion

≠ uniform in [0;1], rounded to 0 or 1

In a first step, we calculate the choice probabilities Pihm for each household h for all alternatives im according to the NNNL model structure (Table 1)

and the deterministic utility component as specified in Equation (14). Ac-

cording to Brownstone and Small (1989) we then randomly generate individ-

ual choices by drawing a random number x from a uniform distribution on

[0, 1]. The household chooses alternative k if

k-1 j=0

Pj

<

x



k j=0

Pj ,

where

P0 = 0. These choices are then used as dependent variables to compute

the estimators. Model estimation is done with the procedure PROC MDC

in SAS R 9.1.3, and with the commands nlogit and nlogitrum in STATA R

9.1. The NNNL specification underlies the procedure PROC MDC and the

command nlogit (see SAS (2004) and Heiss (2002)), and the RU2 UMNL

specification underlies the command nlogitrum (see Heiss (2002)).

5.1 Models
According to the utility maximization nested logit RU2 (UMNL) specification, the scale parameters A and B are set equal to 1. When simulating data for the Models 1 and 2, the scale parameters µA and µB are not imposed by an equality constraint. Whereas when simulating data for the Models 3 and 4, the scale parameters µA and µB are set equal. Table 4 gives a model overview. The data generation for the simulation study was done assuming random utility maximization theory. According to Figure 2 four different cases (A, B, C, D) need to be considered when estimating models with generic coefficients. Moreover, data generation and estimation were done with and without equality constraint on the scale parameters. Taken together these two aspects we can differentiate eight scenarios as shown in Table 5. Model 1 corresponds to the Models A and B in Figure 2, Model 4 to the Models C and D accordingly. Model 1 estimated with NNNL software should not be able to reproduce the input coefficients (branch A in Figure 2), but when estimated with UMNL software (branch B in Figure 2) should reproduce the input values. Model 4 is expected to reproduce the coefficients' input values, no matter what software is used for estimation (branches C and D in Figure
16

Table 4: Model Overview

Data Generation

Estimation

without

equality constraint equality constraint

(A), (B)

(C), (D)

without equality constraint (µA = 1.3, µB = 1.7)

Model 1

Model 2

equality constraint (µA = µB = 1.8)

Model 3

Model 4

Table 5: Overview of Scenarios

Data generation Estimation

Expected

= consistent RUM consistent

estimation? with RUM? data reproduction

Model 1 Model 2 Model 3 Model 4

NNNL UMNL NNNL UMNL NNNL UMNL NNNL UMNL

yes yes no no no no yes yes

no (A) yes (B) yes (C) yes (D) no (A) yes (B) yes (C) yes (D)

no yes no no no no yes yes

2). The Models 2 and 3 should per se not be able to reproduce the input coefficients, because when generating these input data sets conditions different from those with data estimation were assumed, i.e. data generation without equality constraint and estimation with equality constraint for Model 2, and data generation with equality constraint and estimation without equality constraint for Model 3.
17

Even when using NNNL software, coefficients consistent with random utility theory can be estimated with Models 2 and 4 because of the estimation with equality constraint. The coefficients of the exogenous variables generated with SAS R are estimated with SAS R and STATA R . The analysis was repeated for 100 artificial data sets with the same parameter values. The means and test results of the estimated parameters for Model 1 and Model 4 are displayed in Tables 6 to 13. In the utility maximization nested logit (UMNL) model, the IV-parameters only capture the (dis-)similarity of the alternatives within the nest. The IV-parameters in the non-normalized nested logit (NNNL) model capture another effect: the relative importance of the variables with generic coefficients for the alternatives within the corresponding nest (see Heiss (2002), p. 240). Although these two effects are not in line, they are captured in the NNNL model with one single IV-parameter. The "generic" specification of the NNNL model implies a contradictory restriction. This is the reason why "generic" models should not be estimated with NNNL software without imposing restrictions. Only if it is a priori assumed that the IV-parameters are the same in all nests, the scaling problem of the NNNL model can be avoided. The presence of generic coefficients then does not bias the estimates of the NNNL model, because the coefficients are equally scaled in each nest.
5.2 Estimation Results
For Model 1 data generation and estimation was done without putting an equality constraint on the scale parameters. Only the estimation with the UMNL software is consistent with random utility theory. As there are generic coefficients (pri and pro) in the model, only the UMNL software estimation should result in RUM consistent estimates (Table 5). As it was expected the non-normalized nested logit (NNNL) software estimates do not equal their input values, but the UMNL software estimates do. To confirm this obvious result several t-tests were conducted (see Table 7). The hypothesis that the estimated mean parameter value over 100 iterations equals the true (input) value only has to be rejected for the dc|B parameter. The hypotheses for all other parameters cannot be rejected on the 95% confidence level. This means that the means of the estimated parameters equal their input values used for data generation.
18

Table 6: Estimation results for Model 1

parameter name
dc|A cc|B dc|B pri pro I VA I VB

input value
0.50 -0.50 -1.00 -0.80 1.70 0.77 0.59

SAS R PROC MDC
NNNL
0.73 -0.69 -1.50 -0.84 2.38 0.73 0.51

STATA R nlogit NNNL
0.73 -0.69 -1.50 -0.84 2.38 0.73 0.51

STATA R nlogitrum RU2 UMNL
0.50 -0.51 -1.04 -0.80 1.71 0.78 0.60

Displayed estimates are mean values over 100 iterations.   = 0.01; observations = 4, 000; iterations = 100

19

Table 7: Separate t-tests for Model 1 nlogitrum parameter estimates

name
dc|A cc|B dc|B pri pro µA µB

H0
0.50 -0.50 -1.00 -0.80 1.70 1.30 1.70

mean
0.50 -0.51 -1.04 -0.80 1.71 1.28 1.67

t value
0.53 -1.96 -2.59 -0.14 0.30 0.47 0.36

Pr> |t|
0.5971 0.0531 0.0111 0.8875 0.7668 0.6389 0.7212

n

=

100;

df

=

99;

µ

=

 IV

with  = 1

For Model 2 data generation was done without, estimation was done with equality constraint, leading to RUM consistent estimates in any case. But due to the different assumptions for data generation and estimation, the estimated parameters are largely expected not to equal their input values. The estimation with the NNNL software leads to wrong parameter estimates without any re-scaling option. The main issue when estimating model 2 lies in the wrong scale parameter estimate for nest B. As the t-tests in Table 9 show the parameters related to nest B (cc|B, dc|B, µB) cannot be reproduced with the nlogitrum command. The estimation with the nlogitrum command is able to reproduce some of the input values, but in general all three estimations lead to wrong parameter estimates.

20

Table 8: Estimation results for Model 2

parameter name
dc|A cc|B dc|B pri pro I VA I VB

input value
0.50 -0.50 -1.00 -0.80 1.70 0.77 0.59

SAS R PROC MDC
NNNL
0.66 -0.71 -1.49 -1.07 2.28 0.76 0.76

STATA R nlogit NNNL
0.66 -0.71 -1.49 -1.07 2.28 0.76 0.76

STATA R nlogitrum RU2 UMNL
0.50 -0.53 -1.13 -0.80 1.70 0.75 0.75

Displayed estimates are mean values over 100 iterations.   = 0.01; observations = 4, 000; iterations = 100

21

Table 9: Separate t-tests for Model 2 nlogitrum parameter estimates

name
dc|A cc|B dc|B pri pro µA µB

H0
0.50 -0.50 -1.00 -0.80 1.70 1.30 1.70

mean
0.50 -0.53 -1.13 -0.80 1.70 1.33 1.33

t value
-0.55 -4.50 -9.19 0.01 0.16 -1.34 12.98

Pr> |t|
0.5846 0.0001 0.0001 0.9946 0.8717 0.1827 0.0001

n

=

100;

df

=

99;

µ

=

 IV

with  = 1

For Model 3 data generation was done with, estimation was done without equality constraint. All three estimations result in the same scale parameter estimates which equal the input values constrained to equality. Thus, even though different assumptions were taken for data generation and estimation, the estimation results solve this issue leading to RUM consistent estimates in any case. The NNNL parameter estimates can be rescaled by multiplication with the (equal) scale parameters. Unfortunately, the H0 hypotheses for the parameters cc|B and dc|B have to be rejected (Table 11). In general, the estimation results for Model 3 are somewhat unexpected.

22

Table 10: Estimation results for Model 3

parameter name
dc|A cc|B dc|B pri pro I VA I VB

input value
0.50 -0.50 -1.00 -0.80 1.70 0.56 0.56

SAS R PROC MDC
NNNL
0.91 -0.93 -1.85 -1.45 3.08 0.56 0.57

STATA R nlogit NNNL
0.91 -0.93 -1.85 -1.45 3.08 0.56 0.57

STATA R nlogitrum RU2 UMNL
0.50 -0.51 -1.04 -0.80 1.71 0.56 0.57

Displayed estimates are mean values over 100 iterations.   = 0.01; observations = 4, 000; iterations = 100

23

Table 11: Separate t-tests for Model 3 nlogitrum parameter estimates

name
dc|A cc|B dc|B pri pro µA µB

H0
0.50 -0.50 -1.00 -0.80 1.70 1.80 1.80

mean
0.50 -0.51 -1.04 -0.80 1.71 1.79 1.75

t value
0.27 -2.08 -2.79 -0.00 0.24 -0.11 0.46

Pr> |t|
0.7850 0.0401 0.0064 0.9973 0.8092 0.9147 0.6489

n

=

100;

df

=

99;

µ

=

 IV

with  = 1

The remarkable particularity in Model 4 (data generation and estimation
with equality constraint) is that the parameter estimates with the NNNL
software can be transferred according to Equation (12), resulting in the
parameter estimates with the UMNL software. The parameters estimated with STATA R nlogitrum equal a multiple of the parameters estimated with SAS R PROC MDC or STATA R nlogit respectively. The parameters esti-
mated in the NNNL models do not have any meaning before a re-scaling, i. e.
their multiplication with the estimated IV-parameter, and can therefore not
be interpreted in the sense of random utility theory. Possible discrepancies
of the parameters are caused by rounding. All except for one parameter estimates with the command nlogitrum in STATA R significantly equal the true
values, which were used when simulating the data set. Separate t-tests of the
hypotheses that the estimated parameters equal their true values shed more
light on this (Table 13). The hypotheses for all but one (dc|B) parameter cannot be rejected on the 95% confidence level.

24

Table 12: Estimation results for Model 4

parameter name
dc|A cc|B dc|B pri pro I VA I VB

input value
0.50 -0.50 -1.00 -0.80 1.70 0.56 0.56

SAS R PROC MDC
NNNL
0.91 -0.93 -1.85 -1.45 3.08 0.56 0.56

STATA R nlogit NNNL
0.91 -0.93 -1.85 -1.45 3.08 0.56 0.56

STATA R nlogitrum RU2 UMNL
0.50 -0.51 -1.03 -0.80 1.70 0.56 0.56

Displayed estimates are mean values over 100 iterations.   = 0.01; observations = 4, 000; iterations = 100

Table 13: Separate t-tests for Model 4 nlogitrum parameter estimates

name
dc|A cc|B dc|B pri pro
µ

H0
0.50 -0.50 -1.00 -0.80 1.70 1.80

mean
0.50 -0.51 -1.03 -0.80 1.70 1.79

t value
0.25 -1.91 -2.87 0.08 0.20 -0.09

Pr> |t|
0.8042 0.0588 0.0050 0.9354 0.8412 0.9284

n

=

100;

df

=

299;

µ

=

 IV

with  = 1

25

6 Summary
Although the nested logit model has, because of its ability to account for similarities between alternative via partial correlation of the error terms, received increasing attention, the various specifications of the nested logit model have only marginally been focused on. But this differentiation gets its special relevance from the fact that generally only the RU2 UMNL specification is consistent with random utility theory. Both estimations with real data and simulation studies require investigating the software's underlying nested logit specification. Whereas in estimations with utility maximization nested logit (UMNL) software no particularities are to be considered, estimation with non-normalized nested logit (NNNL) software proves to be more difficult. Only by imposing restrictions on the IV-parameters or by introducing dummy nests can estimation results consistent with random utility theory be reached. It was demonstrated that when using NNNL software without imposing restrictions, a model consistent with random utility theory can not be estimated (see Table 2 and Section 3.3). Three cases are to be distinguished: (1) model without generic coefficients, (2) model with generic coefficients and without equality constraint on the scale parameters, and (3) model with generic coefficients and with equality constraint on the scale parameters. In case (1) the coefficients estimated with NNNL software (e. g. PROC MDC in SAS R ) can be transferred to the coefficients estimated with UMNL software (e. g. nlogitrum in STATA R ) by multiplying them with the estimated IV-parameter. The thus re-scaled coefficients are the "true" model coefficients. This article did not dwell on case (1) as in marketing applications mostly at least one variable with a generic coefficient (e. g. price) enters the model. A model estimated with NNNL software in case (2) is not applicable. This becomes especially relevant if the software user is not aware of the described issue of different nested logit model specifications. Here the danger of a wrong model estimation is very high. If UMNL software is used in case (2), the distinction between RU1 and RU2 normalization has to be made. A model with RU1 normalization is not consistent with random utility theory and thus the same conclusions as for the NNNL software are true. In contrast, the RU2 normalization is theory-consistent. The estimation results in case (3) show that the coefficients estimated with NNNL software can be transferred to the coefficients estimated with UMNL software by multiplying them with the estimated IV-
26

parameter. For data generation with an equality constraint on the nest-specific scale parameters and model estimation with an equality constraint on the IVparameters (Model 4 in Table 4), leading to consistency with random utility theory in any case, the reproduction of the generic coefficients' input values succeeds.
27

References
Ailawadi KL, Neslin SA (1998) The Effect of Promotion on Consumption: Buying More and Consuming It Faster. Journal of Marketing Research 35(3):390≠398
Anderson SP, de Palma A (1992) Multiproduct Firms: A Nested Logit Approach. The Journal of Industrial Economics 40(3):261≠276
Baltas G, Doyle P, Dyson P (1997) A model of consumer choice for national vs private label brands. Journal of the Operational Research Society 48(10):988≠995
Ben-Akiva M, Lerman SR (1985) Discrete Choice Analysis: Theory and Application to Travel Demand, sixth printing 1994 edn. The MIT Press, Cambridge/Massachusetts
Bhat CR (1997) Covariance Heterogeneity in Nested Logit Models: Econometric Structure and Application to Intercity Travel. Transportation Research B 31(1):11≠21
Brownstone D, Small KA (1989) Efficient Estimation of Nested Logit Models. Journal of Business & Economic Statistics 7(1):67≠74
Cameron AC, Trivedi PK (2005) Microeconometrics. Cambridge University Press
Carrasco JA, de Dios Ortu¥zar J (2002) Review and assessment of the nested logit model. Transport Reviews 22(2):197≠218
Chib S, Seetharaman PB, Strijnev A (2004) Model of Brand Choice with a No-Purchase Option Calibrated to Scanner-Panel Data. Journal of Marketing Research 41(2):184≠196
Chintagunta PK (1993) Investigating Purchase Incidence, Brand Choice and Purchase Quantity Decisions of Households. Marketing Science 12(2):184≠ 208
Chintagunta PK, Vilcassim NJ (1998) Empirical implications of unobserved household heterogeneity for manufacturer and retailer pricing. Journal of Retailing and Consumer Services 5(1):15≠24
28

Daly A (2001) Alternative tree logit models: comments on a paper of Koppelman and Wen. Transportation Research Part B 35(8):717≠724
de Dios Ortu¥zar J (2001) On the development of the nested logit model. Transportation Research Part B 35(2):213≠216
Guadagni PM, Little JDC (1983) A Logit Model of Brand Choice Calibrated on Scanner Data. Marketing Science 2(3):203≠238
Guadagni PM, Little JDC (1998) When and What to Buy: A Nested Logit Model of Coffee Purchase. Journal of Forecasting 17(3/4):303≠326
Heiss F (2002) Structural choice analysis with nested logit models. The Stata Journal 2(3):227≠252
Hensher DA, Greene WH (2002) Specification and estimation of the nested logit model: alternative normalisations. Transportation Research Part B 36(1):1≠17
Hensher DA, Rose JM, Greene WH (2005) Applied Choice Analysis. Cambridge University Press
Hunt GL (2000) Alternative Nested Logit Model Structures and the Special Case of Partial Degeneracy. Journal of Regional Science 40(1):89≠113
Kamakura WA, Kim BD, Lee J (1996) Modeling Preference and Structural Heterogeneity in Consumer Choice. Marketing Science 15(2):152≠172
Kannan PK, Wright GP (1991) Modeling and Testing Structured Markets: A Nested Logit Approach. Marketing Science 10(1):58≠82
Knapp TA, White NE, Clark DE (2001) A Nested Logit Approach to Household Mobility. Journal of Regional Science 41(1):1≠22
Koppelman FS, Wen CH (1998a) Alternative Nested Logit Models: Structure, Properties and Estimation. Transportation Research B 32(5):289≠298
Koppelman FS, Wen CH (1998b) Nested Logit Models: Which Are You Using? Transportation Research Record 1645:1≠7
McFadden D (1974) Conditional logit analysis of qualitative choice behavior. In: Zarembka P (ed) Frontiers in econometrics, pp 105≠142
29

McFadden D (1978) Modelling the choice of residential location. In: Karlqvist A, Lundqvist L, Snickars F, Weibull JW (eds) Spatial Interaction Theory and Planning Models, North-Holland Publishing Company, Amsterdam New York Oxford, pp 75≠96
McFadden D (1981) Econometric Models of Probabilistic Choice. In: Manski CF, McFadden D (eds) Structural Analysis of Discrete Data with Econometric Applications, The MIT Press, Cambridge, pp 198≠272
Munizaga MA, Alvarez-Daziano R (2001) Mixed Logit vs. Nested Logit and Probit Models. Tech. rep., Universidad de Chile
SAS (2004) SAS/ETS 9.1 User's Guide. SAS Publishing, Cary/NC, USA Su¥arez A, del Bosque IR, Rodr¥iguez-Poo JM, Moral I (2004) Accounting for
heterogeneity in shopping centre choice models. Journal of Retailing and Consumer Services 11:119≠129 Sun B, Neslin SA, Srinivasan K (2003) Measuring the Impact of Promotions on Brand Switching When Consumers Are Forward Looking. Journal of Marketing Research 40(4):389≠405 Train KE (1980) A Structured Logit Model of Auto Ownership and Mode Choice. Review of Economic Studies 47:357≠370 Train KE (2003) Discrete Choice Methods with Simulation. Cambridge University Press
30

SFB 649 Discussion Paper Series 2007
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Trade Liberalisation, Process and Product Innovation, and Relative Skill Demand" by Sebastian Braun, January 2007.
002 "Robust Risk Management. Accounting for Nonstationarity and Heavy Tails" by Ying Chen and Vladimir Spokoiny, January 2007.
003 "Explaining Asset Prices with External Habits and Wage Rigidities in a DSGE Model." by Harald Uhlig, January 2007.
004 "Volatility and Causality in Asia Pacific Financial Markets" by Enzo Weber, January 2007.
005 "Quantile Sieve Estimates For Time Series" by J¸rgen Franke, JeanPierre Stockis and Joseph Tadjuidje, February 2007.
006 "Real Origins of the Great Depression: Monopolistic Competition, Union Power, and the American Business Cycle in the 1920s" by Monique Ebell and Albrecht Ritschl, February 2007.
007 "Rules, Discretion or Reputation? Monetary Policies and the Efficiency of Financial Markets in Germany, 14th to 16th Centuries" by Oliver Volckart, February 2007.
008 "Sectoral Transformation, Turbulence, and Labour Market Dynamics in Germany" by Ronald Bachmann and Michael C. Burda, February 2007.
009 "Union Wage Compression in a Right-to-Manage Model" by Thorsten Vogel, February 2007.
010 "On -additive robust representation of convex risk measures for unbounded financial positions in the presence of uncertainty about the market model" by Volker Kr‰tschmer, March 2007.
011 "Media Coverage and Macroeconomic Information Processing" by Alexandra Niessen, March 2007.
012 "Are Correlations Constant Over Time? Application of the CC-TRIGt-test to Return Series from Different Asset Classes." by Matthias Fischer, March 2007.
013 "Uncertain Paternity, Mating Market Failure, and the Institution of Marriage" by Dirk Bethmann and Michael Kvasnicka, March 2007.
014 "What Happened to the Transatlantic Capital Market Relations?" by Enzo Weber, March 2007.
015 "Who Leads Financial Markets?" by Enzo Weber, April 2007. 016 "Fiscal Policy Rules in Practice" by Andreas Thams, April 2007. 017 "Empirical Pricing Kernels and Investor Preferences" by Kai Detlefsen,
Wolfgang H‰rdle and Rouslan Moro, April 2007. 018 "Simultaneous Causality in International Trade" by Enzo Weber, April
2007. 019 "Regional and Outward Economic Integration in South-East Asia" by
Enzo Weber, April 2007. 020 "Computational Statistics and Data Visualization" by Antony Unwin,
Chun-houh Chen and Wolfgang H‰rdle, April 2007. 021 "Ideology Without Ideologists" by Lydia Mechtenberg, April 2007. 022 "A Generalized ARFIMA Process with Markov-Switching Fractional
Differencing Parameter" by Wen-Jen Tsay and Wolfgang H‰rdle, April 2007.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

023 "Time Series Modelling with Semiparametric Factor Dynamics" by Szymon Borak, Wolfgang H‰rdle, Enno Mammen and Byeong U. Park, April 2007.
024 "From Animal Baits to Investors' Preference: Estimating and Demixing of the Weight Function in Semiparametric Models for Biased Samples" by Ya'acov Ritov and Wolfgang H‰rdle, May 2007.
025 "Statistics of Risk Aversion" by Enzo Giacomini and Wolfgang H‰rdle, May 2007.
026 "Robust Optimal Control for a Consumption-Investment Problem" by Alexander Schied, May 2007.
027 "Long Memory Persistence in the Factor of Implied Volatility Dynamics" by Wolfgang H‰rdle and Julius Mungo, May 2007.
028 "Macroeconomic Policy in a Heterogeneous Monetary Union" by Oliver Grimm and Stefan Ried, May 2007.
029 "Comparison of Panel Cointegration Tests" by Deniz Dilan Karaman ÷rsal, May 2007.
030 "Robust Maximization of Consumption with Logarithmic Utility" by Daniel Hern·ndez-Hern·ndez and Alexander Schied, May 2007.
031 "Using Wiki to Build an E-learning System in Statistics in Arabic Language" by Taleb Ahmad, Wolfgang H‰rdle and Sigbert Klinke, May 2007.
032 "Visualization of Competitive Market Structure by Means of Choice Data" by Werner Kunz, May 2007.
033 "Does International Outsourcing Depress Union Wages? by Sebastian Braun and Juliane Scheffel, May 2007.
034 "A Note on the Effect of Outsourcing on Union Wages" by Sebastian Braun and Juliane Scheffel, May 2007.
035 "Estimating Probabilities of Default With Support Vector Machines" by Wolfgang H‰rdle, Rouslan Moro and Dorothea Sch‰fer, June 2007.
036 "Yxilon ≠ A Client/Server Based Statistical Environment" by Wolfgang H‰rdle, Sigbert Klinke and Uwe Ziegenhagen, June 2007.
037 "Calibrating CAT Bonds for Mexican Earthquakes" by Wolfgang H‰rdle and Brenda LÛpez Cabrera, June 2007.
038 "Economic Integration and the Foreign Exchange" by Enzo Weber, June 2007.
039 "Tracking Down the Business Cycle: A Dynamic Factor Model For Germany 1820-1913" by Samad Sarferaz and Martin Uebele, June 2007.
040 "Optimal Policy Under Model Uncertainty: A Structural-Bayesian Estimation Approach" by Alexander Kriwoluzky and Christian Stoltenberg, July 2007.
041 "QuantNet ≠ A Database-Driven Online Repository of Scientific Information" by Anton Andriyashin and Wolfgang H‰rdle, July 2007.
042 "Exchange Rate Uncertainty and Trade Growth - A Comparison of Linear and Nonlinear (Forecasting) Models" by Helmut Herwartz and Henning Weber, July 2007.
043 "How do Rating Agencies Score in Predicting Firm Performance" by Gunter Lˆffler and Peter N. Posch, August 2007.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

044 "Ein Vergleich des bin‰ren Logit-Modells mit k¸nstlichen neuronalen Netzen zur Insolvenzprognose anhand relativer Bilanzkennzahlen" by Ronald Franken, August 2007.
045 "Promotion Tournaments and Individual Performance Pay" by Anja Schˆttner and Veikko Thiele, August 2007.
046 "Estimation with the Nested Logit Model: Specifications and Software Particularities" by Nadja Silberhorn, Yasemin Boztu and Lutz Hildebrandt, August 2007.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

