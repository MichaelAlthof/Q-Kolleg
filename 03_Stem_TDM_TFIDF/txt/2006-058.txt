BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2006-058
Perpetual Barrier Options in Jump-Diffusion Models
Pavel V. Gapeev*
* Weierstrass Institute for Applied Analysis and Stochastics, Berlin, Germany and
Russian Academy of Sciences, Institute of Control Sciences, Moscow, Russia
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

Perpetual barrier options in jump-diffusion models
Pavel V. Gapeev
Abstract We present a closed form solution to the perpetual American double barrier call option problem in a model driven by a Brownian motion and a compound Poisson process with exponential jumps. The method of proof is based on reducing the initial irregular optimal stopping problem to an integro-differential free-boundary problem and solving the latter by using continuous and smooth fit. The obtained solution of the nontrivial free-boundary problem gives the possibility to observe some special analytic properties of the value function at the optimal stopping boundaries.
Key words: American double barrier options, optimal stopping problem, jump-diffusion model, integro-differential free-boundary problem, continuous and smooth fit, It^o-Tanaka-Meyer formula.
MSC (2000): Primary 60G40, 34K10, 91B28. Secondary 60J60, 60J75. JEL Classification: G13.
1 Introduction
The main aim of this paper is to present a closed form solution to the optimal stopping problem (2.3) for the process S = (St)t0 defined in (2.1)-(2.2). This problem is related to the option pricing theory in mathematical finance, where the process S can describe the price of a risky asset (e.g., a stock) on a financial market. In that case, the value (2.3) can
This research was supported by Deutsche Forschungsgemeinschaft through SFB 649 Economic Risk. Weierstraﬂ Institute for Applied Analysis and Stochastics (WIAS), Mohrenstr. 39, D-10117 Berlin, Germany, e-mail: gapeev@wias-berlin.de (Institute of Control Sciences, Russian Academy of Sciences, Profsoyuznaya Str. 65, 117997 Moscow, Russia)
1

be interpreted as a fair price of a perpetual double out-of-money call option of American type in a jump-diffusion model. The explicit expressions for the value function and the stopping boundary are derived by means of reducing the initial irregular optimal stopping problem (2.3) to the corresponding nontrivial integro-differential free-boundary problem (2.7)-(2.11) and solving the latter by applying continuous- and smooth-fit conditions. The obtained expressions give the possibility to observe explicitly that the value function (2.3) may not be smooth at the stopping boundary B and may not be continuous at the point of discontinuity L of the payoff function under some relationships on the parameters of the model. Such properties can be explained by the sample path behavior of the jumpdiffusion process S from (2.1)-(2.2) as well as by the discontinuity of the reward in (2.3). The regularity of the value function for optimal stopping problems for Markov processes with discontinuous rewards and viscosity solutions of the related variational inequalities were studied in [2]-[3] and [5].
For the classical Black-Merton-Scholes model driven by Brownian motion the problem (2.3) was considered in [4] for the single barrier case and both finite and infinite horizon, where the influence of the upper barrier on the stopping boundary was observed. The single upper barrier perpetual American put option problem with and without constraints on the short-selling of stock was considered in [13]. The closed-form expressions for the prices and optimal hedging strategies were obtained and the related stochastic optimization problem of mixed optimal stopping and singular control type in the constrained case was studied. The barrier version of the Russian option problem, where the decision about stopping should be taken before the price process reaches a 'dangerous' positive level, was recently studied in [22].
In the present paper we study a more general model by adding a compound Poisson process as driving term, where to simplify the exposition and aiming at closed form expressions for the value function and the stopping boundary we consider the perpetual case and let the jumps be exponentially distributed. Besides the analytical tractability of this model, it has some other desirable properties. For example, it is able to reproduce the leptokurtic feature of the return distribution. In addition, taking a HARA-type utility function and the corresponding utility-based martingale measure, the jumps remain expo-
2

nentially distributed under the measure transformation (see [14]-[15] and also [16]-[17] for a detailed description of the model). Note that the obtained perpetual option prices can be considered as upper estimations for arbitrage-free prices of the related options with finite expiry which are widely used by practitioners. The barrier options of European type in more general exponential L¥evy models were recently considered in [6], where the precise link between option prices and related partial integro-differential equations was explored.
The paper is organized as follows. In Section 2 we formulate the corresponding optimal stopping problem and reduce it to an equivalent integro-differential free-boundary problem. In Section 3 we derive an explicit solution to the free-boundary problem that also prepares the proof of the main result which is stated in Theorem 4.1. In Section 4 we verify that the solution of the free-boundary problem turns out to be a solution of the initial optimal stopping problem. In Section 5 we give some concluding remarks and comment the structure of the solution under different relationships on the parameters of the model.

2 Formulation of the problem

Let us now formulate the related irregular optimal stopping problem for a discontinuous reward and reduce it to the equivalent free-boundary problem.

2.1. For a precise formulation of the problem let us consider a probability space

(, F , P ) with a standard Brownian motion W = (Wt)t0 and a jump process J = (Jt)t0

defined by Jt =

Nt i=1

Yi,

where

N

=

(Nt)t0

is

a

Poisson

process

with

intensity



and

(Yi)iN is a sequence of independent random variables exponentially distributed with pa-

rameter 1 (W , N and (Yi)iN are supposed to be independent). The stock price process

S = (St)t0 is given by:

St = s exp

r

-



-

2 2

-

 1-

t +  Wt +  Jt

(2.1)

where   0, 0   < r and  < 1. It follows that S solves the stochastic differential

equation:



dSt = St-(r - ) dt + St- dWt + St-

ey - 1 (µ(dt, dy) - (dt, dy)) (S0 = s) (2.2)

0

3

where r is the riskless interest rate and the dividend rate payed to stockholders is St. Here µ(dt, dy) is the measure of jumps of the process J with the compensator (dt, dy) = dtI(y > 0)e-ydy, which means that we work directly under a martingale measure for S. Note that the assumption  < 1 guarantees that the jumps of S are integrable under the martingale measure, which is no restriction.
By using the utility arguments presented in the previous section (see also [12] or [8]) we may conclude that an arbitrage-free price for the perpetual American double barrier outof-money call option coincides with the value of the following optimal stopping problem:

V(s) = sup Es e-r (S - K)+


L



min
0t

St,

max
0t

St



H

(2.3)

for some 0 < L < K < H given and fixed, where the supremum is taken over all stopping

times  with respect to the natural filtration of S, and Es denotes the expectation under the assumption that S0 = s for s > 0. We also note that when  = 0 the solution of the problem (2.3) can be trivial (under H  ), so that we assume that  > 0. It is easily

seen that the function (2.3) admits the representation:

V(s) = sup Es e-r() (S - K)+


(2.4)

for all 0 < L  s  H, where  = inf{t  0 | St / (L, H)} is a stopping time of the process S, and V(s) = 0 for all 0 < s < L and s > H. Taking into account the structure of the payoff function in the problem (2.3), we will search for an optimal stopping time

in the form:

 = inf{t  0 | St / (L, B)}

(2.5)

for some number B  [K, H] to be determined.

2.2. By means of standard arguments it can be shown that the infinitesimal operator L of the process S acts on an arbitrary function F  C2(0, ) (or F  C1(0, ) when

 = 0) according to the rule:

(LF )(s) = (r -  + )s F

(s)

+

2 2

s2

F

(s) +

 0

F sey

- F (s)

e-y dy

(2.6)

for all s > 0, where we denote  = -/(1 - ). In order to find explicit expressions for

the unknown value function V(s) from (2.3) and the unknown boundary B from (2.5),

4

let us use the results of general theory of optimal stopping problems for continuous time Markov processes (see, e.g., [9], [24, Chapter III, Section 8] and [20]). We can reduce the optimal stopping problem (2.3) to the free-boundary problem:

(LV )(s) = rV (s) for L < s < B

(2.7)

V (B-) = B - K; V (L+) = 0 if either  > 0, or  = 0 with r -  +  < 0 (2.8)

V (s) = s - K for B  s  H; V (s) = 0 for 0 < s < L and s > H

(2.9)

V (s)  (s - K)+ for L  s  B

(2.10)

for some 0 < K  B  H, where the first equality in (2.8) is the instantaneous-stopping condition playing the role of the continuous-fit condition in case  = 0, and the second equality in (2.8) is the continuity condition for the value function at the fixed point of discontinuity L of the payoff function. The similar properties were observed in [6] by solving barrier option problems of another European type with fixed time expiry and discontinuous payoffs in models with jumps. Note that the superharmonic characterization of the value function (see [7], [24] and [20]) implies that (2.3) is the smallest function satisfying (2.7)-(2.10). Moreover, we further assume that the smooth-fit condition:

V (B-) = 1 if either  > 0, or  < 0, or 0 <  < 1 with r -  +  > 0 (2.11)
is satisfied when 0 < K  B < H. The latter can be explained by the fact that in those cases, leaving the continuation region (L, B) the process S can pass through the boundary B < H continuously. This property was earlier observed in [18, Section 2] and [19] by solving some other optimal stopping problems for jump processes (see also [1] for necessary and sufficient conditions for the occurrence of smooth-fit condition and references to the related literature and [20] for an extensive overview). Observe that we do not assume that the smooth-fit condition (2.11) holds when B = H because the payoff function of the problem (2.3) has a discontinuity at the point H.

3 Solution of the free-boundary problem
Let us now derive explicit solutions to the free-boundary problem formulated above under different relationships on the parameters of the model.
5

3.1. Let us first consider the continuous case  > 0 and  = 0. In this case, by means of the same arguments as in [23, Section 8] or [25, Chapter VII, Section 2a], it can be shown that the equation (2.7) has the general solution:

V (s) = C1 s1 + C2 s2

(3.1)

where C1 and C2 are some arbitrary constants, and 2 < 0 < 1 < 1 are given by:

i

=

1 2

-

r- 2

- (-1)i

1 2

-

r

- 2



2

+

2r 2

(3.2)

for i = 1, 2. Hence, applying the conditions (2.8) and (2.11) to the function (3.1), we get that the following equalities:

C1 B1 + C2 B2 = B - K C1 L1 + C2 L2 = 0

(3.3) (3.4)

hold for some 0 < K  B  H, and the condition:

1C1 B1 + 2C2 B2 = B

(3.5)

is satisfied when 0 < K  B < H. Thus, solving the system (3.3)-(3.5) we get that the

solution of the problem (2.7)-(2.8)+(2.11) is given by:

V

(s;

B)

=

(B

-

K)

(s/L)1 (B/L)1

- -

(s/L)2 (B/L)2

(3.6)

for all L  s < B, where B is determined as the unique solution of the equation:

1(B/L)1 (B/L)1

- 2(B/L)2 - (B/L)2

=

B

B -K

(3.7)

whenever its unique root belongs to the interval [K, H), or B = H otherwise. Observe that when L = 0, taking into account the fact that 2 < 0 < 1 < 1, it
follows that in (3.1) we have C2 = 0, since otherwise V (s)  ± as s  0, which should be excluded by virtue of the obvious fact that the value function (2.3) is bounded under

s  0. Thus, solving the system (3.3)+(3.5) with C2 = 0 we get that the solution of the problem (2.7)-(2.8)+(2.11) takes the form:

V (s; B) = (B - K)

s B

1

(3.8)

6

for all L < s < B, where B is given by:

B

=

1K 1 - 1



H.

The formulas (3.8) and (3.9) were earlier obtained in [4, Section 1].

(3.9)

3.2. From now on let us consider the jump-diffusion case  = 0 and for the integrability

of jumps assume that  < 1. By means of straightforward calculations, we reduce the

equation (2.7) to the form:

(r - 

+ )s V

(s) +

2 2

s2

V

(s) - s G(s) = (r + ) V (s)

(3.10)

with  = 1/ and  = -/(1 - ), where taking into account the conditions (2.8)-(2.9)

we set:

G(s) = -

B s

V

(z)

dz z+1

+

F (B, H, K)

if

G(s) =

s L

V

(z)

dz z+1

if

 = 1/ < 0

for all 0 < L  s  B and denote:

 = 1/ > 1

(3.11) (3.12)

F (B, H, K)

=

B + (1 - )K B(1 - )

-

H + (1 - )K H(1 - )

(3.13)

for each 0 < K  B  H. Then, from (3.10) and (3.11)-(3.12) it follows that the function

G(s) solves the following (third-order) ordinary differential equation:

2s3 2

G

(s) +

2( + 1) + r -  + 

s2 G (s)

+ ( + 1)

2 2

+

r

-



+



- (r + ) s G (s) -  G(s) = 0

(3.14)

for 0 < L < s < B, which has the general solution:

G(s)

=

C1

s1 1

+ C2

s2 2

+ C3

s3 3

(3.15)

where C1, C2 and C3 are some arbitrary constants and 3 < 2 < 1, i = 0 for i = 1, 2, 3,

are the real roots of the corresponding (characteristic) equation:

2 2

3

+

2



-

1 2

+ r -  +  2

+

2( - 2

1)

+

r

-



+



- (r + )  -  = 0.

(3.16)

7

Therefore, differentiating both sides of the formulas (3.11)-(3.12) we obtain that the integro-differential equation (3.10) has the general solution:

V (s) = C1 s1 + C2 s2 + C3 s3

(3.17)

where we set i = i +  for i = 1, 2, 3. Observe that if  = 0 and r -  +  = 0 then it is seen that (3.14) degenerates into a second-order differential equation, and in that case we can put C3 = 0 into (3.15) and (3.17), while the roots of the equation (3.16) are explicitly given by:

i

=

r+ 2(r -  +

)

-

 2

-

(-1)i

r+ 2(r - 

 +

)

-

 2

2

+

r

 -+



(3.18)

for i = 1, 2. Note that if  = 0 and r -  +  = 0 then (3.14) degenerates into a first-order differential equation, and in that case we can put C2 = C3 = 0 into (3.15) and (3.17), while the unique root of the equation (3.16) is given by:

1

=

-

r

 +

.

(3.19)

Hence, applying conditions (3.11)-(3.12), (2.8) and (2.11) to the functions (3.15) and (3.17), respectively, we get that the following equalities:

C1

B 1 1

+ C2

B2 2

+ C3

B3 3

= BF (B, H, K)

C1

L1 1

+ C2

L2 2

+ C3

L3 3

=

0

C1 B1 + C2 B2 + C3 B3 = B - K

C1 L1 + C2 L2 + C3 L3 = 0

(3.20) (3.21) (3.22) (3.23)

hold for some 0 < K  B  H with F (B, H, K) defined in (3.13) and

1C1 B1 + 2C2 B2 + 3C3 B3 = B

(3.24)

is satisfied when 0 < K  B < H. Here (3.20) holds if 0 <  < 1, (3.21) holds if  < 0, (3.23) holds if either  > 0, or  = 0 with r -  +  < 0 and  = -/(1 - ), and (3.24) holds if either  > 0, or  < 0, or 0 <  < 1 with r -  +  > 0.

8

3.3. Let us now consider the subcase of negative jumps  = 1/ < 0. If, in addition,  > 0, then solving the system (3.21)-(3.24), by using straightforward calculations we obtain that the solution of the system (2.7)-(2.9)+(2.11) is given by:

V

(s;

B)

=

(B

-

K)

1(3 1(3 -

- 2)(s/L)1 + 2(1 - 3)(s/L)2 + 3(2 - 1)(s/L)3 2)(B/L)1 + 2(1 - 3)(B/L)2 + 3(2 - 1)(B/L)3

(3.25)

for all 0 < L  s < B, where B is determined as the unique solution of the equation:

1(3 - 2)1(B/L)1 + 2(1 - 3)2(B/L)2 + 3(2 - 1)3(B/L)3 1(3 - 2)(B/L)1 + 2(1 - 3)(B/L)2 + 3(2 - 1)(B/L)3

=

B B-K

(3.26)

whenever its unique root belongs to the interval [K, H), or B = H otherwise. Note that if, in addition,  = 0, then we can put C3 = 0 into (3.15) and (3.17)
and omit the second condition in (2.8) implying (3.23). Thus, solving the system (3.21)-

(3.22)+(3.24) with C3 = 0, by using straightforward calculations we obtain that the solution of the system (2.7)-(2.9)+(2.11) is given by:

V

(s;

B)

=

(B

-

K)

1(s/L)1 1(B/L)1

- -

2(s/L)2 2(B/L)2

(3.27)

for all 0 < L  s < B, where B is determined as the unique solution of the equation:

11(B/L)1 1(B/L)1

- 22(B/L)2 - 2(B/L)2

=

B B-K

(3.28)

whenever its unique root belongs to the interval [K, H), or B = H otherwise. Observe that when L = 0 we omit the second condition in (2.8) implying (3.23) as
well as (3.21) and take into account the fact that if  = 1/ < 0 then 3 < 0 < 2 < - < 1 -  < 1 so that 3 <  < 2 < 0 < 1 < 1 with i = i +  for i = 1, 2, 3. It thus follows that in (3.15) as well as in (3.17) we have C2 = C3 = 0, since otherwise G(s)  ± and V (s)  ± as s  0 that should be excluded by virtue of the facts that the value function (2.3) so that the function (3.12) are bounded under s  0. Therefore, solving the system (3.22)+(3.24) with C2 = C3 = 0 we obtain that the solution of the system (2.7)-(2.9)+(2.11) is given by the same formulas as in (3.8)-(3.9) with 1 = 1 + , where if  > 0 then 1 is the largest root of the equation (3.16), while if  = 0 then 1 is given by (3.18).

9

3.4. Let us now consider the subcase of positive jumps  = 1/ > 1. If, in addition,

 > 0, then solving the system (3.20)+(3.22)-(3.24), by using straightforward calculations

we obtain that the solution of the system (2.7)-(2.9)+(2.11) is given by (3.17) with Ci = Ci(B, H, K, L) for i = 1, 2, 3 defined by:

C1

=

[A(B, H, K) - 13(B - K)](L2B3 - L3B2) + 1(B - K)(3L3B2 - 2L2B3) 3(2 - 1)B1 (L2 B3 - L3 B2 ) - 1(2 - 3)B3 (L2 B1 - L1 B2 )

(3.29)

C2

=

[A(B, H, K) - 12(B - K)](L3B1 - L1B3) + 2(B - K)(1L1B3 - 3L3B1) 1(3 - 2)B2 (L3 B1 - L1 B3 ) - 2(3 - 1)B1 (L3 B2 - L2 B3 )

(3.30)

C3

=

[A(B, H, K) - 23(B - K)](L1B2 - L2B1) + 3(B - K)(2L2B1 - 1L1B2) 2(1 - 3)B3 (L1 B2 - L2 B1 ) - 3(1 - 2)B2 (L1 B3 - L3 B1 )

(3.31)

for all 0 < L  s < B with A(B, H, K) = 123BF (B, H, K) for each 0 < K  B  H, where B is determined as the unique solution of the equation (3.24) with Ci = Ci(B, H, K, L) for i = 1, 2, 3 given by (3.29)-(3.31) whenever its unique root belongs to the interval [K, H), or B = H otherwise.
Note that if, in addition,  = 0 with r -  +  > 0 and  = -/(1 - ), we can put

C3 = 0 into (3.15) and (3.17) and ignore the second condition in (2.8) implying (3.23). Thus, solving the system (3.20)+(3.22)+(3.24) with C3 = 0, by using straightforward calculations we obtain that the solution of the system (2.7)-(2.9)+(2.11) is given by:

V

(s;

B)

=

(B

-

K)

1(s/B)1 1

- -

2(s/B)2 2

+

12BF (B, 1 - 2

H,

K)

s B

1 -

s B

2

(3.32)

for all 0 < L  s < B, where B is determined as the unique solution of the equation:

F (B, H, K)

=

11 1

- -

22 2

B-K 12B

-

B 12B

(3.33)

whenever its unique root belongs to the interval [K, H), or B = H otherwise. Observe that when L = 0 and either  > 0, or  = 0 with r -  +  > 0, we also

ignore the second condition in (2.8) implying (3.23) and take into account the fact that

if  = 1/ > 0 then 3 < - < 1 -  < 2 < 0 < 1 so that 3 < 0 < 1 < 2 <  < 1 with i = i +  for i = 1, 2, 3. It thus follows that in (3.15) as well as in (3.17) we

10

have C3 = 0, since otherwise V (s)  ± as s  0 that should be excluded by virtue of the fact that the value function (2.3) is bounded under s  0. Therefore, solving the system (3.20)+(3.22)+(3.24) with C3 = 0 we obtain that the solution of the system (2.7)-(2.9)+(2.11) is given by the same formulas as in (3.32)-(3.33).

3.5. Let us finally consider the case  = 0 and  = 1/ > 1 with r -  +   0 and

 = -/(1 - ). Observe that in this case we can put C3 = 0 and omit the smooth-fit condition (2.11) implying (3.24). If, in addition, r -  +  < 0, then solving the system

(3.20)+(3.22)-(3.23) with C3 = 0, by using straightforward calculations we obtain that the

solution of the system (2.7)-(2.9) is given by the same formula as in (3.6) with i = i + 

and i for i = 1, 2 are given by (3.18), where B is determined as the unique solution of

the equation:

F (B, H, K)

=

B-K 12B

1(B/L)1 (B/L)1

- 2(B/L)2 - (B/L)2

(3.34)

whenever its unique root belongs to the interval [K, H), or B = H otherwise.

Note that if, in addition, r -  +  = 0, then we can put C2 = C3 = 0 into (3.15) and

(3.17) and ignore the second condition in (2.8) implying (3.23). Thus, solving the system

(3.20)+(3.22) with C2 = C3 = 0, by using straightforward calculations we obtain that the solution of the system (2.7)-(2.9) is given by the same formula as in (3.8) with 1 = 1 +  and 1 is given by (3.19), where B is determined as the unique solution of the equation:

F (B, H, K)

=

B-K 1B

(3.35)

whenever its unique root belongs to the interval [K, H), or B = H otherwise. Observe that when L = 0 we can take into account that if, in addition, r -  +  < 0

then 2 < - < 1 -  < 1 < 0 so that 2 < 0 < 1 < 1 with i = i + , where i for i = 1, 2 are given by (3.18). It follows that in (3.15) as well as in (3.17) we have C2 = C3 = 0, since otherwise V (s)  ± as s  0 that should be excluded by virtue of the fact that the function (2.3) is bounded under s  0. Note that if, in addition,

r -  +  = 0 then 1 -  < 1 < 0 so that 1 > 1 with 1 = 1 + , where 1 is given by (3.19). Therefore, solving the system (3.20)+(3.22) with C2 = C3 = 0 we obtain that the solution of the system (2.7)-(2.9) is given by the same formulas as in (3.8) and (3.35),

where if r -  +  < 0 then 1 is given by (3.18), while if r -  +  = 0 then 1 is given

11

by (3.19).

4 Main result and proof

Taking into account the facts proved above, let us now formulate the main assertion of the paper.

Theorem 4.1. Let the process S be given by (2.1)-(2.2). Then the value function of

the optimal stopping problem (2.3) has the expression:

 V (s; B), if L  s  B

V(s) = s0,- K,

if B < H and B  s  H if 0 < s < L or s > H

(4.1)

and the optimal stopping time has the structure (2.5), where the function V (s; B) and the boundary B are specified as follows:
(i) if  > 0 and  = 0 then V (s; B) is given by (3.6) with B being the unique solution of (3.7) whenever it belongs to the interval [K, H), or B = H otherwise;
(ii) if  < 0 and either  > 0 or  = 0 then V (s; B) is given by (3.25) or (3.27) with B being the unique solution of (3.26) or (3.28), respectively, whenever it belongs to [K, H), or B = H otherwise;
(iii) if 0 <  < 1 and either  > 0, or  = 0 with r -  - /(1 - ) > 0, then V (s; B) is given by (3.17) with Ci = Ci(B, H, K, L) for i = 1, 2, 3 defined by (3.29)-(3.31), or (3.32), with B being the unique solution of (3.24) or (3.33), respectively, whenever it belongs to [K, H), or B = H otherwise;
(iv) if  = 0 and 0 <  < 1 with either r -  - /(1 - ) < 0 or r -  - /(1 - ) = 0 then V (s; B) is given by (3.6) or (3.8) with B being the unique solution of (3.34) or (3.35), respectively, whenever the former belongs to [K, H), or B = H otherwise, where i are replaced by i+ and i for i = 1, 2 are given by (3.18) in case r--/(1-) < 0, and 1 is given by (3.19) in case r -  - /(1 - ) = 0.
Proof. In order to verify the assertions stated above, it remains to show that the function (4.1) coincides with the value function (2.4) and the stopping time  from (2.5)

12

with the boundary B specified above is optimal. For this, let us denote by V (s) the righthand side of the expression (4.1). In this case, by means of straightforward calculations

and the assumptions above it follows that the function V (s) solves the system (2.7)-

(2.9), and the condition (2.11) is satisfied when either  > 0, or  < 0, or 0 <  < 1

with r -  - /(1 - ) > 0 holds. In addition, we note that V (s) is a convex function

on the set [L, H]. Then, applying It^o-Tanaka-Meyer formula (see, e.g., [10, Chapter V,

Theorem 5.52] or [21, Chapter IV, Theorem 51]) to e-r(t)V (St), we obtain:

t

e-r(t) V (St) = V (s) +

e-ru (LV - rV )(Su)I(Su = B) du + Mt

0

(4.2)

where  = inf{t  0 | St / (L, H)} and the process (Mt)t0 given by:

t

Mt =

e-ru V (Su)I(Su = B) Su dWu

0

t

+ e-ru V Su-ey - V (Su-)

00

(µ(du, dy) - (du, dy))

(4.3)

is a local martingale with respect to Ps being a probability measure under which the process S defined in (2.1)-(2.2) starts at s  [L, H]. Note that when  = 0 and r -  -

/(1 - ) = 0, the indicators in the formulas (4.2) and (4.3) can be set to one.

By using straightforward calculations and the arguments from the previous section,

it can be verified that (LV - rV )(s)  0 for all L < s < H and s = B. Moreover, by means of standard arguments it can be shown that the function V (s; B) is increasing on the interval [L, B], and thus the property (2.10) also holds that together with (2.8)-(2.9) yields V (s)  (s - K)+ for all L  s  H. Observe that from (2.1) it is seen that when

either  > 0 or r -  - /(1 - ) = 0, the time spent by the process S at the point B is of Lebesgue measure zero. Thus, in those cases, the indicators appearing in the integrals

in (4.2)-(4.3) can be also ignored. Hence, from the expression (4.2) and the structure of

the stopping time in (2.5) with K  B  H it follows that the inequalities:

e-r() (S - K)+  e-r() V (S)  V (s) + M

(4.4)

hold for any stopping time  of the process S started at s  [L, H]. Let (n)nN be an arbitrary localizing sequence of stopping times for the process
(Mt)t0. Taking in (4.4) the expectation with respect to the measure Ps, by means
13

of the optional sampling theorem (see, e.g., [11, Chapter I, Theorem 1.39]) we get:

Es e-r( n) (S n - K)+  Es e-r( n) V (S n )  V (s) + Es Mn = V (s)

(4.5)

for all L  s  H. Hence, letting n go to infinty and using Fatou's lemma, we obtain that for any stopping time  the inequalities:

Es e-r() (S - K)+  Es e-r() V (S)  V (s)

(4.6)

are satisfied for all L  s  H. By virtue of the fact that the function V (s) together with the boundary B satisfy
the system (2.7)-(2.11) and taking into account the structure of  in (2.5), from the expression (4.2) it follows that the equalities:

e-r(n) (Sn - K)+ = e-r(n) V (Sn ) = V (s) + Mn

(4.7)

hold for all L  s  H and any localizing sequence (n)nN of (Mt)t0. Observe that by the structure of the stopping times  and  as well as the integrability of jumps of the process S, by using the independence of the processes W and J in the expression (2.1), it can be shown that the property:

Es sup e-r(t) St < 
t0

(4.8)

holds for all L  s  H and the variable e-r() S is equal to zero on the set {   = }. Hence, letting n go to infinity and using conditions (2.8)-(2.9), we can apply the Lebesgue dominated convergence theorem for (4.7) to obtain the equality:

Es e-r() (S - K)+ = V (s)

(4.9)

for all L  s  H, which together with (4.6) directly implies the desired assertion.

By using the facts proved in the previous section, applying the same arguments as in the proof of Theorem 4.1, it is shown that the following assertion holds, which can be formally obtained as the limiting case of the main result under L  0.

14

Corollary 4.2. Suppose that in the conditions of Theorem 4.1 we have L = 0. Then

the value function of the problem (2.3) takes the form:

 V (s; B), V(s) = s0,- K,

if 0 < s  B if B < H and B  s  H if or s > H

(4.10)

and the optimal stopping time is given by (2.5), where V (s; B) and B are specified as follows:
(i) if  > 0 and  = 0 then V (s; B) is given by (3.8) with B from (3.9), where 1 is given by (3.2);
(ii) if  < 0 then V (s; B) is given by (3.8) with B from (3.9) and 1 replaced by 1 + 1/, where 1 is the largest root of the equation (3.16) in case  > 0, and 1 is given by (3.18) in case  = 0;
(iii) if 0 <  < 1 and either  > 0, or  = 0 with r--/(1-) > 0, then V (s; B) is given by (3.32) with B being the unique solution of (3.33) whenever it belongs to [K, H), or B = H otherwise, where i = i + 1/ and i for i = 1, 2 are the largest roots of the equation (3.16) in case  > 0, and i for i = 1, 2 are given by (3.18) in case  = 0;
(iv) if  = 0 and 0 <  < 1 with either r -  - /(1 - ) < 0 or r -  - /(1 - ) = 0 then V (s; B) is given by (3.8) with B from (3.35) and 1 replaced by 1 + 1/, where 1 is given by (3.18) in case r -  - /(1 - ) < 0, and 1 is given by (3.19) in case r -  - /(1 - ) < 0.
Let us now consider the dependence of the solution on the lower barrier.
Remark 4.3. Let us denote by V(s; L) the fair price of the perpetual double barrier option from (2.3) and by B(L) the exercise boundary from (2.5), where we underline the dependence on L  (0, K). Then, by the structure of the payoff in (2.3) it follows that V(s; L) decreases in L on (0, K). Hence, a simple comparison argument yields that B(L) also decreases in L on (0, K). The intuition behind these properties is that the holder should exercise an option with a higher floor L earlier than an option with a lower one.

15

5 Conclusion
We have considered the perpetual double barrier call option problem in a jump-diffusion model with infinite time horizon. The related irregular optimal stopping problem has been reduced to a nontrivial free-boundary problem which has been solved under different relationships on the parameters of the model. The behavior of the solution under the changing lower barrier has been also studied. Let us finally make some concluding remarks concerning the analytic properties of the obtained solution of the free-boundary problem under several relationships on the parameters of the model.
Remark 5.1. Observe that when  = 0 and 0 <  < 1 with r -  - /(1 - )  0 we have V(B-) < 1 and thus the smooth-fit condition (2.11) fails to hold. This property can be explained by the fact that in this case, leaving the continuation region (L, B) the process S can pass through the boundary B < H only by jumping. Such an effect was earlier observed and explained in [18, Section 2] and [19] by solving other optimal stopping problems for jump processes.

VT H -K
L

°°

°

°

°

°

V(s)

° °

°

°

°

°

°

°

°

K B H

E
s

Figure 1. A computer drawing of the value function V(x) and the boundaries L and B in the case of Remark 5.1.

16

Remark 5.2. Note that when either  > 0, or  = 0 with r -  - /(1 - ) > 0, the optimal stopping boundary B may coincide with the given upper barrier H and V(H-) < 1 may hold, so that the smooth-fit condition (2.11) also fails to hold (see Figure 2). Contrary to the arguments in Remark 5.2, this property can be explained by the discontinuity of the payoff function in (2.3) at the point H in these cases.

VT H -K
L

°°

°

°

°

V(s)

° °

°

°

°

°

°

°

°

°

K B = H

E
s

Figure 2. A computer drawing of the value function V(x) and the boundaries L and B in the case of Remark 5.2.

Remark 5.3. Observe that when  = 0 and  < 0 we have V(L+) > 0 and thus the second condition in (2.8) fails to hold (see Figure 3). This property can be explained by the fact that r -  - /(1 - ) > 0 under  < 0, so that leaving the continuation region (L, B) the process S can pass through the fixed boundary L only by jumping. Such an effect was earlier observed and explained in [18, Section 3] (see also [1] and [6]).
The continuity of the value function in optimal stopping problems with discontinuous rewards was studied in [2]-[3] and [5]. According to the results in [1] and [6] we may conclude that the properties described in Remarks 5.1-5.3 appear because of finite intensity of jumps and exponential distribution of jump sizes of the compound Poisson process J.

17

VT H -K
L

°°

°

°

°

°

°

V(s)

° °

°

°

°

°

°

°

K B H

E
s

Figure 3. A computer drawing of the value function V(x) and the boundaries L and B in the case of Remark 5.3.

Remark 5.4. Note that when  = 0 with 0 <  < 1 and r -  - /(1 - )  0 the value function V(s) and the stopping boundary B do not depend on the lower barrier L. This property can be explained by the fact that in this case the process S is strictly increasing and thus it can never pass through the fixed boundary L after being started at s  [L, H].

Acknowledgments. The results of the paper were presented at the Symposium on Optimal Stopping with Applications held at the University of Manchester in January 2006. The author is grateful to the organizers and participants for their interest and valuable comments.

References
[1] Alili, L. and Kyprianou, A. E. (2005). Some remarks on first passage of L¥evy processes, the American put and pasting principles. Annals of Applied Probability 15(3) (2062≠2080).
[2] Bassan, B. and Ceci, C. (2000). Optimal stopping problems with discontinuous
18

reward: regularity of the value function and viscosity solutions. Stochastics and Stochastics Reports 72(1≠2) (55≠77).
[3] Bassan, B. and Ceci, C. (2002). Regularity of the value function and viscosity solutions in optimal stopping problems for general Markov processes. Stochastics and Stochastics Reports 74(3≠4) (633≠649).
[4] Broadie, M. and Detemple, J. (1995). American capped call options on dividend-paying assets. Review of Financial Studies 8(1) (161≠191).
[5] Ceci, C. and Bassan, B. (2004). Mixed optimal stopping and stochastic control problems with semicontinuous final reward for diffusion processes. Stochastics and Stochastics Reports 76(4) (323≠337).
[6] Cont, R. and Voltchkova, E. (2005). Integro-differential equations for option prices in exponential L¥evy models. Finance and Stochastics 9 (299≠325).
[7] Dynkin, E. B. (1963). The optimum choice of the instant for stopping a Markov process. Soviet Math. Dokl. 4 (627≠629).
[8] Gapeev, P. V. and Ku®hn, C. (2005). Perpetual convertible bonds in jumpdiffusion models. Statistics and Decisions 23 (15≠31).
[9] Grigelionis, B. I. and Shiryaev, A. N. (1966). On Stefan's problem and optimal stopping rules for Markov processes. Theory Probab. Appl. 11 (541≠558).
[10] Jacod, J. (1979). Calcul Stochastique et Probl`emes de Martingales. Lecture Notes in Mathematics, Berlin.
[11] Jacod, J. and Shiryaev, A. N. (1987). Limit Theorems for Stochastic Processes. Springer, Berlin.
[12] Kallsen, J. and Ku®hn, C. (2004). Pricing derivatives of American and game type in incomplete markets. Finance and Stochastics 8 (261≠284).
[13] Karatzas, I. and Wang, H. (2000). Barrier options of American type. Applied Mathematics and Optimization 42 (259≠279).
19

[14] Kou, S. G. (2002). A jump diffusion model for option pricing. Management Science 48 (1086≠1101).
[15] Kou, S. G. and Wang, H. (2004). Option pricing under a double exponential jump diffusion model. Management Science 50 (1178≠1192).
[16] Mordecki, E. (1999). Optimal stopping for a diffusion with jumps. Finance and Stochastics 3 (227≠236).
[17] Mordecki, E. (2002). Optimal stopping and perpetual options for L¥evy processes. Finance and Stochastics 6 (473≠493).
[18] Peskir, G. and Shiryaev, A. N. (2000). Sequential testing problems for Poisson processes. Annals of Statistics 28 (837≠859).
[19] Peskir, G. and Shiryaev, A. N. (2002). Solving the Poisson disorder problem. Advances in Finance and Stochastics. Essays in Honour of Dieter Sondermann. Sandmann, K. and Scho®nbucher, P. eds. Springer (295≠312).
[20] Peskir, G. and Shiryaev, A. N. (2006). Optimal Stopping and Free-Boundary Problems. Bikkh®auser, Basel.
[21] Protter, Ph. (1990). Stochastic Integration and Differential Equations. Springer, New York.
[22] Shepp, L. A., Shiryaev A. N. and Sulem, A. (2002). A barrier version of the Russian option. Advances in Finance and Stochastics. Essays in Honour of Dieter Sondermann. Sandmann, K. and Sch®onbucher, P. eds. Springer (271≠284).
[23] Shiryaev, A. N., Kabanov, Y. M., Kramkov, D. O. and Melnikov, A. V. (1994). On the pricing of options of European and American types, II. Continuous time. Theory of Probability and Applications 39(1) (61≠102).
[24] Shiryaev, A. N. (1978). Optimal Stopping Rules. Springer, Berlin.
[25] Shiryaev, A. N. (1999). Essentials of Stochastic Finance. World Scientific, Singapore.
20

SFB 649 Discussion Paper Series 2006
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Calibration Risk for Exotic Options" by Kai Detlefsen and Wolfgang K. H‰rdle, January 2006.
002 "Calibration Design of Implied Volatility Surfaces" by Kai Detlefsen and Wolfgang K. H‰rdle, January 2006.
003 "On the Appropriateness of Inappropriate VaR Models" by Wolfgang H‰rdle, Zdenk Hl·vka and Gerhard Stahl, January 2006.
004 "Regional Labor Markets, Network Externalities and Migration: The Case of German Reunification" by Harald Uhlig, January/February 2006.
005 "British Interest Rate Convergence between the US and Europe: A Recursive Cointegration Analysis" by Enzo Weber, January 2006.
006 "A Combined Approach for Segment-Specific Analysis of Market Basket Data" by Yasemin Boztu and Thomas Reutterer, January 2006.
007 "Robust utility maximization in a stochastic factor model" by Daniel Hern·ndez≠Hern·ndez and Alexander Schied, January 2006.
008 "Economic Growth of Agglomerations and Geographic Concentration of Industries - Evidence for Germany" by Kurt Geppert, Martin Gornig and Axel Werwatz, January 2006.
009 "Institutions, Bargaining Power and Labor Shares" by Benjamin Bental and Dominique Demougin, January 2006.
010 "Common Functional Principal Components" by Michal Benko, Wolfgang H‰rdle and Alois Kneip, Jauary 2006.
011 "VAR Modeling for Dynamic Semiparametric Factors of Volatility Strings" by Ralf Br¸ggemann, Wolfgang H‰rdle, Julius Mungo and Carsten Trenkler, February 2006.
012 "Bootstrapping Systems Cointegration Tests with a Prior Adjustment for Deterministic Terms" by Carsten Trenkler, February 2006.
013 "Penalties and Optimality in Financial Contracts: Taking Stock" by Michel A. Robe, Eva-Maria Steiger and Pierre-Armand Michel, February 2006.
014 "Core Labour Standards and FDI: Friends or Foes? The Case of Child Labour" by Sebastian Braun, February 2006.
015 "Graphical Data Representation in Bankruptcy Analysis" by Wolfgang H‰rdle, Rouslan Moro and Dorothea Sch‰fer, February 2006.
016 "Fiscal Policy Effects in the European Union" by Andreas Thams, February 2006.
017 "Estimation with the Nested Logit Model: Specifications and Software Particularities" by Nadja Silberhorn, Yasemin Boztu and Lutz Hildebrandt, March 2006.
018 "The Bologna Process: How student mobility affects multi-cultural skills and educational quality" by Lydia Mechtenberg and Roland Strausz, March 2006.
019 "Cheap Talk in the Classroom" by Lydia Mechtenberg, March 2006. 020 "Time Dependent Relative Risk Aversion" by Enzo Giacomini, Michael
Handel and Wolfgang H‰rdle, March 2006. 021 "Finite Sample Properties of Impulse Response Intervals in SVECMs with
Long-Run Identifying Restrictions" by Ralf Br¸ggemann, March 2006. 022 "Barrier Option Hedging under Constraints: A Viscosity Approach" by
Imen Bentahar and Bruno Bouchard, March 2006.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

023 "How Far Are We From The Slippery Slope? The Laffer Curve Revisited" by Mathias Trabandt and Harald Uhlig, April 2006.
024 "e-Learning Statistics ≠ A Selective Review" by Wolfgang H‰rdle, Sigbert Klinke and Uwe Ziegenhagen, April 2006.
025 "Macroeconomic Regime Switches and Speculative Attacks" by Bartosz Makowiak, April 2006.
026 "External Shocks, U.S. Monetary Policy and Macroeconomic Fluctuations in Emerging Markets" by Bartosz Makowiak, April 2006.
027 "Institutional Competition, Political Process and Holdup" by Bruno Deffains and Dominique Demougin, April 2006.
028 "Technological Choice under Organizational Diseconomies of Scale" by Dominique Demougin and Anja Schˆttner, April 2006.
029 "Tail Conditional Expectation for vector-valued Risks" by Imen Bentahar, April 2006.
030 "Approximate Solutions to Dynamic Models ≠ Linear Methods" by Harald Uhlig, April 2006.
031 "Exploratory Graphics of a Financial Dataset" by Antony Unwin, Martin Theus and Wolfgang H‰rdle, April 2006.
032 "When did the 2001 recession really start?" by Jˆrg Polzehl, Vladimir Spokoiny and Ctlin Stric, April 2006.
033 "Varying coefficient GARCH versus local constant volatility modeling. Comparison of the predictive power" by Jˆrg Polzehl and Vladimir Spokoiny, April 2006.
034 "Spectral calibration of exponential LÈvy Models [1]" by Denis Belomestny and Markus Reiﬂ, April 2006.
035 "Spectral calibration of exponential LÈvy Models [2]" by Denis Belomestny and Markus Reiﬂ, April 2006.
036 "Spatial aggregation of local likelihood estimates with applications to classification" by Denis Belomestny and Vladimir Spokoiny, April 2006.
037 "A jump-diffusion Libor model and its robust calibration" by Denis Belomestny and John Schoenmakers, April 2006.
038 "Adaptive Simulation Algorithms for Pricing American and Bermudan Options by Local Analysis of Financial Market" by Denis Belomestny and Grigori N. Milstein, April 2006.
039 "Macroeconomic Integration in Asia Pacific: Common Stochastic Trends and Business Cycle Coherence" by Enzo Weber, May 2006.
040 "In Search of Non-Gaussian Components of a High-Dimensional Distribution" by Gilles Blanchard, Motoaki Kawanabe, Masashi Sugiyama, Vladimir Spokoiny and Klaus-Robert M¸ller, May 2006.
041 "Forward and reverse representations for Markov chains" by Grigori N. Milstein, John G. M. Schoenmakers and Vladimir Spokoiny, May 2006.
042 "Discussion of 'The Source of Historical Economic Fluctuations: An Analysis using Long-Run Restrictions' by Neville Francis and Valerie A. Ramey" by Harald Uhlig, May 2006.
043 "An Iteration Procedure for Solving Integral Equations Related to Optimal Stopping Problems" by Denis Belomestny and Pavel V. Gapeev, May 2006.
044 "East Germany's Wage Gap: A non-parametric decomposition based on establishment characteristics" by Bernd Gˆrzig, Martin Gornig and Axel Werwatz, May 2006.
045 "Firm Specific Wage Spread in Germany - Decomposition of regional differences in inter firm wage dispersion" by Bernd Gˆrzig, Martin Gornig and Axel Werwatz, May 2006.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

046 "Produktdiversifizierung: Haben die ostdeutschen Unternehmen den Anschluss an den Westen geschafft? ≠ Eine vergleichende Analyse mit Mikrodaten der amtlichen Statistik" by Bernd Gˆrzig, Martin Gornig and Axel Werwatz, May 2006.
047 "The Division of Ownership in New Ventures" by Dominique Demougin and Oliver Fabel, June 2006.
048 "The Anglo-German Industrial Productivity Paradox, 1895-1938: A Restatement and a Possible Resolution" by Albrecht Ritschl, May 2006.
049 "The Influence of Information Costs on the Integration of Financial Markets: Northern Europe, 1350-1560" by Oliver Volckart, May 2006.
050 "Robust Econometrics" by Pavel CÌzek and Wolfgang H‰rdle, June 2006. 051 "Regression methods in pricing American and Bermudan options using
consumption processes" by Denis Belomestny, Grigori N. Milstein and Vladimir Spokoiny, July 2006. 052 "Forecasting the Term Structure of Variance Swaps" by Kai Detlefsen and Wolfgang H‰rdle, July 2006. 053 "Governance: Who Controls Matters" by Bruno Deffains and Dominique Demougin, July 2006. 054 "On the Coexistence of Banks and Markets" by Hans Gersbach and Harald Uhlig, August 2006. 055 "Reassessing Intergenerational Mobility in Germany and the United States: The Impact of Differences in Lifecycle Earnings Patterns" by Thorsten Vogel, September 2006. 056 "The Euro and the Transatlantic Capital Market Leadership: A Recursive Cointegration Analysis" by Enzo Weber, September 2006. 057 "Discounted Optimal Stopping for Maxima in Diffusion Models with Finite Horizon" by Pavel V. Gapeev, September 2006. 058 "Perpetual Barrier Options in Jump-Diffusion Models" by Pavel V. Gapeev, September 2006.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

