BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2005-008
Stable Distributions
Szymon Borak* Wolfgang Härdle*
Rafal Weron**
* CASE - Center for Applied Statistics and Economics, Humboldt-Universität zu Berlin, Germany
**Hugo Steinhaus Center, Wroclaw University of Technology, Poland
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

1 Stable distributions
Szymon Borak, Wolfgang H¨ardle, and Rafal Weron
JEL classification codes: C16
1.1 Acknowledgement
We gratefully acknowledge financial support by the Deutsche Forschungsgemeinschaft and the Sonderforschungsbereich 649 "O¨ konomisches Risiko".
1.2 Introduction
Many of the concepts in theoretical and empirical finance developed over the past decades ­ including the classical portfolio theory, the Black-Scholes-Merton option pricing model and the RiskMetrics variance-covariance approach to Value at Risk (VaR) ­ rest upon the assumption that asset returns follow a normal distribution. However, it has been long known that asset returns are not normally distributed. Rather, the empirical observations exhibit fat tails. This heavy tailed or leptokurtic character of the distribution of price changes has been repeatedly observed in various markets and may be quantitatively measured by the kurtosis in excess of 3, a value obtained for the normal distribution (Bouchaud and Potters, 2000; Carr et al., 2002; Guillaume et al., 1997; Mantegna and Stanley, 1995; Rachev, 2003; Weron, 2004). It is often argued that financial asset returns are the cumulative outcome of a vast number of pieces of information and individual decisions arriving almost continuously in time (McCulloch, 1996; Rachev and Mittnik, 2000). As such, since the pioneering work of Louis Bachelier in 1900, they have been modeled by the Gaussian distribution. The strongest statistical argument for it is based

2 1 Stable distributions
on the Central Limit Theorem, which states that the sum of a large number of independent, identically distributed variables from a finite-variance distribution will tend to be normally distributed. However, as we have already mentioned, financial asset returns usually have heavier tails.
In response to the empirical evidence Mandelbrot (1963) and Fama (1965) proposed the stable distribution as an alternative model. Although there are other heavy-tailed alternatives to the Gaussian law ­ like Student's t, hyperbolic, normal inverse Gaussian, or truncated stable ­ there is at least one good reason for modeling financial variables using stable distributions. Namely, they are supported by the generalized Central Limit Theorem, which states that stable laws are the only possible limit distributions for properly normalized and centered sums of independent, identically distributed random variables.
Since stable distributions can accommodate the fat tails and asymmetry, they often give a very good fit to empirical data. In particular, they are valuable models for data sets covering extreme events, like market crashes or natural catastrophes. Even though they are not universal, they are a useful tool in the hands of an analyst working in finance or insurance. Hence, we devote this chapter to a thorough presentation of the computational aspects related to stable laws. In Section 1.3 we review the analytical concepts and basic characteristics. In the following two sections we discuss practical simulation and estimation approaches. Finally, in Section 1.6 we present financial applications of stable laws.
1.3 Definitions and basic characteristics
Stable laws ­ also called -stable, stable Paretian or L´evy stable ­ were introduced by Levy (1925) during his investigations of the behavior of sums of independent random variables. A sum of two independent random variables having an -stable distribution with index  is again -stable with the same index . This invariance property, however, does not hold for different 's.
The -stable distribution requires four parameters for complete description: an index of stability   (0, 2] also called the tail index, tail exponent or characteristic exponent, a skewness parameter   [-1, 1], a scale parameter  > 0 and a location parameter µ  R. The tail exponent  determines the rate at which the tails of the distribution taper off, see the left panel in Figure 1.1. When  = 2, the Gaussian distribution results. When  < 2, the variance is infinite and the tails are asymptotically equivalent to a Pareto law, i.e. they

1.3 Definitions and basic characteristics
Dependence on alpha

Tails of stable laws

3

log(1-CDF(x)) -5

log(PDF(x)) -10 -8 -6 -4 -2

-10

-10 -5 0 5 10 x

0 12 log(x)

Figure 1.1: Left panel : A semilog plot of symmetric ( = µ = 0) -stable probability density functions (pdfs) for  = 2 (black solid line), 1.8 (red dotted line), 1.5 (blue dashed line) and 1 (green long-dashed line). The Gaussian ( = 2) density forms a parabola and is the only -stable density with exponential tails. Right panel : Right tails of symmetric -stable cumulative distribution functions (cdfs) for  = 2 (black solid line), 1.95 (red dotted line), 1.8 (blue dashed line) and 1.5 (green long-dashed line) on a double logarithmic paper. For  < 2 the tails form straight lines with slope -.
STFstab01.xpl

exhibit a power-law behavior. More precisely, using a central limit theorem type argument it can be shown that (Janicki and Weron, 1994; Samorodnitsky and Taqqu, 1994):

limx xP(X > x) = C(1 + ), limx xP(X < -x) = C(1 + ),

(1.1)

where:

C =

2


x- sin(x)dx
0

-1

=

1 

()

sin

 2

.

The convergence to a power-law tail varies for different 's and, as can be seen

in the right panel of Figure 1.1, is slower for larger values of the tail index.

4 1 Stable distributions

Moreover, the tails of -stable distribution functions exhibit a crossover from an approximate power decay with exponent  > 2 to the true tail with exponent . This phenomenon is more visible for large 's (Weron, 2001).
When  > 1, the mean of the distribution exists and is equal to µ. In general, the pth moment of a stable random variable is finite if and only if p < . When the skewness parameter  is positive, the distribution is skewed to the right, i.e. the right tail is thicker, see the left panel of Figure 1.2. When it is negative, it is skewed to the left. When  = 0, the distribution is symmetric about µ. As  approaches 2,  loses its effect and the distribution approaches the Gaussian distribution regardless of . The last two parameters,  and µ, are the usual scale and location parameters, i.e.  determines the width and µ the shift of the mode (the peak) of the density. For  = 1 and µ = 0 the distribution is called standard stable.

1.3.1 Characteristic function representation

Due to the lack of closed form formulas for densities for all but three dis-

tributions (see the right panel in Figure 1.2), the -stable law can be most

conveniently described by its characteristic function (t) ­ the inverse Fourier

transform of the probability density function. However, there are multiple pa-

rameterizations for -stable laws and much confusion has been caused by these

different representations, see Figure 1.3. The variety of formulas is caused by

a combination of historical evolution and the numerous problems that have

been analyzed using specialized forms of the stable distributions. The most

popular parameterization of the characteristic function of X  S(, , µ), i.e. an -stable random variable with parameters , , , and µ, is given by

(Samorodnitsky and Taqqu, 1994; Weron, 2004):



-|t|{1

-

isign(t)

tan

 2

}

+

iµt,

ln

(t)

=

-|t|{1

+

isign(t)

2 

ln

|t|}

+

iµt,

 = 1,  = 1.

(1.2)

For numerical purposes, it is often advisable to use Nolan's (1997) parameter-

ization:



-|t|{1

+

isign(t)

tan

 2

[(|t|)1-

-

1]}

+

iµ0t,

 = 1,

ln

0(t)

=

-|t|{1

+

isign(t)

2 

ln(|t|)}

+

iµ0t,

 = 1. (1.3)

1.3 Definitions and basic characteristics

5

Dependence on beta

Gaussian, Cauchy, and Levy distributions

PDF(x) 0.1 0.2 0.3 0.4

PDF(x) 0.05 0.1 0.15 0.2 0.25 0.3

0

-5 0 x

5 -5

0 x

5

Figure 1.2: Left panel : Stable pdfs for  = 1.2 and  = 0 (black solid line), 0.5 (red dotted line), 0.8 (blue dashed line) and 1 (green long-dashed line). Right panel : Closed form formulas for densities are known only for three distributions ­ Gaussian ( = 2; black solid line), Cauchy ( = 1; red dotted line) and Levy ( = 0.5,  = 1; blue dashed line). The latter is a totally skewed distribution, i.e. its support is R+. In general, for  < 1 and  = 1 (-1) the distribution is totally skewed to the right (left).
STFstab02.xpl

The S0 (, , µ0) parameterization is a variant of Zolotariev's (M)-parameterization (Zolotarev, 1986), with the characteristic function and hence the density

and the distribution function jointly continuous in all four parameters, see the

right panel in Figure 1.3. In particular, percentiles and convergence to the

power-law tail vary in a continuous way as  and  vary. The location parame-

ters µ=

of the two

µ0

-





2 

representations ln  for  = 1.

are related Note also,

by µ that

=

µ0 -  tan

 2

for

the traditional scale

 = 1 and parameter

G of the Gaussian distribution defined by:

fG(x)

=

1 2G

exp

-

(x - µ)2 2G2

,

 is not the same as  in formulas (1.2) or (1.3). Namely, G = 2.

(1.4)

6
S parameterization

1 Stable distributions
S0 parameterization

PDF(x) 0.1 0.2 0.3 0.4 0.5

PDF(x) 0.1 0.2 0.3 0.4 0.5

0

0

-4 -2 0 2 4 x

-4 -2 0 2 4 x

Figure 1.3: Comparison of S and S0 parameterizations: -stable pdfs for  = 0.5 and  = 0.5 (black solid line), 0.75 (red dotted line), 1 (blue short-dashed line), 1.25 (green dashed line) and 1.5 (cyan longdashed line).
STFstab03.xpl

1.3.2 Stable density and distribution functions
The lack of closed form formulas for most stable densities and distribution functions has negative consequences. For example, during maximum likelihood estimation computationally burdensome numerical approximations have to be used. There generally are two approaches to this problem. Either the fast Fourier transform (FFT) has to be applied to the characteristic function (Mittnik, Doganoglu, and Chenyao, 1999) or direct numerical integration has to be utilized (Nolan, 1997, 1999).
For data points falling between the equally spaced FFT grid nodes an interpolation technique has to be used. Taking a larger number of grid points increases accuracy, however, at the expense of higher computational burden. The FFT based approach is faster for large samples, whereas the direct integration method favors small data sets since it can be computed at any arbitrarily chosen point. Mittnik, Doganoglu, and Chenyao (1999) report that for N = 213 the FFT based method is faster for samples exceeding 100 observations and

1.3 Definitions and basic characteristics

7

slower for smaller data sets. Moreover, the FFT based approach is less universal ­ it is efficient only for large 's and only for pdf calculations. When computing the cdf the density must be numerically integrated. In contrast, in the direct integration method Zolotarev's (1986) formulas either for the density or the distribution function are numerically integrated.

Set  = variable

- in

tan

 2

.

Then

representation

the S0,

density i.e. X

f (x; , )  S0 (1, 

of a , 0),

standard -stable random can be expressed as (note,

that Zolotarev (1986, Section 2.2) used yet another parametrization):

· when  = 1 and x > :

f (x; , )

=

(x

-



)

1 -1

 | -1 |



2
V (; , ) exp

-(x

-



)

 -1

V

(;

,



)

d,

-
(1.5)

· when  = 1 and x = :

f (x; , )

=

(1

+

1 

(1 +

) 

cos(

)2

1 2

)

,

· when  = 1 and x < : f (x; , ) = f (-x; , -),

· when  = 1:





1 2|

|

e-

x 2



2

-

 2

V

(; 1, ) exp

-e-

x 2

V

(;

1,

)

d,

 = 0,

f (x; 1, )

=



1 (1+x2

)

,

 = 0,

where

=

1 

arctan(- ),

 = 1,

 2

,

 = 1,

and



(cos



)

1 -1



cos  sin (+)

-1

cos{+(-1)} cos 

,

V (; , ) =  2


 2

+

cos 

exp

1 

(

 2

+

)

tan



,

 = 1,  = 1,  = 0.

8 1 Stable distributions

The distribution F (x; , ) of a standard -stable random variable in representation S0 can be expressed as:

· when  = 1 and x > :

F (x;

,

)

=

c1(,

)

+

sign(1 - 

)

 2
exp
-

-(x

-



)

 -1

V

(;

,



)

d,

where

c1(, ) =

1 

 2

-



,

1,

 < 1,  > 1,

· when  = 1 and x = :

F (x; , )

=

1 

 2

-

,

· when  = 1 and x < :

F (x; , ) = 1 - F (-x; , -),

· when  = 1:





1 



2

-

 2

exp

-e-

x 2

V

(;

1,

)

d,

 > 0,

F

(x;

1,

)

=



1 2
1

+

1 

arctan x,

- F (x, 1, -),

 = 0,  < 0.

Formula (1.5) requires numerical integration of the function g(·) exp{-g(·)},

where

g(; x, , )

=

(x

-



)

 -1

V

(;

,



).

The

integrand

is

0

at

-,

increases

monotonically to a and then decreases

maximum of monotonically

1 e

at

to 0

point  for

at

 2

(Nolan,

which 1997).

g(; x, , However,

) in

= 1, some

cases the integrand becomes very peaked and numerical algorithms can miss

the spike and underestimate the integral. To avoid this problem we need to

find the argument  of the peak numerically and compute the integral as a

sum

of

two

integrals:

one

from

-

to



and

the

other

from



to

 2

.

1.4 Simulation of -stable variables

9

1.4 Simulation of -stable variables

The complexity of the problem of simulating sequences of -stable random variables results from the fact that there are no analytic expressions for the inverse F -1 of the cumulative distribution function. The first breakthrough was made by Kanter (1975), who gave a direct method for simulating S(1, 1, 0) random variables, for  < 1. It turned out that this method could be easily adapted to the general case. Chambers, Mallows, and Stuck (1976) were the first to give the formulas.
The algorithm for constructing a standard stable random variable X  S(1, , 0), in representation (1.2), is the following (Weron, 1996):

·

generate a random variable V

uniformly

distributed

on

(-

 2

,

 2

)

and

an

independent exponential random variable W with mean 1;

· for  = 1 compute:

X

=

S,

·

sin{(V + B,)} {cos(V )}1/

·

cos{V - (V + B,)} W

(1-)/
,

(1.6)

where

B,

=

arctan( tan 

 2

)

,

S, =

1 + 2 tan2

 2

1/(2)
;

· for  = 1 compute:

X

=

2 

 2

+

V

tan V -  ln

 2

W

cos

V

 2

+

V

.

(1.7)

Given the formulas for simulation of a standard -stable random variable, we

can easily simulate a stable random variable for all admissible values of the

parameters , ,  and µ using the following property: if X  S(1, , 0) then

 X + µ,

 = 1,

Y

= X +

2 





ln



+

µ,

 = 1,

(1.8)

10 1 Stable distributions
is S(, , µ). It is interesting to note that for  = 2 (and  = 0) the ChambersMallows-Stuck method reduces to the well known Box-Muller algorithm for generating Gaussian random variables (Janicki and Weron, 1994). Although many other approaches have been proposed in the literature, this method is regarded as the fastest and the most accurate (Weron, 2004).
1.5 Estimation of parameters
Like simulation, the estimation of stable law parameters is in general severely hampered by the lack of known closed-form density functions for all but a few members of the stable family. Either the pdf has to be numerically integrated (see the previous section) or the estimation technique has to be based on a different characteristic of stable laws.
All presented methods work quite well assuming that the sample under consideration is indeed -stable. However, if the data comes from a different distribution, these procedures may mislead more than the Hill and direct tail estimation methods. Since the formal tests for assessing -stability of a sample are very time consuming we suggest to first apply the "visual inspection" tests to see whether the empirical densities resemble those of -stable laws.
1.5.1 Tail exponent estimation
The simplest and most straightforward method of estimating the tail index is to plot the right tail of the empirical cdf on a double logarithmic paper. The slope of the linear regression for large values of x yields the estimate of the tail index , through the relation  = -slope.
This method is very sensitive to the size of the sample and the choice of the number of observations used in the regression. For example, the slope of about -3.7 may indicate a non--stable power-law decay in the tails or the contrary ­ an -stable distribution with   1.9. This is illustrated in Figure 1.4. In the left panel a power-law fit to the tail of a sample of N = 104 standard symmetric ( = µ = 0,  = 1) -stable distributed variables with  = 1.9 yields an estimate of ^ = 3.732. However, when the sample size is increased to N = 106 the power-law fit to the extreme tail observations yields ^ = 1.9309, which is fairly close to the original value of .
The true tail behavior (1.1) is observed only for very large (also for very small,

1.5 Estimation of parameters
Sample of size N=10^4

Sample of size N=10^6

11

log(1-CDF(x)) -5

log(1-CDF(x)) -5

-10

-10

-4 -2 0 2 4 log(x)

-4 -2 0 2 4 log(x)

Figure 1.4: A double logarithmic plot of the right tail of an empirical symmetric 1.9-stable distribution function for a sample of size N = 104 (left panel ) and N = 106 (right panel ). Thick red lines represent the linear regression fit. The tail index estimate (^ = 3.7320) obtained for the smaller sample is close to the initial power-law like decay of the larger sample (^ = 3.7881). The far tail estimate ^ = 1.9309 is close to the true value of .
STFstab04.xpl

i.e. the negative tail) observations, after a crossover from a temporary powerlike decay (which surprisingly indicates   3.7). Moreover, the obtained estimates still have a slight positive bias, which suggests that perhaps even larger samples than 106 observations should be used. In Figure 1.4 we used only the upper 0.15% of the records to estimate the true tail exponent. In general, the choice of the observations used in the regression is subjective and can yield large estimation errors, a fact which is often neglected in the literature.
A well known method for estimating the tail index that does not assume a parametric form for the entire distribution function, but focuses only on the tail behavior was proposed by Hill (1975). The Hill estimator is used to estimate the tail index , when the upper (or lower) tail of the distribution is of the form: 1-F (x) = Cx-, see Figure 1.5. Like the log-log regression method, the Hill estimator tends to overestimate the tail exponent of the stable distribution

12 1 Stable distributions
Sample of size N=10^4

alpha 2.5

2

200 400 600 800 1000 Order statistics

Sample of size N=10^6

Sample of size N=10^6

alpha 1.7 1.8 1.9 2 2.1

alpha 2 2.5

0

50000

100000

0

Order statistics

1000 Order statistics

2000

Figure 1.5: Plots of the Hill statistics ^n,k vs. the maximum order statistic k for 1.8-stable samples of size N = 104 (top panel ) and N = 106 (left and right panels). Red horizontal lines represent the true value of . For better exposition, the right panel is a magnification of the left panel for small k. A close estimate is obtained only for k = 500, ..., 1300 (i.e. for k < 0.13% of sample size).
STFstab05.xpl

1.5 Estimation of parameters

13

if  is close to two and the sample size is not very large. For a review of the extreme value theory and the Hill estimator see H¨ardle, Klinke, and Mu¨ller (2000, Chapter 13) or Embrechts, Klu¨ppelberg, and Mikosch (1997).

These examples clearly illustrate that the true tail behavior of -stable laws is visible only for extremely large data sets. In practice, this means that in order to estimate  we must use high-frequency data and restrict ourselves to the most "outlying" observations. Otherwise, inference of the tail index may be strongly misleading and rejection of the -stable regime unfounded.

We now turn to the problem of parameter estimation. We start the discussion

with the simplest, fastest and ... least accurate quantile methods, then develop

the slower, yet much more accurate sample characteristic function methods

and, finally, conclude with the slowest but most accurate maximum likelihood

approach. Given a sample x1, ..., S(, , µ) observations, in what

xfnolloofwins,dwepeepnrdoevnitdeanedstiidmeantteicsa^ll,y^d,is^t,riabnudteµd^

of all four stable law parameters.

1.5.2 Quantile estimation

Already in 1971 Fama and Roll provided very simple estimates for parameters of symmetric ( = 0, µ = 0) stable laws when  > 1. McCulloch (1986) generalized and improved their method. He analyzed stable law quantiles and provided consistent estimators of all four stable parameters, with the restriction   0.6, while retaining the computational simplicity of Fama and Roll's method. After McCulloch define:

v

=

x0.95 x0.75

- -

x0.05 x0.25

,

(1.9)

which is independent of both  and µ. In the above formula xf denotes the f -th population quantile, so that S(, , µ)(xf ) = f . Let v^ be the corresponding sample value. It is a consistent estimator of v. Now, define:

v

=

x0.95 + x0.05 - 2x0.50 x0.95 - x0.05

,

(1.10)

and let v^ be the corresponding sample value. v is also independent of both  and µ. As a function of  and  it is strictly increasing in  for each . The
statistic v^ is a consistent estimator of v.

Statistics v and v are functions of  and . This relationship may be inverted

14 1 Stable distributions

and the parameters  and  may be viewed as functions of v and v:

 = 1(v, v),  = 2(v, v).

(1.11)

Substituting v and v by their sample values and applying linear interpolation between values found in tables provided by McCulloch (1986) yields estimators ^ and ^.
Scale and location parameters,  and µ, can be estimated in a similar way. However, due to the discontinuity of the characteristic function for  = 1 and  = 0 in representation (1.2), this procedure is much more complicated. We refer the interested reader to the original work of McCulloch (1986).

1.5.3 Characteristic function approaches

Given a sample x1, ..., xn of independent and identically distributed (i.i.d.) random variables, define the sample characteristic function by

^(t)

=

1 n

n

eitxj .

j=1

(1.12)

Since |^(t)| is bounded by unity all moments of ^(t) are finite and, for any fixed t, it is the sample average of i.i.d. random variables exp(itxj). Hence, by the law of large numbers, ^(t) is a consistent estimator of the characteristic function (t).

Press (1972) proposed a simple estimation method, called the method of moments, based on transformations of the characteristic function. The obtained estimators are consistent since they are based upon estimators of (t), Im{(t)} and Re{(t)}, which are known to be consistent. However, convergence to the population values depends on a choice of four points at which the above functions are evaluated. The optimal selection of these values is problematic and still is an open question. The obtained estimates are of poor quality and the method is not recommended for more than preliminary estimation.

Koutrouvelis (1980) presented a regression-type method which starts with an initial estimate of the parameters and proceeds iteratively until some prespecified convergence criterion is satisfied. Each iteration consists of two weighted regression runs. The number of points to be used in these regressions depends on the sample size and starting values of . Typically no more than two or

1.5 Estimation of parameters

15

three iterations are needed. The speed of the convergence, however, depends on the initial estimates and the convergence criterion.
The regression method is based on the following observations concerning the characteristic function (t). First, from (1.2) we can easily derive:

ln(- ln |(t)|2) = ln(2) +  ln |t|.

(1.13)

The real and imaginary parts of (t) are for  = 1 given by

{(t)} = exp(-|t|) cos

µt

+

|t|sign(t)

tan

 2

,

and

{(t)} = exp(-|t|) sin

µt

+

|t|sign(t)

tan

 2

.

The last two equations lead, apart from considerations of principal values, to

arctan

{(t)} {(t)}

=

µt

+



tan

 2

sign(t)|t|.

(1.14)

Equation (1.13) depends only on  and  and suggests that we estimate these parameters by regressing y = ln(- ln |n(t)|2) on w = ln |t| in the model

yk = m + wk + k, k = 1, 2, ..., K,

(1.15)

where tk is an appropriate set of real numbers, m = ln(2), and k denotes an

error

term.

Koutrouvelis

(1980)

proposed

to

use

tk

=

k 25

,

k

= 1, 2, ..., K;

with

K ranging between 9 and 134 for different estimates of  and sample sizes.

Once ^ and ^ have been obtained and  and  have been fixed at these values, estimates of  and µ can be obtained using (1.14). Next, the regressions are repeated with ^, ^, ^ and µ^ as the initial parameters. The iterations continue until a prespecified convergence criterion is satisfied.

Kogon and Williams (1998) eliminated this iteration procedure and simplified the regression method. For initial estimation they applied McCulloch's (1986) method, worked with the continuous representation (1.3) of the characteristic function instead of the classical one (1.2) and used a fixed set of only 10 equally spaced frequency points tk. In terms of computational speed their method compares favorably to the original method of Koutrouvelis (1980). It has a significantly better performance near  = 1 and  = 0 due to the elimination of discontinuity of the characteristic function. However, it returns slightly worse results for very small .

16 1 Stable distributions

1.5.4 Maximum likelihood method

The maximum likelihood (ML) estimation scheme for -stable distributions
does not differ from that for other laws, at least as far as the theory is concerned.
For a vector of observations x = (x1, ..., xn), the ML estimate of the parameter vector  = (, , , µ) is obtained by maximizing the log-likelihood function:

n
L(x) = ln f~(xi; ),
i=1

(1.16)

where f~(·; ) is the stable pdf. The tilde denotes the fact that, in general, we do not know the explicit form of the density and have to approximate it numerically. The ML methods proposed in the literature differ in the choice of the approximating algorithm. However, all of them have an appealing common feature ­ under certain regularity conditions the maximum likelihood estimator is asymptotically normal.

Modern ML estimation techniques either utilize the FFT approach for approximating the stable pdf (Mittnik et al., 1999) or use the direct integration method (Nolan, 2001). Both approaches are comparable in terms of efficiency. The differences in performance are the result of different approximation algorithms, see Section 1.3.2.

Simulation studies suggest that out of the five described techniques the method of moments yields the worst estimates, well outside any admissible error range (Stoyanov and Racheva-Iotova, 2004; Weron, 2004). McCulloch's method comes in next with acceptable results and computational time significantly lower than the regression approaches. On the other hand, both the Koutrouvelis and the Kogon-Williams implementations yield good estimators with the latter performing considerably faster, but slightly less accurate. Finally, the ML estimates are almost always the most accurate, in particular, with respect to the skewness parameter. However, as we have already said, maximum likelihood estimation techniques are certainly the slowest of all the discussed methods. For example, ML estimation for a sample of a few thousand observations using a gradient search routine which utilizes the direct integration method is slower by 4 orders of magnitude than the Kogon-Williams algorithm, i.e. a few minutes compared to a few hundredths of a second on a fast PC! Clearly, the higher accuracy does not justify the application of ML estimation in many real life problems, especially when calculations are to be performed on-line.

1.6 Financial applications of stable laws

17

Table 1.1: Fits to 2000 Dow Jones Industrial Average (DJIA) index returns from the period February 2, 1987 ­ December 29, 1994. Test statistics and the corresponding p-values based on 1000 simulated samples (in parentheses) are also given.

Parameters: -stable fit Gaussian fit Tests: -stable fit
Gaussian fit

 1.6411


0.0050 0.0111

Anderson-Darling
0.6441
(0.020)
+
(<0.005)

µ -0.0126 0.0005
0.0003
Kolmogorov 0.5583
(0.500)
4.6353
(<0.005)

STFstab06.xpl

1.6 Financial applications of stable laws
Many techniques in modern finance rely heavily on the assumption that the random variables under investigation follow a Gaussian distribution. However, time series observed in finance ­ but also in other applications ­ often deviate from the Gaussian model, in that their marginal distributions are heavy-tailed and, possibly, asymmetric. In such situations, the appropriateness of the commonly adopted normal assumption is highly questionable.
It is often argued that financial asset returns are the cumulative outcome of a vast number of pieces of information and individual decisions arriving almost continuously in time. Hence, in the presence of heavy-tails it is natural to assume that they are approximately governed by a stable non-Gaussian distribution. Other leptokurtic distributions, including Student's t, Weibull, and hyperbolic, lack the attractive central limit property.
Stable distributions have been successfully fit to stock returns, excess bond returns, foreign exchange rates, commodity price returns and real estate returns (McCulloch, 1996; Rachev and Mittnik, 2000). In recent years, however, several studies have found, what appears to be strong evidence against the stable model (Gopikrishnan et al., 1999; McCulloch, 1997). These studies have estimated the

18 1 Stable distributions

Table 1.2: Fits to 1635 Boeing stock price returns from the period July 1, 1997 ­ December 31, 2003. Test statistics and the corresponding p-values based on 1000 simulated samples (in parentheses) are also given.

Parameters: -stable fit Gaussian fit Tests: -stable fit
Gaussian fit

 1.7811


0.0141 0.0244

Anderson-Darling
0.3756
(0.18)
9.6606
(<0.005)

µ 0.2834 0.0009
0.0001
Kolmogorov 0.4522
(0.80)
2.1361
(<0.005)

STFstab07.xpl

tail exponent directly from the tail observations and commonly have found  that appears to be significantly greater than 2, well outside the stable domain. Recall, however, that in Section 1.5.1 we have shown that estimating  only from the tail observations may be strongly misleading and for samples of typical size the rejection of the -stable regime unfounded. Let us see ourselves how well the stable law describes financial asset returns.
In this section we want to apply the discussed techniques to financial data. Due to limited space we chose only one estimation method ­ the regression approach of Koutrouvelis (1980), as it offers high accuracy at moderate computational time. We start the empirical analysis with the most prominent example ­ the Dow Jones Industrial Average (DJIA) index, see Table 1.1. The data set covers the period February 2, 1987 ­ December 29, 1994 and comprises 2000 daily returns. Recall, that it includes the largest crash in Wall Street history ­ the Black Monday of October 19, 1987. Clearly the 1.64-stable law offers a much better fit to the DJIA returns than the Gaussian distribution. Its superiority, especially in the tails of the distribution, is even better visible in Figure 1.6.
To make our statistical analysis more sound, we also compare both fits through Anderson-Darling and Kolmogorov test statistics (D'Agostino and Stephens, 1986). The former may be treated as a weighted Kolmogorov statistics which

1.6 Financial applications of stable laws

19

Stable and Gaussian fit to DJIA returns

Stable, Gaussian, and empirical left tails

log(CDF(x)) -5

CDF(x) 0 0.5 1

-10

-0.02

0 x

0.02

-6 -5 -4 -3 -2 log(x)

Figure 1.6: Stable (cyan) and Gaussian (dashed red) fits to the DJIA returns (black circles) empirical cdf from the period February 2, 1987 ­ December 29, 1994. Right panel is a magnification of the left tail fit on a double logarithmic scale clearly showing the superiority of the 1.64-stable law.
STFstab06.xpl

puts more weight to the differences in the tails of the distributions. Although no asymptotic results are known for the stable laws, approximate p-values for these goodness-of-fit tests can be obtained via the Monte Carlo technique. First the parameter vector is estimated for a given sample of size n, yielding ^, and the test statistics is calculated assuming that the sample is distributed according to F (x; ^), returning a value of d. Next, a sample of size n of F (x; ^)distributed variates is generated. The parameter vector is estimated for this simulated sample, yielding ^1, and the test statistics is calculated assuming that the sample is distributed according to F (x; ^1). The simulation is repeated as many times as required to achieve a certain level of accuracy. The estimate of the p-value is obtained as the proportion of times that the test quantity is at least as large as d.
For the -stable fit of the DJIA returns the values of the Anderson-Darling and Kolmogorov statistics are 0.6441 and 0.5583, respectively. The corresponding approximate p-values based on 1000 simulated samples are 0.02 and 0.5 allowing

20
Stable and Gaussian fit to Boeing returns

1 Stable distributions
Stable, Gaussian, and empirical left tails

CDF(x) 0 0.5 1
log(CDF(x)) -8 -6 -4 -2

-0.05

0 x

0.05

-5 -4 -3 -2 log(x)

Figure 1.7: Stable (cyan) and Gaussian (dashed red) fits to the Boeing stock returns (black circles) empirical cdf from the period July 1, 1997 ­ December 31, 2003. Right panel is a magnification of the left tail fit on a double logarithmic scale clearly showing the superiority of the 1.78-stable law.
STFstab07.xpl

us to accept the -stable law as a model of DJIA returns. The values of the test statistics for the Gaussian fit yield p-values of less than 0.005 forcing us to reject the Gaussian law, see Table 1.1.
Next, we apply the same technique to 1635 daily returns of Boeing stock prices from the period July 1, 1997 ­ December 31, 2003. The 1.78-stable distribution fits the data very well, yielding small values of the Anderson-Darling (0.3756) and Kolmogorov (0.4522) test statistics, see Figure 1.7 and Table 1.2. The approximate p-values based, as in the previous example, on 1000 simulated samples are 0.18 and 0.8, respectively, allowing us to accept the -stable law as a model of Boeing returns. On the other hand, the values of the test statistics for the Gaussian fit yield p-values of less than 0.005 forcing us to reject the Gaussian distribution.
The stable law seems to be tailor-cut for the DJIA index and Boeing stock price returns. But does it fit other asset returns as well? Unfortunately, not. Although, for most asset returns it does provide a better fit than the Gaussian

1.6 Financial applications of stable laws

21

Table 1.3: Fits to 4444 JPY/USD exchange rate returns from the period December 1, 1978 ­ January 31, 1991. Test statistics and the corresponding p-values (in parentheses) are also given.

Parameters: -stable fit Gaussian fit Tests: -stable fit
Gaussian fit

 1.3274


0.0020 0.0049

Anderson-Darling
4.7833
(<0.005)
91.7226
(<0.005)

µ -0.1393 -0.0003
-0.0001
Kolmogorov 1.4520
(<0.005)
6.7574
(<0.005)

STFstab08.xpl

law, in many cases the test statistics and p-values suggest that the fit is not as good as for these two data sets. This can be seen in Figure 1.8 and Table 1.3, where the calibration results for 4444 daily returns of the Japanese yen against the US dollar (JPY/USD) exchange rate from December 1, 1978 to January 31, 1991 are presented. The empirical distribution does not exhibit power-law tails and the extreme tails are largely overestimated by the stable distribution. For a risk manager who likes to play safe this may not be a bad idea, as the stable law overestimates the risks and thus provides an upper limit of losses. However, from a calibration perspective other distributions, like the hyperbolic or truncated stable, may be more appropriate for many data sets (Weron, 2004).

22 1 Stable distributions

Stable and Gaussian fit to JPY/USD returns

Stable, Gaussian, and empirical left tails

log(CDF(x)) -5

CDF(x) 0 0.5 1

-10

-0.02

-0.01

0 x

0.01

-7 -6 -5 -4 log(x)

Figure 1.8: Stable (cyan) and Gaussian (dashed red) fits to the JPY/USD exchange rate returns (black circles) empirical cdf from the period December 1, 1978 ­ January 31, 1991. Right panel is a magnification of the left tail fit on a double logarithmic scale. The extreme returns are largely overestimated by the stable law.
STFstab08.xpl

Bibliography
Bouchaud, J.-P. and Potters, M. (2000). Theory of Financial Risk, Cambridge University Press, Cambridge.
Carr, P., Geman, H., Madan, D. B., and Yor, M. (2002). The fine structure of asset returns: an empirical investigation, Journal of Business 75: 305­332.
Chambers, J. M., Mallows, C. L., and Stuck, B. W. (1976). A method for simulating stable random variables, Journal of the American Statistical Association 71: 340­344.
D'Agostino, R. B. and Stephens, M. A. (1986). Goodness-of-Fit Techniques, Marcel Dekker, New York.
Embrechts, P., Kluppelberg, C., and Mikosch, T. (1997). Modelling Extremal Events for Insurance and Finance, Springer.
Fama, E. F. (1965). The behavior of stock market prices, Journal of Business 38: 34­105.
Fama, E. F. and Roll, R. (1971). Parameter estimates for symmetric stable distributions, Journal of the American Statistical Association 66: 331­ 338.
Gopikrishnan, P., Plerou, V., Amaral, L. A. N., Meyer, M. and Stanley, H. E. (1999). Scaling of the distribution of fluctuations of financial market indices, Physical Review E 60(5): 5305­5316.
Guillaume, D. M., Dacorogna, M. M., Dave, R. R., Mu¨ller, U. A., Olsen, R. B., and Pictet, O. V. (1997). From the birds eye to the microscope: A survey of new stylized facts of the intra-daily foreign exchange markets, Finance & Stochastics 1: 95­129.
Ha¨rdle, W., Klinke, S., and Mu¨ller, M. (2000). XploRe Learning Guide, Springer.

24 Bibliography
Hill, B. M. (1975). A simple general approach to inference about the tail of a distribution, Annals of Statistics 3: 1163­1174.
Janicki, A. and Weron, A. (1994). Simulation and Chaotic Behavior of -Stable Stochastic Processes, Marcel Dekker.
Kanter, M. (1975). Stable densities under change of scale and total variation inequalities, Annals of Probability 3: 697­707.
Koutrouvelis, I. A. (1980). Regression-type estimation of the parameters of stable laws, Journal of the American Statistical Association 75: 918­928.
Kogon, S. M. and Williams, D. B. (1998). Characteristic function based estimation of stable parameters, in R. Adler, R. Feldman, M. Taqqu (eds.), A Practical Guide to Heavy Tails, Birkhauser, pp. 311­335.
Levy, P. (1925). Calcul des Probabilites, Gauthier Villars.
Mandelbrot, B. B. (1963). The variation of certain speculative prices, Journal of Business 36: 394­419.
Mantegna, R. N. and Stanley, H. E. (1995). Scaling behavior in the dynamics of an economic index, Nature 376: 46­49.
McCulloch, J. H. (1986). Simple consistent estimators of stable distribution parameters, Communications in Statistics ­ Simulations 15: 1109­1136.
McCulloch, J. H. (1996). Financial applications of stable distributions, in G. S. Maddala, C. R. Rao (eds.), Handbook of Statistics, Vol. 14, Elsevier, pp. 393­425.
McCulloch, J. H. (1997). Measuring tail thickness to estimate the stable index : A critique, Journal of Business & Economic Statistics 15: 74­81.
Mittnik, S., Doganoglu, T., and Chenyao, D. (1999). Computing the probability density function of the stable Paretian distribution, Mathematical and Computer Modelling 29: 235­240.
Mittnik, S., Rachev, S. T., Doganoglu, T. and Chenyao, D. (1999). Maximum likelihood estimation of stable Paretian models, Mathematical and Computer Modelling 29: 275­293.
Nolan, J. P. (1997). Numerical calculation of stable densities and distribution functions, Communications in Statistics ­ Stochastic Models 13: 759­774.

Bibliography

25

Nolan, J. P. (1999). An algorithm for evaluating stable densities in Zolotarev's (M) parametrization, Mathematical and Computer Modelling 29: 229­233.
Nolan, J. P. (2001). Maximum likelihood estimation and diagnostics for stable distributions, in O. E. Barndorff-Nielsen, T. Mikosch, S. Resnick (eds.), L´evy Processes, Brikh¨auser, Boston.
Press, S. J. (1972). Estimation in univariate and multivariate stable distribution, Journal of the American Statistical Association 67: 842­846.
Rachev, S., ed. (2003). Handbook of Heavy-tailed Distributions in Finance, North Holland.
Rachev, S. and Mittnik, S. (2000). Stable Paretian Models in Finance, Wiley.
Samorodnitsky, G. and Taqqu, M. S. (1994). Stable Non­Gaussian Random Processes, Chapman & Hall.
Stoyanov, S. and Racheva-Iotova, B. (2004). Univariate stable laws in the field of finance ­ parameter estimation, Journal of Concrete and Applicable Mathematics 2(4), in print.
Weron, R. (1996). On the Chambers-Mallows-Stuck method for simulating skewed stable random variables, Statistics and Probability Letters 28: 165­171. See also R. Weron, Correction to: On the ChambersMallows-Stuck method for simulating skewed stable random variables, Research Report HSC/96/1, Wroclaw University of Technology, 1996, http://www.im.pwr.wroc.pl/~hugo/Publications.html.
Weron, R. (2001). Levy-stable distributions revisited: Tail index > 2 does not exclude the Levy-stable regime, International Journal of Modern Physics C 12: 209­223.
Weron, R. (2004). Computationally intensive Value at Risk calculations, in J. E. Gentle, W. H¨ardle, Y. Mori (eds.) Handbook of Computational Statistics, Springer, Berlin, 911­950.
Zolotarev, V. M. (1986). One-Dimensional Stable Distributions, American Mathematical Society.

Index

-stable variable, 8
algorithm Box-Muller, 9
asset return, 16
Black Monday, 18
Chambers-Mallows-Stuck method, 9 characteristic function, 4
distribution L´evy stable, 2 stable,  stable distribution stable Paretian, 2
Dow Jones Industrial Average (DJIA), 18
extreme event, 2
Fourier transform, 5 function
characteristic,  characteristic function
goodness-of-fit, 18
Hill estimator, 11
Monte Carlo method, 18
power-law tail, 3

stable distribution, 1 characteristic exponent, 2 density function, 6 direct integration, 6, 16 distribution function, 6 FFT-based approach, 6, 16 index of stability, 2 maximum likelihood method, 15 method of moments, 14 quantile estimation, 13 regression-type method, 14, 15 simulation, 8 skewness parameter, 2 tail exponent, 2 estimation, 11 tail index, 2
stable laws, 16 asset returns, 1
tail exponent, 2, 11 estimation, 11 log-log regression, 11
test statistic Anderson-Darling, 18 Kolmogorov, 18

SFB 649 Discussion Paper Series
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de. 001 "Nonparametric Risk Management with Generalized
Hyperbolic Distributions" by Ying Chen, Wolfgang Härdle and Seok-Oh Jeong, January 2005. 002 "Selecting Comparables for the Valuation of the European Firms" by Ingolf Dittmann and Christian Weiner, February 2005. 003 "Competitive Risk Sharing Contracts with One-sided Commitment" by Dirk Krueger and Harald Uhlig, February 2005. 004 "Value-at-Risk Calculations with Time Varying Copulae" by Enzo Giacomini and Wolfgang Härdle, February 2005. 005 "An Optimal Stopping Problem in a Diffusion-type Model with Delay" by Pavel V. Gapeev and Markus Reiß, February 2005. 006 "Conditional and Dynamic Convex Risk Measures" by Kai Detlefsen and Giacomo Scandolo, February 2005. 007 "Implied Trinomial Trees" by Pavel Cízek and Karel Komorád, February 2005. 008 "Stable Distributions" by Szymon Borak, Wolfgang Härdle and Rafal Weron, February 2005.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

