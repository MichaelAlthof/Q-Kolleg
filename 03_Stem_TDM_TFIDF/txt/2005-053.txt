BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2005-053
Explicit characterization of the super-replication
strategy in financial markets with partial
transaction costs
Imen Bentahar* Bruno Bouchard**
* Technische Universität Berlin, Germany ** Université Paris VI, LPMA, and CREST Paris, France
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Explicit characterization of the super-replication strategy in financial markets with partial transaction costs

Imen Bentahar
TU Berlin, Institut fu¨r Mathematik Berlin, Germany
bentahar@math.tu-berlin.de

Bruno Bouchard
Universit´e Paris VI, LPMA, and CREST Paris, France
bouchard@ccr.jussieu.fr

Abstract
We consider a continuous time multivariate financial market with proportional transaction costs and study the problem of finding the minimal initial capital needed to hedge, without risk, European-type contingent claims. The model is similar to the one considered in Bouchard and Touzi (2000) except that some of the assets can be exchanged freely, i.e. without paying transaction costs. This is the so-called non-efficient friction case. To our knowledge, this is the first time that such a model is considered in a continuous time setting. In this context, we generalize the result of the above paper and prove that the super-replication price is given by the cost of the cheapest hedging strategy in which the number of non-freely exchangeable assets is kept constant over time.
Key words: Transaction costs, hedging options, viscosity solutions. AMS 1991 subject classifications: Primary 90A09, 93E20, 60H30; secondary 60G44, 90A16.
Supported by Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk"
1

1 Introduction
Since the 90's, there has been many papers devoted to the proof of the conjecture of Davis and Clark (1994) : in the context of the Black and Scholes model with proportional transaction costs, the cheapest super-hedging strategy for a European call option is just the price (up to initial transaction costs) of the underlying asset. The first proofs of this result were obtained, independently, by Soner, Shreve and Cvitani´c (1995) and Levental and Skorohod (1995). In a one-dimensional Markov diffusion model, the result was extended by Cvitani´c, Pham and Touzi (1999) for general contingent claims. Their approach relies on the dual formulation of the super-replication cost (see Jouini and Kallal 1995 and Cvitani´c and Karatzas 1996).
The multivariate case was then considered by Bouchard and Touzi (2000). In contrast to Cvitani´c, Pham and Touzi (1999), they did not use the dual formulation but introduced a family of fictitious markets without transaction costs but with modified price processes evolving in the bid-ask spreads of the original market. Then, they defined the associated super-hedging costs and showed that they provide lower bounds for the original one. By means of a direct dynamic programming principle for stochastic target problems, see e.g. Soner and Touzi (2002), they provided a PDE characterization for the upper bound of these auxiliary super-hedging prices. Using similar arguments as in Cvitani´c, Pham and Touzi (1999), they were then able to show that the associated value function is concave in space and non-increasing in time. This was enough to show that it corresponds to the price of the cheapest buy-and-hold strategy in the original market. A different proof relying on the dual formulation for multivariate markets, see Kabanov (1999), was then proposed by Bouchard (2000).
A crucial feature of all the analysis is that transaction costs are efficient, i.e. there is no couple of freely exchangeable assets.
In this paper, we propose a first attempt to characterize the super-replication strategy in financial markets with "partial" transaction costs, where some assets can be exchanged freely. To our knowledge, this is the first time that such a model is considered in a continuous time setting.
As a first step, we follow the approach of Bouchard and Touzi (2000). We introduce a family of fictitious markets and provide a PDE characterization similar to the one obtained in this paper. However, in our context, one can only show that the corresponding value function is concave in some directions (the ones where transaction
2

costs are effective - roughly speaking, not equal to zero), and this is not sufficient to provide a precise characterization of the super-hedging strategy.
To overcome this difficulty, we define a new control problem. With the help of a comparison principle for PDE's, we show that it provides a new lower bound for the original super-hedging price. This new approach allows us to characterize the optimal hedging strategy : it consists in keeping constant the number of non-freely exchangeable assets held in the portfolio and hedging the remaining part of the claim by trading dynamically on the freely exchangeable ones.
The paper is organized as follows. After setting some notations in Section 2, we describe the model and the super-replication problem in Section 3. The main result of the paper is stated in Section 4. In Section 5, we introduce an auxiliary super-hedging problem similar to the one considered in Bouchard and Touzi (2000) and derive the PDE associated to the value function. The main idea of this paper, which allows to conclude the proof, is presented in Section 6. Section 7 contains the proof of some intermediary, and more technical, results.

2 Notations

For the reader's convenience, we first introduce the main notations of this paper.

All elements of IRn are identified with column vectors and the scalar product is

denoted by ·. We denote by IM n,p the set of all real-valued matrices with n rows

and p columns, and by IM+n,p the subset of IM n,p whose elements have non-negative entries. If n = p, we write IM n and IM+n for IM n,n and IM+n,n. The Euclidean norm is
simply denoted by | · |, transposition is denoted by . For M  IM n, we set Tr[M ] :=

n i=1

M

ii

the

associated

trace.

For

x



IRn,

diag[x]

denotes

the

diagonal

matrix

of

IM n whose i-th diagonal element is xi. We denote by 1i the vector of IRn defined by

1ji = 1 if j = i and 0 otherwise. Given a smooth function  mapping IRn into IRp,

we denote by Dz the (partial) Jacobian matrix of  with respect to its z variable.

In the case p = 1, we denote by Dz2s the matrix defined as (Dz2s)ij = 2/zisj. If  depends only on z, we simply write D and D2 in place of Dz and Dz2z. All

inequalities involving random variables have to be understood in the P - a.s. sense.

3

3 The model
3.1 The financial market
We first explain in details the financial market we shall consider in this paper and outline the difference with the literature.
3.1.1 The risky assets and the structure of transaction costs
We consider a financial market which consists of one bank account, with constant price process normalized to unity, and two different types of risky assets. The nonrisky asset is taken as the "num´eraire", sometimes called "cash" or thereafter.
The first m risky assets, P = (P 1, . . . , P m), can be exchanged freely with the num´eraire, while any exchange involving the d other assets, Q = (Q1, . . . , Qd), is subject to proportional transaction costs.
Transaction costs are described by a matrix  = (ij)id,j=0  IM+d+1 satisfying (H) : ij + ji > 0 for all i, j = 0, . . . , d, i = j .
The buying price (resp. selling price) in num´eraire at time t of one unit of Qi is given by t0i+ := (1 + 0i)Qi(t) (resp. t0i- := Qi(t)/(1 + i0)). Thus, [t0i- , t0i+] is the bid-ask spread price of Qi in terms of cash.
As in Bouchard and Touzi (2000) and Kabanov (1999), we also allow for direct exchanges between the assets (Qi)i. Let tij := Qj(t)/Qi(t) be the exchange rate between Qi and Qj before transaction costs at time t. To obtain one unit of Qj one has to pay tij+ := tij(1 + ij) units of Qi. When selling one unit of Qj, one receives tij- := tij/(1 + ji) units of Qi. Here again, [tij- , tij+] is the bid-ask spread price of Qj in terms of Qi.
Remark 3.1 If we want to avoid direct exchanges between Qi and Qj, it suffices to choose ij and ji such that (1+i0)(1+0j) = 1+ij and (1+j0)(1+0i) = 1+ji. With this choice of , making a direct exchange between Qi and Qj or passing through the cash account to make the corresponding exchange are two equivalent strategies. Thus everything works as if direct exchanges where prohibited.
Remark 3.2 The assumption (H) is usually called efficient friction case. It means that the assets (Qi)i can actually not be exchanged freely with the cash or between themselves, or equivalently that the bid-ask spreads ([tij- , tij+])1j=id and [t0i- , t0i+] are not reduced to a singleton.
4

Remark 3.3 Observe that we can always assume that (1 + ij)  (1 + ik)(1 + kj) , i, j, k = 0, . . . , d ,

(3.1)

since otherwise it would be cheaper to transfer money from the account i to j by passing through k rather than directly. Then, for any "optimal" strategy the effective cost between i and j would be ~ij := (1 + ik)(1 + kj) - 1. Thus, after possibly modifying , we can obtain a new market, equivalent to the previous one, such that (3.1) holds.

In this paper, the price process of all the risky assets S := (P (t), Q(t))tT is assumed to be a IR+m+d-valued stochastic process defined by the following stochastic differential system

dS(t) = diag[S(t)] (t, S(t)) dW (t) ,

t  T,

(3.2)

where T is a finite time horizon and {W (t), 0  t  T } is a m + d-dimensional Brownian motion defined on a complete probability space (, F , P) satisfying the usual assumptions. In the following, we shall denote by IF = {Ft, 0  t  T } the P-augmentation of the filtration generated by W .
Here (., .) is an IM m+d-valued function. We shall assume all over the paper that the function diag[s](t, s) satisfies the usual Lipschitz and linear growth conditions in order for the process S to be well-defined and that (t, s) is invertible with (t, s)-1 locally bounded, for all (t, s)  [0, T ] × IR+m+d.
Remark 3.4 As usual, there is no loss of generality in defining S as a martingale since we can always reduce the model to this context by an appropriate change of measure (under mild conditions on the initial coefficients).

3.1.2 The wealth process

The initial holdings is described by a vector x = (x0, . . . , xd)  IRd+1: x0 is the initial

dotation in cash and xi the initial amount invested in Qi, i  d. Since P 1 up to

P m can be freely exchanged with the num´eraire, we do not need to isolate the initial

dotations in theses assets.

A trading strategy is described by a pair  = (, L) where  is a IRm-valued

predictable process satisfying

T 0

|(t)|2dt

<



and

L

=

[Lij ]di,j=0

is

an

IM+1+d-valued

5

process with initial value L(0-) = 0, such that Lij is IF -adapted, right-continuous,

and nondecreasing for all i, j = 0, . . . , d.

Here, i(t) denotes the number of units of P i held in this portfolio at time t. If

L = 0, the part of the portfolio invested in cash and in freely exchangeable assets,

Xx0, evolves as usual according to Xx0(t) = x0 +

t 0

(r)

·

dP (r),

while

the

account

invested in the asset Qi has the dynamics

Xxi (t)

=

xi +

t 0

Xxi (r) Qi(r)

dQi(r)

.

For i, j  0, Lij(t) denotes the cumulated amount of money transferred to the
account Xxj by selling units of Qi (of cash if i = 0) up to time t. In view of the structure of transaction costs described in Section 3.1.1, the wealth process Xx induced by  = (, L) solves

td

X0(t) = x0 + (r) · dP (r) +

Lj0(t) - (1 + 0j)L0j(t)

0 j=1

X i (t)

=

xi +

t 0

X i (r) Qi(r)

dQi(r)

+

d j=0

Lji(t) - (1 + ij)Lij(t)

(3.3) for 1  i  d .

We conclude this section by insisting on the difference between this model and the existing literature. In Bouchard and Touzi (2000) and Kabanov (1999), see also the references quoted in the introduction, there is no couple of freely exchangeable assets. In our model, this corresponds to the case m = 0 or P  0. This assumption is crucial in the proofs of the above papers. To our knowledge, this is the first time that such a model is considered in a continuous time setting (see Schachermayer 2004, Kabanov et al. 2003 and the references therein for discrete time models).

3.2 The super-replication problem

Following Kabanov (1999), we define the solvency region :

K :=

d
x  IR1+d :  a  IM+1+d, xi + (aji - (1 + ij)aij)  0  i = 0, . . . , d
j=0

.

The elements of K can be interpreted as the vectors of portfolio holdings such that the no-bankruptcy condition is satisfied, i.e. the liquidation value of the portfolio holdings x, through some convenient transfers (aij)ij, is nonnegative.

6

Clearly, the set K is a closed convex cone containing the origin. It induces the partial ordering on IRd:

x1 x2 if and only if x1 - x2  K .

A trading strategy  = (, L) is said to be admissible if there is some some c,   IR and  in IRm such that

X0 (t)

-(c +  · P (t),  Q(t)) for all t  T .

(3.4)

We denote by A the set of such trading strategies. Observe that, if X0 satisfies the above condition, then, after possibly changing (c, , ), it holds for Xx too, x  IR1+d.

Remark 3.5 In Bouchard and Touzi (2000), the admissibility condition corresponds to

X0 (t)

0 for all t  T .

We relax this condition by allowing the wealth process to be bounded from below, in terms of K, by a portfolio made of a constant number of units of cash and of the different risky assets. This assumption is sufficient in our context to obtain a kind of super-martingale property for the portfolio process, see e.g. Touzi (1999) and Bouchard (2000). This will allow us to consider a more general class of contingent claims than the one used in Bouchard and Touzi (2000), see below.

A contingent claim is a (1 + d)-dimensional FT -measurable random variable g(S(T )) = (g0(S(T )), . . . , gd(S(T ))). Here, g maps IR+m+d into IR1+d and satisfies

g(p, q) -(c +  · p,  q) for all (p, q)  IR+m × IR+d

(3.5)

for some c,   IR and  in IRm .

In the rest of the paper, we shall identify a contingent claim with its pay-off function g. For i = 1, . . . , d, the random variable gi(S(T )) represents a target position in the asset Qi, while g0(S(T )) represents a target position in num´eraire.

The super-replication problem of the contingent claim g is then defined by p(0, S(0)) := inf w  IR :    A, Xw 10(T ) g(S(T )) ,
where w10 = (w, 0, . . . , 0)  IR1+d. The quantity p(0, S(0)) is the minimal initial capital which allows to hedge the contingent claim g by means of some admissible trading strategy.
7

4 The explicit characterization

Before to state our main result, we need to define some additional notations. We first introduce the positive polar of K

K := {  IR1+d :  · x  0, x  K}

(4.1)

= {(0, . . . , d)  IR+1+d : j  i(1 + ij)  i = j  {0, . . . , d}} ,

together with its (compact) section

 := {(0, . . . , d)  K : 0 = 1}  (0, )1+d .

(4.2)

One easily checks that  is not empty since it contains the vector of IR1+d with all components equal to one. Moreover, it is a standard result in convex analysis that the partial ordering can be characterized in terms of  by

x1 x2 if and only if  · (x1 - x2)  0 for all    ,

(4.3)

see e.g. Rockafellar (1970). For  = (0, . . . , d)  IR1+d, we define  = (1, . . . , d) the vector of IRd obtained
by removing the first component. With these notations, we set

G(p, q) := sup  · g p, diag[]-1q for (p, q) in IR+m × IR+d , 
and denote by Gconc the concave envelope of G with respect to q.

4.1 Main result
The main result of this paper requires the additional conditions : (H) : For all i  m and t  T , [(t, s)ij]jm+d depends only on the m first components of s. (Hg) : g is lower-semicontinuous, Gconc is continuous and has linear growth.
The assumption (H) means that the volatility matrix [(t, S(t))ij]im, jm+d of the freely exchangeable assets P depends only on t and P (t) but not on Q(t). The more technical assumption (Hg) is necessary for our PDE based approach.

8

Theorem 4.1 Assume that (H)-(H)-(Hg) hold. Then,
p(0, S(0)) = min w  IR :    ABH, Xw 10(T ) g(S(T )) ,
where
ABH := { = (, L)  A : L(t) = L(0) for all 0  t  T } .
Moreover, there is some ^  IRd such that
p(0, S(0)) = E C(P (T ); ^ ) + sup  · diag[^ ]Q(0)

where, for   IRd,
C(P (T ); ) := sup Gconc (P (T ), q) -  · q ,
q(0,)d
and there is an optimal hedging strategy (, L)  ABH satisfying L = ^ on [0, T ].
The proof of this result will be provided in the subsequent sections. As in the papers quoted in the introduction, we obtain that the cheapest hedging
strategy consists in keeping the number of non-freely exchangeable assets, Q, constant in the portfolio (equal to ^ ). The cost in num´eraire of such a portfolio is equal to sup  · diag[^ ]Q(0), this follows from (4.3).
But here there is a remaining part, namely g(S(T )) - (0, diag[^ ]Q(T )), which has to be hedged dynamically by investing in the freely exchangeable assets, P . It is done by hedging C(P (T ); ^ ). Under the assumption (H), the law of P is unchanged under any equivalent probability measure which preserves its martingale feature. It follows that the hedging-price of C(P (T ); ^ ) is simply given by its expectation (recall that P is already a martingale under the original probability measure and that the interest rate is equal to 0).
Remark 4.1 In Bouchard and Touzi (2000), the authors make the assumption:
P [Q(u)  A|Ft] > 0 P - a.s. 0  t < u  T
for all Borel subset A of (0, )d. It turns out to be not necessary, the important property being that (t, s) is invertible with locally bounded inverse.
9

From Theorem 4.1, we can deduce an explicit formulation for p(0, S(0)).

Corollary 4.1 Let the conditions of Theorem 4.1 hold. Then,

p(0, S(0)) = min E [C(P (T ); )] + sup  · diag[]Q(0) .

IRd



Moreover, if ^ solves the above optimization problem, then there is an optimal hedging strategy (, L)  ABH which satisfies L = ^ on [0, T ].

The proof will be provided in Section 6. We conclude this section with a remark which provides a characterization of the set of initial wealth which allow to hedge g:

(g) := x  IR1+d :    A, Xx(T ) g(S(T )) .

Remark 4.2 Let the conditions of Theorem 4.1 hold. 1. In Touzi (1999), the result of Bouchard and Touzi (2000) is generalized to the case where the initial wealth, before to be increased by the super-replication price, is non-zero, i.e. the following problem is considered :

p(0, S(0); x) := inf w  IR :    A, Xx+w10(T ) g(S(T )) ,
x  IR1+d. Our result can be easily extended to this case. Indeed, it suffices to observe from the wealth dynamics (3.3) that

Xx+w10(T ) g(S(T ))  Xw 10(T ) g(S(T )) - x0, diag[Q(0)]-1diag[Q(T )]x
where x is obtained from x by dropping the first component. Hence, to characterize p(0, S(0); x), it suffices to replace g by

g(s; x) := g(s) - (x0, diag[Q(0)]-1diag[q]x) , s = (p, q)  (0, )m × (0, )d .

We then deduce from Theorem 4.1 and Corollary 4.1 that, for some ^ (x)  IRd,

p(0, S(0); x) = min w  IR :    ABH, Xx+w10(T ) g(S(T ))
= E C(P (T ); ^ (x), x) + sup  · diag[^ (x)]Q(0)


= min E [C(P (T ); , x)] + sup  · diag[]Q(0)

IRd



(4.4)

10

where
C(P (T ); , x) := sup Gconc (P (T ), q) - x0, diag[Q(0)]-1diag[q]x -  · q
q(0,)d
2. The set of initial wealth which allow to hedge g can then be written
(g) = x  IR1+d : p(0, S(0); x)  0 .

.

3. In the limit case where m = 0, we recover the result of Bouchard and Touzi (2000) and Touzi (1999).

4.2 Example

We conclude this section with a simple example. We consider a two dimensional Black and Scholes model, i.e. m = d = 1, (t, s) =   IM 2 with  invertible. In this case, we have

=

(1, y)  IR2

:

1 1 + 10



y



1 + 01

, 10 + 01 > 0 .

We take g of the form

with K, K¯ > 0. Then,

g(p, q) =

[p - K]+1{q>K¯ } 10

G(s) = [p - K]+1{q>K^ } 10 and Gconc(s) = [p - K]+ (q/K^ )  1 ,

where K^ = K¯ /(1 + 10). For   IR, we have

C(p; ) = sup [p - K]+ (q/K^ )  1 - q
q(0,)d
= [p - K]+ - K^ 1{0K^ [p-K]+} , 

if   0 , otherwise.

Then, by Corollary 4.1,

p(0, S(0)) = min E [C(P (T ); )] + (1 + 01)Q(0) 0

= min 0

E

[P (T ) - K]+ - K^ 1{0K^ [P (T )-K]+}

+ (1 + 01)Q(0)

= min E [P (T ) - K - K^ ]+ + (1 + 01)Q(0) 0

, (4.5)

11

where the expectation is convex in . Then, if the optimal  is different from 0, it must satisfy the first order condition

-K^ E 1{P (T )-KK^ } + (1 + 01)Q(0) = 0 .

(4.6)

We consider two different cases. 1. If P [P (T ) - K  0]  (1 + 01)Q(0)/K^ , then, either the only solution of (4.6) is 0 or (4.6) has no solution. It follows that the optimum in (4.5) is achieved by ^ = 0.
Therefore

p(0, S(0)) = E [P (T ) - K]+ ,

and, by the Clark-Ocone's formula, the optimal hedging strategy (, L) is defined by L = 0 and (t) = E P (T )1{P (T )K} | Ft /P (t). 2. If P [P (T ) - K  0] > (1 + 01)Q(0)/K^ , then (4.6) has a unique solution ^ > 0 which satisfies
p := p(0, S(0)) = E [P (T ) - K - ^ K^ ]+ + (1 + 01)^ Q(0) .

Observe that, in this model, ^ can be computed explicitly in terms of the inverse of the cumulated distribution of the gaussian distribution. Let  = (, L) be defined by
L(t) = ^ and (t) = E P (T )1{P (T )-K^ K^ } | Ft /P (t) on t  T .
By the Clark-Ocone's formula, we have Xp10(T ) = [P (T ) - K - ^ K^ ]+ , ^ Q(T ) .
For ease of notations, let us define

 := [P (T ) - K]+1{Q(T )K¯ } . On {  0}, P (T )  K and Q(T )  K¯ . If P (T ) - K  ^ K^ then Xp10(T ) = (0, ^ Q(T )). Recalling the definition of K^ , we then obtain

Xp10(T ) = (0, ^ Q(T )) If P (T ) - K > ^ K^ , then

(^ K^ , 0) (, 0) .

Xp10(T ) = P (T ) - K - ^ K^ , ^ Q(T )

(P (T ) - K, 0) = (, 0) .

On { = 0}, we have Xp10(T ) 0 = (, 0) since ^ > 0.

12

5 Fictitious markets
In this section, we follow the arguments of Bouchard and Touzi (2000), i.e. we introduce an auxiliary control problem which can be interpreted as a super-replication problem in a fictitious market without transaction costs but were Q is replaced by a controlled process evolving in the "bid-ask" spreads associated to the transaction costs . This is obtained by introducing a controlled process f (Y a,b), see below, which evolves in . Then, the fictitious market is constructed by replacing S by Za,b := (P, diag[f (Y a,b)]Q) and g(S(T )) by f (Y a,b(T )) · g(S(T )).

5.1 Parameterization of the fictitious markets

We first parameterize the compact set . Since K is a polyhedral closed convex

cone, we can find a family e = (ei)in in (0, )1+d, for some n  1, such that, for

all   IR+n ,

n i=1

iei

=

0

implies



=

0,

and

K

=

{

n i=1

iei

,





IR+n }.

Then,

we define the map f from (0, )n into  by

f j(y) :=

nn

yieji /

yiei0

i=1 i=1

, y  (0, )n , j = 0, . . . , d .

In order to alleviate the notations, we define f¯ = (f¯1, . . . , f¯m+d) by

f¯i = 1 for i  m , f¯m+i = f i for 1  i  d and F¯ := diag[f¯] , F := diag[f ] ,(5.1)

where f = (f 1, . . . , f d). Given a controlled process Yya,b, to be defined later, we define the fictitious assets as

Zya,b := F¯(Yya,b)S = (P, Rya,b) where Rya,b := F (Yya,b)Q .

(5.2)

By construction, the fictitious markets preserve the price process corresponding to the freely exchangeable assets P , and the new dynamics of the other assets satisfy

ij-  Rya,b,j/Rya,b,i  ij+ and 0j-  Rya,b,j  0j+ for 1  i, j  d , (5.3)

see (4.1) and recall the definitions of Section 3.1.1. This means that the new exchange rates evolve in the bid-ask spreads of the original market.

13

We now turn to the construction of Yya,b. Given some arbitrary parameter µ > 0, we define for all (y0, s0)  (0, )n × IR+m+d the continuous function y0,s0 on [0, T ] × IR+m+d × (0, )n × IM n,m+d × IRn as

y0,s0(t, s, y, a, b) := where

A(t, s, y, a, b)

if

m+d i=1

constant

otherwise,

n j=1

|si

-

s0i |

+

|

ln

yj y0j

|

<µ

(5.4)

A(t, s, y, a, b)

= (t, s)-1F¯(y)-1

Df¯(y)diag[y]b

+

1 2

Vect

Tr

D2f¯i(y)diag[y]aa diag[y]

id

+ Vect Df¯(y)diag[y]a(t, s) ii id .

Let D be the set of all bounded progressively measurable processes (a, b) = {(a(t), b(t)), 0  t  T } where a and b are valued respectively in IM n,m+d and IRn. For all y in (0, )n and (a, b) in D, we define the controlled process Yya,b as the solution on [0, T ] of the stochastic differential equation

dY (t) = diag[Y (t)] b(t) + a(t)y,S(0)(t, S(t), Y (t), a(t), b(t)) dt + a(t)dW (t)

Y (0) = y ,

(5.5)

It follows from our assumption on  that y,S(0)(t, s, y , a, b) is a random Lipschitz function of y , so that the process Yya,b is well defined.

5.2 Super-replication in the fictitious markets

Let us fix y in (0, )n, (a, b) in D and let  be a progressively measurable process valued in IRm+d satisfying

m+d T
|i(t)|2d Zya,b,i(t) <  .
i=1 0
Then, given w  0, we introduce the process Wwa,,by, defined by
t
Wwa,,by,(t) = w + (s) · dZya,b(s) , t  T
0

(5.6) (5.7)

14

and we denote by Ba,b(w, y) the set of all such processes  satisfying the additional condition

Wwa,,by,(t)  -c -  · Zya,b(t) , t  T , for some (c, )  IR × IRm+d . (5.8)

We finally define the auxiliary stochastic control problems

ua,b(0, y, F¯(y)S(0)) := inf w  IR :   Ba,b(w, y) , Wwa,,by,(T )  f Yya,b(T ) · g (S(T )) ,

(5.9)

and

u(0, y, F¯(y)S(0)) := sup ua,b(0, y, F¯(y)S(0)) .

(5.10)

(a,b)D

The value function ua,b(0, y, F¯(y)S(0)) coincides with the super-replication price

of the modified claim f Yya,b(T ) · g (S(T )) in the market formed by the assets Zya,b
= (P, Rya,b) without transaction costs, recall (5.2). The function u(0, y, F¯(y)S(0)) is the upper-bound of these prices over all the

"controlled" fictitious markets.

Recalling (5.3), these fictitious markets are constructed so as to be "cheaper"

than the original one, in the sense that buying (resp. selling) the i-th asset in the

fictitious market is always cheaper (resp. more profitable) than in the original market

with transaction costs. This implies that the super-replication prices in the fictitious

markets are always smaller than the one in the original model.

Proposition 5.1 For all y  (0, )n, we have p(0, S(0))  u(0, y, F¯(y)S(0)).

The proof of this result follows line by line the one of Proposition 6.1 in Bouchard and Touzi (2000), up to obvious modifications. We therefore omit it.

5.3 The viscosity approach
In this section, we explain the viscosity approach followed by Bouchard and Touzi (2000) which turns out to be powerful in the case m = 0. This approach was initiated by Cvitani´c, Pham and Touzi (1999) in the one dimensional case.
We first extend the value function u to general initial conditions. Given (t, y, z)  [0, T ]×(0, )n×IR+m+d, ua,b(t, y, z) is defined as in (5.9) with (St,s, Yta,y,b,z, Zta,,yb,z) defined as above but with initial conditions (St,s(t), Yta,y,b,z(t), Zta,,yb,z(t)) = (s, y, z) where s =
15

F¯(y)-1z. Observe that the elements of  have positive components, see (4.2), so
that s is well defined. We then define the lower semicontinuous envelope of u on [0, T ]×(0, )n ×IR+m+d
by

u(t, y, z) :=

lim inf

u(t , y , z ) .

(t ,y ,z )(t,y,z)

(t ,y ,z )[0,T )×(0,)n+m+d

Contrary to Bouchard and Touzi (2000), we need to extend the definition of u to the whole subspace [0, T ] × (0, )n × IR+m+d (in opposition to [0, T ] × (0, )n+m+d). Although, we are only interested by u on [0, T )×(0, )n+m+d, since S(0)  (0, )m+d,
this extension will be useful to apply the comparison principle of Proposition 7.1 be-
low.

Theorem 5.1 Let (H) and (Hg) hold. Then u satisfies :
(i) u is independent of its variable y. (ii) u is a viscosity supersolution on [0, T ) × (0, )n × IR+m+d of

inf -Ha  0 ,
aIM n,m+d

where, for a smooth function ,

Ha

:=

 t

+

1 2

Tr

a Dz2za

and

a(t, y, z) := diag[z] (t, F¯(y)-1z) + F¯(y)-1Df¯(y)diag[y]a .

(iv) For all (y, z)  (0, )n × IR+m+d

u(T, y, z)  G(z) .

This result is obtained by following line by line the arguments of Sections 6, 7 and 8 in Bouchard and Touzi (2000), see also Touzi (1999). Since its proof is rather long, we omit it.
In Bouchard and Touzi (2000), the above characterization was sufficient to solve the super-replication problem. Indeed, in the case where m = 0, one can deduce from Theorem 5.1 that u is concave with respect to z and non-increasing in t. This

16

turns out to be sufficient to show that p := supy u(0, y, F¯(y)S(0)), corresponds to the price of a buy-and-hold super-hedging strategy for the original market. Combined with Proposition 5.1, this implies that p is actually the super-replication price in the market with transaction costs.
In our context, where m  1, we can only show that u(t, y, z) is concave with respect to the last d components of z and there is no reason why it should be concave in z (in particular if g(s) depends only on the first components of s). We therefore have to work a bit more.

6 A new interpretation for the super-hedging price and conclusion of the proof of Theorem 4.1

Up to now, we have followed the arguments of Bouchard and Touzi (2000), but as already explained this is not sufficient to conclude. In this section, we provide a new interpretation of the super-replication problem based on a reformulation of the PDE of Theorem 5.1. This is the key idea for solving our original problem.
As a first step, we rewrite the above PDE in a more tractable way. For all (t, z)  [0, T ] × IR+m+d and µ  IM d,m+d, we define
µ(t, z) := diag[z] (t, z)ij1im + µij1i>m 1i,jm+d
where, for real numbers (bij), [bij]1i,jm+d denotes the square (m + d)-dimensional matrix M defined by M ij = bij.
Since u does not depend on its y variable, see Theorem 5.1, we shall omit it from now on if not required by the context.

Corollary 6.1 Let (H), (H) and (Hg) hold. Then, (i) u is a viscosity supersolution on [0, T ) × IR+m+d of

inf -Gµ  0 ,
µIM d,m+d

(6.1)

where, for a smooth function  and µ  IM d,m+d,

Gµ(t, z)

=

 t

+

1 2

Tr

µ(t, z) Dz2z(t, z)µ(t, z)

.

(ii) For each (t, p)  [0, T ) × (0, )m, the map r  (0, )d  u(t, p, r) is concave.

17

(iii) For all (p, r)  IR+m+d

u(T, p, r)  Gconc(p, r) ,

(6.2)

where we recall that Gconc is the concave envelope of G with respect to its last variable r.

The concavity property and (6.1) are obtained by playing with the controls a in the PDE of Theorem 5.1. The complete proof of is reported in Section 7.
Before to enter into the technicalities, observe that, formally, the HamiltonJacobi-Equation of Corollary 6.1 coincides with the control problem

v(0, z) := sup E Gconc(Z^zµ(T )) µU

where, for z = (p, r)  (0, )m+d, Z^zµ is defined by
t
Z^zµ(t) = (Pp(t), R^rµ(t)) with R^rµ(t) = r + diag[R^rµ(s)]µ(s)dW (s) (6.3)
0

and, by (H), solves

t
Z^(t) = z + µ(s)(s, Z^(s))dW (s) t  T .
0

(6.4)

Here, U is the collection of all IM d,m+d-valued square integrable predictable processes µ such that R^rµ is a martingale for r  (0, )d.

If we could show that v is a (viscosity) subsolution of (6.1)-(6.2), then a comparison principle would imply u  v. Also, the above statement is not correct, because the boundary condition (6.2) is not satisfied in general by v, we will show in Section 7 that the inequality u  v actually holds.

Proposition 6.1 Let (H), (H) and (Hg) hold. Then, for all z  (0, )m+d, u(0, z)  sup E Gconc(Z^zµ(T )) .
µU
Proof. See Section 7

18

Using an approximation argument combined with the martingale property of the R^rµ's, (6.3) and the concavity of u with respect to its last d components, recall Corollary 6.1, this implies that, for all r  (0, )d and   ru(0, P (0), r), we have

u(0, P (0), r)  E sup {Gconc(P (T ), r~) -  · r~} +  · r ,
r~(0,)d

(6.5)

where, ru(0, P (0), r) is the subgradient of the concave mapping r  u(0, P (0), r).

Corollary 6.2 Let the conditions (H), (H) and (Hg) hold. Then, for all r  (0, )d and   ru(0, P (0), r), the inequality (6.5) holds.

Proof. By definition of  and Corollary 6.1, we have

u(0, P (0), r) = sup {u(0, P (0), r~) -  · (r~ - r)} .
r~(0,)d
Since, for each r~  (0, )d and µ  U , E R^rµ~ (T ) = r~, it follows from Proposition 6.1 that
u(0, P (0), r)  sup sup E Gconc P (T ), R^rµ~(T ) -  · R^rµ~ (T ) +  · r . r~(0,)d µU
Since Gconc is continuous, we deduce from the representation theorem and (6.3) that

u(0, P (0), r) 

sup E [Gconc(P (T ), ) -  · ] +  · r

L(B;FT )

 E max { Gconc(P (T ), r~) -  · r~ } +  · r , r~B

where B := {  (0, )d : | ln(i)|   , i  d}. The result then follows from monotone convergence.

We can now conclude the proof of our main result.

Proof of Theorem 4.1. In view of Proposition 5.1 and (5.1), we have

p(0, S(0))  sup u(0, P (0), diag[]Q(0)) .


(6.6)

1. Recalling that  is compact and u is concave in its last d variables, there is some ^   which attains the optimum in the above inequality. Moreover, by standard

19

arguments of calculus of variations, we can find some ^  ru(0, P (0), diag[^]Q(0)) such that

(diag[^ ]Q(0)) · (^ - )  0 for all    .

(6.7)

From (4.3), we deduce that (diag[^ ]Q(0) · ^, 0) (0, diag[^ ]Q(0)). 2. Set

 := diag[^ ]Q(0) · ^ and C^(P (T )) := sup Gconc(P (T ), r~) - ^ · r~ ,
r~(0,)d

so that, by (6.6) and Corollary 6.2,

p(0, S(0))  p := E C^(P (T )) +  .

(6.8)

Since by (H) the dynamics of P depends only on P , it follows that there is some

IRm-valued predictable process  satisfying

T 0

|(t)|2dt

<



such

that

·
X0(·) := p -  + (t) · dP (t) is a martingale and X0(T ) = C^(P (T )) . (6.9)
0

3. By combining 1. and 2., we deduce that there is some strategy  = (, L) such that L(t) = L(0), Xp10(0) = (p - , diag[^ ]Q(0)) and

Xp10(T ) = X0(T ), diag[^ ]Q(T )

C^(P (T )), diag[^ ]Q(T ) .

Using (6.9), (4.3) and the definition of C^ this implies that

~ · Xp10(T ) -  · g P (T ), diag[]-1diag[~]Q(T )  0 for all ~,    .

Considering the case where  = ~ and using (4.3) leads to

Xp10(T )

g(S(T )) .

In view of (6.8) it remains to check that   A, but this readily follows from (6.9) and assumption (3.5).

Proof of Corollary 4.1. In view of Theorem 4.1, we only have to show that

p(0, S(0))  inf E [C(P (T ); )] + sup  · diag[]Q(0) .

IRd



20

To see this, fix some   IRd such that
p~ := E [C(P (T ); )] + sup  · diag[]Q(0) <  ,

which is possible by Theorem 4.1. Then, by the same argument as in the proof of Theorem 4.1, see above, we obtain that there exists some  = (, L)  ABH, with L(t) =  on t  T , such that Xp~10 g(S(T )). This proves the required inequality as well as the last statement of the Corollary.
Remark 6.1 A close look at the PDE (6.1) and the above arguments shows that, in the limiting case where  = 0+, everything behaves as if the volatility of the non-freely exchangeable assets was stochastic, taking any possible values in IM d,m+d. Indeed, in the case  = 0+,  = {1, . . . , 1}. Combining Proposition 5.1, Proposition 6.1 and the above arguments, we obtain that
p(0, S(0)) = sup E Gconc(Z^Sµ(0)(T )) µU
where the value function associated to the right hand-side term formally solves
inf -Gµ = 0 on [0, T ) × (0, )m+d , (T, ·) = Gconc(·) on (0, )m+d .
µIM d,m+d
This equation can be viewed as a Black-Scholes-Barenblatt equation where the volatility matrix of the last d assets can take any values in IM d,m+d. This is the kind of equation we obtain in stochastic volatility models, see e.g. Cvitanic et al. (1999).
This comforts the usual intuition that transaction costs "increase" the effective volatility.

7 Proofs

7.1 Proof of Corollary 6.1
We first state the following Lemma which easy proof can be found in Bouchard and Touzi (2000).

Lemma 7.1 Let (H) hold. Then,

(i)

There

is

some



>

0

such

that

0

<

i

+

1 i





for

each







and

i

=

0, . . . , d.

(ii) On (0, )n, the rank of the Jacobian matrix Df of f is d.

21

Proof of Corollary 6.1. (i). Recall from Lemma 7.1 that the rank of Df (y) is d whenever y  (0, )n. Since f¯i = 1 for i  m, we deduce from (H) that, for each µ  IM d,m+d, we can find some a  IM n,m+d such that a(t, y, z) = µ(t, z). Then,
the first result follows from Theorem 5.1. (ii). For  satisfying (6.1) we must have, for all (t, p, r)  [0, T ) × (0, )m+d, -Tr[µ Dr2r(t, p, r)µ]  0 for all µ  IM d,m+d since otherwise we would get a contradiction of (6.1) by considering µ and sending  to infinity. Then, the concavity property follows from the same argument as in Lemma 8.1 of Bouchard and Touzi
(2000). (iii). In view of the boundary condition of Theorem 5.1, it suffices to show that
u(T, p, r) is concave with respect to r. This readily follows from (ii) by passing to the limit (inf) on t.

7.2 Proof of Proposition (6.1)
As explained in Section 6, the value function v is not, in general, a viscosity solution of (6.1)-(6.2), at least in the usual sense. This is due to the fact that the boundary condition is in general not satisfied. To overcome this problem, we define a similar control problem but with bounded controls and then take the limit as the bound goes to infinity. The bound on the control will also play an important role in the proof of the comparison principle of Proposition 7.1 below.

Given   0, we define U as the set of all elements M of IM d,m+d such that |M |  , and we denote by U the collection of all U-valued predictable processes.
We first show that the auxiliary control problems

v(t, z) := sup E Gconc Z^tµ,z(T ) µU

(t, z, )  [0, T ] × (0, )m+d × (0, ) , (7.1)

recall (6.4) and (6.3), satisfy u  sup>0 v, where v is the upper-semicontinuous function defined on [0, T ] × IR+m+d by

v(t, z) :=

lim sup

v(t , z ) .

(t ,z )(t,z)

(t ,z )[0,T )×(0,)m+d

This will be done by means of a comparison argument on the PDE defined by (6.1)(6.2) with U substituted to IM d,m+d.

22

7.2.1 Viscosity properties of v
We start with the subsolution property in the domain. The proof is rather standard now but, as it is short, we provide it for completeness.

Lemma 7.2 For each  > 0, v is a viscosity subsolution on [0, T ) × IR+m+d of

inf -Gµ  0 .
µU

Proof. Let   C2([0, T ] × IRm+d) and (t0, z0) be a strict global maximizer of v -  on [0, T ) × IR+m+d such that (v - )(t0, z0) = 0. We assume that

inf
µU

-G

µ

(t0

,

z0

)

>

0,

(7.2)

and work towards a contradiction. If (7.2) holds, then it follows from our continuity assumptions on  that there exists some t0 <  < T - t0 such that

inf -Gµ(t, z)  0
µU

for all (t, z)  B0 := B((t0, z0), ) ,

(7.3)

where B((t0, z0), ) is the open ball of radius  centered on (t0, z0). Let (tn, zn)n0 be a sequence in B0  ([0, T ) × (0, )m+d) such that

(tn, zn) - (t0, z0) and v(tn, zn) - v(t0, z0)

and notice that

v(tn, zn) - (tn, zn) - 0 .

(7.4)

Next, define the stopping times

nµ := T  inf s > tn : (s, Z^nµ(s))  B0

where µ is any element of U and Z^nµ := Z^tµn,zn. Let pB0 = [t0, t0 + ] × B(z0, )  {t0 + } × B(z0, ) denote the parabolic boundary of B0 and observe that

0 > - :=

sup (v - )(t, z)

(t,z)pB0([0,T ]×IRm+ +d)

since (t0, z0) is a strict maximizer of v - . Then, for a fixed µ  U, we deduce from Ito^'s Lemma and (7.3) that

(tn, zn)  E (nµ, Z^nµ(nµ))  E v nµ, Z^nµ(nµ) +    + E Gconc(Z^nµ(T )) ,

23

where we used the fact that   v  v and v nµ, Z^nµ(nµ)  E Gconc(Z^nµ(T )) | Fnµ .
By arbitrariness of µ  U, it follows from the previous inequality that (tn, zn)   + v(tn, zn) .
In view of (7.4), this leads to a contradiction since  > 0.

We now turn to the boundary condition.

Lemma 7.3 Under (Hg), for each  > 0 and z  IR+m+d, v(T, z)  Gconc(z).
Proof. Let (tn, zn)n be a sequence in [0, T ) × (0, )m+d such that (tn, zn)  (T, z) and v(tn, zn)  v(T, z). Let (µn)n be a sequence in U such that
v(tn, zn)  E Gconc(Z^tµnn,zn(T )) + n-1 , n  1 .
Recalling that (µn)n is uniformly bounded, it follows from standard arguments that Z^tµnn,zn(T )  z P - a.s. as n  , recall (6.3). Moreover, one easily checks that (Z^tµnn,zn(T ))n is bounded in any Lp. Since Gconc is continuous with linear growth, it then follows from the dominated convergence theorem and the above inequality that

lim
n

v

(tn,

zn

)



E

lim
n

Gconc

(Z^tµnn,zn

(T

))

= Gconc(z) .

By definition of (tn, zn)n, this leads to the required result.

7.3 The comparison principle
In order to show that u  v, we need to prove a comparison principle for (6.1)-(6.2) with U in place of IM d,m+d. We adapt the arguments of Barles et al. (2003) to our context.
Proposition 7.1 Let V be an upper semicontinuous viscosity subsolution and U be a lower semicontinuous viscosity supersolution on [0, T ) × IR+m+d of
inf -Gµ = 0 .
µU

24

Assume that V and U satisfy the linear growth condition

|V (t, z)| + |U (t, z)|  K (1 + |z|) , (t, z)  [0, T ) × IR+m+d , for some K > 0 . Then,

V (T, .)  U (T, .) implies V  U on [0, T ] × IR+m+d . Proof. 1. Let  be some positive parameter and consider the functions

u(t, z) := e tU (t, z) and v(t, z) := e tV (t, z) .

It is easy to verify that the functions u and v are, respectively, a lower semicontinuous
viscosity supersolution and an upper semicontinuous viscosity subsolution on [0, T )× IR+m+d of



-

 t

-

sup
µU

Tr

µ Dz2zµ

= 0.

(7.5)

Moreover u and v satisfy

u(T, z)  v(T, z) for all z  IR+m+d , as well as the linear growth condition

|v(t, z)| + |u(t, z)|  A (1 + |z|) , (t, z)  [0, T ) × IR+m+d , for some A > 0 . (7.6)
Through the following steps of the proof we are going to show that u  v on the entire domain [0, T ] × IR+m+d, which is equivalent to U  V on [0, T ] × IR+m+d. We argue by contradiction, and assume that for some (t0, z0) in [0, T ] × IR+m+d
0 <  := v(t0, z0) - u(t0, z0) .

2. Following Barles et al. (2003), we introduce the following functions. For some positive parameter , we set
(z, z ) = 1 + |z|2  + |z |2 and (t, z, z ) = eL(T -t)(z + z , z - z ) .
Here, L and  are positive constants to be chosen later and we don't write the dependence of ,  and  with respect to them.
25

By the linear growth condition (7.6), the upper semicontinuous function  defined by

(t, z, z ) := v(t, z) - u(t, z ) - (t, z, z )

is such that for all (t, z, z ) in [0, T ] × IR+2(m+d)

(t, z, z )  A (1 + |z| + |z |) - min {, } |z - z |2 + |z + z |2 + 1  A (1 + |z| + |z |) - min {, } |z|2 + |z |2 .

We deduce that  attains its maximum at some (t, z, z) in [0, T ] × IR+2(m+d). The inequality (t0, z0, z0)  (t, z, z) reads

(t, z, z)   -  1 + 4|z0|2 eLT .

Hence,  can be chosen sufficiently small (depending on L and |z0|) so that

v(t, z) - u(t, z)  (t, z, z)   -  1 + 4|z0|2 eLT > 0 . (7.7)

From (7.7) and (7.6), we get

0



 2

|z

-

z|2

+

 2

|z

+

z|2



v(t,

z)

-

u(t,

z)

-

 2

|z

+

z|2

-

 2

|z

-

z|2



A (1 + |z| + |z|) - min

 2

,

 2

|z|2 + |z|2 .

We deduce that {|z - z|}>0 as well as {(z, z)}>0 are bounded. Therefore, after possibly passing to a subsequence, we can find (t¯, z¯)  [0, T ] × IR+m+d such that

(t, z, z)  (t¯, z¯, z¯) as    .

Since v - u is upper semicontinuous, it follows from (7.7) that

v(t¯, z¯) - u(t¯, z¯)  lim sup v(t, z) - u(t, z)   -  1 + 4|z0|2 eLT > 0 . 
Since u(T, .)  v(T, .) on IR+m+d, t¯ is in [0, T ), hence for  sufficiently large t is in [0, T ).
3. Let  be sufficiently large so that

|z - z| < 1 and t  [0, T ) .

26

Since (t, z, z) is a maximum point of , by the fundamental result in the User's Guide to Viscosity Solutions (Theorem 8.3 in Crandall et al. 1993), for each  > 0, there are numbers a1 , a2 in IR, and symmetric matrices X and Y  in IM m+d such that

(a1, Dz(t, z, z), X)  P¯2,+(v)(t, z) , (a2, -Dz (t, z, z), Y )  P¯2,+(u)(t, z) ,

with and

a1 - a2

=

 t

(t

,

z

,

z)

=

-L (t, z, z) ,

X 0 0 -Y 

 M + M 2 , where M := D(2z,z )(t, z, z) . (7.8)

Since v is a viscosity subsolution and u is a viscosity supersolution of (7.5) on [0, T )× IR+m+d, we must have

v(t,

z)

-

a1

-

1 2

sup
µU

Tr

[µ(t,

z)

X   µ (t ,

z)]



0,

u(t,

z)

-

a2

-

1 2

sup
µU

Tr

[µ(t,

z)

Y

  µ (t ,

z)]



0.

Taking the difference we get

 (v(t, z) - u(t, z)) + L(t, z, z)



1 2

sup
µU

Tr

[µ(t,

z)

X   µ (t ,

z)]

-

1 2

sup
µU

Tr

[µ(t,

z)

Y

  µ (t ,

z)]



1 2

sup {Tr [µ(t, z) Xµ(t, z)]
µU

- Tr [µ(t, z) Y µ(t, z)]}

.

(7.9)

Let (ei, i = 1, ..., m + d) be an orthonormal basis of IRm+d, and for each µ in U set

iµ := µ(t, z)ei and iµ := µ(t, z)ei

so that

Tr [µ(t, z) Xµ(t, z)] - Tr [µ(t, z) Y µ(t, z)]
m+d
= Xiµ · iµ - Y iµ · iµ
i=1

27

and, by (7.8),

m+d

Tr [µ(t, z) Xµ(t, z)] - Tr [µ(t, z) Y µ(t, z)] 

(M + M 2)iµ · iµ ,

i=1

where iµ is the 2(m + d)-dimensional column vector defined by : iµ := (iµ , iµ ) . Letting  go to zero, and using (7.9), we get

 (v(t, z) - u(t, z)) + L(t, z, z)



1 sup 2 µU

m+d
M iµ · iµ
i=1

.

(7.10)

4. In this last step, we are going to see that, for a convenient choice of the positive constant L, inequality (7.10) leads to a contradiction to (7.7). Notice that

M = eL(T -t)

Dzz + Dz z  + 2Dzz  Dzz - Dz z 

Dzz - Dz z 

Dzz + Dz z  - 2Dzz 

the (partial) Hessian matrices of  being taken at the point (z +z, z -z). Then, for µ in U

m+d

m+d

M iµ · iµ = eL(T -t)

Dzz (iµ + iµ) · (iµ + iµ)

i=1 i=1
+ 2Dzz  (iµ + iµ) · (iµ - iµ)

+ Dz z  (iµ - iµ) · (iµ - iµ) .

(7.11)

Since for each µ in U, |µ| is bounded by , we deduce from the Lipschitz property of the function z  diag[z](t, z) that, for some positive constant C
|µ(t, z) - µ(t, z )|  C|z - z | and |µ(t, z)|  C (1 + |z|) ,
for each z, z in IR+m+d and t in [0, T ]. In the following C denotes a positive constant (independent of ,  and L) which value may change from line to line. 4.1. Since  satisfies |z - z|  1, for i = 1, .., m + d,
Dzz (iµ + iµ) · (iµ + iµ)  C|Dzz| (1 + |z|)2 + (1 + |z|)2 .

28

From |Dzz|  2( + |z - z|2) and the previous estimate, we deduce that Dzz (iµ + iµ) · (iµ + iµ)  C( + |z - z|2) 1 + |z + z|2 . (7.12)

4.2. For i = 1, .., m + d

Dzz  (iµ + iµ) · (iµ - iµ)  C|Dzz | [(1 + |z|) + (1 + |z|)] |z - z| .

Since |Dzz |  4|z - z||z + z| and |z - z|  1, we deduce that Dzz  (iµ + iµ) · (iµ - iµ)  C( + |z - z|2) 1 + |z + z|2 . (7.13)

4.3. For i = 1, .., m + d

Dz z  (iµ - iµ) · (iµ - iµ)  C|Dz z ||z - z|2

and since |Dz z |  2 (1 + |z + z|2), we get Dz z  (iµ - iµ) · (iµ - iµ)  C( + |z - z|2) 1 + |z + z|2 . (7.14)

Finally, collecting the estimates (7.12), (7.13) and (7.14), we deduce from (7.11) that for some positive constant C~ (independent of L,  and )

m+d
M iµ · iµ  C~eL(t-t)( + |z - z|2) 1 + |z + z|2 = C~(t, z, z) .
i=1

Hence,

if

we

take

L



C~ 2

,

then

(7.10)

reads

(v(t, z) - u(t, z))



(

C~ 2

-

L)(t, z, z)



0

which is in contradiction with (7.7).

7.3.1 Proof of Proposition 6.1
We first make use of Proposition 7.1 to obtain the intermediary inequality u  sup>0 v.
Corollary 7.1 Under (H), (H) and (Hg), for each  > 0, we have u  v on [0, T ] × IR+m+d.

29

Proof. In view of Lemmas 7.2, 7.3, Corollary 6.1 and Proposition 7.1, it suffices to
show that u and v have linear growth. To check this condition for v, it suffices to recall that Z^µ is a martingale and use assumption (Hg). We now consider u. First, recall from (Hg) that Gconc has linear growth. Using Lemma 7.1, we deduce that,
for each (a, b)  D and (t, y, z)  [0, T ] × (0, )n+m+d, we have

f Yta,y,b,z(T ) · g (St,s(T ))  Gconc Zta,,yb,z(T )



m+d
1 + Zta,,yb,,zi(T )
i=1

where s = F¯(y)-1z and  is some positive constant, recall (5.1). It follows from the definition of ua,b in (5.9) that

m+d

u(t, y, z) = sup ua,b(t, y, z)   1 + zi

(a,b)D

i=1

.

(7.15)

Now, observe that, for (a, b) = (0, 0), Y (0,0) is constant so that Z(0,0),i coincides with Si up to a multiplicative constant, i  m + d. Hence, Z(0,0) is a P-martingale and it follows from the definition of u(0,0) that

u(t, y, z)  u(0,0)(t, y, z)  E [f (y) · g (St,s(T ))] , s = F¯(y)-1z .

Using Lemma 7.1 and (3.5), we then deduce as above that

m+d
u(t, y, z)  u(0,0)(t, y, z)  -^ 1 + zi
i=1
for some positive constant ^. Combining the last inequality with (7.15) shows that u has linear growth.

Proof of Proposition 6.1. 1. We first show that {Z^zµ , µ  0U} is dense in probability in {Z^zµ , µ  U }. To see this, take µ  U and consider the sequence
defined by µ := µ1|µ|  U,   IN . Recalling (6.3), we deduce from the Ito^'s
isometry that

m+d

E | ln(Z^zµ,i(T )) - ln(Z^zµ,i(T ))|2

i=1

T

 E

|µ(t) - µ(t)|2 + ||µ(t)|2 - |µ(t)|2| dt

0

30

for some  > 0. Since µ  µ dt × dP-a.e. and, by definition of U , µ is square integrable, we deduce from the dominated convergence theorem that ln(Z^zµ,i(T )) goes to ln(Z^zµ,i(T )) in L2, i  m + d. It follows that the convergence holds P - a.s. along some subsequence. 2. By Corollary 7.1, we have
u(0, z)  sup sup E Gconc(Z^zµ(T )) . >0 µU
Since Gconc has linear growth, see (Hg), there is some (c, )  IR × IRd such that Gconc(Z^zµ(T )) +  · Z^zµ(T )  -c. Since Z^zµ is a martingale, it follows that
u(0, z)  sup sup E Gconc(Z^zµ(T )) +  · Z^zµ(T ) -  · z . >0 µU
Using 1. and Fatou's Lemma, we then deduce that u(0, z)  sup E Gconc(Z^zµ(T )) +  · Z^zµ(T ) -  · z .
µU
Since for µ  U , Z^zµ is also a martingale, the result follows.
References
Barles, B., Biton, S., Bourgoing, M. and Ley ,O. (2003), "Quasilinear parabolic equations, unbounded solutions and geometrical equations III. Uniqueness through classical viscosity solution's methods ", Calc. Var. Partial Differential Equations, 18, 159-179.
Bouchard, B. (2000), Contro^le stochastique appliqu´e a` la finance, Phd Thesis, University Paris-Dauphine.
Bouchard, B. and Touzi, N. (2000), "Explicit solution of the multivariate superreplication problem under transaction costs", The Annals of Applied Probability, 10 3, 685-708.
Crandall, M.G., Ishii, H. and Lions, P.L. (1992), "User's guide to viscosity solutions of second order Partial Differential Equations", Bull. Amer. Math. Soc. 27, 1-67.
Cvitanic´, J. and Karatzas, I. (1996), "Hedging and portfolio optimization under transaction costs", Mathematical Finance, 6, 133-165.
31

Cvitanic´, J., Pham, H. and Touzi, N. (1999), "A closed-form solution to the problem of super-replication under transaction costs", Finance and Stochastics, 3, 35-54.
Davis, M. and Clark, J.M.C. (1994), "A note on super-replicating strategies", Phil. Trans. Roy. Soc. London A, 347, 485-494.
Jouini, E. and Kallal, H. (1995), "Martingales and Arbitrage in securities markets with transaction costs", Journal of Economic Theory, 66, 178-197.
Kabanov, Yu. (1999), "Hedging and liquidation under transaction costs in currency markets", Finance and Stochastics, 3 (2), 237-248. Kabanov, Y., Stricker, C. and RA´ sonyi, M. (2003) "On the closedness of sums of convex cones in L0 and the robust no-arbitrage property", Finance and Stochastics 7 (3), 403-411.
Levental, S. and Skorohod, A.V. (1997), "On the possibility of hedging options in the presence of transaction costs", Annals of Applied Probability, 7, 410-443.
Rockafellar, R.T. (1970), Convex Analysis, Princeton University Press, Princeton, NJ.
Schachermayer, W. (2004), "The Fundamental Theorem of Asset Pricing under Proportional Transaction Costs in Finite Discrete Time", Mathematical Finance, 14 (1), 19-48.
Soner, M., Shreve, S. and Cvitanic´ J. (1995), "There is no nontrivial hedging portfolio for option pricing with transaction costs", Annals of Applied Probability, 5, 327-355.
Soner, M. and Touzi, N. (2002), "Dynamic programming for stochastic target problems and geometric flows", Journal of the European Mathematical Society, 4, 201-236.
Touzi, N. (1999), "Super-replication under proportional transaction costs: from discrete to continuous-time models", Mathematical Methods of Operations Research, 50, 297-320.
32

SFB 649 Discussion Paper Series
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Nonparametric Risk Management with Generalized Hyperbolic Distributions" by Ying Chen, Wolfgang Härdle and Seok-Oh Jeong, January 2005.
002 "Selecting Comparables for the Valuation of the European Firms" by Ingolf Dittmann and Christian Weiner, February 2005.
003 "Competitive Risk Sharing Contracts with One-sided Commitment" by Dirk Krueger and Harald Uhlig, February 2005.
004 "Value-at-Risk Calculations with Time Varying Copulae" by Enzo Giacomini and Wolfgang Härdle, February 2005.
005 "An Optimal Stopping Problem in a Diffusion-type Model with Delay" by Pavel V. Gapeev and Markus Reiß, February 2005.
006 "Conditional and Dynamic Convex Risk Measures" by Kai Detlefsen and Giacomo Scandolo, February 2005.
007 "Implied Trinomial Trees" by Pavel Cízek and Karel Komorád, February 2005.
008 "Stable Distributions" by Szymon Borak, Wolfgang Härdle and Rafal Weron, February 2005.
009 "Predicting Bankruptcy with Support Vector Machines" by Wolfgang Härdle, Rouslan A. Moro and Dorothea Schäfer, February 2005.
010 "Working with the XQC" by Wolfgang Härdle and Heiko Lehmann, February 2005.
011 "FFT Based Option Pricing" by Szymon Borak, Kai Detlefsen and Wolfgang Härdle, February 2005.
012 "Common Functional Implied Volatility Analysis" by Michal Benko and Wolfgang Härdle, February 2005.
013 "Nonparametric Productivity Analysis" by Wolfgang Härdle and Seok-Oh Jeong, March 2005.
014 "Are Eastern European Countries Catching Up? Time Series Evidence for Czech Republic, Hungary, and Poland" by Ralf Brüggemann and Carsten Trenkler, March 2005.
015 "Robust Estimation of Dimension Reduction Space" by Pavel Cízek and Wolfgang Härdle, March 2005.
016 "Common Functional Component Modelling" by Alois Kneip and Michal Benko, March 2005.
017 "A Two State Model for Noise-induced Resonance in Bistable Systems with Delay" by Markus Fischer and Peter Imkeller, March 2005.
018 "Yxilon ­ a Modular Open-source Statistical Programming Language" by Sigbert Klinke, Uwe Ziegenhagen and Yuval Guri, March 2005.
019 "Arbitrage-free Smoothing of the Implied Volatility Surface" by Matthias R. Fengler, March 2005.
020 "A Dynamic Semiparametric Factor Model for Implied Volatility String Dynamics" by Matthias R. Fengler, Wolfgang Härdle and Enno Mammen, March 2005.
021 "Dynamics of State Price Densities" by Wolfgang Härdle and Zdenk Hlávka, March 2005.
022 "DSFM fitting of Implied Volatility Surfaces" by Szymon Borak, Matthias R. Fengler and Wolfgang Härdle, March 2005.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

023 "Towards a Monthly Business Cycle Chronology for the Euro Area" by Emanuel Mönch and Harald Uhlig, April 2005.
024 "Modeling the FIBOR/EURIBOR Swap Term Structure: An Empirical Approach" by Oliver Blaskowitz, Helmut Herwartz and Gonzalo de Cadenas Santiago, April 2005.
025 "Duality Theory for Optimal Investments under Model Uncertainty" by Alexander Schied and Ching-Tang Wu, April 2005.
026 "Projection Pursuit For Exploratory Supervised Classification" by EunKyung Lee, Dianne Cook, Sigbert Klinke and Thomas Lumley, May 2005.
027 "Money Demand and Macroeconomic Stability Revisited" by Andreas Schabert and Christian Stoltenberg, May 2005.
028 "A Market Basket Analysis Conducted with a Multivariate Logit Model" by Yasemin Boztu and Lutz Hildebrandt, May 2005.
029 "Utility Duality under Additional Information: Conditional Measures versus Filtration Enlargements" by Stefan Ankirchner, May 2005.
030 "The Shannon Information of Filtrations and the Additional Logarithmic Utility of Insiders" by Stefan Ankirchner, Steffen Dereich and Peter Imkeller, May 2005.
031 "Does Temporary Agency Work Provide a Stepping Stone to Regular Employment?" by Michael Kvasnicka, May 2005.
032 "Working Time as an Investment? ­ The Effects of Unpaid Overtime on Wages, Promotions and Layoffs" by Silke Anger, June 2005.
033 "Notes on an Endogenous Growth Model with two Capital Stocks II: The Stochastic Case" by Dirk Bethmann, June 2005.
034 "Skill Mismatch in Equilibrium Unemployment" by Ronald Bachmann, June 2005.
035 "Uncovered Interest Rate Parity and the Expectations Hypothesis of the Term Structure: Empirical Results for the U.S. and Europe" by Ralf Brüggemann and Helmut Lütkepohl, April 2005.
036 "Getting Used to Risks: Reference Dependence and Risk Inclusion" by Astrid Matthey, May 2005.
037 "New Evidence on the Puzzles. Results from Agnostic Identification on Monetary Policy and Exchange Rates." by Almuth Scholl and Harald Uhlig, July 2005.
038 "Discretisation of Stochastic Control Problems for Continuous Time Dynamics with Delay" by Markus Fischer and Markus Reiss, August 2005.
039 "What are the Effects of Fiscal Policy Shocks?" by Andrew Mountford and Harald Uhlig, July 2005.
040 "Optimal Sticky Prices under Rational Inattention" by Bartosz Makowiak and Mirko Wiederholt, July 2005.
041 "Fixed-Prize Tournaments versus First-Price Auctions in Innovation Contests" by Anja Schöttner, August 2005.
042 "Bank finance versus bond finance: what explains the differences between US and Europe?" by Fiorella De Fiore and Harald Uhlig, August 2005.
043 "On Local Times of Ranked Continuous Semimartingales; Application to Portfolio Generating Functions" by Raouf Ghomrasni, June 2005.
044 "A Software Framework for Data Based Analysis" by Markus Krätzig, August 2005.
045 "Labour Market Dynamics in Germany: Hirings, Separations, and Job-toJob Transitions over the Business Cycle" by Ronald Bachmann, September 2005.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

046 "Paternal Uncertainty and the Economics of Mating, Marriage, and Parental Investment in Children" by Dirk Bethmann and Michael Kvasnicka, September 2005.
047 "Estimation and Testing for Varying Coeffcients in Additive Models with Marginal Integration " by Lijian Yang, Byeong U. Park, Lan Xue and Wolfgang Härdle, September 2005.
048 "Zeitarbeit in Deutschland: Trends und Perspektiven" by Michael C. Burda and Michael Kvasnicka, September 2005.
049 "Courtesy and Idleness: Gender Differences in Team Work and Team Competition" by Radosveta Ivanova-Stenzel and Dorothea Kübler, September 2005.
050 "Do Factor Shares Reflect Technology?" by Benjamin Bental and Domonique Demougin, September 2005.
051 "Optimal investments for risk- and ambiguity-averse preferences: A duality approach" by Alexander Schied, September 2005.
052 "Relational Contracts and Job Design" by Anja Schöttner, September 2005.
053 "Explicit characterization of the super-replication strategy in financial markets with partial transaction costs" by Imen Bentahar and Bruno Bouchard, October 2005.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

