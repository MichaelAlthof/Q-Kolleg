BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2011-053
When to Cross the Spread: Curve Following
with Singular Control
Felix Naujokat* Ulrich Horst**
* Humboldt-Universität zu Berlin, Germany **Corresponding Author
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

When to Cross the Spread: Curve Following
with Singular Control
Felix Naujokat and Ulrich Horst
Institut fu¨r Mathematik Humboldt-Universita¨t zu Berlin Unter den Linden 6, 10099 Berlin
Germany e-mail: {naujokat,horst}@math.hu-berlin.de
Abstract: In this article the problem of curve following in an illiquid market is addressed. Using techniques of singular stochastic control, we extend the results of [NW11] to a twosided limit order market with temporary market impact and resilience, where the bid ask spread is now also controlled. We first show existence and uniqueness of an optimal control. In a second step, a suitable version of the stochastic maximum principle is derived which yields a characterisation of the optimal trading strategy in terms of a nonstandard coupled FBSDE. We show that the optimal control can be characterised via buy, sell and no-trade regions. The new feature is that we now get a nondegenerate no-trade region, which implies that market orders are only used when the spread is small. This allows to describe precisely when it is optimal to cross the bid ask spread, which is a fundamental problem of algorithmic trading. We also show that the controlled system can be described in terms of a reflected BSDE. As an application, we solve the portfolio liquidation problem with passive orders.
AMS 2000 subject classifications: 93E20, 91G80 JEL classification: C61, G11. Keywords and phrases: Stochastic maximum principle, Convex analysis, Fully coupled forward backward stochastic differential equations, Trading in illiquid markets..
1. Introduction
In [NW11] the problem of curve following in an order book model with instantaneous price impact and absolutely continuous market orders is solved. In particular it is assumed that trades have no lasting impact on future prices. However in limit order markets the best bid and best ask prices typically recover only slowly after large discrete trades. In the present work we therefore extend the results of [NW11] to a two-sided limit order market model with temporary market impact and resilience, where the price impact of trading decays only gradually. Trading strategies now include continuous and discrete trades, so that we are in the framework of singular stochastic control. The singular nature of the market order complicates the analysis considerably, the optimal market order cannot be characterised as the pointwise maximiser of the Hamiltonian as in the absolutely continuous case. Moreover, we now face an optimisation problem with constraints, since passive buy and sell orders are modelled separately and both are nonnegative.
Methods of singular control have been applied in different fields including the monotone follower problem as in [BSW80], the consumption-investment problem with proportional transaction costs in [DN90] and finite fuel problems as in [KOWZ00]. Most of them rely on the dynamic programming approach or a direct martingale optimality principle. Here we shall prove a version of the stochastic maximum principle. In contrast to dynamic programming, this does not require regularity of the value function and provides information on the optimal control directly. Maximum principles for singular stochastic control problems can be found in [CH94], [ØS01] and [BM05], among others. These results cannot directly be applied to the optimisation problem under consideration, since it involves jumps and state dependent singular cost terms. The recent paper [ØS10] provides necessary and sufficient maximum principles for jump diffusions with partial information. Despite being fairly general, their setup does not cover the particular model we consider; instead we give a direct proof based on [CH94] and the ideas developped in [NW11].
Corresponding author
1

F. Naujokat/Curve Following with Singular Control

2

As in [NW11] we consider an investor who wants to minimise the deviation of his stock holdings from a prespecified target function, which is driven by a vector of uncontrolled stochastic signals. The applications we have in mind are index tracking, portfolio liquidation, hedging and inventory management. Our problem can be seen as an extension of the monotone follower problem to an order book framework with market and passive orders. In our model, the investor faces a tradeoff between the penalty for deviation and the liquidity costs of trading in the order book, i.e. the costs of crossing the spread and buying into the order book. The investor's market orders widen the spread temporarily; the gap then attracts new limit orders from other market participants and the spread recovers. The key decision the trader has to take is the following: If the spread is small, trading is cheap and a market order might be beneficial. For large spreads however it might be better to stop trading and wait until the spread recovers. When to cross the spread is a fundamental question of algorithmic trading in limit order markets. An equivalent question would be when to convert a limit into a market order. To the best of our knowledge, the problem of when to cross the bid ask spread has not been addressed in the mathematical finance literature on limit order markets. [OW05] and [PSS10], for instance, consider portfolio liquidation for a one-sided order book with initial spread zero and without passive orders; in this case it is optimal never to stop trading.
Our order book model is inspired by [OW05], a model which has recently been generalised to arbitrary shape functions by [AFS10] as well as [PSS10] and stochastic order book height in [Fru11]. While the mentioned articles focus on portfolio liquidation, we consider here the more general problem of curve following and therefore need a two-sided order book model. In addition, we allow for passive orders. These are orders with random execution which do not induce liquidity costs, such as limit orders or orders placed in a dark venue.
Our first mathematical result is an a priori estimate on the control. For the proof, we reduce the curve following problem to an optimisation problem with quadratic penalty and without target function and then use a scaling argument. This result provides the existence and uniqueness of an optimal control via a Koml´os argument. Next we prove a suitable version of the stochastic maximum principle and characterise the optimal trading strategy in terms of a coupled forward backward stochastic differential equation (FBSDE). The proof builds on results from [CH94] and extends them to the present case where we have jumps, state-dependent singular cost terms and general dynamics for the stochastic signal. Next we give a second characterisation of optimality in terms of buy, sell and no-trade regions. It turns out that there is always a region where the costs of trading are larger than the penalty for deviating, so that it is optimal to stop trading when the controlled system is inside this region. This is in contrast to [NW11], where only absolutely continuous trading strategies are allowed and a smoothness condition on the cost function is imposed. It was shown in therein that under these conditions the no-trade region is degenerate, so that the investor always trades. In the present model the no-trade region is defined in terms of a threshold for the bid ask spread. We show that spread crossing is optimal if the spread is smaller than or equal to the threshold. If it is larger, then no market orders should be used. The threshold is given explicitly in terms of the FBSDE and as a result, we can precisely characterise when spread crossing is optimal for a large class of optimisation problems. We will see that market orders are applied such that the controlled system remains inside (the closure of) the no-trade region at all times, and that its trajectory is reflected at the boundary. To make this precise, we show that the adjoint process together with the optimal control provides the solution to a reflected BSDE.
A liquidity event which executes the passive order may also lead to a price shift in the primary venue. Typically, the price after the execution is better than the realised price, so that passive orders become less attractive. Our model is flexible enough to cover "adverse selection" and we discuss how our main results change.
In general it is difficult to solve the coupled forward backward SDE (or the corresponding Hamilton-Jacobi-Bellman quasi variational inequality) explicitly. This is due to the Poisson jumps (leading to nonlocal terms) and the singular nature of the control. For quadratic penalty function and zero target function though the solution can be given in closed form. This corresponds to the portfolio liquidation problem in limit order markets and extends the result of [OW05] to trading strategies with passive orders. The new feature is that the optimal strategy is

F. Naujokat/Curve Following with Singular Control

3

not deterministic, but adapted to passive order execution, and the trading rate is not constant but increasing in time.
The remainder of this paper is organised as follows: We describe the market environment and the control problem in Section 2 and show in Section 3 that a unique optimal control exists. We then provide two characterisations of optimality, first via the stochastic maximum principle in Section 4 and then via buy, sell and no-trade regions in Section 5. The link to reflected BSDEs is presented in Section 6, the effect of adverse selection is investigated in Section 7 and we discuss the application to portfolio liquidation in Section 8.

2. The Control Problem
) Let (, F, {F(s) : s  [0, T ]}, P be a filtered probability space satisfying the usual conditions of right continuity and completeness and T > 0 be the terminal time.

Assumption 2.1. The filtration is generated by the following mutually independent processes,

(i) A d-dimensional Brownian Motion W , d  1.
(ii) Two one-dimensional Poisson processes Ni with intensities i for i = 1, 2. (iii) A compound Poisson process M on [0, T ] × Rk with compensator m(d)ds, where m(Rk) <
.

Trading takes place in a two sided limit order market. We postulate the existence of three

price processes: the benchmark price (a nonnegative martingale), the best ask price (which is

above the benchmark) and the best bid price (which is below the benchmark). On the buy side

of the order book liquidity is available for prices higher than the best ask price, and we assume a

block

shaped

distribution

of

available

liquidity

with

constant

height

1 1

>

0.

This

assumption

is

also made in [OW05]; it is key for the current approach as it leads to linear dynamics for the bid

ask spread. Similarly, liquidity is available on the sell side for prices lower than the best bid. We

assume a block shaped distribution of liquidity available on the sell side with constant height

1 2

>

0.

The

investor's

trades

have

a

temporary

impact1

on

the

best

bid

and

ask

prices,

this

will be made more precise below. The benchmark price is hypothetical and cannot be observed

directly in the market. As in [NW11], it represents the "fair" price of the underlying or a reference

price in the absence of liquidity costs. We assume that the benchmark price is uncontrolled. A

stylised snapshot of the order book and a typical trajectory of the price processes are plotted in

Figure 1.

The investor can apply market buy (resp. sell) orders to consume liquidity on the buy (sell)

side of the order book. His cumulated market buy (sell) orders are denoted by 1 (resp. 2). These are nondecreasing c`adl`ag processes, and hence we allow for continuous as well as discrete

trades and denote by

i(s) i(s) - i(s-)  0
for s  [0, T ] and i = 1, 2 the jumps of i. Such control processes are more general than absolutely continuous trading strategies and they seem better suited to describe real world trading strategies, which are purely discrete.
In addition, just as in [NW11], the investor can use passive buy (resp. sell) orders u1 (resp. u2). We assume that they are placed and fully executed at the benchmark price. Thus a passive order always achieves a better price than the corresponding market order, however its execution is uncertain. We think of them as orders placed in a dark pool or as a stylised form of limit orders. Market and passive orders represent taking and providing liquidity.
The class of admissible controls is now defined for t  [0, T ] as
{ [ T ] Ut (, u) : [t, T ] ×   R+2 × R+2 i(t-) = 0, E i(T )2 + ui(r)2dr < ,
t
1A fundamental property of illiquid markets is that trades move prices. There is a large body of empirical literature on the price impact of trading, we refer the reader to [KS72], [HLM87], [HLM90], [BHS95] and [ATHL05].

F. Naujokat/Curve Following with Singular Control

4

Volume 1400 1200 1000 800 600 400 200

Best Bid Price
99

Benchmark Price Best Ask Price
100 101

Price 102

PRICE 102 100 98 96 94 92

Best ask, best bid and midquote prices

20 40 60 80

TIME 100

Fig 1. (a) This stylised snapshot of the order book shows the best bid, benchmark and best ask price as well as liquidity that is available (dark) and consumed (light). (b) Here we see a typical evolution of the price processes over time. The best ask (red) is above the benchmark price (dashed black), which is above the best bid price (blue). Market buy (resp. sell) orders lead to jumps in the best ask (resp. bid) price. In the absence of trading, the best ask and best bid converge to the benchmark.

i

is

nondecreasing,

c`adla`g

and

progressively }

measurable

and

ui is predictably measurable, for i = 1, 2 .

Each control consists of the four components 1, 2, u1, u2, each of them being nonnegative. In
particular, we face an optimisation problem with constraints. We note that 1(s) (resp. 2(s))
denotes the market buy (resp. sell) orders accumulated in [t, s]. In contrast, u1(s) (resp. u2(s)) represents the volume placed as a passive buy (resp. sell) order at time s  [t, T ]. We remark that from i(T ) <  a.s. for i = 1, 2 it follows that r[t,T ] i(r) <  a.s. and we have the following decomposition of the singular term into a continuous and a pure jump part for

s  [t, T ]:

(  )

i(s) = i(s) -

i(r) +

i(r).

r[t,s]

r[t,s]

Having defined the admissible controls, let us now specify the price dynamics. Instead of

modelling the best bid and best ask price directly, we find it more convenient to work with the

buy and sell spreads instead. Specifically, we denote by X1 the distance of the best ask price to the benchmark price and call this process the buy spread. As in [OW05] and [AFS10] we assume

exponential recovery of the buy spread with resilience parameter 1 > 0. The dynamics of the buy spread are then given for s  [t, T ] by

s 

X1(s) - X1(t-) = - 1X1(r)dr +

1d1(r), X1(t-) = x1  0.

t [t,s]

 As a convention, we write [t,s] for integrals with respect to the singular processes i for i = 1, 2 to indicate that possible jumps at times s and t are included. Similarly, the sell spread X2 is
defined as the distance of the best bid price to the benchmark price and it satisfies

s 

X2(s) - X2(t-) = - 2X2(r)dr +

2d2(r), X2(t-) = x2  0.

t [t,s]

An immediate consequence is that the spreads X1 and X2 are nonnegative and mean reverting. As a consequence, the best ask price is larger than or equal to the best bid price. In our model, the investor's market buy orders have a temporary impact on the best ask price, but not on the best bid (and vice versa). Passive orders do not move prices. Moreover, the price impact of trading decays over time (resilience) and in the absence of trading the price processes converge to the benchmark price.

F. Naujokat/Curve Following with Singular Control

5

Remark 2.2. · In the literature the bid ask spread is typically defined as the distance of the best ask from the best bid price; in our notation this process is given by X1 + X2.
· In the seminal paper [Kyl85] three measures of liquidity are defined, all of which are captured in the model we propose. Depth, "the size of an order flow innovation required
to change prices a given amount", is given by the parameters 1 and 2 which denote the inverse order book height. Resiliency, "the speed with which prices recover from a random,
uninformative shock", is captured by the resilience parameters 1 and 2. Finally, tightness, "the cost of turning around a position over a short period of time", can be measured in
terms of the bid ask spread X1 + X2. · As [NW11], the dynamics of the benchmark price is not important, aside from the fact
that this process is a nonnegative martingale. Then it does not contribute to the expected
trading costs and the liquidity costs only depend on the buy and sell spread.

We shall need a third state process X3 representing the investor's stock holdings. They are the sum of the market and passive buy orders less the market and passive sell orders, and thus

for s  [t, T ] given by

  s

s

X3(s) - X3(t-) =

d1(r) -

d2(r) + u1(r)N1(dr) - u2(r)N2(dr),

[t,s] [t,s] t

t

X3(t-) = x3  R.

A jump of the Poisson process Ni represents a liquidity event which executes the passive order
ui, for i = 1, 2. For simplicity we consider full execution only, this assumption is also made in [Kra11] and in [NW11]. We define the vector X (Xi)i=1,2,3 and write X = X,u if we want to emphasise the dependence of the state process on the control. Note that there are two sources

of jumps, the Poisson processes and the discrete market orders. More precisely, the jump of the

state process at time s  [t, T ] is given by

 X1(s) - X1(s-)
X(s) = X2(s) - X2(s-) = N X(s) + X(s)

X3(s) - X3(s-)





0 11(s)  0  +  22(s)  .

u1(s)N1(s) - u2(s)N2(s)

1(s) - 2(s)

The formulation of the curve following problem is close to [NW11]. The trader wants to minimise

the deviation of his stock holdings to a prespecified target function  : [t, T ] × Rn  R. This

function depends on a vector of uncontrolled stochastic signals Z with dynamics given for s 

[t, T ] by

s s

Z(s) - Z(t-) = µ(r, Z(r))dr + (r, Z(r-))dW (r)

t s

t

+ (r, Z(r-), )M~ (dr, d), Z(t-) = z  Rn.

t Rk

We think of Z as a stochastic factor which drives the target function, it might represent a stock
price index, the price of an underlying or some other kind of risk factor. As above we denote the compensated Poisson martingale by M~ ([0, s]×A) M ([0, s]×A)-m(A)s; similarly N~i Ni-is for i = 1, 2. Having defined the state processes and their respective dynamics, let us now specify the optimisation criterion. The performance functional is defined for (t, x, z)  [0, T ] × R3 × Rn and a control (, u)  Ut as

J(t, x, z, , u)

[ Et,x,z


[t,T ]

[ X1(r-)

+

1 2

] 1(r)

d1(r)

+


[t,T ]

[ X2(r-)

+

2 2

] 2(r)

d2(r)

T ]

+ h (X3(r) - (r, Z(r))) dr + f (X3(T ) - (T, Z(T ))) .

t

(2.1)

F. Naujokat/Curve Following with Singular Control

6

There are four cost terms representing the conflicting objectives of accuracy and liquidity costs.

The first two terms on the right hand side of (2.1) capture trading costs of market buy (resp. sell)

orders, i.e. the costs of crossing the spread and buying (selling) into the order book. Specifically,

an infinitesimal market buy order d1(r) is executed at the best ask price, so that the costs of crossing the spread are given by X1(r-)d1(r). A discrete buy order 1(r) "eats" into the block shaped order book and shifts the spread from X1(r-) to X1(r-) + 11(r). Its liquidity

costs are therefore given by

( X1(r-)

+

1 2

) 1(r)

1(r).

In particular, the jump part in (2.1) is understood as, for i = 1, 2

[ E

] [

]

i(r)di(r) = E

(i(r))2

[t,T ]

r[t,T ]

[( 

)2] [

]

 E i(r)  E i(T )2 < .

r[t,T ]

(2.2)

The last two terms on the right hand side of (2.1) penalise deviation from the target function, the term involving h is referred to as running costs, while the term involving f represents terminal costs. As a shorthand, we sometimes write J(, u) J(t, x, z, , u) if (t, x, z)  [0, T ] × R3 × Rn is fixed. The optimisation problem under consideration is
Problem 2.3. Minimise J(, u) over (, u)  Ut.
For (t, x, z)  [0, T ] × R3 × Rn the value function is defined as

v(t, x, z) = inf J(t, x, z, , u).
(,u)Ut

Remark 2.4. Problem 2.3 is a singular stochastic control problem. Maximum principles for

singular control are derived for instance in [CH94], [ØS01] and [BM05]. However, the above

problem is not coveredby th[eir results the singular cost terms [t,T ] Xi(r-) +

f2oi rseiv(err)a]ldreia(rs)onfosr.

Firstly, i = 1, 2

it involves depend on

jumps. Secondly, the state variable

and on the setup only

jumps allows

of the control, which is not for cost terms of the form

thTe
t

case in the "usual" formulation. The standard k(s, )d(s). A third difficulty in the present

model is that the absolutely continuous control u (the passive order) does not incur trading

costs, so the "standard" characterisation as the pointwise maximiser of the Hamiltonian does

not apply.

The recent article [ØS10] provides necessary and sufficient maximum principles for the singular

control of jump diffusions, where the singular cost term may depend on the state variable. However, they do not allow for terms like [t,T ] i(r)di(r), they do not incorporate absolutely continuous controls (which are needed in the present framework for the passive order u) and

their sufficient condition is based on a convexity condition on the Hamiltonian which is not

satisfied in our specific case. Instead we give a direct proof based on [CH94] and ideas used in

[NW11].

To ensure existence and uniqueness of an optimal control, we impose the following assumptions. Here and throughout, we write c for a generic constant, which might be different at each occurrence.

Assumption 2.5. (i) The penalty functions f, h : R  R are strictly convex, continuously differentiable, normalised and nonnegative.
(ii) In addition, f and h have at least quadratic growth, i.e. there exists  > 0 such that |f (x)|, |h(x)|  |x|2 for all x  R.
(iii) The functions µ,  and  are Lipschitz continuous, i.e. there exists a constant c such that for all z, z  Rn and s  [t, T ],

µ(s, z) - µ(s, z)R2 n + (s, z) - (s, z)2Rn×d

F. Naujokat/Curve Following with Singular Control
 + (s, z, ) - (s, z, )2Rn m(d)  cz - zR2 n .
Rk

In addition, they satisfy

[ ]

sup µ(s, 0)R2 n + (s, 0)2Rn×d + (s, 0, )R2 n m(d) < .

tsT

Rk

7

(iv) The target function  has at most polynomial growth in the variable z uniformly in s, i.e. there exist constants c, q > 0 such that for all z  Rn,
sup |(s, z)|  c(1 + zRq n ).
tsT

(v) The penalty functions f and h have at most polynomial growth.

Remark 2.6. Let us briefly comment on these assumptions. Taking f and h nonnegative is reasonable for penalty functions. Normalisation is no loss of generality, this may always be achieved by a linear shift of f, h and . Quadratic growth of f and h is only needed in Lemma 3.4 for an a priori L2-norm bound on the control, which is then used for a Koml´os argument. The convexity condition leads naturally to a convex coercive problem which then admits a unique solution.

Once the existence of an optimal control is established, we need one further assumption. It guarantees the existence and uniqueness of the adjoint process.
Assumption 2.7. The derivatives f  and h have at most linear growth, i.e. for all x  R we have |f (x)| + |h(x)|  c(1 + |x|).

3. Existence of a Solution

The aim of the present section is to show that the performance functional is strictly convex and that it is enough to consider controls with a uniform L2-norm bound. Combining these results with a Koml´os argument, we then prove that there is a unique optimal control. Henceforth we impose Assumption 2.5. We begin with some growth estimates for the state processes. This result extends [NW11] Lemma 4.1 to the singular control case.

Lemma 3.1. (i) For every p  2 there exists a constant cp such that for every (t, x, z)  [0, T ] × R3 × Rn we have
[] Et,x,z sup Z(s)pRn  cp (1 + zpRn ) .
tsT

(ii) There exists a constant cx such that for any (, u)  Ut we have

[

](

[ ] [ T

])

Et,x,z sup X,u(s)2R3  cx 1 + Et,x,z (T )R2 2 + E

u(r)2R2 dr .

tsT

t

In particular, X,u has square integrable supremum for all (, u)  Ut. Proof. The argument is as in [NW11] Lemma 4.1.
A first consequence of the above lemma is that the zero control incurs finite costs. Corollary 3.2. The zero control incurs finite costs, i.e. for each (t, x, z)  [0, T ] × R3 × Rn we have

J(t, x, z, 0, 0) < .

Proof. This result is a consequence of the polynomial growth of f, h and  together with Lemma 3.1.

F. Naujokat/Curve Following with Singular Control

8

We now show that the performance functional is strictly convex in the control, so that methods of convex analysis can be applied.

Proposition 3.3. The performance functional (, u)  J(t, x, z, , u) is strictly convex, for every (t, x, z)  [0, T ] × R3 × Rn.

Proof.

From

the

definition

of

Xi

for

i

=

1, 2

we

have

di(s)

=

dXi

(s)+i i

Xi

(s)ds

.

We

use

this

to

rewrite the performance functional as

J(t, x, z, , u)

=Et,x,z

[

X1

(T )2 - 21

x12

T

+

X2(T )2 - x22 22

T +
t

1 1

X1

(r)2

dr

T +
t

2 ]2

X2(r)2

dr

+ h (X3(r) - (r, Z(r))) dr + f (X3(T ) - (T, Z(T ))) .

t

(3.1)

The right hand side is strictly convex in X. Due to the fact that (, u)  X,u is affine, it follows that (, u)  J(t, x, z, , u) is strictly convex.

The aim in this section is to prove existence and uniqueness of an optimal control. For the proof of this result, we need two auxiliary lemmata. We first show a quadratic growth estimate on the value function in Lemma 3.4. This extends Lemma 4.2 from [NW11] to the singular control case.

Lemma 3.4. For each (t, x, z)  [0, T ] × R3 × Rn there are constants c1,t, c2, c3 > 0 such that

v(t, x, z)  c1,tx32 - c2 (1 + zRc3n ) .

Proof. The idea is to use the growth conditions on the penalty functions to reduce the optimisation problem to simpler linear-quadratic problem, which can then be estimated in terms of x32. Using the quadratic growth of f and h yields

v(t, x, z)



inf
(,u)Ut

[

Et,x,z

[t,T ]

[ X1(r-)

+

1 2

] 1(r)

d1(r)

+


[t,T ]

[ X2(r-)

+

2 2

] 2(r)

d2(r)

T ]

+  (X3(r) - (r, Z(r)))2 dr +  (X3(T ) - (T, Z(T )))2 .

t

Next

an

application

of

the

inequality

(a

-

b)2



1 2

a2

-

b2

leads

to

v(t, x, z)



[

inf Et,x,z

(,u)Ut

[t,T ]

+

T
t

 2

|X3(r)|2 dr

[ X1
 +
2

(r-)

+

1 2

] 1(r) d1(r)

] [ T

|X3(T )|2 - Et,x,z

t

+


[t,T ]

[ X2(r-)

+

2 2

] 2(r) d2
]

|(r, Z(r))|2 dr + |(T, Z(T ))|2 .

(r)

The polynomial growth of  coupled with Lemma 3.1 provides the existence of constants c2, c3 > 0 such that

v(t, x, z)

(3.2)



inf
(,u)Ut

[

Et,x,z

[t,T ]

[ X1(r-)

+

1 2

] 1(r)

d1(r)

+


[t,T ]

[ X2(r-)

+

2 2

] 2(r)

d2(r)

T +
t

 2

|X3(r)|2 dr +

 2

] |X3(T )|2 - c2 (1 + zcR3n ) .

This provides an estimate of the original value function in terms of an easier optimisation problem with a quadratic penalty function and zero target function. Economically, this may be

F. Naujokat/Curve Following with Singular Control

9

interpreted as a portfolio liquidation problem. To continue the estimate, we define the following "value" function,

v1(t, x) inf
(,u)Ut

[
Et,x
[t,T ]

[ X1(r-)

+

1 2

] 1(r)

d1(r)

+


[t,T ]

[ X2(r-)

+

2 2

2

] (r)

d2

(r)

T +
t

 2

|X3(r)|2 dr +

 2

] |X3(T )|2 .

We remark that the value function v1 is monotone in Xi for i = 1, 2 and Xi is monotone in the

starting value xi, so that v1 does not increase if we replace the initial spread Xi(t-) = xi  0 by zero for i = 1, 2 and only consider starting values x = (0, 0, x3), i.e.

v1(t,

x)



( v1 t,

(0,

0,

x3))

v2(t, x3).

Let us denote by J2 the performance functional associated to the value function v2. Due to xi = 0 for i = 1, 2 the mappings (, u)  Xi,u are linear and the mapping (x3, , u)  X3,u - x3 is also linear. This can be used to show that J2 scales quadratically, i.e. for (t, x3)  [0, T ] × R and
a scaling factor  > 0 we have

J2(t, x3, , u) = 2J2(t, x3, , u).

Next we claim that also v2 scales quadratically. Indeed, let (un, n)  Ut be a minimising sequence for v2(t, x3) and let  > 0 be a scaling factor. We use that J2 scales quadratically to write

v2(t,

x3)

=

lim
n

J2(t,

x3,

n,

un)

=

2

lim
n

J2(t,

x3,

n 

,

un 

)



2v2(t,

x3).

(3.3)

We

now

use

(3.3)

with

the

scaling

factor

1 

to

get

the

reverse

inequality:

2v2(t, x3)

=

2v2

( t,

1)  (x3)



1 

2

2v2(t,



x3

)

=

v2(t, x3).

(3.4)

Combining (3.3) and (3.4) we see that

v2(t, x3) = 2v2(t, x3).

One can check that if x3 = 0 then v2(t, 0) = 0. Choosing now  = |x3| for x3 = 0 we get

 x32v2(t, 1),

x3 > 0

v2(t, x3) = x0,23v2(t, -1),

x3 = 0 x3 < 0,

and defining c1,t min{v2(t, 1), v2(t, -1)} leads to v2(t, x3)  c1,tx32.
Plugging this result into (3.2) provides the following estimate

v(t, x, z)  c1,tx23 - c2 (1 + zRc3n ) .
To prove the assertion of the lemma, it remains to show that the constant c1,t is strictly positive and finite for each t  [0, T ]. The proof of this result can be found in [Nau11] Lemma A.2.1.
We are now ready to prove an a priori estimate on the control, which will be needed in the Koml´os argument below. This result extends [NW11] Lemma 4.3 to the singular control case.

F. Naujokat/Curve Following with Singular Control

10

Lemma 3.5. There is a constant K such that any control with

[ T ]

Et,x,z (T )R2 2 +

u(r)R2 2 dr > K

t

cannot be optimal.

Proof. We first consider the market order . The dynamics of Xi for i = 1, 2 imply that for s  [t, T ] we have



Xi(s) = e-i(s-t)xi + i

e-i(r-t)di(r),

[t,s]

(3.5)

and thus Xi(T )  ie-iT i(T ). Combining this with (3.1) yields

J(, u)



Et,x,z

[ Xi(T )2 2i

-

x21 21

-

x22 ] 22



K1Et,x,z[i(T )2]

-

K2,x.

(3.6)

for

constants

K1, K2,x

>

0.

It

follows

that

if

Et,x,z[i(T )2]

>

J (0,0)+K2,x+1 K1

then



cannot

be

optimal. We have J(0, 0) <  due to Corollary 3.2.

The estimate in terms of the passive order u is slightly more involved. Let i denote the first
jump time of the Poisson process Ni after t for i = 1, 2, an exponentially distributed random variable with parameter i, and set  1  2  T . At the jump time  the state process jumps from X( -) to

X( -) + N X( )

 0
X( -) +  0  .
u1( )1{1<2T } - u2( )1{2<1T }

We use the definition of the cost functional and the fact that the cost terms are nonnegative to

get

J (,

u)

[

=Et,x,z



[t, ) 

[ X1(r-)

+

1 2

] 1(r) d1(r)

+


[t, )

[ X2(r-)

+

2 2

] 2(r) d2(r)
]

+ h (X3(r) - (r, Z(r))) dr + J (, X( -) + N X( ), Z( ), , u)

(3.7)

t

Et,x,z [J (, X( -) + N X( ), Z( ), , u)]

Et,x,z [v(, X( -) + N X( ), Z( ))] ,

where J in the above is evaluated at controls on the stochastic interval2 [, T ]. Combining this

with Lemma 3.4 we get

J

(,

u)



Et,x,z

[ c1,t|X3(

-)

+

N

X3(

)|2

-

c2(1

+

Z (

)cR3n

] )

.

In view of Lemma 3.1 we have

[

]

Et,x,z [Z( )cR3n ]  Et,x,z sup Z(s)Rc3n  c (1 + zcR3n ) ,
s[t,T ]

and thus there is a constant c2,z  0 such that

J (,

u)



-c2,z

+

c1,tE

[ |X3(

-)

+

N

X3(

)|2]

.

(3.8)

2More precisely, we split the interval [t, T ] into the subintervals [t,  ] and (, T ]. By definition of the cost functional, the singular order on the second subinterval (, T ] includes a possible jump at the left endpoint  , so this jump must be excluded from the first subinterval [t,  ]. For this reason, the state process directly after the Poisson jump in (3.7) is given by X( -) + N X( ) and not by X( -) + N X( ) + X( ) = X( ).

F. Naujokat/Curve Following with Singular Control

11

By definition, the stock holdings directly after a jump of the Poisson process are given by

X3( -) + N X3( ) = x3 + 1( -) - 2( -) + u1( )1{1<2T } - u2( )1{2<1T },

and

an

application

of

the

inequality

(a

+ b)2



1 2

a2

- b2

leads

to

|X3( -) + N X3( )|2



1 2

( u1(1)1{1<2T }

-

u2(2)1{2<1T })2

-

(x3

+

1( -)

-

2( -))2



1 2

( u1(1)1{1<2T }

-

u2(2)1{2<1T })2

-

3

( |x3

|2

+

|1( -)|2

+

|2( -)|2)



1 2

( u1(1)1{1<2T }

-

u2(2)1{2<1T })2

-

3

( |x3

|2

+

|1(T

)|2

+

|2(T

)|2)

.

(3.9)

Combining (3.8) and (3.9) we get

1 [( J2(c1,,tuE)t,+x,zc2,zu+1(3c11),1t {(|1x<3|22+T

} - u2(2)1{2<1T })2

Et,x,z

[ |1(T

)|2

+

|2(T

] )|2

])

.

Due to equation (3.6) we have for i = 1, 2

Et,x,z[|i(T )|2]



K2,x K1

+

1 J(, u),
K1

so combining the last two displays and relabelling constants provides

Et,x,z

[( u1(1)1{1<2T }

-

u2(2)1{2<1T })2]



c1,t,x,z

+

c2,tJ (,

u).

(3.10)

We shall now compute the term on the left hand side of inequality (3.10). The jump times i

are independent and exponentially distributed with parameter i, for i = 1, 2. We thus have

Et,x,z

[( u1(1)1{1<2T

}

-

u2(2)1{2<1T

)2]
}

 =





1 e-1 (r1 -t) 2 e-2 (r2 -t)

( u1(r1)1{r1<r2T }

-

u2(r2)1{r2<r1T

)2
}

dr1dr2

t  t T

 1e-1(r1-t)2e-2(r2-t)|u1(r1)|2dr1dr2,

Tt

where we have used the nonnegativity of the integrand in the last line and restricted integration

to (r1, r2)  [t, T ] × [T, ). We now compute

Et,x,z

[( u1(1)1{1<2T }

-

u2(2)1{2<1T })2]

 

 2e-2(r2-t)dr2

T

1e-1(r1-t)Et,x,z [|u1(r1)|2] dr1

T =e-2(T -t)

T

t

1e-1(r1-t)Et,x,z

[ |u1

(r1

)|2]

dr1

t e-2(T -t)1e-1(T -t)

T

Et,x,z

[ |u1

(r1)|2]

dr1.

t

Combining this with equation (3.10) and relabelling constants we get

[ T

]

Et,x,z

|u1(r)|2dr  c1,t,x,z + c2,tJ (, u).

t

F. Naujokat/Curve Following with Singular Control

12

In particular if

[ T

]

Et,x,z

|u1(r)|2dr  c1,t,x,z + c2,tJ (0, 0) + 1,

t

then we see that J(, u) > J(0, 0) and the control (, u) is clearly not optimal. A similar estimate holds for the passive sell order u2.

Theorem 3.6. There is a unique optimal control (^, u^)  Ut for Problem 2.3.

Proof. Let (n, un)nN  Ut be a minimising sequence, i.e.

lim J(n, un) = inf J(, u).

n

(,u)Ut

Recall that continuous.

the singular control Identifying un with

n the

insoandneocnrdeeacsrineagscin`agdlca``agdpl`argocpersoscets· su,nw(rh)edrre,aws euncains

absolutely also inter-

pret un as a singular control. Due to the uniform L2-norm bound from Lemma 3.5 we can then

apply the Koml´os theorem for singular stochastic control given in [Kab99] Lemma 3.5. It provides the existence of a subsequence (also indexed by n) and adapted processes ^ : [t, T ] ×   R+2 such that

¯n 1 n i n
i=1

converges weakly to ^ in the sense that for almost all    the measures ¯n() on [t, T ] converge weakly to ^(). Similarly there is an adapted process  : [t, T ] ×   R+2 such that

u¯n 1 n ui n
i=1

converges weakly to . However it is not yet clear that the limit  is absolutely continuous with
respect to Lebesgue measure, so it is not an admissible passive order. Therefore we now fix ^ and consider the mapping u  J(^, u). The sequence of controls (un)nN is still a minimising sequence, i.e.

lim J(^, un) = inf J(^, u).

n

u

A Koml´os argument as in the proof of [NW11] Theorem 3.1 now provides the existence of a further subsequence (also indexed by n) and a predictable process u^ = u^ which takes values from [t, T ] ×  and is valued in R+2 such that
u¯n 1 n ui n
i=1

converges to u^ ds × dP a.e. on [t, T ] × .

We now show that (^, u^) is an optimal control. The weak convergence coupled with equation

(3.5) implies that for s  [t, T ] such that ^(s) = 0 we have a.s.

[

]

lim
n

X1¯n,u¯n (s)

=

lim
n

e-1(s-t)x1 + 1 

e-1(r-t)d¯1n(r)
[t,s]

=e-1(s-t)x1 + 1

e-1(r-t)d^1(r) = X1^,u^(s),

[t,s]

and similarly for X2 and X3. Combining Fatou's lemma with the convexity of J gives

J(^, u^)



lim inf

J (¯n, u¯n)



lim inf

1

n J (i, ui)

=

inf

J(, u),

n

n n
i=1

(,u)Ut

which shows that (^, u^) minimises J over Ut. Uniqueness is due to the strict convexity of (, u)  J(, u) and can be shown as in the proof of [NW11] Theorem 3.1.

Throughout, we denote by (^, u^) the optimal control and by X^ = X^,u^ the optimal state trajectory.

F. Naujokat/Curve Following with Singular Control

13

4. The Stochastic Maximum Principle

In the preceding section we showed that Problem 2.3 admits a unique solution under Assumption

2.5. We shall now prove a version of the stochastic maximum principle which yields a charac-

terisation of the optimal control in terms of the adjoint equation. In the sequel, we impose

Assumption 2.7 and we write E instead of Et,x,z. The adjoint equation is defined as the following

BSDE on [t, T ],

 P1(s) - P1(t-)




s

1P1(r)





 s Q1(r)

P2(s) - P2(t-) = 

2P2(r)

 dr + Q2(r) dW (r)

P3(s) - P3(t-)

t


h(X^3(r)

- (r, 

s R1,1(r)

Z

(r))) 

 t Q3(r) s R2,1(r)

+ R1,2(r) N~1(dr) + R2,2(r) N~2(dr)

t


s



R1,3(r) R3,1(r,

 )

t R2,3(r)

+ R3,2(r, ) M~ (dr, d)

t


Rk


R3,3(r,

1

)



 0

+ 0 d^1(r) + 1 d^2(r),

[t,s] 0

[t,s] 0

 



P1(T )

0

P2(T ) =  0  .

P3(T )

-f (X^3(T ) - (T, Z(T )))

(4.1)

Remark 4.1. Note that the optimal control ^ now enters the adjoint equation, which is not the case in the "usual" formulation of singular control problems, see e.g. [CH94]. We will show in Section 6 that the solution to the BSDE defined above provides the solution to a reflected BSDE, where the bid ask spread plays the role of the reflecting barrier.

The adjoint process is then a triple of processes (P, Q, R) defined for j = 1, 2, 3 on [t, T ] by

P (s)

 P1(s)
P2(s) , Q(s)

 Q1(s)
Q2(s) and R(s)

 R1,1(s) R1,2(s) R1,3(s)
R2,1(s) R2,2(s) R2,3(s) ,

P3(s)

Q3(s)

R3,1(s) R3,2(s) R3,3(s)

which satisfy for i = 1, 2, 3

Pi : [t, T ] ×   R, Qi : [t, T ] ×   Rd, R1,i : [t, T ] ×   R, R2,i : [t, T ] ×   R, R3,i : [t, T ] × Rk ×   R

and which also satisfy the dynamics (4.1) where P is adapted and Q, R are predictable.

Proposition 4.2. The BSDE (4.1) admits a unique solution which satisfies for i = 1, 2, 3

[

] [ T

] [ T

]

E sup |Pi(s)|2 + E

tsT

[ T

]

Qi(r)2Rd dr + E
t
[ T 

|R1,i(r)|2dr
t
]

+E |R2,i(r)|2dr + E

|R3,i(r, )|2m(d)dr < .

t t Rk

It is unique among triples (P, Q, R) satisfying the above integrability criterion.

Proof. The backward equation (4.1) is a linear BSDE, so standard arguments imply that its

solution can be given in closed form as

 P1(s) =

PP32((ss))

= =

E E E

[ [- [- -

 (s,T ] s(Ts,Th]

]

e-1(r-s)d^1(r) Fs] ,

e-2 (

(r-s)

d^2

(r)

Fs ),

X^3(r) - (r, Z(r)) dr

-

f

(X^3(T

)

-

(T ,

Z (T

) ))

] Fs .

(4.2)

F. Naujokat/Curve Following with Singular Control

14

We refer the reader to [Nau11] Proposition 2.4.2 for details.

The characterisation of the optimal control we shall derive exploits an optimality condition in terms of the G^ateaux derivative of J. Given controls (, u), (¯, u¯)  Ut, it is defined as

J(¯, u¯), (, u) = lim 1 [J (¯ + , u¯ + u) - J(¯, u¯)] . 0 

In our particular case, the G^ateaux derivative can be computed explicitly. This is the content of the following lemma.
Lemma 4.3. The performance functional J : (, u)  J(, u) is G^ateaux differentiable. Its derivative is given by, for controls (, u), (¯, u¯)  Ut,

J(¯, u¯), (, u)

[ [ =E X1,u(r-) -
 [t,T ][ + X2,u(r-) -
[t,T ] [ + X1¯,u¯(r-)
[t,T ]

e-1(r-t)x1

+

1 2

1

] (r)

d¯1

(r)

e-2(r-t)x2

+

2 2

] 2(r) d¯2(r)

+

1 2

] ¯1(r)

d1(r)

+


[t,T ]

[ X2¯,u¯

(r-)

+

2 2

] ¯2(r) d2(r)

 +

T

X3,u

(r)h

(X3¯,u¯ (r)

-

(r,

Z

) (r))

dr

+

X3,u(T

)f



(X3¯,u¯ (T

)

-

(T

,

Z

(T

) ))

] .

t

Proof. The terms involving h and f can be treated exactly as in [NW11] Lemma 5.3, so it is

enough to compute the G^ateaux derivative of

J1(, u)

E

[
[t,T ]

[ X1(r-)

+

1 2

] 1(r)

] d1(r)

.

From equation (3.5) it follows that the map (, u)  X1,u is affine, so for s  [t, T ],   [0, 1] and (, u), (¯, u¯)  Ut we have

 X1¯+,u¯+u(s) =X1¯,u¯(s) + 1

e-1(r-t)d1(r)

=

X1¯,u¯ (s)

+

(X1,u(s)

-

e-1

(s-t)

x1

) .

[t,s]

We can now compute

J1 (¯, u¯), (, u)

1

====E++llliii[mmm-0002[111t[,tEET[[,tJT],[[¯T1[]1]X[(([[[rX¯tt1X,,)TT+1,¯+u1]]¯,u(¯[[,ur¯(XX(-r,r2-11¯u¯1¯)-+,)u¯-+)(+r+e,1u-¯-u(+()r)2X11)+-u(]r1(d-rJ,u¯¯-(t111()X(x(r)(¯rr-11+,)),u+])¯u-)(-d2]r1¯2-e11[t-(),r¯T-)11]]((1[rre(X-)-rt)+1¯)]1,xu(¯dr1(-¯)r21t1-+)(xr))1+2)11

] (r) d (¯1(r) + 1(r))

1 2

¯1

] (r)

d¯1

(r)

¯1(r)

+



1 2

] 1(r)

d1

] (r)

F. Naujokat/Curve Following with Singular Control

+


[t,T ]

[ X1¯,u¯ (r-)

+

1 2

]] ¯1(r) d1(r) .

15

This completes the proof.

Our version of the maximum principle is based on an optimality condition on the G^ateaux
derivative. As a prerequisite for some algebraic manipulations of the G^ateaux derivative, let us now compute d(P · X) for a fixed control (, u)  Ut. Using integration by parts, we have for s  [t, T ]

P (s)X(s) - P (t-)X(t-)

 =

s

X3(r-)h(X^3

(r)

-

(r,

Z

) (r)) dr

t s[

(

)(

)]

+ 1u1(r) P3(r) + R1,3(r) - 2u2(r) P3(r) + R2,3(r) dr

t s [

]

+ X1(r-)Q1(r) + X2(r-)Q2(r) + X3(r-)Q3(r) dW (r)

+

t

s

[ X1

(r-)R1,1(r)

+

X2

(r-)R1,2

(r)

+

X3

(r-)R1,3

(r)

+

u1

( (r) P3

(r-)

+

R1,3

(r))]N~1(dr)

+

t

s

[ X1

(r-)R2,1(r)

+

X2

(r-)R2,2

(r)

+

X3

(r-)R2,3

(r)

-

u2

( (r) P3

(r-)

+

R2,3

(r))]N~2(dr)

t s  +

[ X1(r-)R3,1(r,

)

+

X2

(r-)R3,2

(r,

)

+

X3(r-)R3,3(r,

)]M~

(dr,

d)

t

Rk
[

]

+ 1P1(r) + P3(r) d1(r) +

[] 2P2(r) - P3(r) d2(r)

[t,s]

 [t,s]

+ X1(r-)d^1(r) + X2(r-)d^2(r).

[t,s]

[t,s]

This can be written as

Y ,u(s) = P (t-)X(t-) + L,u(s),

(4.3)

where we define the "local martingale part" L,u for s  [t, T ] by

L,u(s)

 s[

]

X1(r-)Q1(r) + X2(r-)Q2(r) + X3(r-)Q3(r) dW (r)

t s[

+ X1(r-)R1,1(r) + X2(r-)R1,2(r) + X3(r-)R1,3(r)

t

+

( u1(r) P3(r-)

+

R1,3

(r))]N~1

(dr)

 s[

+ X1(r-)R2,1(r) + X2(r-)R2,2(r) + X3(r-)R2,3(r)

t

-

( u2(r) P3(r-)

+

R2,3

(r))]N~2

(dr)

 s +

[ X1

(r-)R3,1(r,

)

+

X2(r-)R3,2

(r,

)

+

X3

(r-)R3,3(r,

)]M~

(dr,

d),

t Rk

and the "non-martingale part" Y ,u for s  [t, T ] by

Y ,u(s)

s (

)

P (s)X(s) - X3(r)h X^3(r) - (r, Z(r)) dr

 s[

t
(

)(

)]

- 1u1(r) P3(r) + R1,3(r) - 2u2(r) P3(r) + R2,3(r) dr

t

F. Naujokat/Curve Following with Singular Control

[

] [

]

- 1P1(r) + P3(r) d1(r) - 2P2(r) - P3(r) d2(r)

[t,s]

 [t,s]

- X1(r-)d^1(r) - X2(r-)d^2(r).
[t,s] [t,s]

16

Let us now check that L is indeed a martingale.

Lemma 4.4. For each (, u)  Ut, the process L,u is a martingale starting in 0.

Proof.

We

first

consider

the

process

·
t

X1(r-)Q1(r)dW

(r).

To

prove

that

it

is

a

true

martingale

it is enough to check that

[ s

]

E sup

X1(r-)Q1(r)dW (r) < .

s[t,T ] t

An application of the Burkholder-Davis-Gundy and H¨older inequalities yields

[ s

] [(  T

)1] 2

E sup

X1(r-)Q1(r)dW (r) cE

X1(r-)Q1(r)2Rd dr

s[t,T ] t

t

[

]1 2

[ T

]1 2

cE sup |X1(r)|2 E

Q1(r)R2 d dr .

r[t,T ]

t

Tt·heRklaXst1

expression is finite (r-)R1(r, )M~ (dr,

due d).

to Lemma 3.1 and A H¨older argument

Proposition 4.2. Now as above shows that

consider

the

process

[ T 

]

E |X1(r)R1(r, )| m(d)dr < .

t Rk

The martingale property now follows from [NW11] Lemma A.3. The remaining terms of L,u can be treated similarly.

We are now in a position to formulate our second main result, the stochastic maximum principle in integral form.

Theorem 4.5. A control (^, u^)  Ut is optimal if and only if for each (, u)  Ut we have

[ EE[
[ EE[


[t,T

]

[ X^1(r)

-

1P1

(r)

-

P3

] (r)

d

(1(r)

-

^1(r))


[t,T

]

[ X^2(r)

-

2P2

(r)

T
t

[u1(r)

-

u^1(r)] [R1,3

T
t

[u2(r)

-

u^2(r)] [R2,3

] + P3(r) d (2(r) - ^2(r))
]
(r) + P3(r)] dr  0, ]
(r) + P3(r)] dr  0.

] ]

 

0, 0,

(4.4)

Proof. We proceed as in [CH94] Theorem 4.1. We are minimising the convex functional J over Ut, so by [ET99] Proposition 2.2.1 a necessary and sufficient condition for optimality of (^, u^) is that

J(^, u^), ( - ^, u - u^)  0 for each (, u)  Ut.

Due to Lemma 4.4 we know that L,u is a martingale starting in zero for each (, u)  Ut. In particular from equation (4.3) we have that E[Y ,u(T ) - Y ^,u^(T )] = 0. The definition of Y ,u

together with the terminal condition (4.1) for the adjoint equation allows us to write this as

[(

)[ ]

0 =E f  X^3(T ) - (T, Z(T )) X3(T ) - X^3(T )

F. Naujokat/Curve Following with Singular Control

17

T (

)[ ]

+ h X^3(r) - (r, Z(r)) X3(r) - X^3(r) dr

t 

+ [P3(r) + 1P1(r)] d(1(r) - ^1(r)) + [-P3(r) + 2P2(r)] d(2(r) - ^2(r))

[t,T ] [

]

+ X1(r-) - X^1(r-) d^1(r) +

[t,T ]
[] X2(r-) - X^2(r-) d^2(r)

[t,T ]
T

[t,T ]

T

]

+ 1 [u1(r) - u^1(r)] [P3(r) + R1,3(r)] dr - 2 [u2(r) - u^2(r)] [P3(r) + R2,3(r)] dr .

tt

Combining this with the explicit formula for the G^ateaux derivative given in Proposition 4.3 yields

J(^, u^), ( - ^, u - u^)

[ 

=E + +

 [t,T ] [t,T ]
[t,T ]

1 2

[1(r)

[

X^1(r-) +

[ X^2(r-) +

- ^1(r)]

1 2

^1

(r)

2 2

^2

(r)

d^1(r) + - P3(r) - + P3(r) -

[t,T ]

2 2

[2(r)

-

^2(r)]

]

1P1(r) d (1(r) - ^1(r))

] 2P2(r) d (2(r) - ^2(r))

d^2(r)

T T

]

- 1 [u1(r) - u^1(r)] [P3(r) + R1,3(r)] dr + 2 [u2(r) - u^2(r)] [P3(r) + R2,3(r)] dr .

tt

Note that for i = 1, 2 we have, using the notation from equation (2.2),

[ E
[

 [t,T ]

i 2

[i(r)

-

^i(r)]

d^i(r)

+


[t,T ]

[ X^i(r-)

+

i 2

] ^i(r) d(i(r)

-

] ^i(r))

=E X^i(r-)d(i(r) - ^i(r))

[t,T ]
+ i 2



] [i(r) - ^i(r)] ^i(r) + ^i(r) [i(r) - ^i(r)]

[

r[t,T ]
[

]

]

=E X^i(r-) + i^i(r) d(i(r) - ^i(r))

[ [t,T ]

]

=E X^i(r)d(i(r) - ^i(r)) .

[t,T ]

Combining the above two displays leads to

[ J(^, u^), ( - ^, u - u^) = E

[] X^1(r) - 1P1(r) - P3(r) d (1(r) - ^1(r))

[t,T ] [

]

+ X^2(r) - 2P2(r) + P3(r) d (2(r) - ^2(r))

[t,T ]
T

-1 [u1(r) - u^1(r)] [P3(r) + R1,3(r)] dr

t T ]

+2 [u2(r) - u^2(r)] [P3(r) + R2,3(r)] dr .

t

F. Naujokat/Curve Following with Singular Control

We conclude that (^, u^) is optimal if and only if for all (, u)  Ut we have

[ EE[
[ EE[


[t,T

]

[ X^1

(r)

-

1P1(r)

-

] P3(r)

d

(1(r)

-

^1

(r))

t[tTTt,T[[uu] [21X((^rr2))(--r)uu^^-21((rr2))P]] [[2RR(r21,,)33+((rr))P++3(rPP)33]((rrd))(]]dd2rr(]]r)-00^.,2(r))

] ]

 

0, 0,

18

5. Buy, Sell and No-Trade Regions

In the preceding section we derived a characterisation of optimality in terms of all admissible

controls. This condition is not always easy to verify. Therefore, we derive a further characterisa-

tion in the present section, this time in terms of buy, sell and no-trade regions. As a byproduct,

this result shows that spread crossing is optimal if and only if the spread is smaller than some

threshold.

We start with the main result of this section, which provides a necessary and sufficient con-

dition of optimality in terms of the trajectory of the controlled system

( s,

X^

(s),

P

) (s) s[t,T

]

.

The proof builds on arguments from [CH94] Theorem 4.2 and extends them to the present framework where we have jumps and state-dependent singular cost terms.

Theorem 5.1. A control (^, u^)  Ut is optimal if and only if it satisfies

(

)

P X^1(s) - 1P1(s) - P3(s)  0 s  [t, T ] = 1,

()

P X^2(s) - 2P2(s) + P3(s)  0 s  [t, T ] = 1,

(5.1)

as well as

( P
( P


[t,T ]

[t,T ]

1{X^1(r)-1P1(r)-P3(r)>0}d^1(r) 1{X^2(r)-2P2(r)+P3(r)>0}d^2(r)

= =

)
0 )
0

= 1, = 1,

and ds × dP a.e. on [t, T ] ×  { R1,3 + P3  0 and (R1,3 + P3) u^1 = 0,
R2,3 + P3  0 and (R2,3 + P3) u^2 = 0.

Proof. First, let (^, u^) be optimal and define the stopping time {}
() inf s  [t, T ] : X^1(s) - 1P1(s) - P3(s) < 0 ,

(5.2) (5.3)

with the convention inf  . Consider the control defined by u = u^, 2 = ^2 and

1(s, ) ^1(s, ) + 1[(),T ](s).

Then 1 is equal to ^1 except for an additional jump of size one at time . It also is c`adl`ag and

increasing on [t, T ]. An application of Theorem 4.5 yields

[ 0 E

[ ]] X^1(r) - 1P1(r) - P3(r) d (1(r) - ^1(r))

[t,T ]

F. Naujokat/Curve Following with Singular Control
[( ) ] =E X^1() - 1P1() - P3() 1{T }  0,

19

which implies that P ( = ) = 1. This proves the first line of (5.1), the second line follows by

similar arguments. Now consider the control defined by u = u^, 2 = ^2 and { 1(t-) = 0,

d1(s, )

1{X^1(s,)-1P1(s,)-P3(s,)0}d^1(s, ).

Then 1 is c`adla`g and increasing on [t, T ], since ^1 is. Due to Theorem 4.5 we have

[ [

]]

0 E

X^1(r) - 1P1(r) - P3(r) d (1(r) - ^1(r))

[ [t,T ] [

]

]

=E X^1(r) - 1P1(r) - P3(r) 1{X^1(r)-1P1(r)-P3(r)>0}d (-^1(r))  0,
[t,T ]

and in particular

[ ]

0=E

1{X^1(r)-1P1(r)-P3(r)>0}d^1(r) ,

[t,T ]

which proves the first part of (5.2), the second part follows by similar arguments. It remains to

prove (5.3). Again by Theorem 4.5 we have for every control (, u)  Ut

[ T

]

0E

(u1(r) - u^1(r))(R1,3(r) + P3(r))dr .

t

Choosing the control (^, u) with u2 = u^2 and

u1(r, ) = u^1(r, ) + 1{R1,3(r-,)+P3(r-,)>0}

we first note that u1 is predictable and we get

[ T

]

0E

1{R1,3(r)+P3(r)>0}(R1,3(r) + P3(r))dr  0,

t

which shows that R1,3 + P3  0 ds × dP a.e. Recall that we also have u^1  0 by definition. We

now want to show at least one of the processes R1,3 + P3 and u^1 is zero. To this end, consider

the

control

(^, u)

whose

passive

orders

are

defined

by

u1

=

1 2

u^1

and

u2

=

u^2.

We

then

get

0

E

[
t

T

(u1(r)

-

u^1(r))(R1,3(r)

+

] P3(r))dr

=

E

[
t

T

-

1 2 u^1(r)(R1,3(r)

+

] P3(r))dr



0,

and it follows that ds × dP a.e. we have u1(R1,3 + P3) = 0. The argument for the second line in

(5.2) is similar. This proves the "only if" part of the assertion.

In order to prove the "if" part, let conditions (5.1), (5.2) and (5.3) be satisfied. We then have

for each (, u)  Ut

[ [

]]

E X^1(r) - 1P1(r) - P3(r) d (1(r) - ^1(r))

[ [t,T ] [

]]

=E X^1(r) - 1P1(r) - P3(r) d1(r)

[[t,T ] [

]

]

+E

X^1(r) - 1P1(r) - P3(r) 1{X^1(r)-1P1(r)-P3(r)>0}d (-^1(r))

[ [t,T ] [

]

]

+E

X^1(r) - 1P1(r) - P3(r) 1{X^1(r)-1P1(r)-P3(r)0}d (-^1(r)) .

[t,T ]

(5.4) (5.5) (5.6)

F. Naujokat/Curve Following with Singular Control

20

The integrand of (5.4) is nonnegative due to condition (5.1), so (5.4) is nonnegative. The term

(5.5) is zero due to condition (5.2). The term (5.6) has a nonpositive integrand and a decreasing

integrator and is therefore also nonnegative. In conclusion, we have

[ [

]]

E X^1(r) - 1P1(r) - P3(r) d (1(r) - ^1(r))  0,

[t,T ]

and by a similar argument

[ [

]]

E X^2(r) - 2P2(r) + P3(r) d (2(r) - ^2(r))  0.

[t,T ]

Still for arbitrary (, u)  Ut we have using (5.3) and u1  0

[ T

] [ T

]

E [u1(r) - u^1(r)] [R1,3(r) + P3(r)] dr = E u1(r) [R1,3(r) + P3(r)] dr  0.
tt

By a similar argument

[ T

]

E [u2(r) - u^2(r)] [R2,3(r) - P3(r)] dr  0.

t

An application of Theorem 4.5 now shows that (^, u^) is indeed optimal.
The preceding theorem gives an optimality condition in terms of the controlled system (P, X^ ). We now show how Theorem 5.1 can be used to describe the optimal market order quite explicitly in terms of buy, sell and no-trade regions.

Definition 5.2. We define the buy, sell and no-trade regions (with respect to market orders)

by

Rbuy Rsell Rnt

{ (s,

x,

p)



[t,

T

]

×

R3

×

R3

|

x1

-

1p1

-

p3

<

} 0

,

{ (s,

x,

p)



[t,

T

]

×

R3

×

R3

|

x2

-

2p2

+

p3

<

} 0

,

{ (s, x, p)



[t,

T]

×

R3

×

R3

|

x1

-

1p1

-

p3

>

0

and

x2

-

2p2

+

p3

>

} 0

.

Moreover, we define the boundaries of the buy and sell regions by

Rbuy Rsell

{ (s,
{ (s,

x, x,

p) p)

 

[t, [t,

T T

] ]

× ×

R3 R3

× ×

R3 R3

| |

x1 x2

- -

1p1 2p2

- +

p3 p3

= =

} 0 } 0

, .

Let us emphasise that each of the three regions defined above is open. We remark that the

time variable s statements like

"itshientcrluadjeecdtoirnytooftthheedperfioncietsison(so, fX^t(hse),bPu(ys,))seullndaenrdthneo-otrpatdime arlegcoionntsrosluicshintshidaet

the no-trade region" make sense. Specifically, we now show that the optimal control remains

inside the closure of the no-trade region at all times, i.e. it is either inside the no-trade region or

on the boundary of the buy or sell region. Moreover, as long as the controlled system is inside

the no-trade region, market orders are not used, i.e. ^i does not increase for i = 1, 2.

Proposition 5.3.

(i)

If

( s,

X^ (s),

P

) (s)

is

in

the

no-trade

region,

it

is

optimal

not

to

use

market orders, i.e. for i = 1, 2

[ ]

E 1{(r,X^ (r),P (r))Rnt}d^i(r) = 0.
[t,T ]

(ii) The optimal trajectory remains a.s. inside the closure of the no-trade region,

P

(( s,

X^ (s),

P

) (s)



Rnt

s



[t,

T

) ]

=

1.

In particular, it spends no time inside the buy and sell regions.

F. Naujokat/Curve Following with Singular Control

21

Proof. Item (1) is a direct consequence of (5.2), while (2) follows from (5.1).

Example 5.4. The particular case of portfolio liquidation is solved in Section 8. In this case, the

optimal strategy is composed of discrete Specifically, these are chosen such that

sell the

oprrdoecersssa(t st,imX^e(ss)t,

= 0, T) P (s)

and a trading rate in (0, T ). remains on the boundary of

the sell region until the passive order is executed and all remaining shares are sold.

The above proposition shows that the controlled system remains inside the closure of the no-trade region and market orders are not used inside the no-trade region. This suggests that markets orders are only used on the boundary, and we shall now make this more precise. To this end, we first note that for i = 1, 2 the nondecrasing process ^i induces a measure on [t, T ] ×  by the following map

[t, s] × A  E 1Ad^i(r).
[t,s]

Proposition 5.5.

(i) We have

(

)

P ^1(s) =

1{(r,X^ (r),P (r))Rbuy}d^1(r) s  [t, T ] = 1.

[t,s]

In particular, the support of the measure induced by ^1 is a subset of () r, X^ (r), P (r)  Rbuy,

i.e. market buy orders are only used if the controlled system is on the boundary of the buy

region.

(ii) Similarly, we have

(

)

P ^2(s) =

1{(r,X^ (r),P (r))Rsell}d^2(r) s  [t, T ] = 1.

[t,s]

In particular, the support of the measure induced by ^2 is a subset of () r, X^ (r), P (r)  Rsell,

i.e. market sell orders are only used if the controlled system is on the boundary of the sell region.

Proof. We only show the first assertion. For s  [t, T ] we have using ^1(t-) = 0 

^1(s) = d^1(r)



[t,s]
[

]

= 1{X^1(r)-1P1(r)-P3(r)<0} + 1{X^1(r)-1P1(r)-P3(r)>0} + 1{X^1(r)-1P1(r)-P3(r)=0} d^1(r).

[t,s]

We shall show that terms in the second line vanish a.s. By Proposition 5.3 (2) we have

P

(( r,

X^ (r),

) P (r)

/

Rbuy

r



[t,

) T]

=

1

i.e. the optimal trajectory spends no time in the buy region, so that a.s. for each s  [t, T ]



1{X^1(r)-1P1(r)-P3(r)<0}d^1(r) =
[t,s]

[t,s] 1{(r,X^ (r),P )(r) Rbuy}d^1(r) = 0.

Due to equation (5.2) we have a.s. for each s  [t, T ]



0=

1{X^1(r)-1P1(r)-P3(r)>0}d^1(r) 

1{X^1(r)-1P1(r)-P3(r)>0}d^1(r)  0,

[t,T ]

[t,s]

F. Naujokat/Curve Following with Singular Control

so that a.s. for each s  [t, T ] 
1{X^1(r)-1P1(r)-P3(r)>0}d^1(r) = 0.
[t,s]

This shows that a.s. for each s  [t, T ] we have



^1(s) =

1{X^1(r)-1P1(r)-P3(r)=0}d^1(r) =

1{(r,X^ (r),P (r))Rbuy}d^1(r).

[t,s]

[t,s]

22

In view of the preceding propositions we have now achieved our main goal, namely to show when spread crossing is optimal. Specifically, there is a threshold 1P1 + P3 for the buy spread. If the buy spread is larger than this threshold, i.e. the controlled system is inside the no-trade region, then the costs of market buy orders are large as compared to the penalty for deviating from the target, and no market orders are used. Note that the threshold can be negative, in this case buying is not optimal at all, irrespective of the spread size. Market orders are only used to prevent a downward crossing of the threshold and as a result the buy spread is never smaller than the threshold. In this sense, the trajectory of the controlled system is reflected at the boundary of the no-trade region. This will be made more precise in Subsection 6 where the link to reflected BSDEs is discussed. A similar interpretation holds for the sell spread, where the threshold is given by 2P2 - P3.

6. Link to Reflected BSDEs

In this section we use the results from the preceding section to show that the adjoint process together with the optimal control is the solution to a reflected BSDE, where the obstacle is the spread. The following definition is taken from [ØS10].

Definition 6.1. Let F : [t, T ] × R ×   R be a measurable function, L : [t, T ] ×   R be an adapted c`adl`ag process and G  L2. We say that (P~, Q~, R~, K) is a solution to the reflected

BSDE with driver F , reflecting barrier L and terminal condition G on the time interval [t, T ] if

the following holds: (i) P~ is adapted, Q~ and R~

R~1 R~2 are predictable and they satisfy
R~3

P~ : [t, T ] ×   R, Q~ : [t, T ] ×   Rd, R~1 : [t, T ] ×   R, R~2 : [t, T ] ×   R, R~3 : [t, T ] × Rk ×   R.

(ii) K is nondecreasing and c`adl`ag with K(t-) = 0.

(iii) For all s  [t, T ] we have

s s s



P~(s) - P~(t-) = F (r, P~(r))dr + Q~(r)dW (r) + R~(r, )N~ (d, dr) - dK(r),

t tt

[t,s]

P~(T ) =G.

(iv) (v)

We We

have have

a.s. a.s.

ftohratall[ts,T]([P~t,(Tr)]

that P~(s)  L(s). - L(r))dK(r) = 0.

The interpretation is as follows: By item (iv), the process P~ is never below the barrier L. Item (v) means that the process K increases only if P~ is at the barrier and is flat otherwise. Let

us now define the following linear combinations of the adjoint processes:

(P¯1) P¯2

()

-1P1 - P3 -2P2 + P3

,

(Q¯1) Q¯2

()

-1Q1 - Q3 -2Q2 + Q3

,

F. Naujokat/Curve Following with Singular Control

R¯1,1 R¯1,2 R¯2,1 R¯2,2
R¯3,1 R¯3,2

 -1R1,1 - R1,3
-1R2,1 - R2,3 -1R3,1 - R3,3

 - 2R1,2 + R1,3 - 2R2,2 + R2,3 . - 2R3,2 + R3,3

23

Proposition 6.2. The process



R¯1,1



P¯1, Q¯1, R¯2,1 , 1^1

R¯3,1

is a solution to the reflected BSDE with driver

-11P1(r) - h(X^3(r) - (r, Z(r))),

reflecting barrier -X^1 and terminal condition f (X^3(T ) - (T, Z(T ))). Similarly, the process



R¯1,2



P¯2, Q¯2, R¯2,2 , 2^2

R¯3,2

is a solution to the reflected BSDE with driver

-22P2(r) + h(X^3(r) - (r, Z(r))),

reflecting barrier -X^2 and terminal condition -f (X^3(T ) - (T, Z(T ))).
Proof. We only check the first assertion. The first two items of Definition 6.1 are clear. Item (iii) follows from the dynamics of the adjoint process by direct computation. Specifically, we have for s  [t, T ]

P¯1(s)

-

P¯1(t-)

=

- 

1(P1(s)
s

-

P1(t-)) (

-

(P3(s)

-

P3(t-)) )

= -11P1(r) - h X^3(r) - (r, Z(r)) dr

t s

+ -1Q1(r) - Q3(r)dW (r)

t s  s + -1R1,1(r) - R1,3(r)N~1(dr) + -1R2,1(r) - R2,3(r)N~2(dr)

t s 

t

+ -1R3,1(r, ) - R3,3(r, )M~ (dr, d) -

d(1^1(r)),

t Rk

(

) [t,s]

P¯1(T ) = - 1P1(T ) - P3(T ) = h X^3(T ) - (T, Z(T )) .

Item (4) follows from equation (5.1) in Theorem 5.1. In order to verify item (v) we apply

Proposition 5.5 to get



(P¯1(r) + X^1(r))d(1^1(r)) [t,T ]

(6.1)

=1

(-1P1(r) - P3(r) + X^1(r))1{X^1(r)-1P1(r)-P3(r)=0}d^1(r) = 0.

[t,T ]

The second assertion follows from similar arguments.

As our main focus is on a solution to the curve following problem and not on reflected BSDEs, we shall not pursue this further and instead refer the interested reader to [ØS10], [EKKP+97]
as well as [CM01].

F. Naujokat/Curve Following with Singular Control

24

7. Adverse Selection

In our model, a liquidity event which executes the passive order may simultaneously shift the benchmark price, e.g. when another agent consumes liquidity in the dark pool and the primary venue. Typically, the benchmark price jumps into a favourable direction and the passive order is executed at a price which is worse than the new price. In other words, the investor's passive order is filled exactly when he does not want it to be executed. On average, he loses money and passive orders become less attractive. This effect is sometimes called "adverse selection", see for instance [Kra11] for a detailed analysis in the framework of portfolio liquidation. In the present section, we shall include adverse selection into our model for curve following and discuss how our main results change.
Suppose that every time the passive buy (resp. sell) order is executed, the benchmark prices jumps down (resp. up). We model its downward (upward) jump by a compound Poisson process M1 (resp. M2) whose jump times agree3 with the jump times of the Poisson process N1 (resp. N2). We denote the compensated Poisson martingale by
M~ i([0, s] × A) Mi([0, s] × A) - imi(A)s,

for i = 1, 2. We denote the benchmark price in the absence of adverse selection by D, a squareintegrable martingale on [0, T ]. With adverse selection, the benchmark price is now given by

D¯ (s) D(s) - M~1(s) + M~2(s).

The process D¯ is then also a martingale which jumps down (resp. up) if our passive buy (resp.

sell) order is executed. The crucial observation is that the passive buy order is executed before

the jump of M1, and thus the passive buy orders incur the following costs,

[

]

E u1(1,i)D¯ (1,i-) ,

i1

where 1,i denotes the i-th jump of M1 for i  N. We note that D¯ (1,i) = D¯ (1,i-) - M1(1,i), so the above equals

[ E



u1(1,i)[D¯ (1,i)

]] + M1(1,i)

=

[ E

T

u1(r)[D¯ (r)

]] +  M1(d, dr) .

i1 0

It follows that adverse selection leads to an additional loss (relative to the benchmark price D¯ )

of size

[ T

]

E u1(r)M1(d, dr) .

0

By

[NW11]

Lemma

A.3,

the

process

·
t

u1(r)M~ 1(d, dr)

is

a

martingale,

so

the

expected

loss

can be written as

[ T

] [ T  

] [ T

]

E u1(r)M1(d, dr) = 1E

u1(r)m1(d)dr = E

1u1(r)dr .

0

00

0

Here we define the constant 1

1


0

m1(d),

representing

the

average

jump

size

of

M1

(i.e.

the expected downward price movement). Similarly, passive sell orders incur the following costs,

[ T

]

E 2u2(r)dr ,

0

where 2

2


0

m2(d)

represents

the

expected

upward

price

move.

Hence,

adverse

selection

leads to an additional linear penalisation of passive orders, just as in [Kra11]. We note that

3In other words, Mi is constructed from Ni by replacing the jumps of size one by a stochastic jump size  > 0 whose distribution is given by mi(), for i = 1, 2.

F. Naujokat/Curve Following with Singular Control

25

therein the performance functional in continuous time is not derived from first principles, but taken as the continuous-time analog of the discrete-time case.
The performance functional for curve following defined in (2.1) now reads as

J(t, x, z, , u)

[ Et,x,z


[t,T ]

[ X1(r-)

+

1 2

] 1(r)

d1(r)

+


[t,T ]

[ X2(r-)

+

2 2

] 2(r)

d2(r)

 T[ (

)

](

)]

+ h X3(r) - (r, Z(r)) +1u1(r) + 2u2(r) dr + f X3(T ) - (T, Z(T )) .

t

The methods developped in the preceding sections are flexible enough to cover this situation and we now discuss how our main results change. The adjoint equation (4.1) remains the same. The a priori estimates from Lemma 3.5 as well as the proof of existence and uniqueness of an optimal control (Theorem 3.6) also hold in this slightly more general setting. An argument as in the proof of Lemma 4.3 shows that the G^ateaux derivative is now given by

J(¯, u¯), (, u)

[ [ =E X1,u(r-) -
 [t,T ][ + X2,u(r-) -
[t,T ] [ + X1¯,u¯(r-)
[t,T ]

e-1(r-t)x1

+

1 2

] 1(r)

d¯1(r)

e-2(r-t)x2

+

2 2

] 2(r)

d¯2(r)

+

1 2

¯1

] (r)

d1

(r)

+


[t,T ]

[ X2¯,u¯

(r-)

+

2 2

] ¯2(r) d2(r)

 +

T

[ 1u1(r)

+

2

u2(r)+X3,u(r)h

(X3¯,u¯

(r)

-

(r,

Z

)] (r)) dr

+

t
X3,u(T

)f



(X3¯,u¯ (T

)

-

(T

,

Z

(T

) ))

] .

The proof of Theorem 4.5 carries over to the case with adverse selection and and we get the following characterisation of optimality.

Theorem 7.1. Under adverse selection, a control (^, u^)  Ut is optimal if and only if for each

(, u)  Ut we have

[ EE[
[ EE[


[t,T

]

[ X^1(r)

-

1P1

(r)

-

P3

] (r)

d

(1(r)

-

^1(r))


[t,T

]

[ X^2(r)

-

2P2

(r)

T
t

[u1(r)

-

u^1(r)] [R1,3

T
t

[u2(r)

-

u^2(r)] [R2,3

] + P3(r) d (2(r) - ^2(r))
]
(r) + P3(r)-1] dr  0, ]
(r) + P3(r)+2] dr  0.

] ]

 

0, 0,

We see that introducing adverse selection does not change the structure of our main results,
but we get additional linear terms involving i, the expected adverse price movement, for i = 1, 2. These terms only affect the optimal passive order ui, but not the optimal market order i. The optimality condition from Theorem 5.1 can now be stated in the following way,

Theorem 7.2. Under adverse selection, a control (^, u^)  Ut is optimal if and only if it satisfies

(

)

P X^1(s) - 1P1(s) - P3(s)  0 s  [t, T ]

()

P X^2(s) - 2P2(s) + P3(s)  0 s  [t, T ]

= 1, = 1,

F. Naujokat/Curve Following with Singular Control

26

as well as

( P
( P


[t,T ]

[t,T ]

1{X^1(r)-1P1(r)-P3(r)>0}d^1(r) 1{X^2(r)-2P2(r)+P3(r)>0}d^2(r)

= =

)
0 )
0

= 1, = 1,

and ds × dP a.e. on [t, T ] ×  { R1,3 + P3-1  0 and (R1,3 + P3-1) u^1 = 0, R2,3 + P3+2  0 and (R2,3 + P3+2) u^2 = 0.
Again, we get a correction term for the passive order which depends on the expected adverse price jump i. We now proceed to the example section and use our main results to solve the portfolio liquidation problem (without adverse selection) explicitly.

8. Application: Portfolio Liquidation with Singular Control and Passive Orders

In this example section we shall apply the general results on curve following to the portfolio liquidation problem, where an investor wants to unwind a large position of stock shares in a short period of time, with as little adverse price impact as possible. Models and solutions have been proposed among others by [AC01] and [SS08]. Our framework is inspired by [OW05], the new feature here are the passive orders.
The investor starts with stock holdings X3(0-) = x3 > 0 and wants to sell them such that

X3(T ) = 0.

(8.1)

The constraint (8.1) ensures that the portfolio is liquidated by maturity. Thus we do not need to penalise deviation and may choose h = f =  = 0. Heuristically, it should be optimal to use only market sell and no buy orders, however we allow for both types of orders and then prove that buying is not optimal. The portfolio liquidation problem with passive orders is

Problem 8.1. Minimise

J(, u)

[ E


[0,T ]

[ X1(r-)

+

1 2

] 1(r)

d1(r)

+


[0,T ]

[ X2(r-)

+

2 2

] 2(r)

] d2(r)

over controls (, u)  U0 such that X^3(T ) = 0 .

We introduce a sequence of auxiliary control problems without constraints, but with a penalty for stock holdings at maturity. For n  N we define

Problem 8.2. Minimise J n(, u)

[
E  [0,T ]
+
[0,T ]

[ X1(r-)
[ X2(r-)

+ +

1 2

] 1(r)

d1(r)

2 2

] 2(r)

d2(r)

+

nX3

(T

)2

]

over controls (, u)  U0.
We first solve the auxiliary control problem.
Proposition 8.3. The solution to Problem 8.2 is given ds × dP a.e. on [0, T ] ×  by a passive sell order of size

u^n2 (s) = X^3(s-),

F. Naujokat/Curve Following with Singular Control

27

Stock Holdings
1.0

Trading Rate
1.0

0.8 0.8

0.6 0.6

0.4 0.4

0.2 0.2

0.5 1.0 1.5 2.0

0.5 1.0 1.5 2.0

Fig 2. Stock holdings and trading rate with (red, 2 = 1) and without (black, 2 = 0) passive orders. If there are no passive orders, there are equally sized initial and terminal discrete trades and a constant trading rate in between. If passive orders are allowed, the initial trade is smaller and the trading rate is increasing in time. If the passive order is executed, the stock holdings jump to zero. The parameters in this simulation are T = 2, x3 = 1, 2 = 1 and 2 = 0.01.

an initial discrete market sell order of size

^2n(0)

=

2ne2T (2

+

2)2

+

2n22 e2T 22(2

+ 22)

-

2n22 x3,

a terminal discrete market sell order of size

^2n(T )

=

2

+ 2

2

e2T

^2n(0)1{T

<2 }

and the following rate of market sell orders in (0, T ),

d^2n(s) = (2 + 2)e2s^2n(0)1{s<2}ds,
where 2 denotes the first jump time of the Poisson process N2. Market and passive buy orders are not used, i.e. a.s. ^1n(s) = 0 for each s  [0, T ] and u^1n = 0 ds × dP a.e. on [0, T ] × .
Proof. The proof proceeds as follows: Taking the candidate optimal control (^n, u^n) as given, we first compute the associated state process and then the adjoint equation. This provides a solution to the forward backward system and it then only remains to check the optimality conditions from Theorem 5.1.
The state trajectory associated to the control (^n, u^n) is given on [0, T ] by

X^1(s) = x1e-1s,

2e2s^2n(0),

if s  2 and s < T,

X^2(s)

=

X^222((22

)e-2(s-2), + 22)e2T ^2n

(0),

if 2 < s, if s = T < 2,

x3

-

2 +2 2

(e2

s

-

1)^2n(0),

if s < 2 and s < T,

X^3(s)

=

1
02,n

2 2

(2

+

22)e2T

^2n(0),

if s = T < 2, if s  2.

(8.2)

Note that the stock holdings X^3 are strictly positive on [0, 2) and jump to zero at 2, i.e. if N2

jumps and the passive order is executed. At this instant, the investor stops trading. Afterwards,

the sell spread X^2 recovers exponentially due to resilience. We will now use the representation

(4.2) to construct the adjoint process. First note that ^1n  0 implies P1 = 0 ds × dP a.e. We

now compute P3. For s  [0, T ] we have using (4.2)

P3(s)

=

-

Es,x[2nX^3(T

] ).

F. Naujokat/Curve Following with Singular Control

28

We know from (8.2) that X^3 = 0 on the stochastic interval [2, T ], so that

P3(s)1{s2} = 0.

We also have P3(T ) = -2nX^3(T ). It remains to consider s  [0, 2  T ) and for such s we

compute using the exponential density of 2 []

P3(s) = - Es,x 2nX^3(T )

[]

= =

- -

Es,x

2n

1 2n

2 2

(2

2 2

(2

+

22)e2T

+ 22)e2T ^2n(0)1{T <2}



^2n(0)

2e-2(z-s)dz

T

=

-

2 2

(2

+

22)e2T

^2n(0)e-2(T -s)

=

-

2 2

(2

+

22)e2s^2n(0).

We now turn to P2. A calculation based on the known form of ^2n, the representation (4.2) and

the density of 2 shows that

[

]

P2(s) =Es,x -

e-2(r-s)d^2n(r)

(s,T ]

T z

=-

2e-2(z-s)

e2se(2-2)r(2 + 2)^2n(0)drdz

s 

{s T

- 2e-2(z-s)

e2se(2-2)r(2 + 2)^2n(0)dr

Ts

}

+

e2 s e(2 -2 )T

1 2

(2

+

2)^2n(0)

dz

=

-

2 + 2

2

e2s^2n(0).

To sum up, the adjoint process is given explicitly as

P1(s)

=

0, {

P2(s) =

-

2 +2 2

e2

s

^2n

(0),

0,

if s < 2 and s < T, else,



-

2 2

(2

+

22)e2s^2n(0),

if s < 2 and s < T,

P3(s) = -0,2nX^3(T ),

if s = T < 2 else.

In particular, Pi is zero on the stochastic interval [2, T ] for i = 2, 3.

Having constructed a solution to the forward backward system, we will now use Theorem

5.1 to show that the control (u^n, ^n) is indeed optimal. Using the known form of X^i and Pi for

i = 1, 2, 3, we check the optimality conditions and compute that a.s.

 X^1(s) - P3(s) - 1P1(s) = -P3(s)  0, s  [0, T ]

XX^^22((ss))

+ +

P3(s) P3(s)

- -

2P2(s) 2P2(s)

=

X^2(s)

= 0, s  [0, 2  T ],  0, s  (2  T, T ],

so that condition (5.1) is satisfied. In order to check (5.2), we first note that ^1n(r) = 0 for each r  [0, T ] a.s. so that
( )
P 1{X^1(r)-1P1(r)-P3(r)>0}d^1n(r) = 0 = 1.
[0,T ]

F. Naujokat/Curve Following with Singular Control

29

In addition, we have X^2 - 2P2 + P3 = 0 on [0, 2  T ] and ^2n is constant on [2  T, T ] so that 

1{X^2(r)-2P2(r)+P3(r)>0}d^2n(r) [0,T ]



= [0,2T ] 1{X^2(r)-2P2(r)+P3(r)>0}d^2n(r) + (2T,T ] 1{X^2(r)-2P2(r)+P3(r)>0}d^2n(r) = 0.

Finally, let us check condition (5.3). A consequence of P1 = 0 is that R1,3 = 0 ds × dP a.e. and we have

R1,3(s) + P3(s-) = P3(s-)  0 and u^1(s) = 0.
If the Poisson process N2 jumps, then P3 jumps to zero, so we have ds × dP a.e. on [0, T ] × 
R2,3(s) + P3(s-) = 0.
An application of Theorem 5.1 now yields that (u^n, ^n) is optimal. We now proceed to the portfolio liquidation problem with passive orders and terminal con-
straint. Proposition 8.4. The solution to Problem 8.1 is given ds × dP a.e. on [0, T ] ×  by a passive sell order of size
u^2(s) = X^3(s-),

an initial discrete market sell order of size

^2(0)

=

22 e2T (2 + 2)2

-

22 x3,

a terminal discrete market sell order of size

^2(T )

=

2

+ 2

2

e2T

^2(0)1{T

<2 }

=

2(2 e2T (2

+ +

2)e2T 2)2 - 22

x3

1{T

<2

}

,

and the following rate of market sell orders in (0, T ),

d^2(s)

=

(2

+ 2)e2s^2(0)1{s<2}ds

=

22(2 + 2) e2T (2 + 2)2 -

22

e2sx31{s<2}ds,

where 2 denotes the first jump time of the Poisson process N2. Market and passive buy orders are not used, i.e. a.s. ^1(s) = 0 for each s  [0, T ] and u^1 = 0 ds × dP a.e. on [0, T ] × .

Proof. We rewrite the performance functional in the following way:

J

(,

u)

[ [ =E X1(r-)
 [0,T ][ + X2(r-)
[0,T ]

+ +

1 2

] 1(r)

d1(r)

2 2

] 2(r)

d2(r)

+

{R\{0}}(X3(T

] )) .

where {R\{0}} is the indicator function in the sense of convex analysis. We then have for each (, u)  U0

Jn(, u)  J(, u).

(8.3)

Moreover, one can check by direct calculation that the strategy (^, u^) satisfies the liquidation constraint (8.1), i.e. we have X^3(T ) = 0 and thus (^, u^) is admissible. Before we prove the
optimality, let us establish some convergence results. We first note that the optimal strategies converge in the sense that limn u^n = u^ ds × dP a.e. and limn ^n(s) = ^(s) for all s  [0, T ]

F. Naujokat/Curve Following with Singular Control

30

a.s. We now show that the associated trading costs also converge. Indeed, using the known form of X3^n,u^n (T ) from (8.2) as well as the known form of ^2n(0) implies that the terminal costs satisfy

lim
n

{nX3^n

,u^n

(T

)2

}

=

lim
n

{[ n

1 2n

2 2

(2

+

22)e2T

]2 } ^2n(0) 1{T <2}

=

lim
n

{[ n

1 2n

2 2

(2

+

22)e2T

2ne2T

(2

+

2)2

+

2n22 e2T 22(2

+

22)

-

2n22

]2 } x3 1{T <2}

=0.

The integrand of the singular cost term defined in Problem 8.2 converges pointwise in the sense

lim
n

{

[ X2^n,u^n (r-)

+

2 2

] ^2n(r)

} d^2n(r)

{}

= lim
n

X2^n,u^n (r-)(2

+

2 )e2 r ^2n (0)1{r<2 } dr

+

2 2

^2n(0)2

+

2 2

^2n(T

)2

=X^2(r-)(2 [
= X2^,u^(r-)

+ +

2 )e2 r ^2 (0)1{r<2 } dr

2 2

^2

] (r)

d^2

(r).

+

2 2

^2

(0)2

+

2 2

^2(T )2

We now apply Fatou's Lemma together with (8.3) to get for each (, u)  U0

J (^,

u^)

[ =E
[0,T
 lim inf
nN

]E[[X^2[(0r,T-] )[X+2^n22,u^n (^r2-(r))+] d^222

] (r)
^2n

] (r)

d^2n(r)

+

nX3^n,u^n (T

] )2

= lim inf Jn(^n, u^n)  lim inf Jn(, u)  J(, u).

nN

nN

This proves that (^, u^) is indeed the solution to Problem 8.1.

We conclude with some remarks on the structure of the optimal control.

Remark 8.5. · It is optimal to offer all outstanding shares as a passive order, and simul-

taneously trade using market orders.

· Let us compare the solutions with and without passive orders. If no passive orders are

allowed, it is shown in [OW05] that the optimal control comprises equally sized initial

and terminal discrete trades and a constant trading rate in between. If passive orders are

allowed, it follows from Proposition 8.4 that the initial discrete trade is small and the

investor starts with a small trading rate, which increases as maturity approaches. The

interpretation is that he is reluctant to use market orders and rather waits for passive

order execution. See Figure 2 for an illustration.

· While [OW05] work in a one sided model and only consider market sell orders, we consider

a larger class of controls and allow for both market buy and sell orders. It is a consequence

of Proposition 8.4 that market buy orders are never used.

· The sell region is in this case

Rsell

=

{ (s,

x,

p)



[0,

T]

×

R3

×

R3

} x2 + p3 - 2p2 < 0 .

The initial discrete trade is chosen such that the controlled system jumps to the boundary of the sell region. Then a rate of market sell orders is chosen such that the state process remains on this boundary until the passive order is executed. · The optimal strategy does not depend on the inverse order book height 2 and is linear in the initial portfolio size x3 = X3(0-).

F. Naujokat/Curve Following with Singular Control

31

· The solution to the portfolio liquidation problem with passive orders given in Proposition 8.4 is similar to the one obtained in [KS09] Proposition 4.2; what they call dark pool can be interpreted as a passive order in our setup. Note however that they work in discrete time in a model without spread and resilience. Our solution is also similar to the one obtained in [NW11] Proposition 7.3, where the portfolio liquidation problem is solved in continuous time using passive and market, but no discrete orders and without resilience.
· The solution given above only holds for initial spread zero. If we start with a larger spread, it might be optimal not to use market orders for a certain period of time and wait for the spread to grow back.
Remark 8.6. As the jump intensity 2 tends to zero, the solution given in Proposition 8.4 for the model with passive orders converges to the solution given [OW05] for the model without passive orders. Specifically we have for s  (0, T )

lim ^2(0)
2 0

=

lim
2 0

22 e2T (2 + 2)2

- 22 x3

=

x3 , 2T + 2

lim ^2(T )
2 0

=

lim
2 0

2 e2T

(2 (2

+ +

2)e2T 2)2 - 22

x3

=

x3 , 2T + 2

lim d^2(s)
2 0

=

lim
2 0

22(2 + 2) e2T (2 + 2)2 -

22

e2sx3ds

=

2x3 ds. 2T + 2

Acknowledgements. The authors thank the Deutsche Bank Quantitative Products Laboratory for financial support as well as Nicholas Westray for helpful discussions. Horst acknowledges financial support through the SFB 649 Economic Risk.

References

[AC01]

R. Almgren and N. Chriss. Optimal execution of portfolio transactions. Journal of

Risk, 3:5­39, 2001.

[AFS10] A. Alfonsi, A. Fruth, and A. Schied. Optimal execution strategies in limit order

books with general shape functions. Quantitative Finance, 10(2):143­157, 2010.

[ATHL05] R. Almgren, C. Thum, E. Hauptmann, and H. Li. Direct estimation of equity

market impact. Risk, 18(7):58­62, 2005.

[BHS95] B. Biais, P. Hillion, and C. Spatt. An empirical analysis of the limit order book

and the order flow in the Paris bourse. Journal of Finance, 50(5):1655­1689, 1995.

[BM05] S. Bahlali and B. Mezerdi. A general stochastic maximum principle for singular

control problems. Electronic Journal of Probability, Vol. 10, Paper 30:988­1004,

2005.

[BSW80] V. E. Benes, L. A. Shepp, and H. S. Witsenhausen. Some solvable stochastic control

problems. Stochastics, 4:39­83, 1980.

[CH94] A. Cadenillas and U. G. Haussmann. The stochastic maximum principle for a

singular control problem. Stochastics and Stochastics Reports, 49:211­237, 1994.

[CM01] J. Cvitanic and J. Ma. Reflected forward-backward SDEs and obstacle problems

with boundary condition. Journal of Applied Mathematics and Stochastic Analysis,

14(2):113­138, 2001.

[DN90] M. Davis and A. Norman. Portfolio selection with transaction costs. Mathematics

of Operations Research, 15:676­713, 1990.

[EKKP+97] N. El Karoui, C. Kapoudjian, E. Pardoux, S. Peng, and M.C. Quenez. Reflected

solutions of backward SDE's, and related obstacle problems for PDE's. The Annals

of Probability, 25(2):702­737, 1997.

[ET99]

I. Ekeland and R. T´emam. Convex analysis and variational problems, volume 28 of

Classics in Applied Mathematics. Society for Industrial and Applied Mathematics

(SIAM), Philadelphia, PA, english edition, 1999.

[Fru11] A. Fruth. Optimal Execution with Stochastic Liquidity. PhD thesis, TU Berlin,

2011.

F. Naujokat/Curve Following with Singular Control

32

[HLM87]
[HLM90]
[Kab99] [KOWZ00] [Kra11] [KS72] [KS09] [Kyl85] [Nau11] [NW11] [ØS01]
[ØS10] [OW05] [PSS10] [SS08]

R. W. Holthausen, R. W. Leftwich, and D. Mayers. The effect of large block transactions on security prices: A cross-sectional analysis. Journal of Financial Economics, 19(2):237­267, 1987. R. W. Holthausen, R. W. Leftwich, and D. Mayers. Large-block transactions, the speed of response, and temporary and permanent stock-price effects. Journal of Financial Economics, 26(1):71­95, 1990. Yu. M. Kabanov. Hedging and liquidation under transaction costs in currency markets. Finance and Stochastics, 3:237­248, 1999. I. Karatzas, D. Ocone, H. Wang, and M. Zervos. Finite-fuel singular control with discretionary stopping. Stochastics and Stochastics Reports, 71:1­50, 2000. P. Kratz. Optimal liquidation in dark pools in discrete and continuous time. PhD thesis, Humboldt-Universit¨at Berlin, 2011. A. Kraus and H. R. Stoll. Price impacts of block trading on the New York Stock Exchange. Journal of Finance, 27(3):569­588, 1972. P. Kratz and T. Sch¨oneborn. Optimal liquidation in dark pools. 2009. preprint. A. S. Kyle. Continuous auctions and insider trading. Econometrica, 53(6):1315­ 1335, 1985. F. Naujokat. Stochastic Control in Limit Order Markets. PhD thesis, HU Berlin, 2011. F. Naujokat and N. Westray. Curve following in illiquid markets. Mathematics and Financial Economics, 4:299­335, 2011. B. Øksendal and A. Sulem. A maximum principle for optimal control of stochastic systems with delay, with applications to finance. In J. M. Menaldi, E. Rofman, and A. Sulem, editors, Optimal Control and Partial Differential Equations, pages 64­79, 2001. B. Øksendal and A. Sulem. Singular stochastic control and optimal stopping with partial information of jump diffusions. preprint, 2010. A. Obizhaeva and J. Wang. Optimal trading strategy and supply/demand dynamics. 2005. working paper. S. Predoiu, G. Shaikhet, and S. Shreve. Optimal execution in a general one-sided limit-order book. preprint, 2010. A. Schied and T. Scho¨neborn. Risk aversion and the dynamics of optimal liquidation strategies in illiquid markets. Finance and Stochastics, 13(2):181­204, 2008.

SFB 649 Discussion Paper Series 2011
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Localising temperature risk" by Wolfgang Karl Härdle, Brenda López Cabrera, Ostap Okhrin and Weining Wang, January 2011.
002 "A Confidence Corridor for Sparse Longitudinal Data Curves" by Shuzhuan Zheng, Lijian Yang and Wolfgang Karl Härdle, January 2011.
003 "Mean Volatility Regressions" by Lu Lin, Feng Li, Lixing Zhu and Wolfgang Karl Härdle, January 2011.
004 "A Confidence Corridor for Expectile Functions" by Esra Akdeniz Duran, Mengmeng Guo and Wolfgang Karl Härdle, January 2011.
005 "Local Quantile Regression" by Wolfgang Karl Härdle, Vladimir Spokoiny and Weining Wang, January 2011.
006 "Sticky Information and Determinacy" by Alexander Meyer-Gohde, January 2011.
007 "Mean-Variance Cointegration and the Expectations Hypothesis" by Till Strohsal and Enzo Weber, February 2011.
008 "Monetary Policy, Trend Inflation and Inflation Persistence" by Fang Yao, February 2011.
009 "Exclusion in the All-Pay Auction: An Experimental Investigation" by Dietmar Fehr and Julia Schmid, February 2011.
010 "Unwillingness to Pay for Privacy: A Field Experiment" by Alastair R. Beresford, Dorothea Kübler and Sören Preibusch, February 2011.
011 "Human Capital Formation on Skill-Specific Labor Markets" by Runli Xie, February 2011.
012 "A strategic mediator who is biased into the same direction as the expert can improve information transmission" by Lydia Mechtenberg and Johannes Münster, March 2011.
013 "Spatial Risk Premium on Weather Derivatives and Hedging Weather Exposure in Electricity" by Wolfgang Karl Härdle and Maria Osipenko, March 2011.
014 "Difference based Ridge and Liu type Estimators in Semiparametric Regression Models" by Esra Akdeniz Duran, Wolfgang Karl Härdle and Maria Osipenko, March 2011.
015 "Short-Term Herding of Institutional Traders: New Evidence from the German Stock Market" by Stephanie Kremer and Dieter Nautz, March 2011.
016 "Oracally Efficient Two-Step Estimation of Generalized Additive Model" by Rong Liu, Lijian Yang and Wolfgang Karl Härdle, March 2011.
017 "The Law of Attraction: Bilateral Search and Horizontal Heterogeneity" by Dirk Hofmann and Salmai Qari, March 2011.
018 "Can crop yield risk be globally diversified?" by Xiaoliang Liu, Wei Xu and Martin Odening, March 2011.
019 "What Drives the Relationship Between Inflation and Price Dispersion? Market Power vs. Price Rigidity" by Sascha Becker, March 2011.
020 "How Computational Statistics Became the Backbone of Modern Data Science" by James E. Gentle, Wolfgang Härdle and Yuichi Mori, May 2011.
021 "Customer Reactions in Out-of-Stock Situations ­ Do promotion-induced phantom positions alleviate the similarity substitution hypothesis?" by Jana Luisa Diels and Nicole Wiebach, May 2011.
SFB 649, Spandauer Str. 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2011
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
022 "Extreme value models in a conditional duration intensity framework" by Rodrigo Herrera and Bernhard Schipp, May 2011.
023 "Forecasting Corporate Distress in the Asian and Pacific Region" by Russ Moro, Wolfgang Härdle, Saeideh Aliakbari and Linda Hoffmann, May 2011.
024 "Identifying the Effect of Temporal Work Flexibility on Parental Time with Children" by Juliane Scheffel, May 2011.
025 "How do Unusual Working Schedules Affect Social Life?" by Juliane Scheffel, May 2011.
026 "Compensation of Unusual Working Schedules" by Juliane Scheffel, May 2011.
027 "Estimation of the characteristics of a Lévy process observed at arbitrary frequency" by Johanna Kappus and Markus Reiß, May 2011.
028 "Asymptotic equivalence and sufficiency for volatility estimation under microstructure noise" by Markus Reiß, May 2011.
029 "Pointwise adaptive estimation for quantile regression" by Markus Reiß, Yves Rozenholc and Charles A. Cuenod, May 2011.
030 "Developing web-based tools for the teaching of statistics: Our Wikis and the German Wikipedia" by Sigbert Klinke, May 2011.
031 "What Explains the German Labor Market Miracle in the Great Recession?" by Michael C. Burda and Jennifer Hunt, June 2011.
032 "The information content of central bank interest rate projections: Evidence from New Zealand" by Gunda-Alexandra Detmers and Dieter Nautz, June 2011.
033 "Asymptotics of Asynchronicity" by Markus Bibinger, June 2011. 034 "An estimator for the quadratic covariation of asynchronously observed
Itô processes with noise: Asymptotic distribution theory" by Markus Bibinger, June 2011. 035 "The economics of TARGET2 balances" by Ulrich Bindseil and Philipp Johann König, June 2011. 036 "An Indicator for National Systems of Innovation - Methodology and Application to 17 Industrialized Countries" by Heike Belitz, Marius Clemens, Christian von Hirschhausen, Jens Schmidt-Ehmcke, Axel Werwatz and Petra Zloczysti, June 2011. 037 "Neurobiology of value integration: When value impacts valuation" by Soyoung Q. Park, Thorsten Kahnt, Jörg Rieskamp and Hauke R. Heekeren, June 2011. 038 "The Neural Basis of Following Advice" by Guido Biele, Jörg Rieskamp, Lea K. Krugel and Hauke R. Heekeren, June 2011. 039 "The Persistence of "Bad" Precedents and the Need for Communication: A Coordination Experiment" by Dietmar Fehr, June 2011. 040 "News-driven Business Cycles in SVARs" by Patrick Bunk, July 2011. 041 "The Basel III framework for liquidity standards and monetary policy implementation" by Ulrich Bindseil and Jeroen Lamoot, July 2011. 042 "Pollution permits, Strategic Trading and Dynamic Technology Adoption" by Santiago Moreno-Bromberg and Luca Taschini, July 2011. 043 "CRRA Utility Maximization under Risk Constraints" by Santiago MorenoBromberg, Traian A. Pirvu and Anthony Réveillac, July 2011.
SFB 649, Spandauer Str. 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2011
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
044 "Predicting Bid-Ask Spreads Using Long Memory Autoregressive Conditional Poisson Models" by Axel Groß-Klußmann and Nikolaus Hautsch, July 2011.
045 "Bayesian Networks and Sex-related Homicides" by Stephan Stahlschmidt, Helmut Tausendteufel and Wolfgang K. Härdle, July 2011.
046 "The Regulation of Interdependent Markets", by Raffaele Fiocco and Carlo Scarpa, July 2011.
047 "Bargaining and Collusion in a Regulatory Model", by Raffaele Fiocco and Mario Gilli, July 2011.
048 "Large Vector Auto Regressions", by Song Song and Peter J. Bickel, August 2011.
049 "Monetary Policy, Determinacy, and the Natural Rate Hypothesis", by Alexander Meyer-Gohde, August 2011.
050 "The impact of context and promotion on consumer responses and preferences in out-of-stock situations", by Nicole Wiebach and Jana L. Diels, August 2011.
051 "A Network Model of Financial System Resilience", by Kartik Anand, Prasanna Gai, Sujit Kapadia, Simon Brennan and Matthew Willison, August 2011.
052 "Rollover risk, network structure and systemic financial crises", by Kartik Anand, Prasanna Gai and Matteo Marsili, August 2011.
053 "When to Cross the Spread: Curve Following with Singular Control" by Felix Naujokat and Ulrich Horst, August 2011.
SFB 649, Spandauer Str. 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

