BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2013-047
Tie the straps: uniform bootstrap confidence bands for bounded influence curve estimators
Wolfgang Karl Härdle* Ya`acov Ritov** Weining Wang*
*Humboldt-Universität zu Berlin, Germany **University of Jerusalem Mount Scopus, Israel
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Tie the straps: uniform bootstrap confidence bands for bounded influence curve estimators 
Wolfgang Karl Ha¨rdle,§ Ya'acov Ritov ¶, Weining Wang
October 28, 2013
Abstract We consider theoretical bootstrap "coupling" techniques for nonparametric robust smoothers and quantile regression, and verify the bootstrap improvement. To cope with curse of dimensionality, a variant of "coupling" bootstrap techniques are developed for additive models with both symmetric error distributions and further extension to the quantile regression framework. Our bootstrap method can be used in many situations like constructing confidence intervals and bands. We demonstrate the bootstrap improvement over the asymptotic band theoretically, and also in simulations and in applications to firm expenditures and the interaction of economic sectors and the stock market.
Keywords: Nonparametric Regression, Bootstrap, Quantile Regression, Confidence Bands, Additive Model, Robust Statistics JEL classification: C00, C14
The financial support from the Deutsche Forschungsgemeinschaft via SFB 649 "O¨ konomisches Risiko", Humboldt-Universita¨t zu Berlin is gratefully acknowledged.
We acknowledge the friendly environment atmosphere of MFO mathematical research institute of Oberwolfach during an Research in pairs stay.
The financial support from ISF is greatly acknowledged. §Professor at Humboldt-Universita¨t zu Berlin, Ladislaus von Bortkiewicz chair of statistics and Director of C.A.S.E. - Center for Applied Statistics and Economics, HumboldtUniversit¨at zu Berlin, Spandauer Straße 1, 10178 Berlin, Germany and School of Business, Singapore Management University, 50 Stamford Road, Singapore 178899. ¶Professor at Department of Statistics Hebrew University of Jerusalem Mount Scopus, Jerusalem 91905, Israel. Hermann Otto Hirschfeld Junior Professor at the Ladislaus von Bortkiewicz chair of statistics and C.A.S.E., Humboldt-Universit¨at zu Berlin, Spandauer Straße 1, 10178 Berlin, Germany. Email:wangwein@cms.hu-berlin.de
1

1 Introduction

Confidence bands are important tools for model specifications. However it is hard to construct precise confidence bands for nonparametric curves as usually a supreme norm is involved in the statistics. Traditional methods based on asymptotic theory have natural drawbacks in their finite sample performance, and this motivates bootstrap methods to attain more precise bands. In this article, we deal with bootstrap bands construction for a general class of nonparametric M - and L- estimates, moreover, we adopt additive models to handle the multivariate covariates case.
Consider Y, X  Rd+1 with variable Y and X  Rd.

l(x) = arg min E Y |X=x(Y - ),

(1)

with (·) as a loss function described in detail in Section 2.1. For the confidence bands construction, one stream of literature using empirical process theory follows the asymptotic results of Bickel and Rosenblatt (1973), which is further extended by Johnston (1982), and has recently been studied by Ha¨rdle and Song (2010) for L-smoothers. However, it has also been shown by H¨ardle, Ritov and Song (2012) that such an asymptotic confidence band has much lower coverage probability in finite sample than what it is supposed to have. The poor performance of such kind of band in finite sample has been well attributed to its slow convergence, see Hall (1991). To address improvement of finite sample performance, there is a class of literature on the bootstrap confidence band, see Claeskens and Van Keilegom (2003), Ha¨rdle and Marron (1991), among others. Figure 1 shows a bootstrap confidence band and an asymptotic band for an M -smoother with (·) being the Tukey's bisquare loss. One sees that the asymptotic band is narrower than the bootstrap one. Moreover, the asymptotic band does not cover the true curve while the bootstrap one does.
The bootstrap is a class of data driven resampling techniques that provide non-asymptotic approximations of finite sample distributions of different statistics. In a location model (more generally a regression model), resampling is done from the estimated residuals and a typical theoretical analysis leads to the conclusion "bootstrap works" in the sense that a suitably centered bootstrap estimator converges to the same asymptotic normal distribution as the original estimator under consideration. A large literature body has focused on showing bootstrap improvements and refinements of approximations via bootstrap resampling, see Hall (1992), Mammen (1992), Horowitz (2001a), H¨ardle, Horowitz and Kreiss (2003), which discuss the conditions for bootstrap consistency, and also prove the bootstrap accuracy as an approximation to the exact finite sample distribution for special types of statistics

2

-2 0 2 4 6 8 10

q q

q q

q

qq

q

qq

q
q q
q

q q

qq q
q q
q

qq q

q

q qq

q

q q

q q q

qq qq q q q

q q

q

q

q

q q

q q

q q

q

qq

q

q

q
q q

q q
q q

qq

q q

q q

q

q q

q

q q
q q qqq
q qq
q

q

q
q qq
q

q q
q

q

0.0 0.2 0.4 0.6 0.8 1.0
q
Figure 1: Plot of true curve (grey), robust estimate with Tukey biweight loss and 5% confidence bands (blue dashed ), local polynomial estimate (black), bootstrap band (red dotted), n = 150.

in a nonparametric framework. But very few articles have focused on nonlinear statistics (e.g. maximum) in nonparametric regression. Ha¨rdle et al. (2012) proposed a bootstrap procedure and showed its improvement properties. This stimulated the current research on finding common properties that loss functions have to share to attain such improvement. Accordingly, we prove a generalized version in the univariate case for the class of loss function with bounded influence. For the high dimensional case, the bootstrap improvement becomes difficult when the dimension d of the regressors gets large. One way to avoid this problem is to impose a structure, such as an additive model, on the multivariate nonparametric function. The additive structure assumes that the covariates' effects are separable, and this effect is presented in many economic applications, H¨ardle (1990). Specifically, we consider the regression function

d
m(x1, . . . , xd) = mj(xj),
j=0

(2)

with m0(x0) a constant. It is well known that (2) solves the dimensionality curse in the sense
that one dimensional convergence rates are achieved for the estimation of m(x1, . . . , xd), but keeps enough flexibility of the marginal influence of the different variables. See Horowitz (2001b), Horowitz and Lee (2005), Horowitz,

3

Klemela¨ and Mammen (2006), and among many others. Horowitz (2001b) focuses on generalized additive models with unknown link functions, Horowitz and Lee (2005) propose a two-stage estimation for quantile regression in additive models, Horowitz et al. (2006) show the equivalence between spline, kernel and other methods in terms of optimal minimax rate in additive model estimation. The resulting estimate m^ j(xj) in (2) though needs to be screened for closeness to mj(xj). This requires construction of confidence intervals and bands (as a function of xj. For such screening tests, our tightened bootstrap techniques will be verified. Namely, the bootstrap based confidence bands are shown to be very close to the true finite sample distribution based ones.
In sum, we investigate a coupling technique that allows us to "tie the straps" even a little tighter for a class of estimators. We mean by that, theoretically speaking, confidence band construction is made more precise in a variety of the estimation problems we consider. The coupling idea is based on mimicking the distribution of the original data via a controllable random mechanism. Similar results like (9) will be derived for additive models.
The remainder of the paper is organized as follows. In Section 2 we explain in details the model setup and the bootstrap method. Section 3 presents the main results. In Section 4 a small simulation study is presented. Finally, we show in Section 5 applications on managerial compensation and impacts on stock markets.

2 Models and bootstrap confidence sets
This section describes the estimator and our coupling techniques, motivates the obtainable theoretical results and discusses some of the assumptions.

2.1 Univariate case

Let us describe the coupled bootstrap in the simple case of nonparametric minimum contrast curve estimation. Here (X, Y )  R2. The object of estimation is identified via:

l(x) = arg min E (Y |X=x)(Y - ),

(3)

where (·) is a loss function of e.g. Hampel/Huber type or more generally (up to a constant) a negative (pseudo) log likelihood. In the quantile regression case, (x) = |x|{ - 1(x  0)} is the check function. Other examples for (·) include the trimmed mean, Huber (1964)

(x) =

x2/2, |x|  k, -k2/2 + k|x|, |x| > k.

(4)

4

or a form of Winsorized mean:

(x) =

x2, k2,

|x|  k, |x| > k

,

(5)

A sample based version of (3) is:

n
^lh(x) = argminn-1 (Yi - )Kh(x - Xi),
i=1

(6)

where Kh(u) = K(u/h)/h is a kernel function with bandwidth h. Now generate a bootstrap sample using an i.i.d. uniform random variables U1, . . . , Un  U (0, 1), and then generate:

Yi = ^lg(Xi) + i, i = 1, . . . , n,

(7)

where i  F^(-|1X=xi)(Ui) (discussed in detail in (24)) and g = O(n-1/9) a slightly larger bandwidth than h. The basic idea of coupling is based on
comparing this sample to the pseudo observations:

Yi = l(Xi) + i, i = 1, . . . , n,

(8)

where i = F(-Y1|X=xi)(Ui). Note that given {Xi}ni=1, the distribution of Yi and Yi are the same. We will show that for a class of loss functions the
following approximation holds:

sup ^lh(x) - l(x) - {^lh,g(x) - ^lg(x)} = Op(h2n),
xB

(9)

where B is a closed compact set in [0, 1], n a slowly increasing sequence (a sequence an is slowly increasing if n-an  0 for any  > 0), ^lh(·) is the nonparametric estimate calculated from {(Xi, Yi )}, ^lh,g(Xi) is an estimate calculated from the bootstrap sample {(Xi, Yi)} with bandwidth h,

n

^ h,g

d=ef

argmin

(Yi - )Kh(x - Xi)

i=1

(10)

and ^lg(Xi) is calculated as in (6) from the original sample with bandwidth g. The basic elements in proving (9) are smoothness of F|X=x(·) and bounded influence of (·) in (3).

5

2.2 Additive models and bootstrap confidence sets

For any x  Rd (d > 1), the nonparametric approach in (6) is not appropriate when d is large, as the standard nonparametric optimal convergence rate, Op(n-4/(4+d)), would be too slow when d is large. Additive models were suggested to remedy the problems posed by the dimensionality. Recall (2),
and impose the additive structure:

d
Yi = mj(xi,j) + i.
j=0

(11)

Further, approximate the additive model via a basis function approach:

Lj +1

mj(xi,j) 

al,j l (xi,j ),

l=1

where the 1(·), 2(·), . . . could be any sequence of functions spanning the L2 space. Our implementation uses B-splines, for example, linear B-splines: Consider a sequence of H-1 equally spaced knots on the interval [0, 1], which define the width H subintervals [lH, (l + 1)H], 0  l  (H-1 - 1). The linear
B-spline basis is:

 H-1x - l + 1  l(x) = l + 1 - H-1x
0

(l - 1)H  x  lH lH  x  (l + 1)H otherwise

Denote the theoretical standardized B spline basis l(·), for the jth variable, j = 1, · · · , d,

l,j(xj) d=ef l(xj) - l-1(xj)cl,j/cl-1,j Bj,l(xj) = l,j(xj)/ l,j(xj) 2,

where l = 0, . . . , H-1, cl,j d=ef l,j(u)fj(u)du with fj(u) is the density for xj, so that E Bj,l(xj) = 0, E Bj,l(xj)2 = 1.
The additive estimate can then be obtained as follows. Define the vectors in (RH-1d+1),

where

A = (a0, a1 , . . . , ad ) (Xi) = {1, g(xi,1) , . . . , g(xi,d) } ,

aj = (a1,j, . . . , aH,j) , g(xi,j) = {1(xi,j), . . . , H (xi,j)} .

6

Finally, let A^ be the estimation of A:

n
A^ = arg min {Yi - A (Xi)}, A i=1

and with j = 1, . . . , d.

m^ j(xi,j) = a^j g(xi,j),

(12) (13)

2.3 Coupled bootstrap for cases of high dimensional covariates

The additive structure in (11) is one solution to the curse of dimensionality, however, the bootstrap approach in (7) does not work for this modeling scenario as nonparametric estimation of F|X(·) would again run into the "curse of dimensionality" problem. We suggest another bootstrap technique (only for bounded influence functions), and prove that it strongly approximates a model with the same asymptotic properties as the original model.
Define

Zi =

1 -1

with prob  with prob 1 - 

,

i = 1, . . . , n.

(14)

This includes the special case for symmetric error distributions with  = 1/2, which is the usual assumption for mean or robust M -smoothers. Moreover, it generally adapts to the case of quantile regression for asymmetric error distributions. The bootstrap couple (,  ), the bootstrap residuals and its associate theoretical couple respectively are:

i d=ef Zi|^i| i d=ef Zii, i = 1, . . . , n,

(15) (16)

where and

i d=ef Fi-,Z1i{Fi,sgn(i)(|i|)}, i = 1, . . . , n, Fi,s(t) d=ef P(|i|  t|si > 0), i = 1, . . . , n, s  {1, -1}.

(17) (18)

Note that the same Zi appears both in (15) and in (16). Recall that FY |X=Xi{l(Xi)} =  and, hence, F|X=Xi(0) =  . Now, it is
easy to see that Vi d=ef Fi,sgn(i)(|i|) have a standard uniform distribution,

7

and if Zi is as above, then i and ZiFi-,Z1i(Vi) have the same distribution. Formally, note that

Fi,+1(t)

=

Fi(t) - 1 

+

 ,

Fi,-1(t)

=

1

-

 - Fi(-t) , 1-

where Fi(·) is the cdf of i. Hence, for t > 0:

P(i < t) =  P[Fi-,+11{Fi,sgn(i)(|i|)} < t] + 1 - 

=  P{Fi,sgn(i)(|i|) < Fi,+1(t)} + 1 - 

=  P{i < 0, Fi,-1(-i) < Fi,+1(t)}

+  P{i > 0, Fi,+1(i) < Fi,+1(t)} + 1 - 

=

 P{i

<

0,

1

-

 - Fi(i) 1-

<

Fi(t)

- 

1+

}

+  P(0 < i < t) + 1 - 

1- =  P[1 -  > Fi(i) >  {1 - Fi(t)}]

+  P(0 < i < t) + 1 - 

=



[1

-

1

- 



{1

-

Fi(t)}

-



]

+

 {Fi(t)

-

1

+



}

+

1

-



= Fi(t).

The case t < 0 is dealt similarly. It follows

L(i) = L(i).

(19)

Our confidence "ideal" interval is conditional on {Vi}in=1 which has a direct link to the absolute value of errors {|i|}in=1. Note however that the estimator is asymptotically consistent and its bias does not depend on these
absolute values. Moreover, by the law of large numbers, the pointwise width
of the conditional confidence interval is within a factor of 1 + Op(1) of the unconditional one.

2.4 How does the coupling work?
The basic idea of our approach is trying to construct an empirically feasible bootstrap sample that is strongly approximating a sample from the true distribution. One example of the coupled bootstrap approach was already explained in (7) and (8). It however relies on estimators of the conditional distribution FY |X=x(·), which become very imprecise when d is large.
8

Another approach proposed in Section 2.3 motivated as the wild bootstrap

is based on randomizing the obtained residuals and using the same random

source to mimic the stochastic of the unobservable errors. To get the basic

idea, let us assume for a moment that the distributions of i are symmetric. Then the coupling may be performed via a Rademacher randomized variables

Zi with

P(Zi = 1) = P(Zi = -1) = 1/2

and generation of the couple i (the bootstrapped residuals), i (the theoretical coupling), where {i , i} is :

i d=ef Zi|^i| i d=ef Zii.

(20)

With this construction, we are able to establish a result similar to (9).
In a non symmetric distribution (required for quantile regression), one defines Zi with P(Zi = 1) =  and P(Zi = -1) = 1 -  assuming the centering FY |Xi{l(Xi)} =  , and the couple (i , i) is given by (15) and (16). It was argued that the distributions of i and i are identical and also the conditional distributions given {Vi}in=1 are the same.
The resampling technique will be applied to nonparametric estimation of
an additive quantile regression model. The reanalysis of the data used by
Horowitz and Lee (2005) provides us with sharper bands that have not been
calculated in that paper.

2.5 Extension to Generalized Linear Models

The model in Section 2 can be extended to generalized linear models, with the relation g{E(Y |X)} = l(X), where g(·) is the known prespecified link

function. For continuous random variable Y , the extension to the above

bootstrap procedure is trivial. Moreover, it can be also generalized to the

models with discrete Yi. For example, for the binary logistic model with Yi

as binary data, define

^i = Yi - g{^lh(Xi)},

(21)

then ^i will be bounded in [-1, 1], and one can apply the same bootstrap procedure as in (20).

3 Main Results
The section gives asymptotic results for the estimators described in Section 2. To establish the asymptotic property, some assumptions are needed:
9

Assumptions

A.1 The solution l(·) of (1) is two-times differentiable and bounded. We abbreviate (Y, ·) to (·), and (·) =  (·) (or subgradient in the quantile regression case) is a.s. bounded by M < . E{()|X} = 0 w.p. 1. Also (·) is Liptchitz continuous except for a finite number of points in the compact set B.

A.2 Assume the support of X is [0, 1]d, the conditional density of  f(|X=·)(·|·), and is bounded by C1 and is twice differentiable in the interior point of [0, 1]d, and bounded away from 0 by c1 > 0.
A.3 The kernel function Kh(·) is a product kernel composed from one dimensional kernels with bandwidth h:

Kh(s) = dj=1K(sj/h)/h, s = (s1, . . . , sd)  Rd.

(22)

A.4 The kernel bandwidth satisfies h  n-1/5. Let g be another bandwidth sequence g >> h, e.g., g = O(n-1/9).
A.5 For each j, the true regression function mj(·), j  1, . . . , d, is at least one time continuous differentiable function on [0, 1].
A.6 E{gl2(Xj)} = 1 for j  1, . . . , d. ||l(Xj)||  C3H, a.s., where l(Xj) d=ef {l2(x1,j), . . . , 2l (xn,j)} , with j  1, . . . , d.

A.7 The number of regressors in (12) is of O(p), where p = dH-1 + 1 with H-1  n1/5, and d = O(n2/3).
A.1 is about the continuity and the bounded influence structure of the loss function, it is quite essential for proving the bootstrap improvement. A.2 assumes W.L.O.G., the covariates are on bounded support and imposes assumption on the conditional density of the error term. A.3 is a standard assumption on the kernel function. A.4 is about theoretical rates of the bandwidths h and g. h is of the standard optimal rate in nonparametric regression, while g is required to be smaller as we need to reduce the bias, see Ha¨rdle and Marron (1991). A.5 - A.7 are assumptions on additive models. A.5 assumes that additive components behave properly. A.6 imposes conditions on the basis functions, and the linear B-spline satisfies A.6.
We show first convergence results for bootstrap methods in (7) and (8) . The resampling step has been defined in (7), where the smooth estimate of the conditional distribution is:
10

n
F(|X=x)(t) d=ef Wh,i(x)1[{Yi - ^lh(Xi)}  t],
i=1

(23)

with Wh,i(x) = n-1Kh(x - Xi)/f^h(x) and f^h(x) = n-1

n i=1

Kh(x

-

Xi)

the kernel density estimator. To have a correctly centered estimation for

F(|X=x)(t), we define

 dF(|X=x)(t)

dF^ (t) = (|X=x)

F(|X =x) (0)+C0 (1-F(|X =x) (0)) C0 dF(|X =x) (t)



F(|X =x) (0)+C0 (1-F(|X =x) (0))

if t < 0, otherwise.

(24)

where C0 is a constant defined as

C0

d=ef

-

0 -

(u)dF(|X

=x)

(u)

 0

(u)dF(|X

=x)(u)

.

Note that the estimator in (24) is centered so that

E F^|X=xi (i) = 0 = E F|X=xi ( )

(25)

The influence function of the estimator is proportional to (·) =  (·).
If it is bounded with bounded derivatives a.e. and L(|X) is such that ||F^(|Xi=x)(·) - F(|X=xi)(·)|| = O(h2n), then a similar coupling argument as in (7) can be used. Recall i = F^(-|1Xi=x)(F(|Xi=x)), then

|(i) - (i)| = Op(h2n)

(26)

This ensures that
n
n-1 {(i ) - (i)}Kh(x - Xi) = Op(h2n).
i=1

(27)

The argument is based on two facts. First from (25) the means are zero and
second that (26) holds. Once the Yis are generated, one applies (10) to the bootstrap data
{(Xi, Yi)}in=1 to obtain ^lh,g(x). Summarizing, we have:

Theorem 3.1. Let assumptions A.1- A.4 be fulfilled and define ^lh(·) as in

(9). Then

sup |An(x)| = Op(h2n),
xB

(28)

11

where

An(x) d=ef (^lh - l)(x) - {(^lh,g - ^lg)(x)}.

(29)

Let assumptions A.1- A.7 be fulfilled and consider the additive model of (11)

with the estimator (12), and the resampling scheme is considered as in (15)

and (16), then

sup |(m^ j - mj)(x) - {(m^ j - m^ j)(x)}| = Oa.s.(H2n).
xB

Remark 1. The aforementioned strong approximation results mean that the stochastic behavior of ^lh(x) - l(x)((m^ j - mj)(x)) is well approximated by its bootstrap counterpart ^lh,g(x) - ^lg(x)((m^ j - m^ j)(x)). This implies in particular that the distribution of supx |^lh(x) - l(x)|(supxB |(m^ j - mj)(x)|) is consistently approximated by that of supx |^lh,g(x) - ^lg(x)| ( supxB |(m^ j - m^ j)(x)|). Also the rate H2n is sufficient for the validity of the bootstrap
for supremum-functionals, see Kreiss and Neumann (1998). Therefore, the
bootstrap confidence band is a direct consequence of the results.

Remark 2. Similar result was proved by H¨ardle et al. (2012) for quantile regression. There the centering ensures that the bootstrap error distribution has the proper quantile. Here it is generalized to a wider class of centering, and to additive models.

4 Simulation
This section is divided into two parts. First, we concentrate on the univariate x  [0, 1] case and the bootstrap procedure (7), (8), check the validity of the bootstrap procedure, and compare it with asymptotic uniform confidence bands. Second, we adopt the bootstrap procedure for the additive model as in (20), and check the validity of the bootstrap band in the same fashion.

4.1 Univariate Case

The simulation setup in the univariate case is:

1) Simulate (Xi, Yi), i = 1, . . . , n according to the predefined joint probability density function (pdf) f (x, y). In order to compare with H¨ardle (1989), we set the joint pdf of (X, Y ) as,

f (x, y) = g{y - sin(x)}1(x  [0, 1]) g(u) = 9(u)/10 + (u/9)/90

(30) (31)

12

95% 90% n Rel. Err. Area Rel. Err. Area 100 0.07(0.02) 1.23(2.51) 0.08(0.02) 1.02(2.20) 200 0.08(0.01) 0.89(1.95) 0.10(0.02) 0.74(1.76) 400 0.05(0.01) 0.78(1.32) 0.09(0.01) 0.64(1.15)
Table 1: Relative errors and areas (estimated as averaged width of the confidence bands over the grid points) of asymptotic (bootstrap) with 100 repetitions per sample, and 200 samples. Relative error d=ef |(true coverage - nominal coverage)|/nominal coverage.
2) Compute ^lh(x) as in (6), with (·) as a biweight loss, ^i d=ef Yi - ^lh(Xi).
3) Compute the estimated conditional edf as in (33) with Gaussian kernel 
Kh(u) = ( 2)-1 exp{-u2/2h}/h,
and h = 0.06 is selected by cross validation. 4) For each i = 1, . . . , n, generate random variable i  F^(|X)(t), i =
1, . . . , n: Yi = ^lg(Xi) + i,
with g = 0.2. 5) For each sample {Xi, Yi}in=1, compute ^lh,g(·) and the random variable
di d=ef sup[|^lh,g(x) - ^lg(x)| f^X (x)f^(|X=xi)(i)}/ EY |X {2(i )}] xB
6) Calculate the 1 -  quantile d of d1, . . . , dn. 7) Construct the bootstrap uniform band centered around ^lh(x)
^lh(x) ± [ f^X (x)f^(|X=xi)(i )}/ EY |X {2(i )}]-1d
Figure 1 shows the theoretical signal curve, the robust estimate using Huber's loss function with corresponding 95% uniform confidence band from the asymptotic theory and the confidence band using the bootstrap method. The real curve is marked as the grey solid line. We then compute the confidence band based on asymptotic theory according to Ha¨rdle (1989). We
13

notice that the asymptotic band is narrower than the bootstrap band. The width of the bands has not been affected by outliers since we adopt robust estimation. To compare which method is more precise, Table 1 presents respectively the relative errors of simulated bands compared with their nominal levels together with the calculated area of the 95% and 90% confidence band, for sample size n = 100, 200, 400. 100 simulation runs are carried out and 200 bootstrap samples are generated for each simulation. From Table 1, we observe that, for the asymptotic method, coverage probabilities improve with increased sample size and the bootstrap method (shown in brackets) obtain a larger coverage probability than the asymptotic one, as it has smaller relative errors. It is also observed that the sizes of the bands decrease with increased sample sizes. Overall, the bootstrap method displays a better convergence rate, while not sacrificing much on the width of the bands.

4.2 Additive model
We now extend to the case of multivariate covariates, where we use an additive model for the estimation. The bootstrap procedure is as follows:

1) Simulate (Xi, Yi), i = 1, . . . , n following model (11). The variables x1, x2, x3, x4  U (-2.5, 2.5),
m1(x1) = sin(x1), m2(x2) = (3x2), m3(x3) = x33, m4(x4) = x44,

and i is simulated from a mixture normal density function with density (u/9)/90 + (u)/10.

2) Compute the estimation m^ 1(x1), m^ 2(x2), m^ 3(x3), m^ 4(x4) via (13) and

^i = Yi -

4 j=1

m^ j

(xi,j

).

3) For each i = 1, . . . , n, generate random variable i, i = 1, . . . , n as in

(15):

4

Yi,i =

m^ j(xi,j) + i.

j=1

4) For each sample {xi,1, xi,2, xi,3, xi,4, yi}, compute m^ j (·) and the random variable

di d=ef

sup { f^Xj (x){f^(|Xj=xi,j)(i)}/ EY |Xj=xi,j {2(i)}

x[-2.5,2.5]

|m^ j (x) - m^ j(x)|}

14

-20 -10 0 10 20 -20 -10 0 10 20 -20 -10 0 10 20 -20 -10 0 10 20

q q

q

q q

qq q

qq qq
q q

qq q qq
q q q

qqq qq

q qqq

q

q qq qq
qq

q q qq

q qq

q q

q q
q
q qq q

qq

q

qqqq q
qq

q q
qq

q

q

q

q

q q

q qq q q

q q
qqq q q q

qq q q

q qq
q qq

q

-2 -1

0

1

2

q q
q qq
qq qq
q
q

q qq

q q

q qq q q qq

q

q qq

q

qq

q qq

q

q qq

q q

q qq q

q

q

q q

q

qq q

q q

q
q q

q qqq q

q

q qqqq

q qq

q qqqq

q

q q

q

qq

qq q q
qq q

q q

q

qq

q q

q q qq

q

-2 -1

0

1

2

q qq
qq q qq

qq q qq q qqq
q qq

q q q qqqqqqq

q q

q qq

q

qq

q

q q

q

q

q

qq qq

qq q

q q qq

qq

q qq

qq qqq q qq q

q

q

q

qq qq

q

q q q qq

qq q qq q

q

q q
q q
q qq q q

q

-2 -1

0

1

2

qq

q q
q

q

q q

q q
q q

qqqqqq qq

q q

q q

q q

q

q q

qq qqq

qq

q

q

q

q q
qq q q

q

q

q q

qq

q

q

q

q q

q

q
q q

q

q

q qq

qq

qq q q

q

q

q q

q

q q

q

q qq

q

q

q

q

q

q q qqq
q

q q
q
qq

q q

-2 -1

0

1

2

Figure 2: Plot of true curve (dark blue), robust estimates and bands (cyan), bootstrap band (red dotted)

5) Calculate the 1 -  quantile d of d1, . . . , dn.
6) Construct the bootstrap uniform band centered around m^ j(xj)
m^ j (xi,j ) ± [ f^xi,j (xj )f^(|Xj=xi,j)(i)}/ EY |Xj=xi,j {2(i)}]d
The estimation of m^ j(xj)s (j = 1, . . . , 4) and their bootstrap confidence bands are shown in Figure 2.
The relative errors between the bootstrap bands and their nominal levels are shown in Table 2. The coverage are close to the nominal levels and the widths of band are clearly shrinking w.r.t. the sample sizes.

5 Empirical analysis
5.1 Firm expenses analysis
Yafeh and Yosha (2003) use a sample of Japanese firms in the chemical industry to examine whether a concentrated shareholding is associated with lower expenditure on activities with scope for managerial private benefits. We focus on the same regression problem as proposed in Horowitz and Lee (2005). The dependent variable Y is: general sales and administrative expenses deflated by sales (denoted by MH5), which is one of five measures of
15

n Rel. Err.

Area

95% 100 0.07, 0.03, 0.05, 0.01 6.06, 5.37, 5.44, 5.21

200 0.07, 0.03, 0.02, 0.04 5.50, 4.74, 4.54, 4.65

400 0.04, 0.02, 0.01, 0.03 4.83, 3.63, 3.76, 3.70

90% 100 0.05, 0.08, 0.06, 0.03 5.88, 5.07, 5.04, 5.30

200 0.03, 0.02, 0.04, 0.02 4.84, 3.84, 3.85, 4.00

400 0.06, 0.02, 0.02, 0.01 4.02, 3.25, 3.11, 3.03

Table 2: Relative errors and areas of bootstrap bands for m^ 1(·), m^ 2(·), m^ 3(·), m^ 4(·) with 100 repetitions per sample, and 200 samples.

expenditures on activities with scope for managerial private benefits considered. The covariates are: ownership concentration (denoted by TOPTEN, cumulative shareholding by the largest ten shareholders), and firm characteristics: the log of assets, firm age, and leverage (the ratio of debt to debt plus equity), sample size= 185. The regression model we consider here is:
M H5 = m0 + m1(T OP T EN ) + m2{log(Assets)} +m3(Age) + m4(Leverage) + error
The estimated additive components and its bootstrap confidence bands are shown in Figure 3. Similarly, it can be seen that the nonlinear effects are log(asset) and TOPTEN, and the firm age effects are minor compared to the other three. Differently, the effect of leverage is also a little bit nonlinear, and the shape of curves deviates from what Horowitz and Lee (2005) present, especially for the effect of TOPTEN. This may due to the different subjects studied: in our case robust estimation with Tukey biweight loss, while in their case the conditional median curve.
5.2 The impact on stock market
We analyze how the four markets (oil, currency, bond, real estate) affect the stock market. This study would give implications to the interactions of the economic conditions among different sectors. The data source is ProQuest Statistical Datasets, we focus on the US market. Therefore, the covariates are taken as: the crude oil index, EUR- USD exchange rate, the 10 year treasury constant maturity inflation index %, the real estate index, and the Y variable is S&P 500 index returns. The data are synchronized to weekly frequency. We select the data during the period 20080903 - 20111128.
It can be observed that all the four markets have non linear effects on the stock indices values, Figure 4, but only exchange rate EUR-USD and crude
16

0 5 10 20

0 5 10 15

-20 -10 0 10

-5 0 5 10 15

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
Figure 3: Robust estimates (blue), bootstrap bands (red dotted), left up: Log(Asset), right up: Leverage, left below: Age, right below: TOPTEN.
oil prices affect the the stock indices returns nonlinearly, Figure 5. It is not difficult to interpret the relationships: In Figure 4, for the exchange rate EUR-USD, the weakness of EUR up to a certain level (< 1.27) are negatively correlated with the stock indices, and then a positive correlation follows, but this relationship is again reversed when the EUR is too high(> 1.43). Oil prices have negative impact on stock indices at every level, but the effects decrease when the prices raise. As for the inflation index, when the inflation rate is high, interest rates are typically high, this may reduce the consumption and investments in the stock market. So one sees a negative correlation there when the inflation index is bigger than (0.7). Finally, increasing real estate index can be a sign of booming economic condition, therefore the stock indices raise when the real estate index gets higher. However, when the real estate index is too high, it is likely that there exist bubble, so one sees a drop in the market indices.
In Figure 5, we see difference effects on S&P log returns, exchange rate EUR- USD are positively correlated with returns until a high lever (> 1.40), the crude oil has majorally negative effects on stock returns. More nonlinearity is presented in the plots for inflation index and real estate index.
17

-100 0

0 20 40 60

-300

1.20 1.25 1.30 1.35 1.40 1.45 1.50

40

60

80 100 120

-50 50 150

0 50 100 150

0.5 1.0 1.5 2.0 2.5 3.0

500000

600000

700000

800000

Figure 4: Robust estimate (blue), bootstrap bands (red dotted), Y: S&P index, left up: exchange rates EUR-USD, right up: crude oil price, left below: inflation index, right below: real estate index.

-0.02 0.02 0.06

-0.04 -0.01 0.01 0.03

1.20 1.25 1.30 1.35 1.40 1.45 1.50

40

60

80 100 120

-0.06 -0.02 0.02

-0.10 -0.04 0.00

0.5 1.0 1.5 2.0 2.5 3.0

500000

600000

700000

800000

Figure 5: Robust estimate (blue), bootstrap bands (red dotted), Y: S&P index log return, left up: exchange rates EUR-USD, right up: crude oil price, left below: inflation index, right below: real estate index.

18

6 Conclusion
We have developed and proved the bootstrap improvement for a wide class of smoothers with bounded influence functions. Moreover, we extend our results to additive models to cope with curse of dimensionality.

A Appendix

A.1 Proof of Theorem 3.1 in the d = 1 case

To prove Theorem 3.1, we show finally, with (optimal rate) h = O(n-1/5):

miax[(^lh - l)(Xi) - {(^lh,g - ^lg)(Xi)}] = Op(h2n),

(32)

This is extended to any point x in a compact set B in (43). Proving (32) can be done by showing first:

max i

|(i )

-

(i

)|

=

Op(h2n).

(33)

Recall the definition of F~|X(·) in (24), it is the induced conditional cdf of {(i )}ni=1. By Franke and Mwita (2011) we have for a small b:

sup |F~(|X)(t) - F(|X)(t)| = Op(h2n).
|t|b,i=1,...,n

(34)

Also recall (24) F^(|X) is a scaled version of F~(|X). Then according to A.2, the inverse function of F^(|X)(·) and F(|X)(·) will also be close in the sense
that

max i

|i

-

i|

=

max i

|F(-|1X)(Ui)

-

F^(-|1X)(Ui)|

=

Op(h2n)

(35)

Moreover, for a i = Op(h2n) uniformly, define F-|X1 (·) as the conditional c.d.f. of () on X,

|(i) - (i)| = |F-|X1 [F^|X {(i)|Xi}|Xi] - (i )|

= |F-|X1 [F|X {()|Xi} + i|Xi] - (i)|

= |F-|X1 [F|X {()|Xi} + i|Xi] - F-|X1 [F|X {()|Xi}|Xi]|



1 c1 i

=

Op(h2n),

by A.2. Therefore, (33) is proved. As (·) plays a role in the estimation via the zero functions defined below, to prove (32), we first want to write the

19

estimation difference (^lh - l)(Xi) and (^lh,g - ^lg)(Xi) written w.r.t. to their zero functions defined as follows.

Gn (, Xi)

d=ef

1 n

n

Wh,j(Xi)[{j -  + ^lg(Xj)}]

j=1

=

1 n

n

Wh,j(Xi){(Yj - )}

j=1

Gn(, Xi)

d=ef

1n n Wh,j(Xi)[{j -  + l(Xj)}]

j=1

=

1 n

n

Wh,j(Xi){(Yj - )}

j=1

Note that, for the first moment, we have the natural equality as follows, so we can focused the difference in the second moment,

E F^|Xi=x (i) = 0 = E (F|Xi=x ). We abbreviate EF|X=Xi as E and EF^|X=Xi as E , define

(36)

l(x) d=ef argmin E (Y - )Kh(X - x) lg(x) d=ef argminE(Y  - )Kh(X - x) Tn(Xi) d=ef Gn{lg(Xi), Xi} - Gn{l(Xi), Xi}.

(37) (38) (39)

as the unbiased version of true function, and it is not hard to derive that the bias has the order of Op(h2).

l(Xi) - l(Xi) = E Gn(l(Xi), Xi) + O(l(Xi) - l(Xi))  E Gn(l(Xi), Xi)

=

{h2l

(Xi)/2 + fX (Xi)l (Xi)h2/fX (Xi)}

K

2 s

+

Op(h2)

Similarly for lg(Xi) - ^lg(Xi), we have

lg(Xi) - ^lg(Xi)

=



E G(l(Xi), Xi) E E Gn(l(Xi), Xi)

+

O(lg (Xi )

-

^l(Xi))

=

{h2^lg (Xi)/2 + fX (Xi)^lg(Xi)h2/fX (Xi)}

K

2 s

+

Op(h2),

where

K

2 s

d=ef

s2K2(s)ds . A balance between bias and variance term

would lead to the choice of the rate h as O(n-1/5n), and we have |l(Xi) -

20

l(Xi) - {lg(Xi) - ^lg(Xi)}| = Op(h2), so we can write the difference of the bias term as Op(h2) in the following derivation. Remark In the case when (·) is not differentiable, in particular for the
quantile case, the above stochastic expansion is still valid, see the stochastic
expansion in Kong, Linton and Xia (2010). According to A.1, excluding non-differentiable (·) case, one can use the
Lipschitz condition of the function (·), and (·) is bounded, we have,  a
constant C, such that,

max |Tn(Xi)| i

=

1 max |
in

n

Wh,j(Xi){(j - lg(Xi) + ^lg(Xj)) - (j - l(Xi) + l(Xj))}|

j=1



1 max
in

n

Wh,j(Xi)|(C[{j - lg(Xi) + ^lg(Xj)} - {j - l(Xi) + l(Xj)}])|

j=1

So we can break the upper bound of maxi |Tn(Xi)|by two terms, the
first term maxi Tn,1(Xi) involves the bootstrapped error and its theoretical
couple, which has been proved by (34), and the second term maxi Tn,2(Xi) is concerning the convergence rate of ^lg(·),

max |Tn(Xi)| i



1 max C
in

n

Wh,j(Xi)|(j - j)|

j=1

+

1 max C
in

n

Wh,j(Xi)|[{^lg(Xj) - lg(Xi)} - {l(Xj) - l(Xi)}]|

j=1

 max Tn,1(Xi) + max Tn,2(Xi). ii

maxi |Tn,1(Xi)| is know to have the rate Op(n-1/2h3/2n), and

max Tn,2(Xi) i

=

1 max C
in

n

Wh,j(Xi)|{^lg(Xi,j,0) - l (Xi,j,0)}(Xi - Xj)|

j=1

+Op(h2),

where Xi,j,0 is a point between Xi and Xj, and C is a constant, according to the mean value theorem. supxB |^lg(x)-l (x)| is of the rate Op(g-1(ng)-1/2n+ g3), see Stone (1982). Therefore the optimal rate for g would be O(n-1/9) in
our case (as in A.4), this rate is slower than the choice of h, which confirms
the results in Ha¨rdle and Marron (1991). Then we can achieve

max Tn,2(Xi) = Op(h2n). i

21

As the second derivative of the loss function (·) does not exist at zero, we use the local version of equicontinuity lemma from chapter VII.1 in Pollard (1984). Our loss function have the following expansion with the remainder term defined as r{y, (x)}

{y - (x)} = {y - l(x)} + { - l(x)}{y - l(x)} + | - l(x)|r{y, (x)}, (40)

define

Rn (Y , lg(Xi)) d=ef n-1

n j=1

r(Yj,

lg (Xi )),

Rn(Y,

l(Xi))

d=ef

n-1

n j=1

r(Yj

,

l(Xi

))

are the high order function, we need to prove it satisfies the equicontinuity

condition around the point lg(Xi) and l(Xi), namely, for each  and , 

such that,

lim sup P( sup Rn (lg) - Rn (lg) > ) < n l : lg-lg <
lim sup P( sup Rn(l ) - Rn(l) > ) < .
n l : l -l <

(41) (42)

According to the equicontinuity lemma in Pollard (1984), first of all we can prove that |r(y, )| has an envelope. As the bounded influence condition in A.2,

|r(y, )| = {|(y - ) - (y - l(x)) - ( - l(x))(y - l(x))|}/| - l(x)|  {| - l(x)|(y - 0)}|/| - l(x)| + {|( - l(x))(y - l(x))|} /| - l(x)|  2C1.

The {Y - l(x)} is differentiable in quadratic mean at l(x). Moreover, we observe that the condition on covering numbers is satisfied, since the class of function r(y, ) can be expressed as a union or intersection of classes of polynomial discrimination, therefore the covering number is bounded.
So we can achieve the estimations are linked to the zero functions around the point lg(Xi) and l(Xi) respectively, as follows

^lh,g(Xi) - lg(Xi)

=

- E

Gn {l(Xi), Xi} EGn{lg(Xi), Xi}

+

Op((nh)-1/2),

^lh(Xi) - l(Xi)

=

- 

Gn{l(Xi), Xi} E Gn{l(Xi), Xi}

+

Op((nh)-1/2),

where  E E Gn {lg(Xi), Xi} denote the partial derivative of E E Gn{, Xi} w.r.t.  taking value at the point lg(Xi).

22

This means,

|^lh,g(Xi) - ^lg(Xi) - ^lh(Xi) + l(Xi)|

=

- 

Gn{lg(Xi), Xi} E E Gn {lg(Xi), Xi}

+



Gn{l(Xi), Xi} E Gn{l(Xi), Xi}

+

Op(h2)

= -  E Gn{l(Xi), Xi}[Gn {lg(Xi), Xi} - Gn{l(Xi), Xi}]  E E Gn{lg(Xi), Xi} E Gn{l(Xi), Xi}

+ Gn{l(Xi), Xi}[ E E Gn{lg(Xi),  E E Gn {lg(Xi), Xi}

Xi} -  E Gn{l(Xi), E Gn{l(Xi), Xi}

Xi}]

+

Op(h2)

Therefore, since Gn {^lg(Xi), Xi} and Gn{l(Xi), Xi} are known by S.L.L.N. to have strong consistency to E Gn {^lg(Xi), Xi} and E Gn{l(Xi), Xi}, we have,

max i

|^lh,g

(Xi)

-

^lg

(Xi)

-

^lh(Xi)

+

l(Xi)|

= O(max Tn(Xi)) + Op(h2n) + Op(h2n), i

and (32) is proved. Define the order statistics X(1), · · · , X(n) of X1, · · · , Xn, so the claim (28)
can be proved from (32) using the fact that,

sup|An(x)|  maxi|An(X(i))| + maxisupx[X(i),X(i+1)]|An(X(i)) - A(x)| (43)

it suffices to consider the speed of the last term. With Lipschitz continuity of An(·):

maxisupx[X(i),X(i+1)]|An(X(i)) - A(x)|  c2maxisupx|Xi - x|,

(44)

where c2 > 0 is a constant, this upper random bound is of order Op(n-1/d log n) = Op(h2n). The uniform bound for Xi - x results from the uniform law of large numbers over a ball of size n-1/d, see Penrose (1964), Theorem 1.1.
Remark For the non-differentiable (·) cases, in particular quantile regres-
sion case, one can still establish similar inequality, as

max | 1 in

n

Wh,j(Xi){(j - lg(Xi) + ^lg(Xj)) - (i - l(Xi) + l(Xj))}|

j=1



1 max
in

n

Wh,j(Xi)|({j - lg(Xi) + ^lg(Xj)} - {i - l(Xi) + l(Xj)})|

j=1

23

Define i,j d=ef |{j - lg(Xi) + ^lg(Xj)} - {i - l(Xi) + l(Xj)}| = Op(h2) because, so
P(i,j > c3h2)  E(|i,j|)/(c3h2) = Op({lg(Xi) + ^lg(Xj) - l(Xi) + l(Xj)}/h2).
Then the argument follows from the above proof. Moreover, one can also use the strong consistency of Gn, Gn to E(Gn) and E Gn respectively based on A.1 and lemma 2.4 of Newey and McFadden (1986).

A.2 Proof of second part of Theorem 3.1
The number of regressors in (11) is of order p = H-1d + 1. Portnoy (1997) shows that as long as n-1(p log n)3/2  0 then the estimators of the regression parameters are consistent and have the standard variance. In our situation,

n-1n1/52/3 log n = O(1)

(45)

and therefore the condition is satisfied. Now we have a look at the behavior of the design matrix in (12).
n
L^(A) d=ef -n-1 {Yi - A (Xi)}
i=1 n
L^(A) d=ef n-1 {Yi - A (Xi)}(Xi)
i=1
2 E L^(A) d=ef - E {Yi - A (Xi)}(Xi)(Xi)

Recall that

A^ = argminAL^(A)

Lemma 14 of Stone (1985) ensures that with probability approaching 1, A^ exists uniquely and that L^(A^) = 0. In addition, there exists m(x) =

A (x), such that

sup |m(x) - m(x)|  CH2.
xB

(46)

According to the bounded influence condition A.1, the jth term, j  1, 2, . . . , H-1d+

24

1.
n
|{L^(A)}j| = |{-n-1 [{m(Xi) + i - A (Xi)} - (0)](Xi)}j|
i=1 n
 [n-1 C3|{A (Xi) + i - A (Xi)}(Xi)|]j
i=1 n
 [n-1 C3|{A (Xi) + i - A (Xi)}(Xi)|]j
i=1
We know first that,
E |[{m(Xi) - m(Xi)}(Xi)]j| = O(H2).
Let i,j d=ef {|m(Xi)-m(Xi)(Xi)|-E |m(Xi)-m(Xi)(Xi)|}j, by Bernstein's Lemma:
Lemma A.1. Let Z1, . . . , Zn be independent r.v.s.
log E exp(tZi)  E(Zi2)t2/2
for all t  [0, ]. Then

nn
P | Zi|  t 2 E Zi2  2 exp(-t2)
i=1 i=1

Finally, we can derive that,

n
n-1 i,j = Oa.s.(H2n-1/2n), j = 1
i=1

The last term

n
n-1|{ i(Xi)}j| = Oa.s.(n-1/2n)

i=1

Therefore, one has collective term from (47) and (48),

(47) (48)

L^(A) = Oa.s.(H3/2 + H-1/2n-1/2n),

where . denotes the L2 norm. By assumption A.5, A.7, l = 1, . . . , H-1, the d dimensional vector
l (Xi) satisfies,
 b 2/d  E b l (Xi)l(Xi)b   b 2/d,

where  and  are two constants.

25

Lemma A.2. Assume A.1 and A.5, as n  ,

A^ - A maxi1,...,n m^ (Xi) - m(Xi)

= Oa.s.(H3/2 + H-1/2n-1/2n) = Oa.s.(H + H-1n-1/2n)

Proof According to similar equicontinuity arguments, exists an (H-1d + 1) × (H-1d + 1) matrix A, such that

A^ - A = O( {2 E L^(A0)}-1{-L^(A)} ),

since

2 E L^(Xi) = (Xi)(Xi)  E (Yi - A^0 (Xi))

According to assumption A.7,

c3IH-1d+1  2 E L^(Xi)  c4IH-1d+1

therefore

A^ - A = Oa.s.(H3/2 + H-1/2n-1/2n).

Moreover, by Cauchy-Schwarz inequality

maxi1,...,n|m^ (Xi) - m(Xi)|  maxi A^ - A (Xi) = Oa.s.(H3/2 + H-1/2n-1/2n)Oa.s.(H-1/2) = Oa.s.(H + H-1n-1/2n).

We would like to check for the pseudo observations Yi = m(Xi) + i.
|{m^ k(Xi,k) - m^ k(Xi,k)} - {m^ k(Xi,k) - mk(Xi,k)}|  |(A^ - A^ - A^ + A )(Xi,k)| = O(|[2EEL^(A^)-1{-L^(A^)} - 2 E L^(A)-1{-L^(A)}] (Xi)| + H2)
as 2 E L^(A^)-1 and 2 E L^(A)-1 are both bounded,

|{m^ k(Xi,k) - m^ k(Xi,k)} - {m^ k(Xi,k) - mk(Xi,k)}|
n
= O(|n-1 {(i ) - (i + A (Xi) - A (Xi))}(Xi) (Xi)| + H2)
i=1 n
= O(|n-1 {(i ) - (i)}(Xi) (Xi)| + H2)
i=1 n
= O(|n-1 {i - i}(Xi) (Xi)| + H2)
i=1 n
= O(|n-1 {Zi|^i| - Zii}(Xi) (Xi)| + H2)
i=1

26

One can derive using coupling argument,
|{m^ k(Xi,k) - m^ k(Xi,k)} - {m^ k(Xi,k) - mk(Xi,k)}| = Oa.s.(n-1/2(H2 + n-1/2n)H-1/2 + H2) = Oa.s.(H2)
References
Bickel, P. J. and Rosenblatt, M. (1973). On some global measures of the deviations of density function estimates, Ann. Statist. 1: 1071­1095.
Claeskens, G. and Van Keilegom, I. (2003). Bootstrap confidence bands for regression curves and their derivatives, Ann. Statist. 31: 1852­1884.
Franke, J. and Mwita, P. (2011). Nonparametric estimates for conditional quantiles of time series, Scientific Commons .
Hall, P. (1991). Edgeworth expansions for nonparametric density estimators, with applications, Statistics: A Journal of Theoretical and Applied Statistics 22: 215­232.
Hall, P. (1992). The Bootstrap and Edgeworth expansion, Springer Verlag.
Ha¨rdle, W. (1989). Asymptotic maximal deviation of M -smoothers, J. Multivariate Anal. 29: 163­179.
Ha¨rdle, W., Horowitz, J. and Kreiss, J.-P. (2003). Bootstrap method for time series, International Statistical Review / Revue Internationale de Statistique 71(2): 435­459.
Ha¨rdle, W. K. (1990). Applied Nonpametric Regression, Cambridge University Press.
Ha¨rdle, W. K., Ritov, Y. and Song, S. (2012). Partial linear quantile regression and bootstrap confidence bands, Journal of Multivariate Analysis 107: 244­262.
Ha¨rdle, W. K. and Song, S. (2010). Confidence bands in quantile regression, Econometric Theory 26: 1180­1200.
Ha¨rdle, W. and Marron, J. S. (1991). Bootstrap simultaneous error bars for nonparametric regression, The Annals of Statistics 19(2): 778­796.
27

Horowitz, J., Klemela¨, J. and Mammen, E. (2006). Optimal estimation in additive regression models, Bernoulli 12(2): 271­298.
Horowitz, J. L. (2001a). The Bootstrap, Handbook of Econometrics.
Horowitz, J. L. (2001b). Nonparametric estimation of a generalized additive model with an unknown link function, Econometrica 69(2): 499­513.
Horowitz, J. L. and Lee, S. (2005). Nonparametric estimation of an additive quantile regression model, Journal of the American Statistical Association 100(472): 1238­1249.
Huber, P. J. (1964). Robust estimation of a location parameter, The Annals of Mathematical Statistics 35(1): 73­101.
Johnston, G. J. (1982). Probabilities of maximal deviations for nonparametric regression function estimates, Journal of Multivariate Analysis 12(402-414).
Kong, E., Linton, O. and Xia, Y. (2010). Uniform Bahadur representation for local polynomial estimates of M-regression and its application to the additive model, Econometric Theory 26: 159­166.
Kreiss, J.-P. and Neumann, M. H. (1998). Regression-type inference in nonparametric autoregression, Annals of Statistics 26: 1570­1613.
Mammen, E. (1992). When does bootstrap work?: Asymptotic results and simulations, Springer Verlag.
Newey, W. K. and McFadden, D. L. (1986). Large sample estimation and hypothesis testing, Handbook of Econometrics 4: 2111­2245.
Penrose, M. D. (1964). A strong law for the largest nearest-neighbour link between random points, Journal London Mathematical Society 60(3): 951­ 960.
Pollard, D. (1984). Convergence of Stochastic Processes, Springer Verlag.
Portnoy, S. (1997). Local asymptotics for quantile smoothing splines, The Annals of Statistics 25(1).
Stone, C. J. (1982). Optimal global rates of convergence for nonparametric regression, The Annals of Statistics 10(4): 1040­1053.
Stone, C. J. (1985). Additive regression and other nonparametric models, The Annals of Statistics 13(2): 689­705.
28

Yafeh, Y. and Yosha, O. (2003). Large shareholders and banks: Who monitors and how?, Economic Journal 113: 128­146.
29

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.

001
002 003 004 005 006
007
008 009
010 011 012
013 014
015 016
017
018 019

"Functional Data Analysis of Generalized Quantile Regressions" by
Mengmeng Guo, Lhan Zhou, Jianhua Z. Huang and Wolfgang Karl Härdle, January 2013. "Statistical properties and stability of ratings in a subset of US firms" by
Alexander B. Matthies, January 2013. "Empirical Research on Corporate Credit-Ratings: A Literature Review" by Alexander B. Matthies, January 2013. "Preference for Randomization: Empirical and Experimental Evidence" by
Nadja Dwenger, Dorothea Kübler and Georg Weizsäcker, January 2013. "Pricing Rainfall Derivatives at the CME" by Brenda López Cabrera, Martin Odening and Matthias Ritter, January 2013. "Inference for Multi-Dimensional High-Frequency Data: Equivalence of
Methods, Central Limit Theorems, and an Application to Conditional Independence Testing" by Markus Bibinger and Per A. Mykland, January 2013.
"Crossing Network versus Dealer Market: Unique Equilibrium in the Allocation of Order Flow" by Jutta Dönges, Frank Heinemann and Tijmen R. Daniëls, January 2013. "Forecasting systemic impact in financial networks" by Nikolaus Hautsch,
Julia Schaumburg and Melanie Schienle, January 2013. "`I'll do it by myself as I knew it all along': On the failure of hindsightbiased principals to delegate optimally" by David Danz, Frank Hüber,
Dorothea Kübler, Lydia Mechtenberg and Julia Schmid, January 2013. "Composite Quantile Regression for the Single-Index Model" by Yan Fan, Wolfgang Karl Härdle, Weining Wang and Lixing Zhu, February 2013. "The Real Consequences of Financial Stress" by Stefan Mittnik and Willi
Semmler, February 2013. "Are There Bubbles in the Sterling-dollar Exchange Rate? New Evidence from Sequential ADF Tests" by Timo Bettendorf and Wenjuan Chen, February 2013.
"A Transfer Mechanism for a Monetary Union" by Philipp Engler and Simon Voigts, March 2013. "Do High-Frequency Data Improve High-Dimensional Portfolio
Allocations?" by Nikolaus Hautsch, Lada M. Kyj and Peter Malec, March 2013. "Cyclical Variation in Labor Hours and Productivity Using the ATUS" by Michael C. Burda, Daniel S. Hamermesh and Jay Stewart, March 2013.
"Quantitative forward guidance and the predictability of monetary policy ­ A wavelet based jump detection approach ­" by Lars Winkelmann, April 2013.
"Estimating the Quadratic Covariation Matrix from Noisy Observations: Local Method of Moments and Efficiency" by Markus Bibinger, Nikolaus Hautsch, Peter Malec and Markus Reiss, April 2013. "Fair re-valuation of wine as an investment" by Fabian Y.R.P. Bocart
and Christian M. Hafner, April 2013. "The European Debt Crisis: How did we get into this mess? How can we get out of it?" by Michael C. Burda, April 2013.

SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
020 "Disaster Risk in a New Keynesian Model" by Maren Brede, April 2013. 021 "Econometrics of co-jumps in high-frequency data with noise" by Markus
Bibinger and Lars Winkelmann, May 2013. 022 "Decomposing Risk in Dynamic Stochastic General Equilibrium" by Hong
Lan and Alexander Meyer-Gohde, May 2013. 023 "Reference Dependent Preferences and the EPK Puzzle" by Maria Grith,
Wolfgang Karl Härdle and Volker Krätschmer, May 2013. 024 "Pruning in Perturbation DSGE Models - Guidance from Nonlinear Moving
Average Approximations" by Hong Lan and Alexander Meyer-Gohde, May 2013. 025 "The `Celtic Crisis': Guarantees, transparency, and systemic liquidity risk" by Philipp König, Kartik Anand and Frank Heinemann, May 2013. 026 "State Price Densities implied from weather derivatives" by Wolfgang Karl Härdle, Brenda López-Cabrera and Huei-Wen Teng, May 2013. 027 "Bank Lending Relationships and the Use of Performance-Sensitive Debt" by Tim R. Adam and Daniel Streitz, May 2013. 028 "Analysis of Deviance in Generalized Partial Linear Models" by Wolfgang Karl Härdle and Li-Shan Huang, May 2013. 029 "Estimating the quadratic covariation of an asynchronously observed semimartingale with jumps" by Markus Bibinger and Mathias Vetter, May 2013. 030 "Can expert knowledge compensate for data scarcity in crop insurance pricing?" by Zhiwei Shen, Martin Odening and Ostap Okhrin, May 2013. 031 "Comparison of Methods for Constructing Joint Confidence Bands for Impulse Response Functions" by Helmut Lütkepohl, Anna StaszewskaBystrova and Peter Winker, May 2013. 032 "CDO Surfaces Dynamics" by Barbara Choro-Tomczyk, Wolfgang Karl Härdle and Ostap Okhrin, July 2013. 033 "Estimation and Inference for Varying-coefficient Models with Nonstationary Regressors using Penalized Splines" by Haiqiang Chen, Ying Fang and Yingxing Li, July 2013. 034 "Robust Estimation and Inference for Threshold Models with Integrated Regressors" by Haiqiang Chen, July 2013. 035 "A new perspective on the economic valuation of informal care: The wellbeing approach revisited" by Konstantin Kehl and Stephan Stahlschmidt, July 2013. 036 "Herding in financial markets: Bridging the gap between theory and evidence" by Christopher Boortz, Simon Jurkatis, Stephanie Kremer and Dieter Nautz, July 2013. 037 "Default Risk Calculation based on Predictor Selection for the Southeast Asian Industry" by Wolfgang Karl Härdle and Dedi Dwi Prastyo, August 2013. 038 "ECB monetary policy surprises: identification through cojumps in interest rates" by Lars Winkelmann, Markus Bibinger and Tobias Linzert, August 2013. 039 "Limited higher order beliefs and the welfare effects of public information" by Camille Cornand and Frank Heinemann, August 2013. 040 "Privacy Concerns, Voluntary Disclosure of Information, and Unraveling: An Experiment" by Volker Benndorf, Dorothea Kübler and Hans-Theo Normann, September 2013.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
ForschunSgTFhsgBise6mre4esh9ient,atsrSpccph:h/aa/wfntsadtfshabrus6oue4upr9gphS.owtrtrtihaewedßiS.ebhFy1uB,t-h6bDe4e-9rD1li0"enEu1.ctd7ose8cnhoBemeircliRnisk".
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
041 "Goodness-of-fit Test for Specification of Semiparametric Copula Dependence Models" by Shulin Zhang, Ostap Okhrin, Qian M. Zhou and Peter X.-K. Song, September 2013.
042 "Volatility linkages between energy and agricultural commodity prices" by Brenda López Cabrera and Franziska Schulz, September 2013.
043 "Testing the Preferred-Habitat Theory: The Role of Time-Varying Risk Aversion" by Till Strohsal, September 2013.
044 "Assortative matching through signals" by Friedrich Poeschel, September 2013.
045 "Intertemporal Consumption and Debt Aversion: An Experimental Study" by Thomas Meissner, September 2013.
046 "Automated Valuation Modelling: A Specification Exercise" by Rainer Schulz, Martin Wersing and Axel Werwatz, October 2013.
047 "Tie the straps: uniform bootstrap confidence bands for bounded influence curve estimators" by Wolfgang Karl Härdle, Ya'acov Ritov and Weining Wang, October 2013.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

