BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2014-022
Nonparametric Test for a Constant Beta over a
Fixed Time Interval
Markus Reiﬂ* Viktor Todorov** George Tauchen***
* Humboldt-Universit‰t zu Berlin, Germany ** Northwestern University, USA *** Duke University, USA
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

Nonparametric Test for a Constant Beta over a Fixed Time Interval
Markus Reiﬂ and Viktor Todorov and George Tauchenß
February 25, 2014
Abstract We derive a nonparametric test for constant (continuous) beta over a fixed interval of time. Continuous beta is defined as the ratio of the continuous covariation between an asset and observable risk factor (e.g., the market return) and the continuous variation of the latter. Our test is based on discrete observations of a bivariate It^o semimartingale with mesh of the observation grid shrinking to zero. We first form a consistent and asymptotically mixed normal estimate of beta using all the observations within the time interval under the null hypothesis that beta is constant. Using it we form an estimate of the residual component of the asset returns that is orthogonal (in martingale sense) to the risk factor. Our test is then based on the distinctive asymptotic behavior, under the null and alternative hypothesis, of the sample covariation between the risk factor and the estimated residual component of the asset returns over blocks with asymptotically shrinking time span. Optimality of the test is considered as well. We document satisfactory finite sample properties of the test on simulated data. In an empirical application based on 10-minute data we analyze the time variation in market betas of four assets over the period 2006≠2012. The results suggest that (for likely structural reasons) for one of the assets there is statistically nontrivial variation in market beta even for a period as short as a week. On the other hand, for the rest of the assets in our analysis we find evidence that a window of constant beta of one week to one month is statistically plausible.
Keywords: nonparametric tests, time-varying beta, stochastic volatility, high-frequency data.
AMS 2000 subject classifications: 62G10, 62M07, 62M10, 91B25. JEL subject classifications: C14, C32, C58, G10.
Todorov's work was partially supported by NSF grant SES-0957330, Reiﬂ's work was supported by the DFG via SFB 649 Economic Risk.
Institut fu®r Mathematik, Humboldt-Universita®t zu Berlin, Unter den Linden 6, 10099 Berlin, Germany; email: mreiss@math.hu-berlin.de.
Department of Finance, Northwestern University, Evanston, IL 60208-2001, email: v-todorov@northwestern.edu. ßDepartment of Economics, Duke University, Durham, NC 27708; e-mail: george.tauchen@duke.edu.
1

1 Introduction
In factor pricing models asset prices are determined by their sensitivities, known as betas, to systematic risk factors as well as the risk premium (market prices of risk) for each of these factors. A leading example is the classical Capital Asset Pricing Model (CAPM) in which the only systematic risk factor is the return on the market portfolio. A key point in the estimation and testing of the factor pricing models is whether the factor loadings, i.e., betas, are constant or time-varying. Indeed, covariation between the betas and the risk premia for the systematic risk factors can lead to excess returns (known as alphas) in addition to what is predicted by the model with betas set at their average values. In particular, the CAPM can hold conditionally but not unconditionally, see e.g., Hansen and Richard (1987) and Lewellen and Nagel (2006). On the other hand, if betas remain constant on a given interval of time, then one can proceed and estimate them efficiently using high-frequency records of the asset and the risk factors within the interval based on in-fill asymptotic methods developed in Barndorff-Nielsen and Shephard (2004), Andersen et al. (2006), Todorov and Bollerslev (2010) and Gobbi and Mancini (2012).
Given the importance of the time-variation in betas for asset pricing, in this paper we develop a nonparametric test for deciding whether beta stays constant or not on a given fixed interval of time. In particular, our analysis is based on discrete observations of a bivariate It^o semimartingale on a fixed interval of time with mesh of the observation grid shrinking to zero. Similar to Todorov and Bollerslev (2010) and Gobbi and Mancini (2012), we separate the beta into continuous and discontinuous one based on the sensitivities of the continuous and discontinuous components of the asset towards the corresponding components of the systematic risk factor. Our interest in this paper is in the continuous beta, similar to prior work on betas that does not consider jumps in asset prices, e.g., Barndorff-Nielsen and Shephard (2004) and Andersen et al. (2006). For simplicity our analysis is done for a one-factor model.
The proposed test is constructed as follows. We first form a "pooled" estimate of beta as the ratio of estimates over the interval of the continuous covariation between the asset and the risk factor and the continuous variation of the latter. This estimator is consistent for the constant beta and asymptotically mixed normal under the null and it converges to a volatility weighted average of the time-varying beta under the alternative. Using this "pooled" beta estimator, we then separate, under the null hypothesis of constant beta, the residual component of the asset which is orthogonal in the continuous martingale sense to the risk factor. That is, we estimate, under the null, the part of the asset that has zero continuous quadratic covariation with the risk factor. Since the "pooled" beta estimates the true beta process only under the null, the above
2

estimate of the residual component is asymptotically orthogonal to the risk factor only when beta is constant.
Our test is formed by splitting the data into blocks of decreasing length and forming test statistics for constant beta on each of the blocks. This is similar to block-based estimation of volatility functionals in high-frequency setting developed in Mykland and Zhang (2009) and Jacod and Rosenbaum (2013). The test statistics on the blocks are based on the different asymptotic behavior under the null and alternative of our estimate of the residual component defined in the previous paragraph. Our test is then formed by summing the test statistics over the blocks and appropriately scaling the resulting sum. The test is asymptotically standard normal under the null and after scaling it down it converges to a volatility weighted measure of dispersion of the beta around its volatility weighted average on the fixed time interval.
There are three distinctive features of our test. First, the test is pathwise in the sense that it tests whether beta is constant or not on the observed path. Hence the analysis here is based on in-fill asymptotics and it requires neither assumptions regarding the sources of the variation in beta nor stationarity and ergodicity conditions. Second, our test statistic is of self-nomalizing type (see de la Pena et al. (2009)) and hence its limiting distribution under the null is pivotal, i.e., it does not depend on "nuisance parameters" like the stochastic volatilities of the two processes. Finally, we can show that our test is asymptotically optimal for local nonparametric alternatives t that are -Ho®lder regular. The separation rate of a weighted L2-distance between hypothesis and alternative is n-2/(4+1), for which a minimax lower bound proves its optimality. This analysis also provides a rationale for selecting the block size, depending on which kind of alternatives we would like to discriminate. Let us also remark that a simple test based on the difference of a nonparametric estimator of t from a constant (e.g. its mean) would be suboptimal in separating only alternatives of weighted L2-distance of order n-/(2+1).
We compare next our test with related existing work. First, there is an enormous amount of literature on parameter shifts and breaks (Kejriwal et al., 2013, and references therein), but the results are all based on a long span ergodic-type theory rather than fixed length in-fill conducted here. Second, Ang and Kristensen (2012) propose a test for constant beta based on a Hausman type statistic that compares a nonparametric kernel-based estimate of betas at fixed time points and a long-run estimate of beta. Ang and Kristensen (2012) do not consider formally the role of the discretization error in their analysis. By contrast, we rely here solely on a fixed span and the associated in-fill asymptotics, and we are interested in checking whether beta is constant on the whole time interval, not only at fixed points in time. Thus, intuitively, our test checks for constancy
3

of beta on an asymptotically increasing number of blocks of shrinking time span. Third, Todorov and Bollerslev (2010), Kalnina (2012) and Aue et al. (2012) consider tests for constant integrated betas, i.e., deciding whether integrals of betas over fixed intervals of time such as days or weeks are the same. Unlike these papers, we are interested in deciding whether the spot beta process remains constant within a fixed interval of time which is a stronger hypothesis and requires essentially conducting testing on blocks of shrinking time span. Finally, our work is related to Mykland and Zhang (2006). In the pure diffusive setting (i.e., without jumps), Mykland and Zhang (2006) are interested in estimating the residual component of the asset without any assumption regarding whether the beta remains constant or not while our interest here is in testing the latter.
We find satisfactory performance of our estimator on simulated data. In an empirical application we study the appropriate time window width over which market betas of four different assets remain constant. For most of the assets we study we find such a window to be at least as long as a week while for one of the assets our test rejects in a nontrivial number of weeks the null of constancy.
The rest of the paper is organized as follows. In Section 2 we introduce our formal setup. In Section 3 we develop the test, analyze its behavior under the null and alternative hypothesis, and study its optimality. Section 4 contains a Monte Carlo analysis of the finite sample performance of the test and in Section 5 we apply the test to study time-variation of market betas. Section 6 concludes. Proofs are in Section 7.

2 Setup and notation

We start with introducing the setting and stating the assumptions that we need for the results

in the paper. The underlying bivariate process (Xt, Yt) is defined on a filtered probability space

(, F , (Ft)t0, P). It is assumed to have the following general dynamics

t t

 t

Xt = X0 + sX ds + sdWs +

X (s, x)µ(ds, dx),



0 t



0 t

0

E t

 t

Yt = Y0 + sY ds + ssdWs + sdWs +

Y (s, x)µ(ds, dx),

00

0 0E

(1)

where X , Y , ,  and  are processes with c`adla`g paths; W and W are two independent Brownian

motions; µ is Poisson measure on R+ ◊ R with compensator dt  dx; X (t, x) and Y (t, x) are two

predictable functions. We note that for the last integrals in (1) to make sense, we need jumps to be

absolutely summable on finite time intervals. We do, therefore, implicitly rule out jumps of infinite

variation in our analysis. This is similar to prior work on estimation of integrated volatility because

infinite variation jumps necessarily spoil inference on the diffusion part of the processes, cf. Jacod

and Reiﬂ (2012).

4

We further assume that the volatility processes  and  are themselves It^o semimartingales,

i.e., they have representations of the form

t t t t

t = 0 + sds + sdWs + sdWs + s dWs

 t 0

0

0 t 

0

+ ((s, x))µ(ds, dx) + ((s, x))µ(ds, dx),

0



E t

t



0 t

E

t

t = 0 + sds + sdWs + sdWs + s dWs

 t 0

0

0 t 

0

+ ((s, x))µ(ds, dx) + ((s, x))µ(ds, dx),

0E

0E

(2)

where W  and W  are two Brownian motions, having arbitrary dependence, but independent from

(Wt, Wt); µ(dt, dx) = µ(dt, dx) - dt  dx is the compensated jump measure; (∑) is a continuous function with bounded domain and with (x) = x in a neighborhood of zero, (x) = x - (x); , , , , , ,  and  are processes with c`adl`ag paths; (t, x) and (t, x) are two

predictable functions.

We note that the specification in (1)-(2) is very flexible and allows for most of the stochastic

volatility models considered in empirical work. We also allow for arbitrary dependence between

the Brownian motion and Poisson measure driving X and the volatility processes. We state our

assumptions for (1)-(2) in the following.

Assumption A. For the process defined in (1)-(2) we have:

(a) |t|-1, |t-|-1, |t|-1 and |t-|-1 are strictly positive; (b) , , , , , , ,  and  are c`adl`ag adapted; X , Y ,  and  are predictable;

(c) X and Y are It^o semimartingales with locally bounded coefficients;

(d) There is a sequence Tk of stopping times increasing to infinity such that:

t  Tk = |X (t, x)|  1 + |Y (t, x)|  1  k(1)(x), |(t, x)|  1 + |(t, x)|  1  k(2)(x),

where k(1)(x) and k(2)(x) are deterministic functions on R satisfying 

|k(1)(x)|rdx < , and

|k(2)(x)|2dx < ,

RR

for some r  [0, 1].

Parts (a) and (b) of Assumption A are necessary as our inference on t depends on the presence of the diffusion components in X and Y . Part (c) of Assumption A controls the activity of the jumps in X and Y and some of our results will depend on the number r.

5

In terms of financial applications, we think of X as the systematic (observable) risk factor, e.g.,

the market, and Y as being a financial asset which contains exposure to the systematic risk factor

as well as risks orthogonal to it, e.g., idiosyncratic risks. Our interest in this paper is in the process

 which captures the exposure of Y to the diffusive risks in X. For this reason, as in Todorov and

Bollerslev (2010), we refer to t as continuous beta. Similar to Mykland and Zhang (2006), we can

define t equivalently as

t

=

dXc, Y ct dXc, Xct

,

(3)

where Xc and Y c are the continuous components of X and Y and recall the angle bracket denotes

the predictable quadratic (co)variation, see e.g., Jacod and Shiryaev (2003).

3 Main results

We proceed with formulating the testing problem that we study in the paper. We assume that we

observe

the

process

(X,

Y

)

on

the

interval

[0,

1]

at

the

equidistant

grid

0,

1 n

,

2 n

,

...,

1

for

some

n



N,

and the asymptotics in the paper will be for n  . The results, of course, extend trivially to

arbitrary time intervals of fixed length. Our interest lies in designing a test to decide whether the

stochastic spot beta process  remains constant or not on the interval [0, 1]. This is a pathwise

property and therefore we are interested in discriminating the following two events dividing the

sample space:

c = { : t() = 0() almost everywhere on [0, 1]} , v =  \ c.

(4)

The set c can be characterized in different ways. One natural way is

{ 1

( 1

)2 }

c =  : s2() ds -

s() ds = 0 ,

00

(5)

which in words means that t is constant on the interval [0, 1] if and only if its variance on that

iantfeearvsiabllwe ittehstrebsypeccotntsotrtuhcetioncgcuesptaimtioantems feoarsur01eas2sdsosc-ia(ted01

with )2vanishes. sds from the

One can then formulate high-frequency data on

(X, Y ). This can be done by forming blocks with increasing number of observations in each of them

but with shrinking time span and estimating t locally in each of the blocks, following a general

approach proposed out, however, that

in Jacod and Rosenbaum (2013) (see also Mykland and

under

the

null

of

constant

beta,

a

CLT

for

1
0

s2ds

-

(Zh0a1 ngsd(s2)0206a)s).inItJtaucronds

and Rosenbaum (2013) is degenerate and higher order asymptotics is needed. This is because the

derivatives of the test statistic with respect to the elements of the variance-covariance matrix on the

6

blocks,

used

to

construct

an

estimate

for

1
0

s2ds

-

( 1
0

)2 sds ,

vanish

under

the

null

hypothesis.

Besides, in this case we also need debiasing terms.

Therefore, we adopt here an alternative point of view to characterize c that avoids the above

complications. Suppose that we know the value of t at time t = 0. In this case, recalling that the

process  is non-vanishing on the interval [0, 1], we have

c = { : Y c - 0Xc, Xct = 0, for every t  [0, 1]} .

(6)

If Xc and Y c had constant and deterministic volatility, we would have to test for independence in

the bivariate Gaussian sample (ni Xc, in(Y c-0Xc))1 i n, where henceforth we use the shorthand

ni Z

=

Z i -Z i-1 nn

for

an

arbitrary

process

Z.

In

this

case,

the

natural

(i.e.,

uniformly

most

powerful

unbiased) test is of the form nR2 - 1 > c with the sample correlation coefficient

R

=


i

(niiXcin)X2cni i((Ycni-(Yc0-X

c) 0X

c

))2

.

(7)

The critical value c > 0 is distribution-free and derived from the finite sample result that 
n - 1R/ 1 - R2 follows a tn-1-distribution under the independence hypothesis (this follows from the exact finite sample distribution of regressions with normal errors, see e.g., chapter 1 of ?) or asymptotically from nR2  2(1). Since in our case, the volatilities are time varying we base our

test on localised statistics of this kind. In line with optimal testing for nonparametric regression

functions, cf. Section 3.4 below, the final test is based on the sum of these localised test statistics

which guarantees high power against time-varying t deviating from 0 in terms of a weighted L2-distance. With this in mind, we turn to the concrete construction of our test statistics.

3.1 The test statistics

We split the high-frequency observations into n/kn blocks with kn observations per block for kn   and kn/n  0. For some constant b  R,  > 0 and   (0, 1/2), we introduce

Cjn(b) =

n kn

jkn ni X(inY
i=(j-1)kn+1

- bni X )1{|ni X|n ,

|inY |n}.

(8)

knCjn(b)

is

an

estimate

of

[

n kn

Y c - bXc, Xc jkn
n

]

-

Y

c

-

bX c ,

X c (j-1)kn

n

which

is

zero

if

the

continuous beta is constant and b = 0. In this case, because of the shrinking time span of the

block,

for

our

purposes

Cjn(0)

will

be

equivalent

to

 (j-1)kn (j-1)kn
nn

n kn

jkn
i=(j-1)kn+1

ni W inW

asymptotically. So, conditionally on F (j-1)kn we are in the above bivariate Gaussian setting.

n

7

The analogue of the denominator of R2 in (7) is given by

Vjn(b) = Vj(n,1)Vj(n,2)(b),

Vj(n,1)

=

n kn

jkn (inX )2 1{|inX|n,
i=(j-1)kn+1

|inY |n},

(9)

Vj(n,2)(b) =

n kn

jkn (ni Y
i=(j-1)kn+1

- bni X )2 1{|inX|n ,

|ni Y |n }.

(10)

Here, however, we compensate Cjn(b)2 by Vjn(b) in the numerator, while dividing by the estimate
from the previous block, Vjn-1(b). The predictable choice of the denominator (with respect to
F (j-1)kn ) guarantees a block-wise martingale difference property and thus avoids an additional bias
n
in the case of stochastic volatilities. Thus, our test statistic takes the final form

T n(b)

=

 1 kn
2n

knn  Tjn(b),
j=2

( )2

Tjn(b) =

Cjn(b) - Vjn(b) .
Vjn-1(b)

(11)

Let us point out that for convenience all statistics Cjn(b), Vjn(b), Tjn(b) and T n(b) are scaled to have stochastic order one (under the null of constant beta).

3.2 Testing for a known constant beta
In the next theorem we formally characterize the behavior of our test statistic when we are interested in testing for a known constant beta.

Theorem

1

Grant

Assumption

A

and

let

the

sequence

(kn)

satisfy

kn





with

kn n

 0.

()

(a) If kn-1n1/4  0 and kn-1n2-(4-r)  0 with  

1 2(2-r)

,

1 2

, we have

T n(0) -L Z, in restriction to the set c,

(12)

for Z being a standard normal random variable.

(b) If kn-1n1-(2-r)  0, we have

1 nkn

T

n

(0

)

-P

1 2

1
0

(s ((s -

- 0)2s2 0)2s2 +

s2)

ds,

in restriction to the set v.

(13)

Starting with the behavior under the null hypothesis of constant beta, we see that the asymptotic limit of our statistic is standard normal and does not depend on any of the "nuisance parameters" in our model like the volatility processes  and . This is due to the fact that the statistic is of

8

"self-normalizing" type. This is very convenient for the inference process. In addition, the self-

normalization property of our statistic avoids the need of showing stable convergence (which is a

much stronger form of convergence), typically needed in high-frequency asymptotics for conducting feasible inference, see e.g., Jacod and Protter (2012). The condition on the block size kn-1n1/4  0 in part(a) of Theorem 1 is to ensure that the averaging within the blocks is sufficient so that the within-block averages are not far away from their limits. The condition kn-1n2-(4-r)  0 is to ensure that the error due to the elimination of the jumps is negligible. The user chooses , so as

with estimators of truncated type (Mancini (2009)), it is optimal to set  as close as possible to its

upper limit of 1/2. In this case, the lower bound on  in Theorem 1(a) will be satisfied (provided

r < 1). We note also that the second condition for kn in part(a) of the theorem becomes more restrictive for higher values of the jump activity as the separation of higher activity jumps from

the diffusive component is harder.

Turning to the limit of our statistic in the case of  time-varying on the interval [0, 1], given

in part (b) of the theorem, we see that the limit is a weighted average of the distance (s - 0)2.

The

weighting

is

determined

by

the

stochastic 

volatilities

s2

and

s2

over

the

interval.

The

scaling

down of the statistic is by the factor nkn, which means that higher block size kn leads to higher

rate of explosion of the statistic under the alternative. Finally, the condition for the block size in

part(b) of the theorem is very close to the analogous one under the null hypothesis in part (a) of

the theorem, provided  is selected very close to 1/2.

3.3 Testing for unknown constant beta

In most cases of practical interest, we will not know the level of beta, but instead we shall need

to estimate it under the assumption that it is constant over a given interval. We will then be

simultaneously interested in the estimated value and in the outcome of a test to decide whether it

can be assumed to have stayed constant. Thus, we need first an initial estimator of the continuous

beta over the interval. We shall use the following natural estimator

n

=

ni=in=1 1(inXni X)ni2Y1{1|{|ni Xni X||n n,

, |in |inY

Y |n |n }

}

,

which can be equivalently defined as

(14)

n

n = argmin

(inY - inX )2 1{|inX|n , |inY |n},

i=1

(15)

where the objective function in the above optimization is the empirical analogue of Y c - Xc, Y c -

Xc1. This estimator has been studied in Todorov and Bollerslev (2010) and Gobbi and Mancini

(2012).

9

When the process  varies over the time interval [0, 1], n converges in probability to  = 0101ss2ds2dss ,

(16)

which can be viewed as a volatility weighted average of the time-varying beta over the interval. 
The rate of convergence of n is n and its limiting behavior in the general case when the process

 can vary over time is given by the following lemma.

()

Lemma 1 Suppose the process (X, Y ) satisfies Assumption A and let  

1 2(2-r)

,

1 2

. Then

(

)

n n - 

-L-s

 V Z,

(17)

where Z is independent standard normal defined on an extension of the original probability space

and

V

=

( 1
0

2

[ 1 )4 (s2s4

s2ds

0

+

( 1 s2s2)ds
0

)2 s2ds

+

( 1
0

)2 ss2ds

1
0

s4ds

1 1 1 ]

- 2 ss2ds ss4ds s2ds .

000

(18)

The proof of Lemma 1 follows from the limiting results for multivariate truncated variation, see

e.g., Theorem 13.2.1 of Jacod and Protter (2012), and an application of the Delta method.

With this estimator of 0 (under the null), our test in the case of unknown beta is simply based on T n(n). Its asymptotic behavior is given in the following theorem.

Theorem

2

Grant

Assumption

A

and

let

the

sequence

(kn)

satisfy

kn





with

kn n

 0.

()

(a) If kn-1n1/4  0 and kn-1n2-(4-r)  0 with  

1 2(2-r)

,

1 2

, we have

T n(n) -L Z, in restriction to the set c,

(19)

for Z being a standard normal random variable.

(b) If kn-1n1-(2-r)  0, we have

1 nkn

T

n(n)

-P

1

1 (

(s - )2s2

) ds,

2 0 (s - )2s2 + s2

in restriction to the set v.

(20)

From part(a) of the theorem we can see that the estimation of the unknown beta has no asymptotic effect on our statistic under the null. The only difference from the testing against a known constant beta under the alternative is that now the limit of the statistic in (20) contains the averaged value . Note that the limit of (20) is a volatility weighted version of (5).

10

3.4 Testing against local alternatives and asymptotic optimality

The asymptotics under the alternative in Theorems 1(b) and 2(b) are somewhat misleading regarding the choice of the block size kn. For a fixed single alternative the test is asymptotically most powerful if kn is chosen as large as possible. This, however, is not reasonable for fixed n because on large blocks time varying betas that oscillate will give similar values for the test statistics as constant betas due to the averaging on each block. This phenomenon is well understood for testing a nonparametric regression function where the bandwidth h of a kernel smoother takes on the role of the relative block size kn/n. For a more meaningful statement local alternatives as well as uniform error probabilities should be considered.
Following Ingster and Suslina (2003) we are studying the optimal separation rate rn between the single hypothesis
H0 = {P},

for some fixed constant risk value  > 0 and the local nonparametric alternative

H1,(rn)

=

{ Pt

such

that

a.s.

t



C  (R),

1
0

t2(t - )2 t2(t - )2 + t2

dt

} rn2 , ,

where C(R) = {f : |f (t) - f (s)| R|t - s|, |f (t)| R} for all t, s  [0, 1] denotes a H®older ball

of regularity   (0, 1] and radius R > 0. In this notation it is understood that the laws Pt are defined on the path space of ((Xt, Yt), t  [0, 1]) and the nuisance parameters t2, t2 and the drift

and jump parts may vary with the parameter of interest t. The separation rate rn  0 is called minimax optimal over C(R) if there is a test n, based on

n observations, such that

()

  (0, 1)  > 0 : lim sup P(n = 1) + sup Pt(n = 0)

n

Pt H1,(rn)



holds while the infimum of the error probabilities over any possible test n remains positive:

()

  (0, 1)

~ > 0 : lim inf inf
n n

P(n = 0) + sup Pt(n = 0)
Pt H1,(~rn)

.

Our test then satisfies a minimax bound with separation rate rn = n-2/(4+1). To keep the proofs transparent, we show this only in the case when X and Y do not jump and  from the hypothesis

H0 is assumed to be known.

Theorem 3 Assume that Assumption SA in Section 7.1 holds and X (t, x) = Y (t, x) = 0 almost

surely

for

t



[0, 1].

Suppose



>

5/12

and

kn

=

4-1
n 4+1 ,

rn

=

n-2/(4+1).

Then

for

any





(0, 1)

11

and critical value c/2 under the hypothesis (i.e. lim supn P(T n()

 > 0 such that the test n = 1{Tn() > c/2} satisfies

()

lim sup P(n = 1) + sup Pt(n = 0)

n

Pt H1,(rn)

c/2) .

/2), there is a (21)

The condition  > 5/12 in the above theorem is due to the rate condition on the block size kn-1n1/4  0 in Theorem 1(a). The natural assumption for the process  is that it is itself a continuous It^o semimartingale and thus has H®older regularity  of almost 1/2. In this case the optimal block length is kn  n1/3 and the separation rate is rn  n-1/3, which is far better than the optimal nonparametric estimation rate n-/(2+1)  n-1/4.
For an adaptive choice of the optimal block length kn, without specifying the regularity  in advance, and even "parametric power" (in the sense of Theorem 1(b)) for certain parametric submodels for t, an analogue of the maximal test statistics of ? can be applied. Note that they also show that their test allows for a parametric form of the null hypothesis, assuming that the true parameter can be estimated at rate n-1/2 under the null. This estimator is plugged into the test statistics exactly in the same way as we test for unknown .
Here, we focus on the non-obvious question of optimality. We shall derive a lower bound on the separation rate for the even smaller subclass of pure Gaussian martingales, where neither jumps nor drift terms appear in (X, Y ) and where the volatilities are deterministic. Already in this subclass no other test can have a smaller minimax separation rate than rn = n-2/(4+1), which then, of course, extends to the more general model for which our test is designed. Our test is thus indeed minimax optimal.

Theorem 4 Assume that Assumption SA in Section 7.1 holds, tX = tY = X (t, x) = Y (t, x) = 0

almost surely for t  [0, 1], and t and t are deterministic. Then for any   (0, 1],   (0, 1)

there is a ~ > 0 such that for rn = n-2/(4+1) and arbitrary tests n

()

lim inf inf
n n

P(n = 1) + sup Pt(n = 0)
Pt H1,(~rn)

.

(22)

4 Monte Carlo study

We now evaluate the performance of our test on simulated data from the following model



dXt = VtdWt + dLt, dYt = tdXt + VtdWt + dLt, 



dVt = 0.03(1 - Vt)dt + 0.18 VtdBt, dVt = 0.03(1 - Vt)dt + 0.18 VtdBt,

(23)

12

where (W, W , B, B) is a vector of independent standard Brownian motions; L and L are two pure-

jump L¥evy processes, independent of each other and of the Brownian motions, each of which with characteristic triplet (0, 0, ) for a zero truncation function and (dx) = 1.6e-2|x|dx. V and V

in (23) are square-root diffusion processes used extensively in financial applications for modeling

volatility. For the process , we consider

H0 : t = 1 and Ha : dt = 0.03(1 - t)dt + 0.18tdBt,

(24)

for B being a Brownian motion independent from the Brownian motions in (23). The parameters of the model are calibrated to real financial data. In particular, the means of Vt and Vt are set to 1 and they are both persistent processes (our unit of time is a trading day and returns are in percentage). Jumps in X and Y have intensity of 0.4 jumps per day and 0.8 jumps per day respectively. The variances of the jump components of both X and Y are 40% that of their continuous components (on any fixed time interval).
The observation scheme is similar to that of our empirical application. We set 1/n = 38, which corresponds to sampling every 10 minutes in a 6.5 hours trading day. In the application of the test, we set kn = 19 which corresponds to constructing two blocks per unit of time (which is day). We test for constant beta on an interval of length of T = 5 (week), T = 22 (one month) and T = 66 (one quarter) by summing the test statistics over the T days.
The results from the Monte Carlo, which is based on 1000 replications, are reported in Table 1. The test performs reasonably in finite samples. In particular, the actual rejection rates are in the vicinity of the nominal ones under the null hypothesis of constant beta across the three intervals T = 5, T = 22 and T = 66. We notice a bit of over-rejection at the 1% level across the three intervals. Turning to the power of the test, not surprisingly we note that the power increases with T , with the power against the considered time-varying beta model being lowest for the case T = 5. Intuitively, more observations (higher T ) allow us to better discriminate the noise in the recovery of  from its true time variation.

5 Empirical application
The test for constant market beta is conducted on four assets sampled at the 10-minute frequency over the period 2006≠2012. We refer to them by ticker symbol: IBM, XOM (Exxon Mobil), GLD (an Exchange-traded Fund (ETF) that tracks the price of gold), and BAC (Bank of America). IBM and XOM are both very stable large-cap stocks; GLD (or gold) is a storable asset that provides a hedge against general macroeconomic risks, while BAC went through stressful episodes with large

13

Table 1: Monte Carlo Results

Interval

Significance Level (Percent)

week month quarter

10.0 5.0 1.0
Constant Beta 7.11 4.70 2.30 10.50 6.30 3.00 10.70 7.10 3.10

10.0 5.0

1.0

Time-Varying Beta

12.64 8.95 45.97 39.43 83.20 79.50

5.07 29.17 72.20

price fluctuations during the global financial crises. The market index is SP Y , the ETF that tracks the S&P 500 index.
Each 10-minute data set consists of 1746 days of 38 within-day returns (log-price increments), and the tests are conducted at the weekly, monthly, and quarterly time intervals. A week consists of five consecutive trading days, while the calendar months and quarters contain (on average) 22 and 66 trading days, respectively. We use the term windows for these time segments. The test is implemented exactly as in the Monte Carlo, in particular we set the block size to kn = 19.
Table 2 shows the observed rejection rates of the test for constant, but unknown, beta over the three windows for different size levels and each of the four securities. Starting with IBM, for the weekly window there is little evidence against the null of constant beta at the 10 and 5 percent levels and only slightly so at the 1 percent level (but recall from the Monte Carlo that at 1% our test is slightly over-rejecting in finite samples). On the other hand, the observed rejection rates are somewhat above nominal for a monthly window and well above nominal for a quarter interval. We detect a very similar pattern for XOM. Mainly, at the weekly window there is no strong statistical evidence for time-varying betas while the rejection rates of the test for constant betas increases well above nominal levels as we move from a monthly to a quarterly window. We note that the evidence for time-variation in the market beta of XOM at the monthly and quarterly level is quite stronger than that for IBM. Interestingly for GLD the results are much the same, despite the fact that gold is just a storable commodity with negative cost of carry and used largely as a reserve asset in contrast to IBM and XOM, two huge profitable enterprizes. Taken together, the results suggest that for IBM, XOM and GLD, a weekly window would be a safe choice for treating market beta as constant in an asset pricing study.
On the other hand, the conclusions from Table 2 for BAC are far different. The betas appear unstable for any testing window at all three nominal frequencies. In retrospect, this instability might
14

Table 2: Tests for Constant Market Betas

Interval

Significance Level (Percent)

10.0 5.0 1.0

10.0 5.0 1.0

IBM

XOM

week 10.60 6.59 3.72 month 20.24 10.71 7.14 quarter 42.86 39.29 14.29

10.60 8.02 3.44 29.76 21.43 16.67 57.14 50.00 28.57

week month quarter

7.74 22.62 64.29

GLD
5.16 2.87 16.67 9.52 50.00 39.29

14.61 38.10 78.57

BAC
10.89 30.95 71.43

6.02 23.81 57.14

Note: See text for securities associated with the ticker symbols. For each specified window length, the table shows the percent of all windows for which the hypothesis of constant but unknown beta is rejected at the specified nominal level.

not be surprising given the changing corporate structure and regulatory environment experienced by this company over the period 2006--2012. The outcomes in the table suggest it would be misguided and perhaps misleading to undertake an asset pricing test of BAC treating its market beta as constant over any of the considered windows.
Figure 1 shows time series of the weekly estimated market betas based on the pooled estimator in (14). The contrasts are especially interesting when viewed in the context of the test results in Table 1 and also keeping in mind that the sample contains the most turbulent financial episode in many decades. Starting with IBM, we see from Figure 1 no significant pattern in the time series variation of its weekly market beta. Most of the weekly IBM market beta variation can be attributed to sampling error in its estimation. This is consistent with our test results in Table 2 and in particular the relatively low rejection rates for constancy of beta even over a time window of a month. Again consistent with our test results in Table 2 we see more time variation in the XOM market betas. Particularly noticeable is the period of July-August 2008 during which the market beta of XOM is quite low. Another interesting episode is that of May 2011 during which XOM's market beta was much higher than its average level.
Turning to GLD, we see a lot of variation in its sensitivity towards the market over the analyzed period. Perhaps not surprisingly, during bad times, such as the 2008 global financial crisis and the subsequent European monetary crises, GLD market beta is negative as during these periods gold
15

 


1.4 1.2
1 0.8 0.6 0.4 0.2
2006

Figure 1: Estimated Betas Using Weekly Windows
IBM XOM 2

1.5

1

0.5

2008

2010

2012

0 2006

2008

2010

1 0.5
0 -0.5
2006

GLD

2008

2010

2012

4 3 2 1 0 2006

BAC

2008

2010

2012 2012

serves the purpose of a hedging financial instrument. On the other hand, during normal times gold has little (positive) market sensitivity and it acts more like a pure commodity. Finally for BAC, and completely in accordance with our results in Table 2, we see very clear and persistent time variation. Over the period of 2006 until 2012, BAC market beta gradually increases from around 1 to around 2. Along the way of this gradual increase, we notice spikes in market beta around periods of crises such as the one in the Fall of 2008.
6 Conclusion
We propose a nonparametric test for constant beta over a fixed interval of time from discrete observations of an asset and a risk factor with asymptotically vanishing distance between observations. The test is based on forming test statistics for constant beta over blocks with asymptotically increasing observations within them and shrinking time span and then summing them and scaling
16

appropriately the resulting sum. The test is of self-normalized type which makes its limiting distribution under the null pivotal and independent from nuisance "parameters" such as the stochastic volatilities of the underlying processes. We show asymptotic optimality for local nonparametric alternatives that are ≠H®older regular. We find satisfactorily performance on simulated data in a Monte Carlo. In an empirical application we study the time window over which market betas of four different assets can be assumed to remain constant.

7 Proofs

Throughout the proofs we will denote with K a constant that does not depend on n and the indices i and j, but only on the characteristics of the multivariate process (X, Y ) and the powers involved in

the estimates below,(and fur)ther K can chang(e from )line to line. We will further use the shorthand

notation Eni (∑) = E

∑|F i-1 n

and Pin (∑) = P

∑|F i-1 n

.

We start with some auxiliary notation to be used throughout the proofs. For arbitrary b  R,

we denote

Cjn(b)

=

n kn

jkn inXc(ni Y c
i=(j-1)kn+1

-

bin X c ),

Vjn(b) = Vj(n,1)Vj(n,2)(b),

Vj(n,1)

=

n kn

jkn (inXc)2 ,
i=(j-1)kn+1

Vj(n,2)(b)

=

n kn

jkn (inY
i=(j-1)kn+1

c

-

binXc)2 ,

T n(b)

=

 1 kn
2n

knn  Tjn(b),
j=2

( )2

Tjn(b) =

Cjn(b) - Vjn(b)

Vjn-1(b)

,

where recall Xc and Y c are the continuous parts of the processes X and Y . We also use the

following shorthand notation
t t Ytc = sds + sdWs,
00

s = sY - 0sX ,

and we further set

Xsn

=

Xsc

-

X

c
i-1

,

n

[]

Ysn

=

Ysc

-

Y

c
i-1

,

n

for s 

i-1 i ,.
nn

Finally, we denote

{} Bn = |n - |  n-1/2 ,

for some arbitrary small positive numbers  > 0 and  > 0.

17

7.1 Localization

We will proof the results under the following stronger assumption: Assumption SA. For the process defined in (1)-(2) we have:

(a) |t| and |t| are uniformly bounded from below and above; (b) , , , , , , ,  and  are bounded; X , Y ,  and  are bounded;

(c) the coefficients in the It^o semimartingale representations of X and Y are bounded;

(d)

|X (t, x)| + |Y (t, x)|  (1)(x) for all |(t, x)| + |(t, x)|  (2)(x) for all t

t 

 1 with 
1 with R


R

|

(1)(x)|r

dx

<

|(2)(x)|2dx < ;



for

some

r



(0, 1);

Extending the results to the case when only the weaker assumption A holds follows from standard localization procedure as in Lemma 4.4.9 of Jacod and Protter (2012).

7.2 Preliminary results

Lemma 2 Under assumption SA and t = 0 for t  [0, 1], we have

E (j-1)kn

(Cjn(0)2

-

Vjn

(0

) )

n

 K ( kn  1

) .

nn

(25)

Proof of Lemma we have Cjn(0) =

2.nknFirsjit=k,n(wj-e1d)kenr+iv1esinoXmecbinoYuncd. sAfoprpClyjnin(g0I)t2^o.

Note that for t = formula and since

0 on t  [0, 1], Wt and Wt are

orthogonal, we have

( i

i )

Ein-1(inXcinY c) = Ein-1

n i-1

Xsnsds

+

n i-1

YsnsX ds

.

nn

Next, given the It^o semimartingale assumption for the processes X and Y , as well as an appli-

cation of Cauchy-Schwarz and Burkholder-Davis-Gundy inequalities, we have

( i

i )

Ein-1

n i-1

Xsn(s

-

 i-1 )ds
n

+

n i-1

Ysn(sX

-

Xi-1 )ds
n

K  n2 .

nn

From here, using the definition of the processes Xn and Y n, we have altogether

|Eni-1(ni XcinY c)|



K n2 .

(26)

Next, using It^o formula we have

(i

 i )(  i

i )

(ni Xc)2(ni Y c)2 =

2

n i-1

XsndXsc

+

n i-1

s2ds

2

n i-1

YsndYsc

+

n i-1

s2ds

.

n n nn

18

Applying Cauchy-Schwarz and Burkholder-Davis-Gundy inequalities, and using the independence

of Wt and Wt, we get

( i

i )

Ein-1

n i-1

XsndXsc

n i-1

YsndYsc

 n2Kn .

nn

(27)

Further using the It^o semimartingale assumption for t, Cauchy-Schwarz and Burkholder-Davis-

Gundy inequalities, we have

( i

i

)

( i

i

)

Eni-1

n i-1

XsndXsc

n i-1

(s2

-

2i-1
n

)ds

+ Ein-1

n i-1

YsndYsc

n i-1

(s2

-

2i-1
n

)ds

 n2Kn .

nn

nn

(28)

Finally using the definition of Xn and Y n, exactly as in (26) above, we get

( i

)

( i

)

Eni-1

n i-1

XsndXsc

+ Eni-1

n i-1

YsndYsc

K  n2 .

nn

(29)

Combining the bounds in (26)-(29), we get

E (j-1)kn
n

(Cjn(n))2

=

n2 kn

jkn

E (j-1)kn

i=(j-1)kn+1

n

( i n
i-1 n

i

s2ds

n i-1

n

) s2ds

+ Rj(n,1),

where

Rj(n,1)



K

( kn



1

) .

nn

We turn next to Vjn(0). Using It^o formula, we can write

  

Vj(n,1) Vj(n,2)

= (0

)knn=(k2nn((jjk2n-nn1)k(jjnkn-nX1)ksnndYXsnscd+Ysc

)
jkn
+(jn-n1)(kjjnkn-n1)ks2ndss2d,s)

.

nn

(30) (31)

From here, using similar bounds to the ones derived in (27)-(29), we get

E (j-1)kn
n

(Vjn(0))

=

n2

E2 kn

(j-1)kn n

( jkn n
(j-1)kn n

 jkn

s2ds

n (j-1)kn

n

) s2ds +

Rj(n,2),

where

Rj(n,2)

 K . n

(32)

Given the bounds for the conditional expectations of the residual terms Rj(n,1) and Rj(n,2), we are

left with the difference

n2 kn

jkn

E (j-1)kn

i=(j-1)kn+1

n

( i n
i-1 n

i

s2ds

n i-1

n

) s2ds -

n2

E2 kn

(j-1)kn n

( jkn n
(j-1)kn n

 jkn

s2ds

n (j-1)kn

n

) s2ds .

19

Using the It^o semimartingale representation of 2 and 2 in (2) and Cauchy-Schwarz inequality,

we have

|E (t2 - u2|Fu) | + |E (t2 - u2|Fu) |  K|t - u|, u  t, |E ((t2 - u2)(t2 - u2)|Fu) |  K|t - u|, u  t.

Using these inequalities as well as the algebraic identity

x1y1 - x2y2 = (x1 - x2)(y1 - y2) + x2(y1 - y2) + (x1 - x2)y2 for any real x1, x2, y1, y2,

we have

( i

i

)

E (j-1)kn
n

n i-1

s2ds

n i-1

s2ds

-

1 n2

2 (j-1)kn n

2 (j-1)kn n

nn



K

kn n3

,

i = (j - 1)kn + 1, .., jkn,

E (j-1)kn
n

( jkn n (j-1)kn

 jkn

s2ds

n (j-1)kn

s2ds -

)

2

kn 2

2

 2 (j-1)kn (j-1)kn nn n

nn

 K ( kn )3 . n

Combining these results with the bounds in (30) and (32), we get the result to be proved.

Lemma 3 Under assumption SA and t = 0 for t  [0, 1], we have

E (j-1)kn
n

Vjn(0) -

n2 kn2

 jkn n
(j-1)kn n

 jkn

s2ds

n (j-1)kn

n

s2ds

2



K .
kn

(33)

Proof of Lemma 3. We make use of (33) as well as the boundedness of the processes 2 and 2, to bound

E (j-1)kn
n

Vjn(0) -

n2 kn2

 jkn n
(j-1)kn n

 jkn

s2ds

n (j-1)kn

n

s2ds

2

 K E (j-1)kn
n

Vj(n,1)

-

n kn

 jkn n (j-1)kn

s2ds

2

+ K E (j-1)kn
n

n

Vj(n,2)(0) -

n kn

 jkn n (j-1)kn

s2ds

2

n

+ K E (j-1)kn
n

Vj(n,1)

-

n kn

 jkn n (j-1)kn

s2ds

4

+

K E (j-1)kn
n

n

Vj(n,2)(0)

-

n kn

 jkn n (j-1)kn

s2ds

4

.

n

Using the decomposition of Vj(n,1) and Vj(n,2)(0) in (31) and applying the Burkholder-Davis-Gundy inequality we get the result to be proved.

Lemma 4 Under assumption SA and t = 0 for t  [0, 1], we have

E (j-1)kn

(Cjn(0)2

-

Vjn(0))2

-

2 4 4 (j-1)kn (j-1)kn

n nn



K

[( kn

)1/2-



1

] ,

n kn

 > 0.

(34)

20

Proof of Lemma 4. We first denote the analogues of Cjn(0) and Vjn(0), with s and s kept at their values at the beginning of the block, as

C

n j

=

n  (j-1)kn (j-1)kn

kn n

n

jkn inW inW ,
i=(j-1)kn+1

V

n j

=

2

n2 2

 2 (j-1)kn (j-1)kn

kn n

n

jkn (ni W )2

jkn (ni W )2.

i=(j-1)kn+1

i=(j-1)kn+1

Using Burkholder-Davis-Gundy inequality for discrete martingales, we have

E (j-1)kn

C

n j

p



K,

E (j-1)kn

V

n j

p



K,

p  2.

nn

(35)

Using the algebraic identity x2 - y2 = (x - y)2 + 2y(x - y) as well as Cauchy-Schwarz inequality

and (35), we can write

E (j-1)kn

(Cjn(0)2

- Vjn(0))2

- E (j-1)kn

( (C

jn)2

-

V

n)2
j

n



( K  E (j-1)kn

(Cnjn(0)2

-

(C

n j

)2)2

)

+

( K  E (j-1)kn

(Vjn(0)

-

V

n)2
j

)

,

(36)

nn

 for (u) = u  u. Next, applying the It^o formula as well as the It^o semimartingale assumption

for the process X , we have

() Eni-1 inX c -  (j-1)kn ni W inY c
n



K

kn n2

.

From here, using Burkholder-Davis-Gundy inequality for discrete martingales, together with our

assumption for  being It^o semimartingale, It^o formula and the independence of Wt from Wt, as well as H®older inequality, we have for every p  1 and any  > 0

E (j-1)kn
n

n kn

jkn ( in X c
i=(j-1)kn+1

) -  (j-1)kn inW ni Y c
n

p



K ( kn )(p/2)1- . n

Similar analysis implies

E (j-1)kn
n

n kn

jkn ni W
i=(j-1)kn+1

( ni Y

c

-

 (j-1)kn
n

) inW

p



K

( kn )(p/2)1- n

,

and therefore

E (j-1)kn
n

Cjn(0)

-

C

n j

p



K

( kn )(p/2)1- n

.

(37)

Combining this result with the bound in (35), together with Cauchy-Schwarz inequality, we get

E (j-1)kn
n

(Cjn(0)2

-

(Cnj )2)2



K

( kn )1- . n

(38)

21

We

turn

to

bounding

E (j-1)kn

( Vjn

(0

)

-

V

nj )2.

Using inequality in means, i.e.,

n
i=1

|xi|p

n

for

any

p1

and

n
any

real

{xi}i=1,..,n,

we

first

have

for

p1

n i=1

xi

p

n

E (j-1)kn
n

 n
kn

jkn [ (ni Xc)2
i=(j -1)kn +1

+

(inY

c)2

+

2 (j-1)kn

(ni W

)2

n

+

2 (j-1)kn n

]p (ni W )2 



K.

Using the algebraic identity x2 - y2 = (x - y)2 + 2y(x - y), the Burkholder-Davis-Gundy inequality

for discrete martingales, It^o formula for the function f (x, y) = xy, our assumption for  being It^o

semimartingale, we have for any  > 0

E (j-1)kn
n

n kn

jkn [ (ni Xc)2
i=(j-1)kn+1

-

2 (j-1)kn n

] (ni W )2

p



K

( kn )1- n

,

p  2,

and similarly

E (j-1)kn
n

n kn

jkn [ (ni Y
i=(j-1)kn+1

c)2

-

2 (j-1)kn n

] (ni W )2

p



K

( kn )1- n

,

p  2.

Using the above inequalities and H®older inequality, we have

E (j-1)kn
n

(Vjn(0)

-

V

n)2
j



K

( kn )1- n

,

 > 0.

(39)

Altogether, combining the bounds in (36), (38) and (39), we get

E (j-1)kn

(Cjn(0)2

- Vjn(0))2

- E (j-1)kn

( (C

nj )2

-

V

n)2
j

nn

 K ( kn )1/2- , n

 > 0.

(40)

We

are

thus

left

with

E (j-1)kn

( (C

nj )2

- V nj )2.

First, using finite sample distribution results for

n

regressions with normally distributed errors, see e.g., ?, we have

(C

n j

)2

V

n j

1

-

1 kn

(C jn )2

V

n j

=d

kn kn -

1

t2kn

-1

=

(C

n j

)2

V

n j

=d

1

+

tk2n-1

1 kn

(tk2n

-1

-

, 1)

where tk denotes a random variable, having a t-distribution with k degrees of freedom. Therefore,

for kn > 7 (so that the tkn-1-distribution has finite sixth moment), using the moments of the

t-distribution, we have

E (j-1)kn
n

( (Cjn)2

V

n j

)2 -1

-2

K .
kn

Second, using Burkholder-Davis-Gundy inequality for discrete martingales, we have

E (j-1)kn
n

( V

n)2
j

-

4 (j-1)kn

4 (j-1)kn

nn

p


K knp/2 ,

p  2.

22

Combining the above bounds, and using H®older inequality, we have for kn > 6

E (j-1)kn

( (C

jn)2

-

V

n)2
j

- 2 4 4 (j-1)kn (j-1)kn

n nn

 K . kn

The result of the lemma then follows from (40) and (41).

(41)

Lemma 5 Under assumption SA and t = 0 for t  [0, 1], for any constant  > 0, we have

E (j-1)kn Cjn(0) p + E (j-1)kn Vj(n,1) p + E (j-1)kn Vj(n,2)(0) p  K, p  1, n nn

( P

Vj(n,1)

-

n kn

 jkn n (j-1)kn

s2ds

n



n 
kn

 jkn n
(j-1)kn n

) s2ds



K knp/2 ,

p  1,

( P

Vj(n,2)(0) -

n kn

 jkn n (j-1)kn

s2ds

n



n 
kn

 jkn n
(j-1)kn n

) s2ds



K knp/2 ,

p  1,

where the constant K in the above bounds depends on the constant .

(42) (43) (44)

Proof of Lemma 5. Using Burkholder-Davis-Gundy inequality for discrete martingales, we have

E (j-1)kn
n

n kn

jkn
i=(j-1)kn+1

[ (ni Xcni Y

c)

-

Eni-1 (in X c in Y

] c)

p



K.

Using this bound together with the bound for Eni-1(ni XcinY c) in (26), we get the bound for Cjn(0) in (42). The bounds for Vj(n,1) and Vj(n,2)(0) in (42) follow from inequality in means.
Next using the decomposition of Vj(n,1) and Vj(n,2)(0) in (31), we have by an application of

Burkholder-Davis-Gundy inequality

  E (j-1)kn
n
 E (j-1)kn
n

Vj(n,1)

-

n kn

 jkn n (j-1)kn

s2ds

p



n

Vj(n,2)(0)

-

n kn

 jkn n (j-1)kn

s2ds

n

,K
knp/2

p

p



,K
knp/2

 1, p 

1.

From here, using the boundedness of the processes || and ||, both from below and above, we get

the bounds in (43) and (44).

Lemma 6 Under Assumption SA for any constant  > 0 and provided n2/kn  0, for  being the constant in the definition of the set Bn, we have

E (j-1)kn
n

( 

1 kn

Cjn

(n)

-

n kn

 jkn n
(s
(j-1)kn n

)2

 

- )s2ds 1{Bn}



K ,
kn

(45)

E (j-1)kn
n

(  Vj(n,1) -

n kn

 jkn n (j-1)kn

)2

 

s2ds 



K ,
kn

n

(46)

23

E (j-1)kn
n

(  Vj(n,2)(n) -

n kn

 jkn n ((s (j-1)kn

- )2s2

)2

 

+ s2)ds 1{Bn}



K ,
kn

n

( P

Vj(n,1)

-

n kn

 jkn n (j-1)kn

n

s2ds

 jkn nn

1{Bn }

>

 kn

(j-1)kn

n

) s2ds 

K knp/2 ,

p  1,

( P

Vj(n,2)(n)

-

n kn

 jkn n (j-1)kn

((s

-

n)2s2

+

s2)ds

n

 jkn nn

1{Bn }

>

 kn

(j-1)kn

n

) s2ds 

K knp/2 ,

p  1.

(47) (48) (49)

Proof of Lemma 6. Using It^o formula, we have

1 kn

Cjn(n)

=

n kn

 jkn n (s (j-1)kn n

- n)s2ds

+

n kn

 jkn n (j-1)kn

XsndYsc

+

n kn

 jkn n (j-1)kn

YsndXsc

-

2n

n kn

 jkn n (j-1)kn

XsndXsc.

nn

n

From here using the definition of the set Bn and applying the Burkholder-Davis-Gundy inequality,

we have the result in (45). The results in (46) and (47) are shown in exactly the same way. Finally, the bounds on the probabilities in (48) and (49) follow from the fact that on Bn, n is bounded as well as an application of the Burkholder-Davis-Gundy inequality.

Lemma 7 Under Assumption SA, and with n~/kn  0 for some ~ > 0, for any bounded random

variable b and n sufficiently high, we have

E (j-1)kn
n

Vj(n,1) - Vj(n,1) p + E (j-1)kn Vj(n,2)(b) - Vj(n,2)(b) p

(n

)

K

np-1-(2p-r) knp-1

 n-p(2-r)

,

for p = 1, p = 2 and p = 4,

E (j-1)kn

Cjn(b)

-

Cj (b)

2



K

( n1-(4-r)



) knn-2(2-r) ,

(n )

P |Vjn(n) - Vjn(n)|1{Bn} >   Kn-(2-r),  > 0.

(50)
(51) (52)

Proof of Lemma 7. In the proof we use the shorthand notation

Cin = {|ni X|  n , |inY |  n} .

We can decompose

Vj(n,1)

-

Vj(n,1)

=

-n kn

jkn (ni X c)21{(Cin)c}
i=(j-1)kn+1

+

2n kn

jkn inXcinXj 1{Cin}
i=(j-1)kn+1

+

n kn

jkn (inXj )21{Cin},
i=(j-1)kn+1

24

Vj(n,2)(b) - Vj(n,2)(b)

=

n kn

jkn (in,1)(b),
i=(j-1)kn+1

i(n,1)(b) = -(inY c - binXc)21{(Cin)c},

(in,2)(b) = (ni Y j - bni Xj )21{Cin}, i(n,3)(b) = 2(inY c - binXc)(ni Y j - binXj )1{Cin},

where we denoted Xj = X - Xc and Y j = Y - Y c. We then have for p  1 and  > 0

[

]

 Ein-1 [(ni Xc)2p1{(Cin)c} + |(in,1)(b)]|p  Kn-p-1+r+,



Eni-1 [(ni Xj )2p1{Cin} + |(in,2)(b)|p



K n-1-(2p-r) , ]

Ein-1 |inXcni Xj 1{Cin}|p + |(in,3)(b)|p  Kn-1-p/2-(p-r)+.

(53)

Combining these results, using successive conditioning, we have the result in (50). We next turn to (51). We have

Cjn(b)

-

Cj (b)

=

n kn

jkn (ai
i=(j-1)kn+1

+

bi

+

ci

+

di) ,

ai = -inXc(ni Y c - binXc)1{(Cin)c}, bi = ni Xc(ni Y j - bni Xj )1{Cin},

ci = ni Xj (inY c - binXc)1{Cin}, di = ni Xj (ni Y j - binXj )1{Cin}.

 

Ein-1|ai|  Kn-2+r+,

Ein-1|ai|2  Kn-3+r+,



Ein-1(|bi| + |ci|)  Kn-3/2-(1-r)+, Eni-1|di|  Kn-1-(2-r), Ein-1|di|2

Ein-1(|bi|2 + |ci|2)  Kn-2-(2-r)+,  Kn-1-(4-r).

(54)

From here, using successive conditioning, we have the result in (51). We finally show (52). For

some sufficiently big constant  > 0 and sufficiently high n, taking into account the definition of

the set Bn, we have

(

)(

)

P |Vjn(n) - Vjn(n)|1{Bn} >   P |Vj(n,1)| + |Vj(n,2)(n)| >  + KE Vj(n,1) - Vj(n,1)

+

K

n kn

2
k=1

jkn
i=(j-1)kn+1

E|i(n,k)(

-

)|

+

K

n kn

2
k=1

jkn
i=(j-1)kn+1

E|(in,k)(

+

)|

+

K

n kn

jkn
i=(j-1)kn+1

E

[ (|in X c |

+

|inY

c|)

(|ni Xj|

+

|inY

j

) |

] 1{Cin}

,

and note that  coincides with 0 under the null hypothesis and is a bounded positive random variable otherwise under Assumption SA. From here, applying the bounds in (53) above, as well as the bounds in (48)-(49) of Lemma 6 and taking into account the rate of growth of kn, we get the result in (52).

25

7.3 Proof of parts (a) of Theorems 1 and 2.
We first prove the result for the statistic T n(n) with the result stated in the following lemma.
Lemma 8 Under Assumption SA with t = 0 for t  [0, 1] and further kn-1n1/4  0 and kn-1n  , we have
T n(n) -L Z,
for Z being a standard normal random variable.

Proof of Lemma 8. We denote the sets

Aj(n,1)

=

{

Vj(n,1)

-

n kn

 jkn n (j-1)kn

s2ds

<

1n 2 kn

 jkn n (j-1)kn

} s2ds ,

nn

A(jn,2)()

=

{

Vj(n,2)()

-

n kn

 jkn n (j-1)kn

s2ds

<

1n 2 kn

 jkn n (j-1)kn

} s2ds .

nn

We decompose

Tjn(n) - Tjn(0) = Rj(n,1) + Rj(n,2) + Rj(n,3) + Rj(n,4),

[ ]( )

Rj(n,1) =

(Cjn(n)2 - Vjn(n)) - (Cjn(0)2 - Vjn(0)) Vjn-1(0) - Vjn-1(n)

2 (j-1)kn

2 (j-1)kn

Vjn-1

(n

)

,

[

n n ](

)

Rj(n,2) =

(Cjn(n)2 - Vjn(n)) - (Cjn(0)2 - Vjn(0))

 2 2 (j-1)kn (j-1)kn

- Vjn-1(0)

nn

2 (j-1)kn

2 (j-1)kn

Vjn-1

(n

)

,

nn

Rj(n,3)

=

(Cjn(n)2

- Vjn(n)) - (Cjn(0)2  2 2
(j-1)kn (j-1)kn

- Vjn(0)) ,

n
(

n

)

Rj(n,4)

=

(Cjn(0)2

- Vjn(0)) Vjn-1(0) - Vjn-1(n) Vjn-1(0)Vjn-1(n)

.

We can further split

Tjn(0) = Tj(n,1)(0) + Tj(n,2)(0),

Tj(n,1)(0)

=

Cjn(0)2 - Vjn(0  2 2
(j-1)kn (j-1)kn

)

,

nn



Tj(n,2)(0)

=

(Cjn(0)2

-

Vjn(0))



1 Vjn-1(0)

-

1  2 2
(j-1)kn (j-1)kn

.

nn

We split the proof into several steps.

26

Step 1. We prove T (n,1)(0) -L Z. The result follows from an application of Theorem VIII.3.6

in Jacod and Shiryaev (2003). In particular, using Lemmas 2, 3, 4 and 5, we have

  

12 knjknnn=n/2knjn=jn=P/2k/2(knn{EEk(njn(-jT-n1n)1j(k)nkn,n1()((TTj(0jn()n,1,1)>()(00)F)))(j2---1P)k(nE)0(,j

-1)kn n
-P

(Tj(n,1)(0)))2} 0,  > 0.

n

-P 1,

Step

2.

We

prove


kn n

n/kn
j=2

( Tj(n,2)(0)1{A(jn-,11)



)
} A(jn-,12) (0 )

-P

0. Using Lemmas 2, 3 and

5, successive conditioning, the It^o semimartingale assumption for  and , and the definition of the

sets A(jn,1) and A(jn,2)(0), we have

n/kn
j=2

E

( Tj(n,2)

(0)1{Ajn-1}

)2



K

( n kn2



) 1

,



() E Ti(n,2)(0)1{Ain-1}Tj(n,2)(0)1{Anj-1}

i,j: i= j, i2, j2

()

K

n3/2  kn3 1 ,

where we use the shorthand notation Ajn = Aj(n,1)  Aj(n,2)(0). Combining the above three bounds, and taking into account the rate of growth condition in the Lemma, we establish the asymptotic

negligibility Step 3. We

prreosvueltofkntnhis jsn=t/e2kpn.

(

Rj(n,1)

1{
A(jn-,11)



)
} A(jn-,12) (n )

-P

0. First, we can decompose

Cjn(n)2

-

Cjn(0)2

=

kn(n

-

0)2

( Vj(n,1)

)2

-

 2 kn(n

-

0)Cjn(0)Vj(n,1),

(55)

Vjn(n)

-

Vjn(0)

=

( n

-

)2 0

(Vj(n,1))2

-

2 kn

(n

-

0)Vj(n,1)Cjn(0).

(56)

Next, using using successive conditioning, Cauchy-Schwarz inequality, as well as the bounds derived

in Lemma 5, we get

kn n

n/kn

[ E

() |Cjn(0)|Vj(n,1)(Vj(-n1,1))2

+

E

() |Cjn(0)|Vj(n,1)|Cjn-1(0)|Vj(-n1,1)

j=2
(

)(

)]

+ E (Vj(n,1))2(Vj(-n1,1))2 + E (Vj(n,1))2|Cjn-1(0)|Vj(-n1,1)  K,

 and the result of this step then follows from the n rate of convergence of n to 0 established in Lemma 1.

27

Step

4.



We prove

kn n

n/kn
j=2

(

Rj(n,2)

1{
Aj(n-,11)



)
} A(jn-,12) (n )

-P

0. Using successive conditioning,

the It^o semimartingale assumption for  and , as well as Lemma 3, we get

kn n

n/kn

E

{[ |Cjn(0)|Vj(n,1)

+

] (Vj(n,1))2

j=2

Vjn-1(0)

-

2 (j-1)kn

2 (j-1)kn

nn

}  K ( kn  1

) ,

n kn

 and from here the result to be proved in this step follows because of the n rate of convergence of

n to 0 established in

Step 5. We prove

kn n

Lemma 1 and the decomposition in (55)-(56).

n/kn
j=2

Rj(n,3)

-P

0. Given the CLT result

in

Lemma

1

for

n,

and

the

decomposition in (55)-(56), the result to be proved in this step will follow if we can show

(

kn n

)3/2

n/kn

(Vj(n,1))2

j=2

-P 0,

kn n

n/kn

() Cjn(0)Vj(n,1)

j=2

-P 0.

The first of this results follows trivially from the bound on the moments of Vj(n,1) derived in

Lemma 5. Next, application of Cauchy-Schwarz inequality, the proof of Lemma 3 and the bound

of Lemma 5 for the p-th absolute moment of Cjn(0), yields

kn n

n/kn



( Cjn

(0

)

( Vj(n,1)

j=2

-

2 (j-1)kn n

))

-P 0.

Finally, using the bound in (26) in the proof of Lemma 2, as well as successive conditioning and

Cauchy-Schwarz and Burkholder-Davis-Gundy inequalities, we get

E

 n/kn

j=2

2 Cjn(0)



K

n kn

,

and

this

implies

the

asymptotic

negligibility

of

kn n

n/kn
j=2

Cjn(0)

and

hence

the

result

to

be

shown

in this step. Step 6. We prove


kn n

n/kn
j=2

( Rj(n,4)1{A(jn-,11)



Aj(n-,12) (n )



)
} A(jn-,12) (0 )

-P 0. Using successive

conditioning, Cauchy-Schwarz inequality, as well as the bounds in Lemma 5, we get

kn n

n/kn { E

(Cjn(0))2 - Vjn(0)

[ ]} (Vj(-n1,1))2 + |Cjn-1(0)|Vj(-n1,1)  K,

j=2

 and this implies the result to be shown in this step, given the n rate of convergence of n and

the decomposition in (55)-(56).

Step 7. We prove

 kn n

n/kn

(( Tj(n,2)(0)

+

Rj(n,1)

+

Rj(n,2)

+

) Rj(n,4)

) 1{Anj-1}

j=2

-P 0,

28

for Anj

{ = A(jn,1)



Aj(n,2)(0)



A(jn,2)(n)}c.

In view of

Lemma 1, it suffices to

prove

conver-

gence on the set Bn for some sufficiently small positive numbers  > 0 and  > 0. We have

 E

 kn n

n/kn

(( Tj(n,2)

(0

)

+

Rj(n,1)

+

Rj(n,2)

+

) Rj(n,4) 1{Ajn-1

)
 Bn}

 
1

j=2



n/kn
j=2

P

( Ajn-1



) Bn



K

n kn

1 knp/2

,

p  1,

where for the last inequality, we applied Lemmas 5 and 6 and the boundedness from below of the processes || and ||. This bound implies the asymptotic negligibility to be proved in this step.

Proof of parts (a) of Theorems 1 and 2 continued. What remains to be shown is that the
difference T n(n) - T n(n) is asymptotically negligible. Recalling the definition of the set Bn, we first note that P((Bn)c)  0, therefore it suffices to focus on the set Bn only.
We decompose Tjn(n) - Tjn(n) = j(n,1) + j(n,2) + j(n,3) + j(n,4), where

j(n,1)

=

Cjn(n)2

-

Cjn(n)2 - Vjn(n) Vjn-1(n)

+

Vjn(n) ,

j(n,2)

=

Cjn(n)2

- Cjn(0)2 - Vjn(n) + Vjn(0) Vjn-1(n)Vjn-1(n)

() Vjn-1(n) - Vjn-1(n) ,

j(n,3)

=

Cjn(0)2 - Vjn(0) Vjn-1(0)Vjn-1(0)

( Vjn-1(0)

-

) Vjn-1(0) ,

(

)

j(n,4) = (Cjn(0)2 - Vjn(0))

1 Vjn-1(n)

-

1 Vjn-1(0)

-

1 Vjn-1(n)

+

1 Vjn-1(0)

.

The proof consists of several steps and we will henceforth denote with  some sufficiently small

positive Step 1.

constant. We prove



1{Bn}

kn n

n/kn
j=2

j(n,1)1{|Vjn-1(n)|>}

-P

0, whenever n1/2-(2-r)  0 and

n2-(4-r) kn



0.

This follows directly from applying the algebraic identity x2-y2

= (x-y)2+2y(x-y)

for any Step 2.

real We

x and prove

y1{, Btnh}eboknnundjon=n/2knn-j(n,2)01o{|nVjnt-h1(ense)|t>B, n|V,jn-as1(w0e)|l>l a}s

Lemmas -P 0.

5 and 7. We make

use

of

the

decomposition in (55) and (56), the bounds in Lemmas 5 and 7, the fact that n1/2-(n -0) -P 0

for arbitrary small  > Step 3. We prove 1{Bn}

0

(by Lemma 1).

kn n

n/kn
j=2

j(n,3)

1{|Vjn-1

(0

)|>,

|Vjn-1(0)|>}

-P

0,

provided

n1-

(8-r) 3

kn

 0.

This result follows from showing convergence in L2-norm, upon applying successive conditioning,

using Cauchy-Schwarz inequality and the bounds in Lemmas 2, 4 and 7.

29

Step

4.

We

prove



1{Bn}

kn n

n/kn
j=2

j(n,4)1{|Vjn-1(0)|>,

|Vjn-1(0)|>,

|Vjn-1(n)|>,

|Vjn-1(n)|>}

provided

n

1 3

-

2 3

(4-r)+

kn

0

for

some

arbitrary

small

 > 0.

-P

0,

Making use of an analogous decomposition of the difference Vjn(n) - Vjn(0) as in (56), we can

bound

11

- Vjn-1(n) Vjn-1(0)

1{|Vjn-1(0)|>, |Vjn-1(n)|>}



K kn

|n

-

0|Vj(n,1)|Cjn(0)| + K|n

- 0|2(Vj(n,1))2.

Similar analysis can be made for the term involving 1/Vjn(n) - 1/Vjn(0). From here using the convergence result for n in Lemma 1, and the results in Lemmas 4, 5 and 7, we get the result to be proved in this step.

Step 5. We prove



1{Bn}

kn n

n/kn

[ (|j(n,1)|

+

|j(n,2)|

+

|j(n,3)|

+

|j(n,4)|)

j=2

]

◊ 1{|Vjn-1(0)|<  |Vjn-1(0)|<  |Vjn-1(n)|<  |Vjn-1(n)|<} -P 0,

provided

n1-(2-r) kn



0.

Using

the

definition

of

the

set

Bn,

the

bounds

in

Lemmas

5,

6

and

7,

we

get the result of this step.

7.4 Proof of parts (b) of Theorems 1 and 2.

We

can

decompose

1 kn

Tjn

(n

)

=

(jn,1)

+



(n,2) j

+



(n,3) j

,

where

j(n,1) =

(
n kn

 jkn n (j-1)kn

(s

-

)2 )s2ds

n kn

 jkn n (j-1)kn

s2ds

n kn

n
 jkn n (j-1)kn

( (s

-

)2s2

), + s2 ds

nn



(n,2) j

=

1 kn

( Cjn(n)2

-

) Vjn(n)

-

(
n kn

 jkn n (j-1)kn

(s

-

)2 )s2ds

n

n kn

 jkn n (j-1)kn

s2ds

n kn

 jkn n (j-1)kn

( (s

-

)2s2

) + s2 ds

,

nn

(jn,3)

=

1 kn

Cjn(n)2 - Vjn(n) Vjn-1(n)

-

1 kn

n kn

 jkn n (j-1)kn

Cjn(n)2 - Vjn(n)

s2ds

n kn

 jkn n (j-1)kn

( (s

- )2s2

). + s2 ds

nn

The proof consists of the following steps in which we denote with  some sufficiently small positive

constant.

30

Step 1.

We

have

kn n

n/kn
j=2



(n,1) j

-a.s.

1
0

(s - )2 s2
((s-)2s2+s2)

ds.

This follows from convergence of

Riemann sums and the fact that the processes ,  and  have c`adl`ag paths (and hence are

Riemann integrable).

Step 2.

We

prove

kn n

n/kn
j=2

j(n,2)

-P

0, provided

n1-(4-r) kn

 0.

First, it suffices to focus

attention to the set Bn because of the bounds in Lemma 6, we have E|(jn,2)|

CLT K

(for1ninn

Lemma
1-(4-r)
2

1 

kn kn

and we
n1-(4-r) kn

do 

so. The)n using n-(2-r) , and

the this

implies the result to be shown in this step.

Step 3.

We

prove

kn n

n/kn
j=2



(n,3) j

1{|Vjn-1

(n

)|>}

-P

0, provided

n1-(4-r) kn

 0.

First,

we have

the algebraic inequality:

1 kn

Cjn(n)2

-

( n
kn

 jkn n (j-1)kn

(s

-

)2 )s2ds

Vjn-1(n)1{Bn}

n

K

1 kn

Cjn(n

)2

-

( n
kn

 jkn n (j-1)kn

(s

-

)2 )s2ds

n

Vj(-n1,1)(Vj(-n1,1) + Vj(-n1,2)(0)).

From here, using successive conditioning and Lemmas 6 and 7, we get

 E

1 kn

Cjn(n)2

-

( n
kn

 jkn n (j-1)kn

(s

-

)2 )s2ds

 Vjn-1(n)1{Bn}  Kn,

n

where we use the shorthand n

( = 1
kn

 1-(4-r)
n 2 kn

 n1-(4-r)
kn



n-(2-r)

) .

Similar analysis leads

to

( E

Vjn(n)

-

n kn

 jkn n (j-1)kn

s2ds

n kn

 jkn n (j-1)kn

( (s

-

)2s2

+

s2)

ds

) Vjn-1(n)1{Bn}  Kn.

nn

Com( bining the above )two results, it is hence sufficient to prove the result of this step in which

1 kn

Cjn(n)2 - Vjn(n)

in



(n,3) j

is

replaced

with

the

term

( n
kn

 jkn n (s (j-1)kn

)2 - )s2ds

-

1 kn

n kn

 jkn n (j-1)kn

s2ds

n kn

 jkn n (j-1)kn

( (s

- )2s2

+ s2) ds.

n nn

The last term is bounded and hence the result follows by an application of Lemmas 6 and 7.

Step 4. We

We will

prove

kn n

be done

n/kn
j=2





(n,3) j

1{|Vj(n-1(n)|}

-P

if we can show P |Vjn-1(n)|  

0 provided )
 Bn 

n1-(2-r)

K

(

kn kn

)

n

n

 0. for some

deterministic

sequence n  0. This follows from an application of the bounds in Lemmas 6 and 7, as well as

the fact that on Bn n is bounded.

31

7.5 Proof of Theorem 3.

For

a

general

process

t

we

define

Ztn

=

Yt

-

t
0

sn/ndXs

and

we

split

Cjn()

=

Cjn,X () + Cjn,Z ()

with

{

Cjn,X () Cjn,Z ()

= =

n kn
n kn

jkn jik=n(j-1)kn+1
i=(j-1)kn+1

s2i ((i-1)/n ni Xni Zn

- .

),

s2i = (ni X)2,

(57)

We further set

Vjn,X ()

=

(n kn

jkn
i=(j-1)kn+1

)( s2i

n kn

jkn si2((i-1)/n
i=(j-1)kn+1

-

) )2 ,

and

T n,X () =

1

 kn

knn 

Cjn,X ()2

-

Vjn,X () .

2

n
j=2

Vjn-1()

We start with the analysis of T n,X (). First, by the H®older property, we have

Cjn,X ()2

=

n2 kn

(

i=(j

jkn
-1)kn

+1

s2i

)(

jkn
i=(j-1)kn+1

s2i

((i-1)/n

- )2

jkn - si2((i-1)/n
i=(j-1)kn+1

) - Øj)2

n2 kn

(

jkn
i=(j-1)kn+1

)( s2i

jkn
i=(j-1)kn+1

s2i ((i-1)/n

-

)2

-

R2(kn/n)2

jkn
i=(j-1)kn+1

) si2 ,

where we denoted Øj

=

jkn
i=(j-1)kn+1

s2i (i-1)/n

/

jkn
i=(j-1)kn+1

s2i .

From here, by straight-forward

expectation and variance bounds, and taking into account the assumed rate at which kn grows

asymptotically, we find

Cjn,X ()2 - Vjn,X ()

n2 (1
kn j

- OL2
kn/n

(kn-1 (

))

 jkn/n
(j-1)kn/n

t2dt

)

◊ t2 (t - )2(1 - OL2 (kn-1)) - R2(kn/n)2(1 + OL2 (kn-1)) dt.

(j-1)kn/n

It

is

easy

to

see

that

Lemma

5

continues

to

hold

with

Yt

replaced

by

t
0

sn/n

dXs

.

Therefore,

for

any   (0, 1) there is a K > 0 such that

(

)

P Dj Kkn-1 with

j=1,...,n/kn

Dj

:=

{n kn

 jkn/n
(j-1)kn/n

t2

dt

n kn

 jkn/n
((t
(j-1)kn/n

-

)2t2

+

t2) dt/Vjn()

/

[1

-

, 1

+

} ] .

32

Hence,

we

can

asymptotically

work

on

the

event


j=1,...,n/kn

Djc

and

conclude

that

T n,X ()

is

bounded from below by

 nkn 2

knn 
j=2

(1

-

)

 jkn/n
(j-1)kn

/n

t2(t - )2dt -

n kn

 jkn/n
(j-1)kn

/n

((t

(1 + )R2(kn/n)2 - )2t2 + t2) dt

 jkn/n
(j-1)kn/n

t2dt

-

OP

(1).

The latter is, using Riemann sum approximations and the separation rn under the alternative, of

order

 nkn 2

( (1

-

)2rn2

-

(1

+

) )R2(kn/n)2

1
0

(t

-

t2 )2t2

+

t2

dt

-

OP

(1),

where we also made growth condition for

use kn.

of the fact that t2 Consequently, for

andt2

are 

It^o

 = ( 2K +

semimartingales

1)

1+ 1-

R

and

the

as well choices

as the assumed of kn and rn we

have

T n,X ()

KR2

1
0

(t

-

t2 )2t2

+

t2 dt

-

OP (1)

uniformly over the alternative The same arguments as for

and the

over K > 0, n 1. proof of Theorem 1(a),

applied

to

the

pair

( Xt,

Yt

-

t
0

) sdXs ,

the fact that dXc, (Zn)ct = (t - tn/n)t2dt is asymptotically negligible due to supt[0,1] |(t -

tn/n)t2| = OP (n-) for t  C(R), together with the bounds derived above and a Cauchy-

Schwarz bound for the cross term yield the following uniform result

T n()

( 1 KR2
0

(t

-

t2 )t2

+

t2

)2 dt

-

 OP ( K).

The right-hand side converges to + in probability as K  +. Hence, we choose K and thus 

so large that Pt(T n() c/2) > 1 - /2 on H1,(rn) holds, which implies the result.

7.6 Proof of Theorem 4.

For any sign sequence  = (j)  {-1, +1}Jn with Jn = n/kn, we define

Jn-1

(t) =  +

jJn-K(Jnt - j),

j=0

where K is a kernel of support [0, 1] with -H®older constant smaller than R. Then the functions
Jn-K(Jnt - j), j = 0, . . . , Jn - 1, have disjoint support on [0, 1] and lie in C(R). Consequently, also (t) is in the H®older ball C(R). We obtain further (t) - L2 = Jn-KL2 and thus (t)  H1(cJn-KL2) holds for some c > 0.

33

Under the alternatives we work with some fixed (deterministic and positive) t2 and t2. For the

hypothesis H0 : t =  we set

i

=

 i/n
(i-1)/n

t2d(tii/-n1)/(iin/-n1)t2/|n((tt2)+-t2|(dt(t)

-



)2)

dt

,

which is independent of  because |(t) - | does not depend on the sign. Under H0 we then

consider

volatilities

02,t

and

02,t,

depending

on

n,

such

that

 i/n
(i-1)/n

02,tdt

=

(1

-

2i

)

 i/n
(i-1)/n

t2dt

and with 02,t defined in an analogous way. Note that by construction and by H®older continuity

of (t) we have i = O(Jn-) and |i - i-1| = O(n-) (assuming  and  are regular) so that

for each n we can even find a smooth version of 02 and 02. This minimal change simplifies the

ensuing likelihood considerations drastically because it guarantees that the empirical covariances

are sufficient statistics for these sets of parameters.

We bound the minimax testing error by the average error over  using the likelihood to change

the measure and the Cauchy-Schwarz inequality in combination with E[n2]

1,

E

[

dP dP

]

=

1:

P(n = 1) + sup Pt(n = 0)
tH1,(cJn-KL2 )

2-Jn



() P(n = 1) + P(t)(n = 0)

{-1,+1}Jn

=

1

[( - E n 2-Jn


{-1,+1}Jn

( dP dP

))] -1

1

-

( [( E 2-Jn


{-1,+1}Jn

dP dP

)2]

-

)1/2 1.

Since the transformed increments ni (X, Y - X) = (ni X, inY - ni X) are independent under

all Pt, the likelihood factorizes over the Jn blocks:

dP dP

(ni

(X,

Y

- X)1

i

n)

=

Jn-1
j=0

pj,j (njkn+i(X, Y pj,0(jnkn+i(X, Y

- X))1 - X))1

i i

kn kn

with density functions pj,1, pj,-1, pj,0 on R2kn of the transformed increments on block j. This factorization permits a significant simplification, using invariance with respect to bi-measurable

transformations:

[( E 2-Jn


{-1,+1}Jn

dP )2] dP

=

2-2Jn


,{-1,+1}Jn

Jn-1 
j=0

pj,j pj,j pj2,0

pj,0

=

Jn-1
j=0



(

pj,1 + pj,-1 2pj,0

)2 pj,0.

Under P(t) the increments ni (X, Y - X) on block j with j = ±1 are independent and centered

Gaussian with covariance matrix

i j

=

( j

(ii/-n1)(/iin/-n1)t2/|n(t2td)t-

| dt

(ii/-n1j)/n(ii/(-n1t2)/+n t2t2|(((tt))--|)d2t)

) dt

,

34

which implies correlation of ji. Denoting by 0i the covariance matrix under H0 we obtain

therefore

()

(ij )-1

-

(i0)-1

=

-j i det(i0)1/2

0 1

1 0

.

Using the above, upon denoting with (Zx,i, Zy,i)i a sequence of independent standard Gaussian

random vectors, we obtain



(

pj,1 + pj,-1 2pj,0

)2 pj,0

=

[( E

(j+1)kn (1

-

)( i2)

1 2

( exp

(j+1)kn

) iZx,iZyi

+

1 2

( exp

-

(j+1)kn

))2] iZx,iZyi

i=jkn+1

i=jkn+1

i=jkn+1

=

(

(j+1)kn (1

-

i2

) )

1 4

E

[

( exp

(j+1)kn

) 2iZx,iZyi

+

( exp

-

(j+1)kn

) 2iZx,iZyi

+

] 2

i=jkn+1

i=jkn+1

i=jkn+1

=

(

(j+1)kn (1

-

i2

) )

1 2

E

[

( exp

(j+1)kn

) 2i2Zy2i

+

] 1

i=jkn+1

i=jkn+1

=

(

(j+1)kn (1

-

i2

) )

1 2

( 1

+

(j+1)kn (1

-

) 42i )-1/2

( i=jkn+1

 )( i=jkn+1



)

= 1-

2i +

i2j2 1 +

2i + 3

4i + 2

i22j

+

O(kn

max
i

i6)

i i=j

i i i= j

=

1

+

( 2

(j+1)kn

i2)2

+

O(kn

max
i

i6),

i=jkn+1

where we applied a Taylor expansion to the logarithm of the product, using that kn maxi 2i = O(nJn-1-2) is small. Noting kn/n  0 and the continuity of the integrands, we have the Riemann

sum approximation

Jn-1
j=0

(

(j+1)kn
i=jkn+1

i2)2



nkn

1
0

(t2

t4((t) - )4 + t2((t) - )2)2

dt.

A similar expansion of the product as above thus yields the total asymptotic bound

( Jn-1  (nkn)-1
j=0

(

pj,1 + pj,-1 2pj,0

)2

pj,0

-

) 1



2

1
0

(t2

t4((t) - )4 + t2((t) - )2)2

dt

for n, Jn, kn  . Noting |(t) - | Jn-K, the last expression, when scaled up by nkn, is less than (1-)2 for Jn-4 C(1-)2Jnn-2 with some constant C = C(K, , ) > 0. Hence, for Jn at most (C(1 - 2))-1/(4+1)n2/(4+1) the minimax error is bounded by . Choosing Jn  N of that order, the separation bound cJn-KL2 of the alternative is ~rn with ~ = c(C(1 - )2)-1/(4+1),

as asserted.

35

References
Andersen, T. G., T. Bollerslev, F. X. Diebold, and G. Wu (2006). Realized Beta: Persistence and Predictability., pp. 1 ≠ 39. Northwestern U: Advances in Econometrics, vol. 20.
Ang, A. and D. Kristensen (2012). Testing conditional factor models. Journal of Financial Economics 106 (1), 132≠156.
Aue, A., S. Hormann, L. Horvath, M. Huskova, and J. G. Steinebach (2012). Sequential Testing for the Stability of High-Frequency Portfolio Betas. Econometric Theory 28 (4), 804≠837.
Barndorff-Nielsen, O. E. and N. Shephard (2004). Econometric analysis of realized covariation: High frequency based covariance, regression, and correlation in financial economics. Econometrica 72 (3), 885 ≠ 925.
de la Pena, V., T. Lai, and Q. Shao (2009). Self-Normalized Processes. Springer-Verlag.
Gobbi, F. and C. Mancini (2012). Identifying the Brownian Covariation from the Co-Jumps given Discrete Observations. Econometric Theory 28, 249≠273.
Hansen, L. P. and S. F. Richard (1987). The role of conditioning information in deducing testable restrictions implied by dynamic asset pricing models. Econometrica 55 (3), 587 ≠ 613.
Ingster, Y. and I. Suslina (2003). Nonparametric goodness-of-fit testing under Gaussian models. New York, NY: Springer.
Jacod, J. and P. Protter (2012). Discretization of Processes. Springer-Verlag.
Jacod, J. and M. Reiﬂ (2012). A remark on the rates of convergence for integrated volatility estimation in the presence of jumps. arXiv preprint arXiv:1209.4173263, to appear in The Annals of Statistics.
Jacod, J. and M. Rosenbaum (2013). Quarticity and Other Functionals of Volatility: Efficient Estimation. Annals of Statistics 118, 1462≠1484.
Jacod, J. and A. N. Shiryaev (2003). Limit Theorems For Stochastic Processes (2nd ed.). Berlin: SpringerVerlag.
Kalnina, I. (2012). Nonparametric Tests of Time Variation in Betas. Technical report, University of Montreal.
Kejriwal, M., P. Perron, and J. Zhou (2013). Wald tests for detecting multiple structural changes in persistence. Econometric Theory 29 (2), 289 ≠ 323.
Lewellen, J. and S. Nagel (2006). The conditional capm does not explain asset-pricing anomalies. Journal of Financial Economics 82 (2), 289 ≠ 314.
Mancini, C. (2009). Non-parametric Threshold Estimation for Models with Stochastic Diffusion Coefficient and Jumps. Scandinavian Journal of Statistics 36, 270≠296.
Mykland, P. and L. Zhang (2006). ANOVA for Diffusions and Ito Processes. Annals of Statistics 34, 1931≠1963.
Mykland, P. and L. Zhang (2009). Inference for Continuous Semimartingales Observed at High Frequency. Econometrica 77, 1403≠1445.
Todorov, V. and T. Bollerslev (2010). Jumps and Betas: A New Theoretical Framework for Disentangling and Estimating Systematic Risks. Journal of Econometrics 157, 220≠235.
36

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.

001 002 003 004 005 006 007 008 009 010 011 012 013 014 015 016 017 018

"Principal Component Analysis in an Asymmetric Norm" by Ngoc Mai Tran, Maria Osipenko and Wolfgang Karl H‰rdle, January 2014. "A Simultaneous Confidence Corridor for Varying Coefficient Regression with Sparse Functional Data" by Lijie Gu, Li Wang, Wolfgang Karl H‰rdle and Lijian Yang, January 2014. "An Extended Single Index Model with Missing Response at Random" by Qihua Wang, Tao Zhang, Wolfgang Karl H‰rdle, January 2014. "Structural Vector Autoregressive Analysis in a Data Rich Environment: A Survey" by Helmut L¸tkepohl, January 2014. "Functional stable limit theorems for efficient spectral covolatility estimators" by Randolf Altmeyer and Markus Bibinger, January 2014. "A consistent two-factor model for pricing temperature derivatives" by Andreas Groll, Brenda LÛpez-Cabrera and Thilo Meyer-Brandis, January 2014. "Confidence Bands for Impulse Responses: Bonferroni versus Wald" by Helmut L¸tkepohl, Anna Staszewska-Bystrova and Peter Winker, January 2014. "Simultaneous Confidence Corridors and Variable Selection for Generalized Additive Models" by Shuzhuan Zheng, Rong Liu, Lijian Yang and Wolfgang Karl H‰rdle, January 2014. "Structural Vector Autoregressions: Checking Identifying Long-run Restrictions via Heteroskedasticity" by Helmut L¸tkepohl and Anton Velinov, January 2014. "Efficient Iterative Maximum Likelihood Estimation of HighParameterized Time Series Models" by Nikolaus Hautsch, Ostap Okhrin and Alexander Ristig, January 2014. "Fiscal Devaluation in a Monetary Union" by Philipp Engler, Giovanni Ganelli, Juha Tervala and Simon Voigts, January 2014. "Nonparametric Estimates for Conditional Quantiles of Time Series" by J¸rgen Franke, Peter Mwita and Weining Wang, January 2014. "Product Market Deregulation and Employment Outcomes: Evidence from the German Retail Sector" by Charlotte Senftleben-Kˆnig, January 2014. "Estimation procedures for exchangeable Marshall copulas with hydrological application" by Fabrizio Durante and Ostap Okhrin, January 2014. "Ladislaus von Bortkiewicz - statistician, economist, and a European intellectual" by Wolfgang Karl H‰rdle and Annette B. Vogt, February 2014. "An Application of Principal Component Analysis on Multivariate TimeStationary Spatio-Temporal Data" by Stephan Stahlschmidt, Wolfgang Karl H‰rdle and Helmut Thome, February 2014. "The composition of government spending and the multiplier at the Zero Lower Bound" by Julien Albertini, Arthur Poirier and Jordan RoulleauPasdeloup, February 2014. "Interacting Product and Labor Market Regulation and the Impact of Immigration on Native Wages" by Susanne Prantl and Alexandra SpitzOener, February 2014.

SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
019 "Unemployment benefits extensions at the zero lower bound on nominal interest rate" by Julien Albertini and Arthur Poirier, February 2014.
020 "Modelling spatio-temporal variability of temperature" by Xiaofeng Cao, Ostap Okhrin, Martin Odening and Matthias Ritter, February 2014.
021 "Do Maternal Health Problems Influence Child's Worrying Status? Evidence from British Cohort Study" by Xianhua Dai, Wolfgang Karl H‰rdle and Keming Yu, February 2014.
022 "Nonparametric Test for a Constant Beta over a Fixed Time Interval" by Markus Reiﬂ, Viktor Todorov and George Tauchen, February 2014.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
ForschunSgTFhsgBise6mre4esh9ient,atsrSpccph:h/aa/wfntsadtfshabrus6oue4upr9gphS.owtrtrtihaewedﬂiS.ebhFy1uB,t-h6bDe4e-9rD1li0"enEu1.ctd7ose8cnhoBemeircliRnisk". This research was supported by the Deutsche
Forschungsgemeinschaft through the SFB 649 "Economic Risk".

