BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2005-025
Duality Theory for Optimal Investments under Model Uncertainty
Alexander Schied * Ching-Tang Wu**
* Technische Universität Berlin, Germany ** National University of Kaohsiung, Taiwan
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Duality theory for optimal investments under model uncertainty

Alexander Schied
Institut fu¨r Mathematik, MA 7-4 TU Berlin
Strasse des 17. Juni 136 10623 Berlin, Germany e-mail: schied@math.tu-berlin.de

Ching-Tang Wu
Department of Applied Mathematics National Chiao Tung University 1001 Ta Hsueh Road Hsinchu, Taiwan 300 e-mail: ctwu@math.nctu.edu.tw

First version: Feb 25, 2005, this version: Sep 2, 2005

Abstract: Robust utility functionals arise as numerical representations of investor preferences, when the investor is uncertain about the underlying probabilistic model and averse against both risk and model uncertainty. In this paper, we study the duality theory for the problem of maximizing the robust utility of the terminal wealth in a general incomplete market model. We also allow for very general sets of prior models. In particular, we do not assume that all prior models are equivalent to each other, which allows us to handle many economically meaningful robust utility functionals such as those defined by AVaR, concave distortions, or convex capacities. We also show that dropping the equivalence of prior models may lead to new effects such as the existence of arbitrage strategies under the least favorable model.
1 Introduction
There is a vast literature on the construction of utility-maximizing investment strategies in complete and incomplete market models. An implicit assumption made in most papers on this subject is that the investor is in possession of a market model that accurately describes the probabilities for the future stock price evolution. In reality, however, the exact probabilities themselves are often unknown, i.e., the choice of an appropriate model is subject to Knightian uncertainty.
In the late 1980's, Gilboa and Schmeidler [8], [21], [9] and Yaari [22] formulated natural axioms which should be satisfied by a preference order on payoff profiles such as to account for aversion against both risk and Knightian uncertainty. They showed that such
Supported by Deutsche Forschungsgemeinschaft through the Research Center Matheon "Mathematics for key technologies" (FZT 86) and the SFB 649 "Economic Risk".
Supported by the National Science Council under Grant NSC 91-2115-M-390-002.
1

2

a preference order can be numerically represented by a robust utility functional of the

form

X - inf EQ[ U (X) ] , QQ

where Q is a set of probability measures and U is a utility function; see also [6, Section 2.5].

In a financial market model, a natural question is thus to construct dynamic investment

strategies whose terminal wealth maximizes a given robust utility functional. Systematic approaches to this question were independently1 given by M. Quenez [16] and the first

author [19]. Quenez [16] gives two types of result. The first is a duality result in the spirit

of Kramkov and Schachermayer [13, 14] under relatively strong assumptions on the prior set Q; in particular it is assumed that

all measures in (the closure of) Q are equivalent to a given reference measure P. (1)

The second class of results in [16] deals with explicit examples that can be handled with

BSDE techniques. This technique basically requires that Q consists of the class of all

market models with a fixed volatility and a varying drift process that takes values in

(possibly random) closed sets Ct  Rd. In [19], the focus is on determining explicit solutions for several classes of prior sets Q

in complete market models. More precisely, it is shown that in numerous situations the

set Q admits a measure Q that is "least-favorable" in the sense that the robust problem

becomes equivalent to the standard problem for Q, regardless of the choice of the utility

function. For most examples in [19], the condition (1) is too restrictive. For instance, (1)

cannot not hold if the set Q arises from coherent risk measures such as Average Value at

Risk,

dQ 1 AVaR(X) = sup EQ[ -X ] | Q P and dP   ,

which typically coincides with the worst conditional expectation

W CE(X) = sup E[ -X | A ] | P[ A ] >  .

Condition (1) is also often violated if the prior set is the core of a concave distortion or, more generally, of a submodular capacity. These examples also play an important role in economics; see, e.g., Schmeidler [21] and Yaari [22]. The same is true for lawinvariant robust utility functionals as considered in [20] and by Jouini et al. [12]. Another example for which (1) is not satisfied is provided by the case of "weak information", where Q consists of all measures Q P under which a given random variable has a fixed distribution; see Plachky and Ru¨schendorf [17] and Baudoin [2]. Nevertheless, in many of these cases it is possible to construct solutions for the robust utility maximization problem, at least if the market model is complete; see [19]. We also refer to Cont [4] for a further discussion of (1) in the theory of model uncertainty.
1In fact, a first version of the present paper was completed by us without knowledge of [16], and we are grateful to Martin Schweizer for informing us about this related work.

3
In a more recent paper, Gundel [11] has extended the method of Goll and Ru¨schendorf [10] to obtain results in an incomplete market. This method works if U is defined on all of R but may fail, e.g., for HARA utility functions. Gundel [11] also requires condition (1). For a recent extension of the BSDE approach, we refer to Mu¨ller [15].
In this note, we are interested in developing the duality theory for robust utility maximization in a very general framework. As for the conditions on the financial market model and the utility function, the benchmark has already been set in the work of Kramkov and Schachermayer [13, 14]. Here we will adopt their framework in assuming that the price process S is a general d-dimensional semimartingale defined on a filtered probability space (, F, (Ft), P). As in [13, 14], we will assume that the model is `arbitrage free' in the sense that there exists an equivalent martingale measure for all admissible value processes.
With the market model being fixed, we need to formulate natural conditions on the set Q from which our robust utility functional will be defined. First of all, it is necessary that each measure Q  Q respects P-nullsets, for otherwise a stochastic integral defined with respect to P might make no sense under Q. Thus, we assume that
(a) Q P for all Q  Q.
Next, there is no loss of generality in assuming that
(b) Q is convex.
As mentioned above, a typical result in all previous papers on robust utility maximization is the existence of a measure Q which is "least favorable" in the sense that the robust problem is equivalent to the standard problem for Q. If one wishes to get some control over Q then it is natural to require that Q  Q. This requirement will be guaranteed by assuming that
(c) Q is closed in some reasonable topology such as total variation.
To obtain the existence of Q in our general setup, one needs to assume that
(d) Q is relatively compact in a reasonable topology.
We finally add the assumption that our set Q is "sensitive" in the sense that
(e) Q[ A ] = 0 for all Q  Q implies P[ A ] = 0.
At first glance, this condition may seem less natural than the preceding ones. But note that, due to the Halmos-Savage theorem and the assumptions (a), (b), and (c), it is equivalent to the rather weak requirement that there exists one Q  Q that is equivalent to P. This latter requirement should be compared to the assumption (1), which would add to the set (a)­(e) the condition that "P Q for all Q  Q".
Our aim in this paper is to establish a duality theory for robust utility maximization given the set of assumptions (a)­(e). On the one hand, our main results will be formulated within the above-mentioned paradigm: For each level of initial wealth there exists a measure Q that is least favorable in the sense explained above. On the other hand, we

4
will also challenge this paradigm at least partially: In our general setup, the measure Q may no longer be equivalent to the reference measure P. In fact, we will see in Example 2.5 that one may have to face the situation that Q admits arbitrage opportunities when considered as a market model on its own. If this is the case, it will no longer be possible to apply the standard theory of utility maximization to the model with subjective measure Q. The failure of equivalence also creates some difficulties in our proofs and a number of open questions such as regularity properties of the value functions or the uniqueness of optimal strategies for the primal and dual problems.
2 Statement of main results
As in Kramkov and Schachermayer [13, 14], we assume that the utility function of the investor is a strictly increasing and strictly concave function U : (0, )  R, which is also continuously differentiable and satisfies the Inada conditions
U (0+) = + and U (-) = 0.
Payoffs are modeled as random variables X on a given probability space (, F, P). Their utility shall be assessed in terms of a robust utility functional
X - inf EQ[ U (X) ], QQ
where Q is a set of probability measures on (, F). We assume the following conditions:
Assumption 2.1 (i) Q is convex. (ii) P[ A ] = 0 if and only if Q[ A ] = 0 for all Q  Q (iii) The set Z := {dQ/dP | Q  Q } is closed in L0(P)
Condition (ii) combines assumptions (a) and (e) as formulated in Section 1. Condition (iii) takes care of closedness (c) and compactness (d); see Lemma 3.2. We emphasize once more that (ii) is strictly weaker than the assumtion that all measures in Q are equivalent to P, which is assumed in [16], [11] and rules out many examples, which are explicitly solvable for complete models [19]. In fact, the Halmos-Savage theorem shows that, under condition (iii), condition (ii) is equivalent to the assumption
Q P for all Q  Q and Qe = ,
where Qe denotes the set of measures in Q that are equivalent to P. We use the same setup as in [13, 14] also for the financial market model. The dis-
counted price process of d assets is modeled by a stochastic process S = (St)0tT . We assume that S is a d-dimensional semimartingale on (, F, P) with respect to a filtration (Ft)0tT . A self-financing trading strategy can be regarded as a pair (x, ), where x  R

5

is the initial investment and  = (t)0tT is a d-dimensional predictable and S-integrable process. The value process X associated with (x, ) is given by X0 = x and

t
Xt = X0 + r dSr ,
0

0tT.

For x > 0 given, we denote by X (x) the set of all such processes X with X0  x that are admissible in the sense that Xt  0 for 0  t  T . We assume that our model is arbitrage-free in the sense that M = , where M denotes the set of measures equivalent to P under which each X  X (1) is a local martingale; see [13]. Thus, our main problem can be stated as follows:

Maximize inf EQ[ U (XT ) ] among all X  X (x). QQ
Consequently, the value function of the robust problem is defined as

(2)

u(x) := sup inf EQ[ U (XT ) ] XX (x) QQ
One of our first results will be the minimax identity

u(x)

=

inf
QQ

uQ(x),

where

uQ(x) := sup EQ[ U (XT ) ]
XX (x)

(3)

is the value function of the optimal investment problem for an investor with subjective measure Q  Q. Next, we define as usual the convex conjugate function V of U by

V (y) := sup U (x) - xy ,
x>0

y > 0.

With this notation, it follows from Theorem 3.1 of [13] that, for Q  Qe with finite value function uQ,

uQ(x) = inf vQ(y) + xy y>0

and

where the dual value function vQ is given by

vQ(y) = sup(uQ(x) - xy),
x>0

(4)

vQ(y) = inf EQ[ V (YT ) ], Y YQ(y)
and the space YQ(y) is defined as

YQ(y) = Y  0 | Y0 = y and XY is a Q-supermartingale for all X  X (1) .

We thus define the dual value function of the robust problem by

v(y) := inf vQ(y) = inf inf EQ[ V (YT ) ].

QQe

QQe Y YQ(y)

(5)

Remark: The reader may have noticed that the Q-expectation of U (XT ) might not be well-defined in the sense that EQ[ U +(XT ) ] and EQ[ U -(XT ) ] are both infinite. There

6

are several ways to deal with such pairs (Q, X). For instance, we can simply extend the expectation operator EQ[ · ] to the entire set L0 by letting

EQ[ F ] := sup EQ[ F  n ] for arbitrary F  L0.
n

(6)

In doing so, we exclude X from the maximization problem (2). Moreover, we will see

in Lemma 3.1 below that uQ(x) =  for all x > 0 as soon as EQ[ U +(XT ) ] =  for one strategy X. Hence, such measures Q will not contribute to the robust value function

u(x) = infQ Q uQ (x) unless our problem (2) is trivial. Finally, note that all expectations occurring in (5) are defined in the ordinary sense, since V is a decreasing convex function

and 0  EQ[ YT ]  y for all Y  YQ(y).



Theorem 2.2 In addition to the above assumptions, let us assume that

uQ0(x) <  for some x > 0 and some Q0  Qe. Then the value function u is concave, takes only finite values, and satisfies

(7)

u(x)

=

sup
XX (x)

inf
QQ

EQ[

U (XT

)

]

=

inf
QQ

sup
XX (x)

EQ[

U

(XT

)

].

Moreover, two value functions u and v are conjugate to another:

(8)

u(x) = inf v(y) + xy y>0

and v(y) = sup u(x) - xy .
x>0

In particular, v is convex. The derivatives of u and v satisfy

(9)

u (0+) =  and v (-) = 0.

(10)

Remark 2.3 It will turn out in the proof of this theorem that the value function u and its dual v can be defined via the smaller set

Qef := Q  Qe | uQ(x) <  for some x > 0 = Q  Qe | uQ(x) <  for all x > 0 ,

i.e.,

u(x) = inf uQ(x) QQef

and

Also note that (7) can be restated as Qfe = .

v(y) = inf vQ(y). QQfe



7

The situation becomes much simpler if we assume that all measures in Q are equivalent to P. In this case, we also get some additional results, which generalize those in Quenez [16], where additional assumptions on Q are required.

Corollary 2.4 In addition to the assumptions of Theorem 2.2 suppose that all measures in Q are equivalent to P. Then for each y > 0 such that v(y) <  there exist Q  Q and Y  YQb(y) such that v(y) = EQb[ V (YT ) ]. Moreover, Y is unique: any other optimal pair (Q , Y )  {(Q, Y ) | Q  Q, Y  YQ(y) } satisfies Y = Y P-a.s.

We now come to the existence of optimal strategies. The following simple example illustrates some of the difficulties one might meet if Q contains measures that are not equivalent to P.

Example 2.5 Consider a one-period model in discrete time (t = 0, 1) with two risky assets S1, S2 satisfying S01 = S02 = 1. Under the measure Q1, the first asset has, at time 1, the distribution
Q1[ S11 = 2 ] =: q = 1 - Q1[ S11 = 0 ],
where 1/2 < q < 1. The second asset S12 is independent of S11 under Q1, has support {0, 1, . . . }, and finite expected value EQ1[ S12 ] > S02 = 1. We take P := Q1 as our reference measure. We introduce another measure Q0 P by requiring that

Q0[ S11 = 2 ] = Q0[ S11 = 0 ] = 1/2 and Q0[ S12 = 0 ] = 1.

For Q we take the set of all convex combinations Q := Q1 + (1 - )Q0, 0    1.
Note first that a trading strategy can only be admissible for P if it does not contain short positions in the second asset, because S12 is unbounded. Let us now look at the optimal strategy under Q. First, one easily checks that there is some 0  (0, 1) such that EQ[ S12 | S11 ]  1 P-a.s. for   0. Thus, for these values of , the optimal portfolio will contain no long positions in the second asset; see, e.g., [6, Proposition 2.41].

But this means that for   0 there will be no investment, long or short, into the second asset, because our admissibility assumption excludes short positions. Second, we

have EQ[ S11 | S12 ] > 1 P-a.s. for all  > 0. Hence, it will be optimal to allocate some investment into the first asset, resulting in uQ(x) > U (x) for  > 0. Third, under Q0 it is not optimal to allocate any admissible investment, long or short, to either of the risky

assets, and it follows that uQ0(x) = U (x). Thus, Q := Q0 is the unique measure in Q such that uQb(x) = u(x) = infQQ uQ(x),
and in order to determine the optimal strategy for the robust problem, we must look for

the optimal strategy for the model Q. This task is straightforward in this simple example:

just put everything into the bond. However, it would create difficulties if we would try

to apply the general theory of utility maximization, because Q = Q0 is not equivalent to the martingale measures in our market model. To make things worse, Q0 considered as a market model on its own has not the same admissible strategies than P, since short

selling the second asset is admissible in the model Q0. In fact, such short sales even create

arbitrage opportunities under Q0.



8

Our next aim is to get existence results for optimal strategies despite the difficulties displayed by the preceding example. Even for the classical case Q = {Q} additional assumptions are needed to guarantee the existence of optimal strategies for each initial capital: It was shown in [14] that a necessary and sufficient condition is the finiteness of the dual value function vQ. This condition translates as follows to our robust setting:

vQ(y) <  for all y > 0 and each Q  Qe.

(11)

Recall from [14, Note 2] that (11) holds as soon as uQ is finite for all Q  Qe and the asymptotic elasticity of the utility function U is strictly less than one:

xU (x)

AE(U ) = lim sup

< 1.

x U (x)

(12)

While it is sufficient to assume (11) when all measures in Q are equivalent to P, we need to assume (12) to get some regularity results in the general case.

Theorem 2.6 In addition to Assumption 2.1 let us assume (11). Then both value functions u and v take only finite values and satisfy

u (-) = 0 and v (0+) = -.

(13)

For any x > 0 there exist an optimal strategy X  X (x) and a measure Q  Q such that

u(x)

=

inf
QQ

EQ[

U (XT

)

]

=

EQb [

U (XT

)

]

=

uQb (x).

In particular, the suprema and infima in (8) are attained. There also exist some y in the

superdifferential of u(x) and some Y  YP(y) such that,

v(y) = E ZV YT , and XT = I YT ZZ

Q-a.s.,

(14)

where Z = dQ/dP and I = -V . Furthermore, XY is a martingale under P, and the dual

value function satisfies

dP 

v(y)

=

inf
P M

inf
QQe

EQ

V

y dQ

.

(15)

If in addition AE(U ) < 1 holds, then u is strictly concave and v is continuously differentiable. Moreover, XT YT is supported by {Z > 0}, i.e.,

{XT YT > 0} = {Z > 0} P-a.s.

(16)

Remark: The identity (16) shows that the duality relation (14) cannot be extended
beyond the support of Q. This fact challenges the paradigm of solving the robust problem
via determining a least favorable measure. On the other hand, if S is continuous and
·
X = x + t dSt
0

is

known

under

Q,

then

this

strategy

can

be

extended

to

all

of



by

replacing



by

t

I {

>t}

,

where  := inf{t  0 | E[ Z | Ft ] = 0}.



9

We get some additional results if all measures in Q are equivalent to P:
Corollary 2.7 In addition to the assumptions of Theorem 2.2 let us assume (11) and that all measures in Q are equivalent to P. Then both value functions u and v take only finite values, u is strictly concave, and v is continuously differentiable. For any x > 0, the optimal solution X  X (x) is unique and it is given by
XT = I(YT ),
where I is the inverse function of U and Y is as in Corollary 2.4 for y as in Theorem 2.6. If Q is as in Corollary 2.4, then it satisfies all the properties of the measure Q in Theorem 2.6.

3 The duality of the value functions

As in [13, 14], we obtain "abstract versions" of our theorems if we replace the spaces X (x) and YQ(y) by the respective spaces

C(x) = g  L+0 (, FT , P) | 0  g  XT for some X  X (x) .

and, for Q  Qe,

DQ(y) = h  L0+(, FT , P) | 0  h  YT for some Y  YQ(y) .

It is easy to see that this substitution does not affect the values of our value functions. That is, we have uQ(x) = supgC(x) EQ[ U (g) ] and vQ(y) = infhDQ(y) EQ[ V (h) ], where we use the convention (6). Moreover, if there is an optimal g or h, then it must clearly be the terminal value of some process X  X (x) or Y  YQ(y). We note next that the spaces YQ(y) and DQ(y) can easily be related to Y(y) := YP(y) and D(y) := DP(y): if (ZtQ)0tT is the density process of Q  Qe with respect to P, then
YQ(y) = { Y /ZQ | Y  Y(y) } and DQ(y) = { h/ZTQ | h  D(y) },

as can be seen easily by the Bayes formula for conditional expectations. Hence, the dual

value function satisfies

h

v(y) = inf vQ(y) = inf inf E ZV

QQe

ZZe hD(y)

Z

,

(17)

where

Ze :=

dQ dP

Q  Qe

;

we also define

Z = dQ Q  Q . dP

The formula (17) is convenient, since the infimum is now taken over two sets that are no

longer dependent on another. Also, recall from [13] that for Q  Qe

g  C(x) h  DQ(y)

 

g  0 and sup EQ[ hg ]  xy
hDQ(y)
h  0 and sup EQ[ hg ]  xy.
gC(x)

(18)

10
Lemma 3.1 With our convention (6), we have:
(a) For any Q P and x > 0, g  EQ[ U (g) ] is a concave functional on C(x).
(b) uQ(x) = supgC(x) EQ[ U (g) ] and u(x) = infQQ uQ(x) are concave functions of x.
(c) If there exist x > 0 and g  C(x) such that EQ[ U +(g) ] = , then uQ  +.
Proof: (a) Since U is concave and x  x  n is increasing and concave, we have U (g + (1-)g )n  (U (g)n)+(1-)(U (g )n) for any convex combination of g, g  C(x). This implies the assertion.
(b) This follows from part (a) and the fact that
{ g + (1 - )g | g  C(x), g  C(x ) }  C(x + (1 - )x ).
(c) We have 1 + g  C(x + 1) and EQ[ U (1 + g) ] = +. Hence, uQ(x + 1) = +, which in view of part (b) implies uQ  +.
Note that the concavity of u and (7) imply that u takes only finite values and is continuous on (0, ). The following lemma is certainly well known; we include a short proof for the convenience of the reader.
Lemma 3.2 Suppose parts (i) and (ii) of Assumption 2.1 hold. Then part (iii) of Assumption 2.1 holds if and only if Z is weakly compact in L1(P).
Proof: Assume (iii), take F  L+ (P), and let (Zn) be a sequence in Z such that E[ ZnF ] tends to infZZ E[ ZF ]. By the standard Komlos-type argument [5, Lemma A1.1], there exists a sequence of convex combinations Zn  conv{Zn, Zn+1, . . . }  Z converging P-a.s. to some random variable Z0  Z. Thus, for every F  L+ (P) there exists Z0  Z such that E[ Z0F ]  E[ ZF ] for all Z  Z. Since all members of Z are probability densities, the same result is true for arbitrary F  L, and weak compactness follows from James' theorem (see, e.g., [7]).
Conversely, suppose (Zn) is a sequence in Z converging P-a.s. to some Z0. Weak compactness of Q gives E[ Zn ]  E[ Z0 ], and it follows that Zn  Z0 in L1(P). Since Z is closed in L1(P) due to part (i) we get Z0  Z.
Recall that Qf denotes the set of Q  Q such that uQ(x) <  for some and hence all x > 0.
Lemma 3.3 For Q0, Q1  Qf and 0  t  1 let Qt := tQ1 + (1 - t)Q0  Q. Then t  uQt(x) is a continuous function for each x > 0.

11

Proof: On the one hand, f (t) := uQt(x) takes only finite values and is convex as the supremum, taken over g  C(x), of the affine functions t  EQt[ U (g) ]. Hence f is continuous on (0, 1) and upper semicontinuous on [0, 1]. On the other hand, U (· + ) is
bounded from below for any   (0, x), and so

t  EQt[ U ( + g) ] = sup EQt[ U ( + g)  n ]
n
is lower semicontinuous for each g  C(x). Moreover, g +   C(x) for each g  C(x - ) and hence

lim inf t0

uQt (x)



lim inf t0

sup
gC(x-)

EQt [

U (g

+

)

]



sup
gC(x-)

EQ0 [

U (g

+

)

]



uQ0 (x

-

).

Sending   0 and using the continuity of uQ0 as a concave function, we get that f is also lower semicontinuous at t = 0. The proof for t = 1 is identical.

Lemma 3.4 We have

u(x) = sup inf EQ[ U (g) ] = inf sup EQ[ U (g) ]

gC(x) QQ

QQ gC(x)

= sup inf EQ[ U (g) ] = inf sup EQ[ U (g) ]

gC(x) QQe

QQe gC(x)

(19) (20)

Proof: To prove that in (19) supremum and infimum may be interchanged, take  > 0 and note that

u(x + )  sup inf EQ[ U ( + g) ] = sup inf E[ ZU ( + g) ].

gC(x) QQ

gC(x) ZZ

As in the proof of Lemma 3.3, we see that Z  E[ ZU ( + g) ] is, for each g  C(x), a weakly lower semicontinuous affine functional defined on the weakly compact convex set Z. Moreover, for each Z  Z, g  E[ ZU ( + g) ] is a concave functional defined on the convex set C(x). Thus, the conditions of the lop sided minimax theorem [1, Chapter 6, p. 295] are satisfied, and so

sup min E[ ZU ( + g) ] = min sup E[ ZU ( + g) ].

gC(x) ZZ

ZZ gC(x)

Hence, we arrive at

u(x

+

)



min
QQ

sup
gC(x)

EQ[

U (

+

g)

]



inf
QQ

sup
gC(x)

EQ[

U (g)

]



sup
gC(x)

inf
QQ

EQ[

U (g)

]

=

u(x).

Sending   0 and using the continuity of u yields the first part of the lemma. We still have to show that Q may be replaced by Qe. We obtain from (7) and Lemma
3.3 that u(x) = infQQe uQ(x). Hence

u(x) = inf uQ(x) = inf sup EQ[ U (g) ]  sup inf EQ[ U (g) ]

QQe

QQe gC(x)

gC(x) QQe



sup
gC(x)

inf
QQ

EQ[

U

(g)

]

=

u(x).

12

A key observation for our future analysis is the convexity of the function (z, y)  zV (y/z). A proof of this observation goes as follows. For z0, z1, y0, y1  (0, ) let  := z1/(z0 + z1)  (0, 1). Then

 y1

+ (1 - ) y0

=

y0

+ y1

=

y1 2

,

z1 z0 z0 + z1 z 1

2

where z 1 := (z0 + z1)/2 and y 1 := (y0 + y1)/2. It follows that 22

z1V 2

y1 2
z1 2

 z 1 (1 - )V y0 2 z0

+ V y1 z1

1 = 2 z0V

y0 z0

1 + 2 z1V

y1 . z1

(21)

Note that the inequality is strict if y0/z0 = y1/z1.
We will show next that in (17) the set Ze can be replaced by the larger set Z or by the smaller set Zef , where Zf and Zef correspond to the densities of measures in Qf and Qef . If Z = dQ/dP, we will also write uZ and vZ for uQ und vQ, respectively.

Lemma 3.5 We have vQ(y) =  for Q  Qe\Qef , and for v(y) <  the dual value function of the robust problem satisfies

h

v(y) = inf vQ(y) = inf inf E ZV

QQfe

ZZ hD(y)

Z

.

Proof: First we show that

h

v(y) = inf inf E ZV ZZe hD(y)

Z

h

= inf inf E ZV ZZ hD(y)

Z

.

(22)

Suppose Z1  Z\Ze and h1  D(y) are such that E[ Z1V (h1/Z1) ] < . Due to our assumption v(y) < , we may choose Z0  Ze and h0  D(y) such that E[ Z0V (h0/Z0) ] < . Now let Zt := tZ1 +(1-t)Z0 and ht := th1 +(1-t)h0 for 0  t < 1. Since the function t  E[ ZtV (ht/Zt) ] is convex and takes only finite values, it is upper semicontinuous and we get E[ Z1V (h1/Z1) ]  lim supt1 E[ ZtV (ht/Zt) ]. Since Zt  Ze for t < 1, this yields our claim (22).
Now we will follow the proof of Lemma 3.4 in [13] to show that vQ(y) =  for Q  Qe\Qef . This fact will complete the proof. With Bn := {g | 0  g  n}, we get as in [13, Lemma 3.4] that, for V n(y) := sup0<xn(U (x) - xy),

vQn (y)

:=

inf
hD(y)

EQ[

V

n(h)

]

=

sup
gBn

inf
hD(y)

EQ[

U (g)

-

gh

]

=

inf
hD(y)

sup
gBn

EQ[

U (g)

-

gh

].

We also get that vQ(y)  vQn (y) and that

vQn (y) sup uQ(x) - xy = . x>0

This proves the assertion.

13

Lemma 3.6 With V - denoting the negative part of V , the set of random variables ZV - h Z  Z, h  D(y) Z
is uniformly integrable with respect to P.

Proof: The set Z is uniformly integrable according to Lemma 3.2 and the Dunford-Pettis theorem. Hence, there is nothing to show if V is bounded from below. If V is unbounded from below, let  denote the inverse function of -V and y0 := (0) (we may assume without loss of generality that V (0) > 0). We have

E

Z

V-

h Z

 E Z -V

h Z

+ y0  E[ h ] + y0  y + y0 =: M

(23)

for all Z  Z and h  D(y). It was shown in Lemma 3.2 of [13] that (t)/t   as t  . Hence, for every a > 0 there exists c(a) > 0 such that (t)  at for all t  c(a). Let us write FZh for V -(h/Z). Then (23) implies that

E ZFZhI{FZhc(a)}



1 aE

Z (FZh )

 M, a

(24)

uniformly in Z  Z and h  D(y). Now suppose  > 0 is given. Take c := c(2M/) and

let  := /(2c). Hence, if A  F is such that E[ Z IA ]  , then

E ZFZh · IA

=

E ZFZh · IA{FZhc}

+ E ZFZh · IA{FZh<c}

  2 + c · E[ Z IA ]  .

Finally, the uniform integrability of Z yields the existence of some  > 0 such that E[ Z IA ]   as soon as P[ A ]  , and the proof is complete.

Lemma 3.7 If v(y) < , then there exist Z  Z and h  D(y) such that
v(y) = E[ ZV (h/Z) ].
Moreover, the function v is convex and lower semicontinuous on [0, ) if we define v(0) := V (0) := limy0 V (y).
Proof: In a first step, we show that the function
Z × D(y) (Z, h) - E ZV h/Z
is lower semicontinuous with respect to P-a.s. convergence. Without loss of generality, we may assume V () < 0. Suppose that almost surely Zn  Z and hn  h.
We claim that P-a.s. lim infn ZnV +(hn/Zn)  ZV +(h/Z) and limn ZnV -(hn/Zn) = ZV -(h/Z), where we use the convention 0 ·  = 0. The first inequality clearly becomes an identity on {Z > 0}. On {h > 0}  {Z = 0}, we have ZnV +(hn/Zn) = 0 = ZV +(h/Z) for large enough n, due to our assumption V () < 0. On {h = 0}  {Z = 0}, we have lim infn ZnV +(hn/Zn)  0, but this inequality may be strict. As for the negative

14

part of V , the asserted convergence is clear on {Z > 0}. On {Z = 0}, we clearly have lim infn ZnV -(hn/Zn)  0 = ZV -(h/Z). Moreover, there is some c = c() > 0 such that hn()  c() for all n. Hence lim supn ZnV -(hn/Zn)  limn ZnV -(c/Zn) = 0 on {Z = 0}, due to the fact that V () = 0
Now Fatou's lemma yields E[ ZV +(h/Z) ]  lim infn E[ ZnV +(hn/Zn) ], while Lemma 3.6 implies that E[ ZnV -(hn/Zn) ]  E[ ZV -(h/Z) ]. Combining these two facts gives lower semicontinuity.
Now let (Zn, hn)  Z × D(y) be a sequence such that E[ ZnV (hn/Zn) ]  v(y). Applying twice the standard Komlos-type argument of Lemma A1.1 in [5], we obtain a
sequence (Zn, hn)  conv{(Zn, hn), (Zn+1, hn+1), . . . }  Z × D(y)
that converges P-a.s. to some (Z, h). We have Z  Z by Lemma 3.2. Moreover, D(y) is closed in L0 by (18), and we get h  D(y).
By the convexity of (x, z)  zV (x/z) and step one of this proof we get

E[ ZV (h/Z) ]  lim inf E[ ZnV (hn/Zn) ]  lim inf E[ ZnV (hn/Zn) ] = v(y).

n

n

Lemma 3.5 then shows that the pair (h, Z) is as desired. Convexity of v now follows easily from the convexity of (Z, h)  E[ ZV (h/Z) ]. To
show lower semicontinuity, take a sequence yn > 0 converging to y  0. There is nothing to show if lim infn v(yn) = , so we may assume that supn v(yn) < . Then there are hn  D(yn) and Zn  Z such that v(yn) = E[ ZnV (hn/Zn) ]. Hence, we can pass to a sequence of convex combinations, which converges P-a.s. to some (h, Z). Using (18) and our assumptions on Z yields (h, Z)  D(y) × Z, while Lemma 3.5, convexity, and step 1 of this proof give v(y)  E[ ZV (h/Z) ]  lim infn v(yn).

Proof of Theorem 2.2: By Lemma 3.4, (4), and Lemma 3.5,

u(x) = inf uQ(x) = inf uQ(x) = inf inf vQ(y) + xy = inf v(y) + xy ,

QQe

QQef

QQef y>0

y>0

which is the first identity in (9). The second one follows from the first and the convexity

and lower semicontinuity of v as established in Lemma 3.7; see, e.g., [6, Proposition A.6

(b)]. The identities in (10) can be proved as in [13, Lemma 3.5].

Proof of Corollary 2.4: The uniqueness of Y follows from the strict convexity of V and the fact that the inequality (21) is strict if y0/z0 = y1/z1.

4 The existence of optimal strategies

Throughout this section, we assume that the conditions of Theorem 2.6 are satisfied. In

view of Lemma 3.5, we extend the definition of vZ beyond the case Z  Ze by setting

h

vZ(y) := inf E hD(y)

ZV

z

for any Z  Z.

15

Lemma 4.1 For any x0 > 0, there exist some Z  Z, y > 0, and h  D(y) such that (a) u(x0) = uZb(x0), (b) v(y) = vZb(y) = E[ ZV (h/Z) ], (c) u(x0) = v(y) + x0y.
Moreover, u is a strictly increasing function.

Proof: Let (Zn) be any sequence in Ze such that uZn(x0)  u(x0). Such sequences exist due to Lemma 3.4. In the first step, we show that

u+(x0)



lim inf n

uZn

(x0)



lim sup
n

uZn

(x0)



u-(x0),

where u±(x0) are the left- and right-hand derivatives of u in x0. Indeed, the concavity of uZn implies that for x1  (0, x0)

uZn (x0 )



uZn (x0 ) x0

- -

uZn (x1 ) x1



uZn(x0) - u(x1) . x0 - x1

Sending first n   and then x1  x0 yields lim supn uZn(x0)  u-(x0). To get the lower bound, use a similar argument with x2 > x0.
In the next step, we use the standard Komlos-type argument to obtain a sequence
(Zn) in Ze such that both uZn(x0)  u(x0) and Zn  Z P-a.s., which is possible due to the convexity of the functional Z  uZ(x0). Moreover, we have for any  > 0

uZb(x0)



sup
gC(x0)

E[

ZU

(g

+

)

]



lim inf n

sup
gC(x0)

E[

ZnU (g

+

)

]



lim inf n

uZn (x0

+

)



lim inf n

uZn(x0) + uZn(x0)

 u(x0) + u-(x0).

Taking   0 gives u(x0) = uZb(x0). Next observe that u(x0) - u(x0 - )  uZb(x0) - uZb(x0 - ) > 0 for each   (0, x0).
That is, the function u is strictly increasing.
Let yn := uZn(x0). By passing to a subsequence if necessary, we may assume that (yn) converges to some y  [u+(x0), u-(x0)]. Since u is strictly increasing, we have y > 0. Applying the results of [13, 14] for each n, we get

vZn(yn) = uZn(x0) - x0yn - u(x0) - x0y = v(y),
where we have used the duality relation (9) and the fact that y belongs to the superdifferential of u. Due to the results in [13, 14], there exist hn  D(yn) such that vZn(yn) = E[ ZnV (hn/Zn) ]. As in the proof of Lemma 3.7, we obtain a sequence
(Zn, hn)  conv{(Zn, hn), (Zn+1, hn+1), . . . }
that converges P-a.s. to (Z, h), where h  D(y). As in Lemma 3.7, we obtain E[ ZV (h/Z) ] = v(y).

16

Lemma 4.2 If AE(U ) < 1 then {Z > 0}  {h > 0}.

Proof: Suppose by way of contradiction that B := {Z > 0}  {h = 0} satisfies P[ B ] > 0.

If V (0) = , then P[ B ] > 0 would contradict the fact that v(y) < . Now we consider

the case V (0) < . Take h  D(y) such that P[ h > 0 ] = 1 (e.g., we can take ydP /dP

where P   M), and let ht := (1 - t)h + thIB  D(y) for 0  t  1. Then ZV (ht/Z)  L1(P), due to Lemma 3.6.

Next,

as

t



0,

1 t

Z

(V

(ht/Z

)

-

V

(h/Z

))

decreases

to

h

V (0+)h · IB - V

h·I . Z Bc{Zb>0}

Due to our assumtion AE(U ) < 1 and [13, Lemma 6.3 (iv)], there exist constants c, y0 > 0 such that -V (y)  cV (y)/y for 0 < y  y0. This implies that

-E V

h h·I Z Bc{Zb>0}

< .

On the other hand, V (0+) = -, and so monotone convergence guarantees that

1 tE ZV

ht Z

- ZV

h Z

in contradiction to the optimality of h.

- -

as t  0,

Proof of Theorem 2.6: Due to our assumption (11) and Lemma 3.5, we have Qef = Qe. In particular, we have EQ[ U +(g) ] <  for all Q  Qe and g  C(x) by Lemma 3.1.

Moreover,

uQ(x) - 0 x

as x  

(25)

for each Q  Qe; see [14, Note 1]. Hence it follows from the proof of [14, Eq. (25)] that the mapping C(x) g  EQ[ U (g) ] is upper semicontinuous with respect to almost-sure convergence (note that the proof of Eq. (25) in [14] does not use the assumption that (gn)

is a maximizing sequence). Hence, C(x) g  infQQe EQ[ U (g) ] is also upper semicontinuous with respect to almost-sure convergence. Now let (gn) be a maximizing sequence in C(x). By the usual Komlos-type argument there is a sequence gn  conv{gn, gn+1, . . . } converging P-a.s. to some g  0. We have g  C(x) due to (18). Moreover, the

concavity of the functional g  infQQe EQ[ U (g) ] implies that (gn) is again a maximizing sequence, while its upper semicontinuity yields that infQQe EQ[ U (g) ]  u(x). In fact, we even have infQQ EQ[ U (g) ]  u(x). To see this, note first that the set {Q  Q | EQ[ U (g) ] = -} must be empty, for otherwise it would have a non-void intersection with Qe. Hence, for Q  Q\Qe and Q0  Qe, EQ[ U (g) ] is the limit as t  1 of EQt[ U (g) ] with Qt := tQ + (1 - t)Q0  Qe.
Next, for Z as in Lemma 4.1, we get

u(x)

=

uZb(x)



E[

ZU (g)

]



inf
QQ

EQ[

U (g)

]



u(x),

17

so all inequalities are in fact identities, and g is optimal. Next, we show that the optimal g coincides dQ := Z dP-a.s. with I(h/Z), where y
and h are as in Lemma 4.1 for x0 := x. We have 0  V (h/Z) + gh/Z - U (g) and

EQb[ V (h/Z) + gh/Z - U (g) ] = v(y) + E

gh I {Zb>0}

- u(x)

 v(y) + xy - u(x) = 0.

Thus, 0 = V (h/Z)+gh/Z-U (g) and in turn g = I(h/Z) Q-a.s. We also get E gh I ] = {Zb>0}
xy, which in view of the a priori bound E[ gh ]  xy implies that

{gh > 0}  {Z > 0}.

(26)

Clearly, g = XT and h = YT for some X  X (x) and Y  Y(y). Their product forms a martingale under P since E[ XT YT ] = xy. The identity (15) follows from the definition of the dual value function and the corresponding identity in [13, 14]. The assertion that u (-) = 0 follows from the fact that u(x)/x  0 as x  , which is itself a consequence of [14, Note 1]. The second identity in (13) follows from the first and the duality relations between u and v.
Next, suppose that AE(U ) < 1. The identity (16) follows from (26) and Lemma 4.2. We now prove the strict concavity of u, which will in turn imply the differentiability of v, due to the duality relations and general principles. Taking Z1  Ze and letting Zt := tZ1 + (1 - t)Z  Ze, one easily shows that t  vZt(y) is a convex function. By our assumption (11), this function is finite for t > 0 and thus upper semicontinuous. Using Lemma 3.3 and (4), we get

uZb(x)

=

lim
t0

uZt (x)

=

lim
t0

inf
y>0

vZt(y) + xy

 inf y>0

vZb(y) + xy .

(27)

Since vZb(y) < , it follows as in [14, Note 2] that vZb(y) <  for all y > 0 provided that AE(U ) < 1 holds. Hence (27) implies that (25) holds for Q := Q. It follows from the proof
of [14, Lemma 1] that for each  > 0 there is some g  C() such that uZb() = E[ ZU (g) ]. This g must be Q-a.s. unique, and we obtain the strict concavity of the function uZb. From here we get the strict concavity of the robust value function u: Take x1, x2 > 0,
x := (x1 + x2)/2, and let Z be as above, then

1 2

u(x1) + u(x2)

- u(x)  1 2

uZb(x1) + uZb(x2)

- uZb(x) < 0.

Proof of Corollary 2.7: Let us suppose that gi  C(xi), i = 1, 2, are such that u(xi) = infQQ EQ[ U (gi) ]. Due to Lemma 3.2 and the weak lower semicontinuity of Z  E[ ZF ] for F  0, there exists some Q  Q such that

u x1 + x2 2

- u(x1) + u(x2) 2



inf
QQ

EQ

U

g1 + g2 2

- U (g1) + U (g2) 2

=

EQe U

g1 + g2 2

- U (g1) + U (g2) , 2

18
and the last term is strictly positive as soon as P[ g1 = g2 ] > 0. With x1 = x2, this gives the uniqueness of the optimal g, for x1 = x2 we then obtain the strict concavity of u. The asserted properties of v now follow by general principles (e.g., [18, Theorem V.26.3]) from the duality relation (9). The remaining assertions follow from the preceding results.
Acknowledgement: It is a pleasure to thank Shuenn-Jyi Sheu for discussions. We also thank Martin Schweizer for informing us about the work of M. Quenez [16] as well as Bernd Vorbrugg and Wiebke Wittmu¨ß for comments on a preliminary version of the manuscript.
References
[1] Aubin, J.-P., Ekeland, I. Applied nonlinear analysis. John Wiley & Sons, New York, 1984.
[2] F. Baudoin, Conditioned stochastic differential equations: theory, examples and application to finance, Stochastic Process. Appl. 100 (2002) 109­145.
[3] Castan~eda-Leyva, N., Hern´andez-Herna´ndez, D. Optimal consumption-investment problems in incomplete markets with stochastic coefficients. Preprint, CIMAT Guanajuato (2004).
[4] R. Cont, Model uncertainty and its impact on the pricing of derivative instruments, to appear in Math. Finance.
[5] Delbaen, F., Schachermayer, W. A general version of the fundamental theorem of asset pricing. Math. Ann. 300 (1994), no. 3, 463­520.
[6] Fo¨llmer, H., Schied, A. Stochastic Finance: An Introduction in Discrete Time. Second Edition. Berlin: de Gruyter Studies in Mathematics 27 (2004).
[7] Floret, K., Weakly compact sets. Lecture Notes in Math. 801, Springer-Verlag, Berlin, 1980.
[8] Gilboa, I. Expected utility with purely subjective non-additive probabilities. J. Math. Econ. 16, 65-88 (1987).
[9] Gilboa, I., Schmeidler, D. Maxmin expected utility with non-unique prior. J. Math. Econ. 18, 141-153 (1989).
[10] Goll, T., Ru¨schendorf, L. Minimax and minimal distance martingale measures and their relationship to portfolio optimization. Finance Stoch. 5, no. 4, 557­581 (2001).
[11] Gundel, A. Robust Utility Maximization for Complete and Incomplete Market Models. To appear in Finance and Stochastics.

19
[12] E. Jouini, W. Schachermayer, N. Touzi: Optimal risk sharing with law-invariant monetary utility functions. Working paper, Universit´e Paris Dauphine (2005).
[13] Kramkov, D., Schachermayer, W. The asymptotic elasticity of utility functions and optimal investment in incomplete markets. Ann. Appl. Probab. 9, no. 3, 904­950 (1999).
[14] Kramkov, D., Schachermayer, W. Necessary and sufficient conditions in the problem of optimal investment in incomplete markets. Ann. Appl. Probab., Vol. 13, no. 4 (2003).
[15] Mu¨ller, M. Market completion and robust utility maximization. PhD Thesis, Humboldt-Universita¨t zu Berlin (2005).
[16] Quenez, M.-C. Optimal portfolio in a multiple-priors model. Seminar on Stochastic Analysis, Random Fields and Applications IV, 291­321, Progr. Probab., 58, Birkha¨user, Basel, 2004.
[17] Plachky, D., Ru¨schendorf, L. Conservation of the UMP--resp. maximin-property of statistical tests under extensions of probability measures. Goodness-of-fit (Debrecen, 1984), 439­457, Colloq. Math. Soc. Janos Bolyai, 45, North-Holland, Amsterdam, 1987.
[18] Rockafellar, R. T. Convex analysis. Princeton Mathematical Series, No. 28 Princeton University Press, Princeton, N.J. 1970. Reprinted 1997.
[19] Schied, A. Optimal investments for robust utility functionals in complete market models. Math. Oper. Research. 30, No. 3, 750-764 (2005).
[20] Schied, A. On the Neyman-Pearson problem for law-invariant risk measures and robust utility functionals. Ann. Appl. Probab. 14, 1398-1423 (2004).
[21] Schmeidler, D. Subjective probability and expected utility without additivity. Econometrica 57, no. 3, 571-587 (1989).
[22] Yaari, M. The dual theory of choice under risk. Econometrica 55, no. 1, 95-115 (1987).

SFB 649 Discussion Paper Series
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Nonparametric Risk Management with Generalized Hyperbolic Distributions" by Ying Chen, Wolfgang Härdle and Seok-Oh Jeong, January 2005.
002 "Selecting Comparables for the Valuation of the European Firms" by Ingolf Dittmann and Christian Weiner, February 2005.
003 "Competitive Risk Sharing Contracts with One-sided Commitment" by Dirk Krueger and Harald Uhlig, February 2005.
004 "Value-at-Risk Calculations with Time Varying Copulae" by Enzo Giacomini and Wolfgang Härdle, February 2005.
005 "An Optimal Stopping Problem in a Diffusion-type Model with Delay" by Pavel V. Gapeev and Markus Reiß, February 2005.
006 "Conditional and Dynamic Convex Risk Measures" by Kai Detlefsen and Giacomo Scandolo, February 2005.
007 "Implied Trinomial Trees" by Pavel !ízek and Karel Komorád, February 2005.
008 "Stable Distributions" by Szymon Borak, Wolfgang Härdle and Rafal Weron, February 2005.
009 "Predicting Bankruptcy with Support Vector Machines" by Wolfgang Härdle, Rouslan A. Moro and Dorothea Schäfer, February 2005.
010 "Working with the XQC" by Wolfgang Härdle and Heiko Lehmann, February 2005.
011 "FFT Based Option Pricing" by Szymon Borak, Kai Detlefsen and Wolfgang Härdle, February 2005.
012 "Common Functional Implied Volatility Analysis" by Michal Benko and Wolfgang Härdle, February 2005.
013 "Nonparametric Productivity Analysis" by Wolfgang Härdle and Seok-Oh Jeong, March 2005.
014 "Are Eastern European Countries Catching Up? Time Series Evidence for Czech Republic, Hungary, and Poland" by Ralf Brüggemann and Carsten Trenkler, March 2005.
015 "Robust Estimation of Dimension Reduction Space" by Pavel !ízek and Wolfgang Härdle, March 2005.
016 "Common Functional Component Modelling" by Alois Kneip and Michal Benko, March 2005.
017 "A Two State Model for Noise-induced Resonance in Bistable Systems with Delay" by Markus Fischer and Peter Imkeller, March 2005.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

018 "Yxilon ­ a Modular Open-source Statistical Programming Language" by Sigbert Klinke, Uwe Ziegenhagen and Yuval Guri, March 2005.
019 "Arbitrage-free Smoothing of the Implied Volatility Surface" by Matthias R. Fengler, March 2005.
020 "A Dynamic Semiparametric Factor Model for Implied Volatility String Dynamics" by Matthias R. Fengler, Wolfgang Härdle and Enno Mammen, March 2005.
021 "Dynamics of State Price Densities" by Wolfgang Härdle and Zden"k Hlávka, March 2005.
022 "DSFM fitting of Implied Volatility Surfaces" by Szymon Borak, Matthias R. Fengler and Wolfgang Härdle, March 2005.
023 "Towards a Monthly Business Cycle Chronology for the Euro Area" by Emanuel Mönch and Harald Uhlig, April 2005.
024 "Modeling the FIBOR/EURIBOR Swap Term Structure: An Empirical Approach" by Oliver Blaskowitz, Helmut Herwartz and Gonzalo de Cadenas Santiago, April 2005.
025 "Duality Theory for Optimal Investments under Model Uncertainty" by Alexander Schied and Ching-Tang Wu, April 2005.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

