BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2009-021
Spectral estimation of the fractional order of a LÈvy process
Denis Belomestny*
*Weierstrass-Institute Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

Spectral estimation of the fractional order of a L¥evy process
Belomestny, Denis  Weierstrass-Institute, Mohrenstr. 39, 10117 Berlin, Germany belomest@wias-berlin.de
April 13, 2009
Abstract We consider the problem of estimating the fractional order of a L¥evy process from low frequency historical and options data. An estimation methodology is developed which allows us to treat both estimation and calibration problems in a unified way. The corresponding procedure consists of two steps: the estimation of a conditional characteristic function and the weighted least squares estimation of the fractional order in spectral domain. While the second step is identical for both calibration and estimation, the first one depends on the problem at hand. Minimax rates of convergence for the fractional order estimate are derived, the asymptotic normality is proved and a data-driven algorithm based on aggregation is proposed. The performance of the estimator in both estimation and calibration setups is illustrated by a simulation study. AMS 2000 Subject Classification: Primary 62F10. Secondary 62J12,62F25,62H12
Keywords: regular L¥evy processes, Blumenthal-Getoor index, semiparametric estimation
JEL CLASSIFICATION: C12, C13
1 Introduction
Nowadays L¥evy processes are undoubtedly one of the most popular tool for modeling economic and financial time series (see e.g. Cont and Tankov, 2004, for an overview).
The financial support from the Deutsche Forschungsgemeinschaft via SFB 649 "Okonomisches Risiko" is gratefully acknowledged
1

belomestny, d.

2

This is not surprising if one takes into account their simplicity and analytic tractability on the one hand and the ability to reproduce many stylized facts of financial time series on the other hand. In the last decade, new subclasses of L¥evy processes have been introduced and actively studied (mainly in the context of option pricing). Among the best known models are normal inverse Gaussian processes (NIG), hyperbolic processes (HP), generalized hyperbolic processes (GHP) and truncated (or tempered) L¥evy processes (TLP). Boyarchenko and Levendorskii (2002) have introduced a general class of regular L¥evy processes of exponential type (RLE) which contains all above mentioned particular L¥evy models. This type of processes is characterized by the requirement that the modulus of the characteristic function of increments behaves like exp(-|u|) as |u|   for some 0 <  < 2. Parameter  coincides with the fractional order of the underlying L¥evy process and plays an important role because it determines the decay of the characteristic function and hence the smoothness properties of the corresponding state price density. Statistical inference for RLE processes is the subject of our paper.
There are basically two types of statistical problems relevant for L¥evy processes: the estimation of parameters of a L¥evy process Xt from a time series of the asset St = exp(Xt) and the calibration of these parameters using options data. Both problems have got much attention recently.
Suppose that a L¥evy process Xt is observed at n time points , 2, . . . , n. Since X0 = 0, this amounts to observing n increments i = Xi - X(i-1), i = 1, . . . , n. If  is small (high-frequency data), then a large increment i indicates that a jump occurred between time ti-1 and ti. Based on this insight and the continuous-time observation analogue, inference for the L¥evy measure of the underlying L¥evy process can be conducted. See, for example, A®it-Sahalia and Jacod (2006) for a semiparametric problem of estimating volatility of a stable process under the presence of L¥evy perturbation or Lee and Mykland (2007) and Figueroa-L¥opez and Houdr¥e (2006) for a nonparametric problems of testing and estimation for jump diffusion models. For low-frequency observations, however, we cannot be sure to what extent the increment i is due to one or several jumps or just to the diffusion part of the L¥evy process. The only way to draw inference is to use the fact that the increments form independent realizations of infinitely divisible probability distributions. In this setting, a variety of methods have been proposed in the literature: standard maximum likelihood estimation (DuMouchel, 1973a,b, 1975), using the empirical characteristic function as an estimating equation (see e.g. Press, 1972; Fenech, 1976; Feuerverger and McDunnough, 1981a; Singleton, 2001), maximum likelihood by Fourier inversion of the characteristic function (Feuerverger and McDunnough, 1981b), a regression based on the explicit form of the characteristic function (Koutrouvelis, 1980), or other numerical approximations (Nolan, 1997). Some of these methods were compared

belomestny, d.

3

in Akgiray and Lamoureux (1989). Note that all of the aforementioned papers deal with the specific parametric (mainly stable) models. A semiparametric estimation problem for L¥evy models has recently been considered in Neumann and Reiﬂ (2007) and Gugushvili (2008).
The second, calibration problem is of special importance for financial applications because pricing of options is performed under an equivalent martingale measure and one can infer on this measure only from options data. Since option data is sparse and the underlying inverse problem is usually ill-posed, we face a rather complicated estimation issue. Different approaches have been proposed in the literature to regularize the underlying inverse problem. For example, in Cont and Tankov (2004) and Cont and Tankov (2006) a method based on the penalized least squares estimation with the minimal entropy penalization is proposed. Belomestny and Reiﬂ (2006) developed a spectral calibration method which avoids solving a high dimensional optimization problem and is based on the direct inversion of a Fourier pricing formula with a cut-off regularization in spectral domain. This method essentially employees the integrability property of the underlying L¥evy measure (finite activity L¥evy processes) that excludes many interesting infinite activity L¥evy processes.
In this paper we consider the problem of estimating the fractional order of a L¥evy process from low-frequency historical as well as options data. Our problem is semiparametric one because we do not assume any specific parametric model for the underlying process but only some asymptotic behavior. The spectral approach allows us to treat both estimation and calibration problems in a unified framework and leads to an efficient data-driven algorithm. Moreover, the fractional order estimate delivered by the spectral method possesses several interesting optimality properties.
The problem of estimating the degree of activity of jumps in semimartingale framework using high-frequency financial data has recently been considered in A®it-Sahalia and Jacod (2009). On the one hand, small increments of the process turn out to be most informative for estimating the activity index. On the other hand, these small increments are the ones where the contribution from the continuous martingale part is mixed with the contribution from the small jumps. A®it-Sahalia and Jacod (2009) proposed an estimation procedure which is able to "see through" the continuous part and consistently estimate the degree of activity for the small jumps under some restrictions on the structure of the underlying semimartingale. Note that in the case of L¥evy processes the degree of activity of jumps is identical to the fractional order of the underlying L¥evy process. We also stress that the case when both diffusion and jump components are presented can be treated in the framework of spectral estimation as well (see Section 6.9).
Short outline of the paper. In Section 2 we introduce the class of RLE processes.

belomestny, d.

4

Section 3 discusses some aspects of financial modeling with RLE processes. Section 4 describes the observational model. In Section 5 methods of estimating the characteristic function of a L¥evy process from low-frequency historical and options data are presented. Section 6 is devoted to the spectral calibration method of estimating the fractional order . We discuss here the problems of regularization and derive minimax rates of convergence for a class of L¥evy processes. In Section 7 adaptive procedure for estimating  is presented and its properties are discussed. We conclude with some simulation results.

2 Regular L¥evy processes of exponential type
In this section we recall some basic properties of L¥evy processes.

2.1 Spectral properties of L¥evy processes

Consider a L¥evy process Xt with a L¥evy measure . That is, Xt is c`adla`g process with independent and stationary increments such that the characteristic function of its marginals t(u) is given by

(2.1)

t(u) := E eiuXt

= exp

t

iuµ

-

u2a2 2

+

(eiux - 1 - iux1{|x|1})(dx)
R

.

So, any L¥evy process Xt is characterized by the so called L¥evy triple (µ, a, ), where µ  R is a drift, a > 0 is a diffusion volatility and  is a L¥evy measure. Note that the drift µ depends on the type of truncation in (2.1). In fact, this characterization is unique for a fixed truncation function and we can reconstruct L¥evy triple from the characteristic function t(u). This reconstruction may be viewed as consisting of three steps. First, because of

(2.2)

1 |u|2

(eiux - 1 - iux1{|x|1})(dx)  0,
R

|u|  ,

we can find a2/2 as lim|u| |u|-2(u) with

(u) = t-1 log(t(u)).

Second, note that

1
(~(u) - ~(u + w)) dw = eiux(dx)
-1 R

with

~(u)

=

(u)

+

a2 2

u2,

(dx) = 2

1

-

sin x

x

(dx).

Since  is a finite measure ( (x2  1)(dx) < ), one can uniquely reconstruct it (and hence ) from ~(u). Finally, we find µ as limu ~(u)/(iu) . So, in principle, we can

belomestny, d.

5

recover all characteristics of the underlying L¥evy process (including the fractional order) provided that t is completely known. If, however, t is estimated from data we face an ill-posed estimation problem because a small perturbation in t may deteriorate its asymptotic behavior and lead to the violation of (2.2). In this case using a regularization technique (see e.g. Cont and Tankov (2004) or Belomestny and Reiﬂ (2006)), we still can get an asymptotically consistent estimates for the whole triple (µ, a, ) given a consistent estimate of t.
Remark 2.1. A consistent estimation of (u) from a time series of Xt is only possible if the number of observations from the distribution with the c. f. t(u) for some t > 0 increases. This can be either due to a decreasing time step in a times series of the process X (high frequency data) or due to an increasing time horizon (low frequency data). While the first type of observational models has got much attention in recent years, there are only few papers dealing with low frequency data (see e.g. Neumann and Reiﬂ (2007)).

2.2 Fractional order of L¥evy processes
Let Xt be a L¥evy process with a L¥evy measure . The value

 := inf r  0 :

|x|r(dx) < 

|x|1

is called the fractional order or the Blumenthal-Getoor index of the L¥evy process Xt. This index  is related to the "degree of activity" of jumps. All L¥evy measures put finite mass on the set (-, -]  [, ) for any arbitrary  > 0, so if the process has infinite jump activity it must be because of the small "jumps", defined as those smaller than . If ([-, ]) <  the process has finite activity and  = 0. But if ([-, ]) =  i.e. the process has infinite activity and in addition the L¥evy measure ((-, -]  [, )) diverges near 0 at a rate ||- for some  > 0 then the fractional order of Xt is equal to . The higher  gets, the more frequent the small jumps become (see A®it-Sahalia and Jacod (2009) for more discussion).
The Blumenthal-Getoor index is closely related to the notion of the degree of jump activity that applies to general semimartingales as shown in A®it-Sahalia and Jacod (2009), and reduces to the Blumenthal-Getoor index in the special case of L¥evy processes.
Note also that the Blumenthal-Getoor index coincides with the stability index for stable processes. Another example of processes having a prescribed fractional order  is the class of tempered stable processes of order . Boyarchenko and Levendorskii (2002) studied a generalization of tempered stable processes, called regular L¥evy processes of exponential type (RLE). A L¥evy process is said to be a RLE process of type [--, +]

belomestny, d.

6

and order   (0, 2) if the L¥evy measure has exponentially decaying tails with rates

-  0 and +  0

(2.3)

-1
e-|y| (dy) < ,
-


e+y (dy) < 
1

and behaves near zero as |y|-(1+):

(dy)
|y|>



() 

,

  +0,

where  is some positive function on R+ satisfying 0 < (+0) < . Obviously, the fractional order of a RLE process of order  is equal to . An equivalent definition of a RLE process in terms of its characteristic exponent (u) can be given as follows. A L¥evy process is called to be a RLE process of type [--, +] and order   (0, 2) if the following representation holds

(2.4)

(u) = iµu + (u), µ  R,

where function  admits a continuation from R into the strip {z  C : Im z  [--, +]} and is of the form

(2.5)

(u) = -|u|(u),

where (u) is a function satisfying lim sup|u| |(u)| <  and lim inf|u| |(u)| > 0 such that

(2.6)

Re[(u)] > 0, u  R \ {0}.

As was mentioned in the introduction, the class of RLE processes includes among others hyperbolic, normal inverse Gaussian and tempered stable processes but does not include variance Gamma process. In the sequel we will mainly consider RLE processes without regularity conditions (2.3) (or equivalently with - = + = 0) since only the behavior of a L¥evy measure near zero matters for the fractional order of the corresponding L¥evy process.
As mentioned before, in this work we are going to consider the problem of estimating the fractional order  of a L¥evy process Xt from a time series of asset prices as well as from option prices. Before turning to this, let us first make our modelling and observational framework more precise.

3 Financial modelling
In this section we recall basic facts concerning financial modelling with exponential L¥evy models.

belomestny, d.

7

3.1 Asset dynamics

We assume that the asset price St follows an exponential L¥evy model under both historical

measure P and risk neutral measure Q. Specifically, we suppose that

 SeXt , St = Sert+Yt ,

under P, under Q,

where Xt and Yt are L¥evy processes, S > 0 is the present value of the asset (at time 0) and r  0 is the riskless interest rate which is assumed to be known and constant. Note, that the martingale condition for St under Q entails EQ[eYt ] = 1. The martingale measure Q is in fact not unique under the presence of jumps. As is standard in the
calibration literature, it is assumed to be settled by the market and to be identical for
all options under consideration. Processes Xt and Yt are related by the requirement that measures P and Q ought to be equivalent: P  Q. Interestingly, this implies that if Xt and Yt are RLE process and Xt is of order P then Yt has the order Q = P. Indeed, the equivalence of the corresponding L¥evy measures P and Q implies (see, Sato (1999))

(3.1)

2
dQ/dP - 1 P(dx) < .
0

Since for RLE processes dQ(x)/dP(x)  x(P-Q) and dP(x)  x-(1+P) dx as x  +0, the condition (3.1) can be satisfied only if P = Q. This means that the fractional order of the underlying L¥evy process must be the same under both historical and risk-neutral measures. This not only indicates the importance of the fractional order parameter for financial applications but also suggests that the combination of two estimates of the fractional order  under P and Q might be useful e.g. to reduce the overall variance of the resulting combined estimator.

3.2 Option pricing

The risk neutral price at time t = 0 of the European call option with strike K and

maturity T is given by

C(K, T ) = e-rT EQ[(ST - K)+].

Using the independence of increments, we can reduce the number of parameters by introducing the so called negative log-forward moneyness

y := log(K/S) - rT,

such that the call price in terms of y is given by

C(y, T ) = S EQ[(eYT - ey)+].

belomestny, d.

8

The analogous formula for the price of the European put option is P(y, T ) = S EQ[(ey - eYT )+] and a well-known put-call parity is easily established

C(y, T ) - P(y, T ) = S EQ[eYT - ey] = S(1 - ey).

As we need to employ Fourier techniques, we introduce the function

(3.2)

 S-1C(y, T ), OT (y) := S-1P(y, T ),

y  0, y < 0.

The function OT records normalized call prices for y  0 and normalized put prices for y < 0. It possesses many interesting properties (see, Belomestny and Reiﬂ (2006) for

details) one of them being the following connection between the Fourier transform of OT and the characteristic function of YT denoted by QT

(3.3)

F[OT ](v)

=

1

- TQ(v - v(v - i)

i) ,

v  R.

Another property which directly follows from (3.3) is that

(3.4)

e-2yOT (y) dy < ,
R

provided that E[e2YT ] exists and is finite.

4 Observations
We consider two kinds of observational models corresponding to two types of statistical problems we are going to tackle. While the first type of models assumes the a time series of St is directly available, the second one supposes that only some functionals of St can be observed.

4.1 Time series data
We assume that the values of the log-price process Xt = log(St) on equidistant time grid  = {t0, t1, . . . , tn} are observed.

4.2 Option data
As to option data, we assume to be given the prices of n call options for a set of forward log-moneynesses y0 < y1 < . . . < yn and a fixed maturity T , corrupted by noise. In terms of the function O, the following sample is available

(4.1)

OT (yj) = OT (yj) + (yj)j, j = 1, . . . , n.

belomestny, d.

9

It is supposed that {j} are independent centered random variables with E[j2] = 1 and supj E[j4] < . Furthermore, we assume that
e-2y2(y) dy < .
R
This condition is required because we need to transform the original regression model
(4.1) to an exponentially weighted one

(4.2)

OT (yj) = OT (yj) + (yj)j, j = 1, . . . , n

with OT (y) = e-yOT (y), OT (y) = e-yOT (y) and (y) = e-y(y). As a matter of fact, a consistent estimation of the fractional order  is only possible
if the amount of data available increases. In our asymptotic analysis we will therefore

assume that the number of time series observations and the number of available options tend to infinity.

5 Estimation of characteristic functions P and Q
The main idea of the spectral estimation method (SEM) is to infer on the parameters of the underlying model using its special structure in the spectral domain. Since spectral behavior of a RLE process is described explicitly by (2.4)-(2.5), we can apply SEM as soon as an estimate for the corresponding characteristic function is available. While estimation of  under P is rather straightforward, its calibration from option prices under Q requires special treatment.

5.1 Estimation of  under P

We estimate the characteristic function P||(u) by its empirical counterpart

~|P|(u)

=

1 n

n

eiu(Xtj -Xtj-1 ).

j=1

The empirical characteristic function ~|P| possesses many interesting properties and we refer to Ushakov (1999) for a comprehensive overview.

5.2 Estimation of  under Q

For estimating TQ we employ the Fourier technique. So, motivated by (3.3) we define 

n

(5.1)

~TQ(u) := 1 - u(u + i)  jOT (yj)eiuyj  , u  R,

j=1

where j = yj - yj-1 and OT is defined in (4.2). For more involved methods of approximating F[OT ](u) see Belomestny and Reiﬂ (2006).

belomestny, d.

10

6 Estimation of fractional order
In this section we turn to the problem of estimating the fractional order of a RLE process. To this aim we apply the spectral estimation method accompanied with a spectral cut-off regularization.

6.1 Main idea

Let us consider a RLE process with the characteristic exponent (u) of the form (2.4)(2.5). In the sequel we assume (mainly for the sake of simplicity) that limu- (u) = limu (u) =   R+. In this case we can rewrite  as

(6.1)

(u) = -|u| (u),

where Re[ (u)] > 0 for u  R \ {0} and  (u)  1 as |u|  . The formula

(6.2)

Y(u) := log(- log(|(u)|2)) = log(2) +  log(u) + log(Re  (u)), u > 0,

with (u) = exp((u)), suggests now the way how to estimate  from . Indeed, in terms of the new "data" Y we have a linear semiparametric problem with the "nuisance" non-parametric part log(Re  (u)). Since log(Re  (u)) tends to 0 as |u|  , we can get rid of this component by basing our estimation on Y(u) with large |u|. On the other hand, if we plug-in an estimate ~ instead of , the variance of Y(u) will increase exponentially with |u| (because of the exponential decay of (u)) and we have to regularize the problem by cutting high frequencies. An appropriate weighting scheme would allow to take both effects into account.

6.2 Truncation
First, we truncate ~ to avoid logarithm's explosion. Let

Y~(u) := log(- log(T-,+[|~|2](u))), u  R \ {0},

where the truncation operator T-,+ with truncation levels 0 < -  + < 1 is defined

via  +, f (u) > +,

T-,+ [f ](u) = f (-u,),

-  f (u)  +, f (u) < -

for any real-valued function f .

belomestny, d.

11

6.3 Linearization

Truncation allows us to linearize the problem. Set

± (u)

:=

|(u)|2

1

±

1

2| log |(u)|| + 2| log |(u)||

.

The following lemma holds

Lemma 6.1. For any u  R \ {0} and any -(u), +(u) satisfying 0 < -  -  +  + < 1,
the following inequality holds with probability one Y~(u) - Y(u) - 1(u)(|~(u)|2 - |(u)|2)  2(u)(|~(u)|2 - |(u)|2)2,

where

1(u) = -2-1|(u)|-2 log-1(|(u)|)

and

2(u)

=

2 max
 {- (u),+ (u)}

1 + | log()| 2 log2()

.

Using the notation

(u) := |~(u)|2 - |(u)|2,

Lemma 6.1 can be reformulated as follows

Corollary 6.2. For any u  R \ {0}

(6.3)

Y~(u) - Y(u) = 1(u)(u) + Q(u),

where (6.4)

|Q(u)|  2(u)2(u)

with probability one.

Remark 6.1. Since (0) = 1 and (u)  0 as |u|   the behavior of truncation levels -(u) and +(u) in the vicinity of points u = 0 and u =  becomes important for determining the behavior of Y~(u) around these points. However, the values of Y~(u) around 0 will be discarded while estimating  and hence we do not need to know +(u) for small |u|. As to -(u), it can be constructed if some prior information on the BlumenthalGetoor index  and the function (u) =  (u) is available. For instance, if   Ø for some Ø  2 and Re[(u)]  + for all u  R then one can take
-(u) = Ce-2+|u|Ø |u|-Ø, |u|  

with some constant C > 0 depending on +.

belomestny, d.

12

Note that the slope coefficient 1 grows exponentially with |u|. This means that the variance of Y~(u) grows exponentially as well and the values of Y~(u) with large |u| should
be discarded when estimating .

6.4 Spectral cut-off estimation

Taking into account the special semi-linear structure of (6.2) together with a heteroscedastic variance of Y~(u), we apply a weighted least squares method to estimate . Let w1(u)

be a function supported on [, 1] with some  > 0 that satisfies

For any U > 0 put

1
w1(u) log(u) du = 1,
0

1
w1(u) du = 0.
0

wU (u) = U -1w1(uU -1)

and define an estimate ~U of  as

(6.5)



~U =

wU (u)Y~(u) du.

0

It is instructive to see what happens with ~U in the case of exact data, i.e Y~ = Y. One

can see that in this case the following decomposition holds


~U = log(2) wU (u) du + wU (u) log(u) du +RU
00

01

with

(6.6)


RU := wU (u) log(Re  (u)) du.
0

So, even in the case of perfect observations we still have the "bias" term RU induced by model misspecification. Indeed, when applying the least squares method we ignore a

non-linearity caused by RU and treat the problem as being linear. This is, however, only justified if RU is small. In fact, RU can be made small by taking large values of U .

6.5 Further specification of the model class

In order to rigorously study the complexity of the underlying estimation problem we have to make further assumptions about the model class. Let us consider a class of L¥evy models A(Ø, -, +, ) with

(6.7)

(u) = iµu + (u), (u) = -|u| (u), u  R,

where 0 <   Ø  2,

(6.8)

0 < -    + < 

belomestny, d.

13

and

(6.9)

|1 -  (u)|

for some 0 <   . We will write

1 |u|

,

|u|  

(, ,  )  A(Ø, -, +, )

to indicate that the L¥evy process with characteristics (, ,  ) is in the class A. The following proposition shows that conditions (6.7), (6.8) and (6.9) can be in fact rephrased in terms of the L¥evy density of a A(Ø, -, +, ) process.

Proposition 6.3. Let (x) be the L¥evy density of a L¥evy process satisfying (6.7), where the function  fulfills

(6.10)

 (u) = 1 + D±u- + o(|u|-), u  ±

with some constants D+ and D-. Then

(6.11)

x2(x) dx = c2-(),
|x|<

where c > 0 is a constant depending on  and  and the function () satisfies

|() - 1| ||,   0.

As will be shown in the next two sections even in the class A(Ø, -, +, ) the problem of estimating  is severely ill-posed, that is a small perturbation  in data may lead (in worst case) to log-/Ø(1/) distance between  and its best estimate. On other hand, it turns out that our estimate ~U achieves the best possible rates of convergence in the class A(Ø, -, +, ).

6.6 Upper bounds

Let us define

 n-1,  :=   2 +

n j=1

j2

~2(yj

),

under P, under Q,

where  2 =

n j=1

j2,

~(yj ) = e-yj (yj )

and

j

= yj - yj-1.

In

the

case

of

calibration

 comprises the level of the numerical interpolation error and of the statistical error

simultaneously. In this section we will study the asymptotic behavior of the estimate

~U = ~U () defined in (6.5) as   0, A := min{-y0, yn}   and e-A  2. Thus,

it is assumed that the number of historical observations as well as the number of available

options tend to infinity. First, we present an upper bound showing that our estimate ~U with the "optimal" choice of the cut-off parameter U converges to  with a logarithmic

rate in .

belomestny, d.

14

Theorem 6.4. For U = UØ with

UØ =

1 2+

log

-1 log-(1/)

1/Ø

and 

1 + /Ø,

under P,

 = ( + 4)/Ø - 1, under Q,

it holds

(6.12)

sup E |~UØ - |2 R(),   0,
(,, )A(Ø,-,+,)

where

R() =

1 2+

log

-1

-2/Ø
.

Remark 6.2. Since the rates are logarithmic it is usual to call the underlying estimation problem severely ill-posed. From a practical point of view severely ill-posedeness means that more observations are needed to reach the desired level of accuracy than for wellposed problems.

Remark 6.3. As can be easily seen the convergence rates depend on Ø, a prior upper bound for . If there is no prior information on Ø one may take Ø = 2.

Remark 6.4. For symmetric stable processes we have  (u)  1 and it can be shown that the rates are parametric in this case, that is

sup E |~UØ - |2
(,, )A(Ø,-,+,)
for some UØ depending on .

,   0

6.7 Lower bounds

Now we show that the rates obtained in the previous section are the best ones in the minimax sense for the class A(Ø, -, +, ).

Theorem 6.5. It holds

(6.13)

lim
s0

lim inf
0

inf
~

sup
(,, )A(Ø,-,+,)

n-,2s()

E(|~

-

|2)

=

O(1),

where

n,s() =

1 2+

log

-1

-/(Ø-s)
,

and the infimum is taken over all estimators ~ of .

belomestny, d.

15

6.8 Asymptotic behavior
In this section we complete the investigation of asymptotic properties of the estimate ~ by proving its asymptotic normality. In the case of estimation under P we have the following
Theorem 6.6. Denote
 1/2
(, U ) =  wU (u)wU (v)1(u)1(v)S(u, v) du dv
0
with
S(u, v) : = Re (u - v) + Im (u + v) -(Re (u) + Im (u))(Re (v) + Im (v)).
Let U = U () be a sequence of cutoffs such that U ()   and (, U ())   > 0 as   0. Then
-1(, U ())(~U() - )  N(0, 1),   0.
A similar result can be proved in the case of calibration as well.

6.9 Processes with a non-zero diffusion part

In fact, spectral calibration algorithm allows us to treat more general models with a non-zero diffusion part. Let A(aØ, Ø, -, +, ) be a class of L¥evy processes with the characteristic exponent of the form

(6.14)

a(u) = iµu - a2u2/2 + (u), (u) = -|u| (u), u  R,

where 0 < a < aØ and conditions (6.8)-(6.9) are fulfilled. We will write (a, , ,  )  A(aØ, Ø, -, +, ) to indicate that a L¥evy process with the characteristic exponent (6.14) belongs to A(aØ, Ø, -, +, ).
Assume first that a(u) = exp(a(u)) is known exactly. Define
L(u) := log(|a(u)|2) = -a2u2 + 2 Re[(u)]

and L(u) := 2L(u) - L(u) = log |a(u)|22 /|a(u)|2 =: log((u))
for some  > 1. It obviously holds

L(u) = -|u| 2 Re[ (u)] -  Re[ (u)] = -c()|u|(u),

belomestny, d.

16

where c() = (2 - )-1 and (u) fulfills

(6.15)

|1 - (u)|

1 |u|

,

|u|  .

Thus, L(u) has a structure similar to the structure of (u) in (6.7) and we can carry over the results of the previous section to a more general models (6.14) by defining

Y~(u) := log - log(T-,+[](u)) ,

where (u) = |~(u)|22 /|~(u)|2 with  being an estimate of a. Define

(6.16)



~,U =

wU (u)Y~(u) du.

0

The following two theorems are extensions of Theorems 6.4 and 6.5 respectively to the

case of L¥evy models with a nonzero diffusion part.

Theorem 6.7. For U = UØ with

UØ =

1 2aØ

log

-1 log-(1/)

1/2

and  = 1 + /2 it holds

(6.17)

sup E |~,UØ - |2 R(),   0,
(a,,, )A(aØ,Ø,-,+,)

where

R() = c-1(Ø)

1 2aØ

log

-1

-
.

Theorem 6.8. It holds

(6.18)

lim inf
0

inf
~

sup
(a,,, )A(aØ,Ø,-,+,)

n-2 ()

E(|~

-

|2)

=

O(1),

where

n() =

1 2aØ

log

-1

-/2
,

and the infimum is taken over all estimators ~ of .

As can be easily seen the estimate ~,UØ is consistent as long as Ø < 2. The nearer is Ø to 2 the closer is the constant c(Ø) to zero and the more difficult becomes the estimation problem. Note also that the convergence rates for the case of a nonzero diffusion part correspond (up to a constant) to the rates in the class of L¥evy models with zero diffusion part when the roughest prior for  (Ø = 2) is used for the estimation.

belomestny, d.

17

7 Adaptive Procedure

Minimax results obtained in the previous sections show the complexity of the underlying

estimation problem but are not very helpful in practice. Putting aside the fact that

they are related to the performance of the procedure in the worst situation (worst case

scenario) which is not necessarily the case for the given model from A(Ø, -, +, ), the choice of U suggested there depends on Ø, is asymptotic and likely to be inefficient for

small sample sizes. In this section we propose an adaptive procedure for choosing the cut-

off parameter U . First, let us fix a sequence of cut-off parameters U1 > U2 > . . . > UK

and define



~k =

wUk (u)Y~(u) du, k = 1, . . . , K.

0

We suggest a method based on the combination of multiple testing and aggregation ideas

(see, Belomestny and Spokoiny (2007)). Namely, for the sequence of estimates ~k consider a sequence of nested hypothesis Hk : 1 = . . . = k = , where



k =

wUk (u)Y(u) du, k = 1, . . . , K.

0

The hypothesis Hk basically means that RUi = 0 for i = 1, . . . , k. The procedure is sequential: we put ^1 = ~1 and start with k = 2 and at each step k the hypothesis

Hk is tested against Hk-1. For testing Hk against Hk-1 we check that the previously constructed adaptive estimate ^k-1 belongs to the confidence intervals built on ~k. Then we put

(7.1)

^k = k~k + (1 - k)^k-1.

The mixing parameter k is defined using a measure of statistical difference between ^k-1

and ~k

k := K(Tk/Vk), Tk := ~k - ^k-1 2/k2,

where k2 is the variance of ~k, K is a kernel supported on [0, 1] and {Vk} is a set of critical values. In particular, k is equal to zero if Hk is rejected, that is ^k-1 lies outside the confidence interval around ~k. The final estimate is equal to ^K .

7.1 Choice of the critical values Vk
The critical values V1, . . . , VK-1 are selected by a reasoning similar to the standard approach of hypothesis testing theory: we would like to provide prescribed performance of the procedure under the simplest (null) hypothesis. In the considered set-up, the null means that

(7.2)

1 = . . . = K = .

belomestny, d.

18

In this case it is natural to expect that the estimate ^k coming out of the first steps of the procedure until index k is close to the nonadaptive counterpart ~k.
To give a precise definition we need to specify a loss function. Suppose that the risk of estimation for an estimate ^ of  is measured by E ^ -  2r for some r > 0. It is not
difficult to show that under the null hypothesis (7.2), each estimate ~k asymptotically fulfills
-1/2(~k - )  N(0, k2),   0.

For example, in the case of estimation under P one can prove (see the proof of Proposition 6.6) that

(7.3) with



k2 =

wUk (u)1(u)wUk (v)1(v)S(u, v) du dv

00

S(u, v) : = Re (u - v) + Im (u + v) -(Re (u) + Im (u))(Re (v) + Im (v)),

Therefore,

E0 k-,2 ~k -  2 r  Cr,

where k2, = k2, Cr = E||2r and  is the standard normal. We require the parameters V1, . . . , VK-1 of the procedure to satisfy

(7.4)

E0 k-,2 ^k - ~k 2 r  Cr ,

k = 2, . . . , K.

Here  stands for a preselected constant having the meaning of a confidence level of the procedure. This gives us K - 1 conditions to fix K - 1 parameters.
Our definition still involves two parameters  and r. It is important to mention that their choice is subjective and there is no way for an automatic selection. A proper choice of the power r for the loss function as well as the "confidence level"  depends on the particular application and on the additional subjective requirements to the procedure.

8 Simulations
8.1 Estimation of the fractional order from a time series
Let us consider the generalized hyperbolic (GH) L¥evy model which was introduced in a series of papers (Eberlein and Keller (1995), Eberlein, Keller and Prause (1998) and Eberlein and Prause (2002)) and emerged from extensive empirical investigations of financial time series. See also Eberlein (2000) for a survey on a number of analytical aspects of

belomestny, d.

19

this model. The characteristic function GH of increments in the GH L¥evy model with parameters (, , , ) is given by

GH (u) = eiµu



2 + 2

K  2 - ( + iu)2


2 - ( + iu)2

K  2 + 2

,

where K is the modified bessel function of the second kind. GH has the L¥evy-Khintchine representation of the form


GH (u) = exp ibu + (eiux - 1 - iux)g(x) dx .
-

Note that this model does not contain a Gaussian component a2u2/2. Function g(x), the

density of the corresponding L¥evy measure, can be represented (see Eberlein (2000)) in

an integral form. From this representation the following expansion for (x) = x2g(x) can

be obtained

(x)

=



+



+

1
2 |x| +

 x + o(|x|),

x  0.

2



A direct consequence of this expansion is that

g(x) dx  1/,   0
|x|>

and hence the fractional order of the GH L¥evy model is equal to 1. In our simulation

study we simulate GH L¥evy process X with  = 0,  = 1 and different pairs of  and

 at n + 1 equidistant points {0, , . . . , n}. Upon that we construct the empirical

characteristic function of increments:

(u)

=

1 n

n

eiu(Xk -X(k-1) ) .

k=1

Following the description of the spectral estimation algorithm, define

Y~(u) := log(- log(T-,+[||2](u))),

where truncation levels - and + are equal to 0.01 and 0.95 respectively. In fact, for practical applications with a medium sample sizes n the choice of these levels is not crucial. Now consider the following minimization problem

(8.1)

U

(l0U

,

l1U )

=

arg

min
l0,l1

0

wU (u)(Y~(u) - l1 log(u) - l0)2 du,

where wU (u) = U -1w(U -1u) and w1(u) = u1{0u1}. An estimate for the fractional order is defined as ~U = l1U . Let U1 > U2 > . . . > UK be an exponentially decreasing sequence of cut-offs and ~1, . . . , ~K be the corresponding sequence of estimates. Following

belomestny, d.

20

(7.1), we construct a sequence of aggregated estimates ^1, . . . , ^K using a triangle kernel and a set of critical values V1, . . . VK computed by (7.4). The variances {k2} in (7.3) are estimated from above using a bound for 1. Box plots of ^ = ^K based on 500 trials for
different n and different pairs of  and  are shown in Figure 8.1.

kappa=1, delta=0.5

kappa=1, delta=1

0.4 0.6 0.8 1.0 1.2 1.4 1.6

0.5 1.0 1.5

100 500 1000 n
kappa=2, delta=1

100 500 1000 n
kappa=5, delta=1

0.6 0.8 1.0 1.2 1.4 1.6

0.5 1.0 1.5

100 500 1000 n

100 500 1000 n

Figure 8.1: Box plots of the estimate ^ under P for different sample sizes and different parameters of the GH process.

8.2 Estimation of the fractional order from options data

In the case of calibration (estimation under Q) we compute first the prices of n call

options

C(yk, T ) = S EQ[(eYT - eyk )+], k = 1, . . . , n

using formula (3.3), where the underlying process Y follows a GH L¥evy model (parameters will be specified later on), S = 1, T = 0.25 and r = 0.06. The log-moneyness design (yi) is chosen to be normally distributed with zero mean and variance 1/3 and reflects the structure of the option market where much more contracts are settled at the money than

belomestny, d.

21

in or out of money. Finally, we simulate

OT (yj) = OT (yj) + (yj)j, j = 1, . . . , n,

where j are standard normal, OT is defined in (3.2) and (y) = [Ø OT (y)]2. In the first step of our estimation procedure we find the function O among all functions

O with two continuous derivatives as the minimizer of the penalized residual sum of

squares

(8.2)

n+1

yn+1

RSS(O, L) = (OT (yi) - O(yi))2 + L

[O(u)]2 du,

i=0 y0

where y0  y1and yn+1  yn are two extrapolated points with artificial values On+1 =

O0 = 0. The first term in (8.2) measures closeness to the data, while the second term

penalizes curvature in the function, and L establishes a trade-off between the two. The

two special cases are L = 0 when O interpolates the data and L =  when a straight line

using ordinary least squares is fitted. In our numerical example we use the R package

psplines with the choice of L that minimizes the generalized cross-validation criterion. It can be shown that (8.2) has an explicit, finite dimensional, unique minimizer which is

a natural cubic spline with knots at the values of yi, i = 1, . . . , n. Since the solution of (8.2) is a natural cubic spline, we can write
n
O(y) = jj(y)
j=1
where j(y), j = 1, . . . , n, is a set of basis functions representing the family of natural cubic splines. We estimate F[O](v + i) by
n
F[O](v + i) = jF[e-yj(y)](v).
j=1
Although F[e-yj(y)] can be computed in closed form, we just use the Fast Fourier Transform (FFT) and compute F[O](v + i) on a fine dyadic grid. On the same grid one

can compute (8.3)

(v) :=

1 T

log

1 + v(v + i)F[O](v + i)

,

v  R,

where log(∑) is taken in such a way that (v) is continuous with (-i) = 0. Now we can

follow the road map of the adaptive spectral calibration algorithm and get an estimate

for the fractional order of the underlying GH L¥evy model. In Figure 8.2 box plots of

the final estimate ^ = ^K based on 500 Monte Carlo trials are shown in the case of the underlying GH L¥evy model with parameters  = -1,  = 1 and different , . Sample

size n is equal to 1000 and noise level Ø takes values in the set {1, 10, 20}. The estimate

^ is obviously biased because of numerical errors (due to the approximation of Fourier

integral and linearization).

belomestny, d.

22

kappa=2, delta=2

kappa=5, delta=2

0.7 0.8 0.9 1.0 1.1 1.2

0.8 0.9 1.0 1.1 1.2

1 10 20 
kappa=2, delta=5

1 10 20 
kappa=5, delta=5

0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3

0.85 0.90 0.95 1.00 1.05 1.10 1.15 1.20

1 10 20 

1 10 20 

Figure 8.2: Box plots of the estimate ^ under Q for different noise levels and different sets of parameters of the underlying GH L¥evy process.

belomestny, d.

23

8.3 Processes with a non-zero diffusion part
Turn now to the class of L¥evy processes containing a non-zero diffusion part which was treated in Section 6.9. The only algorithmic difference to the case of processes with zero diffusion part is that now we first fix some  > 1 and compute
Y~(u) := log(- log(T-,+[||2](u))),
instead of Y~(u), where (u) = |~(u)|22/|~(u)|2 with  being an estimate of a. In the estimation procedure we consider only the set of u with |~(u)| > 0. Note that this set is smaller than the set where |~(u)| > 0 since  > 1. It is also intuitively clear that more observations are needed to estimate ~ with the same quality as |~(u)|2 and therefore the first problem is likely to be computationally more difficult. This conjecture is supported by our simulation study as well. Figure 8.3 shows the boxplots of two estimates ^ and ^ based on 500 samples under historical measure P from the GH L¥evy model with zero diffusion part (left) and with the diffusion parameter a equal to 0.1 (right), remaining parameters , ,  and  being equal to 1, 0, 1 and 4 respectively. The estimate ^ is constructed from the estimates ~U1,, . . . , ~UK, (we use  = 2 and w1(u) = u1{0u1} in (8.1)) via the stagewise aggregation procedure as described in Section 7. We took K = 30, Uk = 100(1.25)-(k-1), k = 1, . . . , K and K(x) = (1 - x)1{0x1}. As to the critical values, they are determined via (7.4) with r = 1,  = 0.5. Note that while the difference between ^ and ^ is rather pronounced for small sample sizes it almost disappears for sample sizes as large as 1000.

kappa=1, delta=5, a=0

kappa=1, delta=5, a=0.1

-0.5 0.0 0.5 1.0 1.5 2.0 -0.5 0.0 0.5 1.0 1.5 2.0

100 500 1000 n

100 500 1000 n

Figure 8.3: Box plots of the estimates ^ (left) and ^ (right) under P for different sample sizes n.

belomestny, d.

24

9 Appendix

9.1 Proof of Lemma 6.1

For any positive - and + satisfying -(u)  |(u)|2  +(u), we have

Y~(u) - Y(u) - 1(u)(T-,+[|~|2](u) - |(u)|2) 

2(u) 2

(T-

,+

[|~|2

](u)

-

|(u)|2)2



2(u) (|~(u)|2 - |(u)|2)2. 2

Furthermore

|~(u)|2 - T-,+[|~|2](u)  |~(u)|2 - |(u)|2 , u  Rd and it holds on the set |~(u)|2  [-, +]
|~(u)|2 - |(u)|2  min{|(u)|2 - -, + - |(u)|2}.

Thus,

1(u)

|~(u)|2 - T-,+[|~|2](u)



2(u) 2

|~(u)|2 - |(u)|2 2

on the set |~(u)|2  [-, +], provided that

2|(u)|2

|log (|(u)|)| min{|(u)|2

-

-, +

-

|(u)|2}



|(u)|4 log2(|(u)|2 1 + | log(|(u)|2)|

)

,

that is

min

1

-

- |(u)|2

,

+ |(u)|2

-

1



1

log(|(u)|2) + | log(|(u)|2

)|

.

9.2 Proof of Proposition 6.3

Without loss of generality we can assume that µ = 0 in (6.7). Denote

(x) =

1

-

sin x

x

(x),

then  is, up to a scaling factor, the density of some probability distribution with the

characteristic function (u), where  is a positive constant and
1
(u) = ((u) - (u + w)) dw.
-1
Due to (6.10) the following asymptotic expansion holds

1
(u) = |u| (u)
-1

1-

1

+

w u

  (u + w)  (u)

dw

= C±(, )|u|-2 1 + O(|u|-) ,

u  ±

with some constants C+ and C- depending on  and . We consider separately two cases.

belomestny, d.

25

Case 0 <  < 1 Note that in this case (u) is integrable on R and the Fourier inversion

formula implies

(x)

=

 2


(exp(-ixu) - 1)(u) du
-

since (0) = 0. We have for any positive number a



(exp(-ixu) - 1)(u) du =

(exp(-ixu) - 1)(u) du

- |u|a

+ (exp(-ixu) - 1)(u) du =: I1 + I2,
|u|>a
where |I1| |x| |x|1-+ for x  0 provided that   . Furthermore,

I2 = C±(, )

(exp(-ixu) - 1)|u|-2 du + O(|x|1-+)

|u|>a

= C±(, )|x|1- [1 + O(|x|)] , x  ±0

and (6.11) holds.

Case 1   < 2 In this case we use the Fourier inversion formula for distribution

functions to get

(x) dx
|x|<

=

2 

 0

sin(u) u

Re[(u)]

du.

The representation

 0

sin(u) u

Re[(u)]

du

=

a 0

sin(u) u

Re[(u)]

du

+

 a

sin(u) u

Re[(u)]

du

=:

I1

+

I2.

and the asymptotic relation

I2

=

C+(, )

 a

sin(u) u

u-2

du

+

O(2-+)

= C+(, )2- [1 + O()] ,   +0

lead now to (6.11) provided that    - 1.

9.3 Proof of Theorem 6.4

The representation ~U -  =
and Lemma 6.1 imply that


wU (u)(Y~(u) - Y(u)) du + RU ,
0

(9.1)

E |~U - |2  3 E

2
wU (u)1(u)(u) du

0

2

+3E

wU (u)2(u)2(u) du + 3|RU |2.

0

belomestny, d.

26

Let us consider the first term in (9.1)

Since

 2

2

E wU (u)1(u)(u) du =

wU (u)1(u) E[(u)] du

00



+ Var

wU (u)1(u)(u) du .

0

1(u) = 2-1|(u)|-2 log-1(|(u)|) = e2|u| Re (u)/(2|u| Re  (u))

we have

1

wU (u)1(u) E[(u)] du =

w1(u)1(U u) E[(U u)] du

00

(9.2)

=

U -

1 0

w1(u)e2U u Re  (U u) 2u Re  (U u)

E[(U u)] du.

Due to localization principle (Laplace method) and the identity

E[(u)] = E |~(u)|2 - |(u)|2 = (1 - |(u)|2),

the integral in (9.2) is asymptotically (as U  ) less than or equal to

1

AU -

w1(u)u-e2Uu du

1-

U -e2U

with arbitrary small  > 0 and some constant A > 0. Similarly


Var wU (u)1(u)(u) du =
0 
wU (u)wU (v)1(u)1(v) Cov((u), (v)) du dv
00
U -2e2U + 2U -4e4U , U  ,

where again localization principle and the identity
Cov(|~(u)|2, |~(v)|2) = 23(-1 - 1)(-1 - 2)[Re((u)(v)(-u - v)) + Re((-u)(v)(u - v)) - 2|(u)|2|(v)|2] +3(-1 - 1)[|(u + v)|2 + |(-u + v)|2 - 2|(u)|2|(v)|2]

are used. Turn now to the second term in (9.1)

 2

2

E wU (u)2(u)2(u) du =

wU (u)2(u) E[2(u)] du

00



+ Var

wU (u)2(u)2(u) du .

0

belomestny, d.

27

Since and

2(u)

|

log |(u)|| |(u)|4

,

u

E ||~(u)|2 - |(u)|2|2 = E ||~(u)|2 - E |~(u)|2 + E |~(u)|2 - |(u)|2|2  2 E ||~(u)|2 - E |~(u)|2|2 + 2| E |~(u)|2 - |(u)|2|2 |(u)|2 + 2, u  ,

we get an asymptotic estimate


wU (u)2(u) E[2(u)] du
0
Similarly, one can prove that

U e2U + 2U e4U , U  .


Var wU (u)2(u)2(u) du
0

2U 2e4U , U  .

Finally, the third term in (9.1)


RU = wU (u) log(Re  (u)) du
0
can be can be bounded by

|RU | =

1
w1(u) log(Re  (uU )) du 
0
A
U -1 |w1(y/U )|| log(Re  (y))| dy
0 1
+ U - |y|-|w1(y)| dy
0

U -,

for A > 0 large enough. Combining all the previous estimates we get

U  ,

(9.3)

E |~U - |2

U -2e2U + 2U 2e4U + U -2 U -2Ø e2+U Ø + 2U 2Ø e4+U Ø + U -2,

U  .

Finally the choice

U=

1 2+

log

-1 log-(1/)

with  = 1 + /Ø leads to (6.12).

1/Ø

In the case of calibration problem we have


n
|~(u)|2 = 1 - 2 Re u(u + i) jO(yj)eiuyj 

j=1

n

+u2(1 + u2)

eiu(yl-yj)j lO(yj)O(yl)

j,l=1

belomestny, d.

28

and  
n
E |~(u)|2 = 1 - 2 Re u(u + i) jO(yj)eiuyj 
j=1
n
+u2(1 + u2) eiu(yl-yj)jlO(yj)O(yl)
j=l n
+u2(1 + u2) j2~j2.
j=1
As was mentioned in Section 3.2 function O(y) = e-yO(y) is nonnegative, Lipschitz and
satisfies Cram¥er condition
O(y)e-y dy < 
R
provided that E[e2YT ] < . Under the condition e-A   2 we get

n
eiuyO(y)dy - eiuyj j O(yj )
R j=1

 2,  2 0

as well as

2n

eiuyO(y)dy -

eiu(yl-yj)j lO(yj )O(yl)

R j,l=1

 2 ,  2  0.

Thus, Further

| E |~(u)|2 - |(u)|2|

n
u2(1 + u2) j2(1 + ~j2).
j=1


n
|~(u)|2 - E |~(u)|2 = -2 Re u(u + i) j~jjeiuyj 
j=1

+2u2(1 + u2) eiu(yl-yj)j l~j~ljl
j<l
n
+u2(1 + u2) j2~j2(j2 - 1)
j=1

and E(|~(u)|2 - E |~(u)|2)2

nn
u2(1 + u2) j2~j2 + u4(1 + u2)2 j4~j4.
j=1 j=1

Using these inequalities, the first term in (9.1) can be estimated from above as

2
E wU (u)1(u)(u) du
0

 2
n
U 8-2e4U  4 + U 4-2e4U  j2~j2
j=1

2U 8-2Ø e4+U Ø

belomestny, d.

29

while the second one is asymptotically negligible if 2U 8-2e4U  0. Taking

U=

1 2+

log

-1 log-(1/)

1/Ø

with  = ( + 4)/Ø - 1, we get (6.12).

9.4 Proof of Theorem 6.5

For any two probability measures P and Q define



2(P,

Q)

=:

 dP
dQ
+

-

1

2
dQ

if P  Q otherwise

The following proposition is the main tool for the proof of lower bounds in the estimation case and can be found in Butucea and Tsybakov (2004).

Proposition 9.1. Let P := {P :   } be a family of models. Assume that there exist 1 and 2 in  with |1 - 2| > 2n > 0 such that

P1  P2 , 2(P1n, P2n)  2 < 1

then

lim inf
n

inf
^n

n-2

max{E1

|^n

-

1|2,

E2

|^n

-

2|2}



(1

-

)2(1

-

)2,

where the infimum is taken over all estimators ^n (measurable function of observations)

of the underlying parameter.

Taking  = A(Ø, -, +, ) and i = (i, i, i), i = 1, 2, we get from Proposition 9.1
sup E(| - |2)  n-2 max{E1(| - 1|2), E2(| - 2|2)}
(,, )A(Ø,-,+,)
provided that |1 - 2| > 2n > 0 and
2(P1n, P2n)  2 < 1.
Turn now to the construction of models 1 and 2. Let us consider a symmetric stable model
(u) = iµu + (u), (u) = -+|u|, 0 <   1, u  R For any  satisfying 0 <  <  and M > 0 define

(u) = iµu + (u),

where

(u)

=

-+ |u| 1{|u|M }

-

(1

+M  + cM -)

|u|-

(1

+

c|u|- )1{|u|>M } .

belomestny, d.

30

Then (u) = exp(iµu + (u)) is a characteristic function of some L¥evy process and

(u) = (u), |u|  M,

where (u) = exp(iµu + (u)). Indeed, the function (u) is a continuous, nonpositive, symmetric function which is convex on R+ for large enough M and small enough c > 0. According to a well known Po¥lya criteria (see e.g. Ushakov (1999)), the function exp((u)) is a c. f. of some absolutely continuous distribution for any  > 0. In particular, for any natural n the function exp((u)/n) is a c. f. of some absolutely continuous distribution. Hence, exp((u)) is a c.f. of some infinitely divisible distribution. Define

(9.4)

1 = (, +, 1), 2 = ( - , +, ,M )

and 1(u) = (u), 2(u) = (u) with

,M (u)

:=

|u| 1{|u|M }

+

(1

M + cM

-)

(1

+

c|u|- )1{|u|>M } .

If M  = 1 + cM -, i.e.

(9.5)

 = log(1 + cM -)/ log M  cM -/ log M, M  ,

then

|,M (u) - 1| |u|-, |u|  

and hence 2   = A(Ø, -, +, ). Furthermore, it holds

2(P1n, P2n) = n2(p1, p2 )

=

n

R

|p1(y) - p2(y)|2 p1 (y)

dy,

where p1 and p2 are densities corresponding to c.f. 1 and 2 respectively. Using the fact that the density of stable law p1(y) does not vanish on any compact set in R and fulfills

p1 (y) |y|-(+1), |y|  ,

we derive

n2(p1 , p2)  nC1

|p1(y) - p2(y)|2 dy

|y|A

+nC2

|y|+1|p1 (y) - p2(y)|2 dy = nC1I1 + nC2I2

|y|>A

for large enough A > 0 and some constants C1, C2 > 0. Using the fact that function 1(u) - 2(u) is two times differentiable (it is zero for |u| < M ) and Parseval's identity, we get

I1



1 2

|1 (u) - 2 (u)|2 du
R



1 2

e-2|u|- du
|u|>M

M 1-+e-2M - ,

belomestny, d.

31

I2



1 2

|(1 (u) - 2 (u))|2 du
|u|>M

|u|6e-2|u|- du
|u|>M

M 7-+e-2M - .

The choice M 

1 2+

log

-1 log-(1/)

1/(-)
with  = 1/n and some   (7 - ( -

))/2( - ) yields

-12(p1 , p2 ) < 1

for small enough . Combining this and (9.5), we arrive at (6.13).

For the proof of lower bounds in the case of calibration one can employ the fact that

the regression model

OT (yi) = OT (yi) + ~(yi)i, i = yi - yi-1, E i2 = 1, i = 1, . . . , n,

is equivalent to the Gaussian white noise model

dZ(x) = O(y) dy + 1/2 dW (y)

with the noise level asymptotics   0, a two-sided Brownian motion W . Here the noise

level  corresponds to the statistical regression error

n j=1

j2

~j2.

Furthermore,

instead

of

2 distance we use the Kullback-Leibler divergence

KL(T1 , T2 )

=

1 2

|(O1 - O2 )(y)|2-1 dy
R

between two models T1 and T2 corresponding to two L¥evy processes with characteristics

1 and 2 respectively (see (9.4)). Simple calculations lead to the estimate

KL(T1 , T2 ) -1M  e-2+M -

with some  > 0. Hence, for small enough  > 0 it holds

KL(T1 , T2 ) < 1

provided that M 

1 2+

log

-1 log- (1/)

1/(-)
with   /2( - ). Assouad

lemma (see e.g. Tsybakov (2008)) together with (9.5) implies (6.13).

9.5 Proof of Proposition 6.6

It holds for any fixed U



~U -  =

wU (u)(Y~(u) - Y(u)) du

0



= wU (u)1(u)(u) du

0



+ wU (u)Q(u) du + RU ,

0

belomestny, d.

32

where Q is defined in (6.3). As shown in Lemma 9.2 the process -1/2(u) converges
weakly to a Gaussian process Z(u) with E[Z(u)] = 0 and Cov(Z(u), Z(v)) = S(u, v). Moreover, -1/2Q(u)  0 almost surely. The extended continuous mapping theorem
(see Van der Vaart and Wellner (1996)) implies that if for some sequence U () and finite
positive real number 

2() =  wU()(u)wU()(v)1(u)1(v)S(u, v) du dv  2
0
and -1()RU()  0, then -1()(~U() - )  N(0, 1).

9.6 Proof of Theorem 6.7

We give only the sketch of the proof. Let - and + be two truncation levels satisfying 0 < -(u) < (u) < +(u) < 1 and 0 < - < (u)(1 - log((u))/(1 + log((u)))). First, similarly to the proof of Proposition 6.1 one can show that

Y~(u) - Y(u) - 1,(u)(T0,+ [~](u) - (u))  2,(u)(T0,+ [~](u) - (u))2, where

1,(u) = -- 1(u) log-1((u)),

and

2(u)

=

2 max
{- (u),+ (u)}

1 + | log()| 2 log2()

.

Furthermore, we have on the set {~(u)  +(u)}

|a(u)|2 - |~(u)|2

|a(u)|22 - |~(u)|22

|(u) - T0,+[~](u)|  +(u)

|a(u)|2

+

|a(u)|2

and on the set {~(u) > +(u)} it holds

|(u) - T0,+[~](u)|  2+(u).
Hence E |(u) - T0,+[~](u)|2  2|a(u)|-4 E |a(u)|2 - |~(u)|2 2
+ E |a(u)|22 - |~(u)|22 2 + 4+2 (u) P(~(u) > +(u)).

Without loss of generality one can assume that there exists U0 > 0 such that (u)/+(u) < 1/2 for u > U0. Then it holds for u > U0

P(~(u) > +(u))  P |a(u)|22 - |~(u)|22 > +(u)|(u)|2/4

+ P |a(u)|2 - |~(u)|2 > +(u)|(u)|2/4



16|a(u)|-4

E

|a(u)|2 - |~(u)|2

2
+E

|a(u)|22 - |~(u)|22

2

.

belomestny, d.

33

In the case of the estimation under P, for instance, we have E |a(u)|2 - |~(u)|2 2 , E |a(u)|22 - |~(u)|22 2 ,   0
and hence E |(u) - T0,+[~](u)|2 |a(u)|-4,   0.
Now one can follow the proof of Theorem 6.4 and use the fact that 1,(u)  c- 1()|u|--1(u) exp(c()|u|(u)), u  .
9.7 Proof of Theorem 6.8
Instead of L¥evy models 1 and 2 one considers models 1,a and 2,a with characteristic exponents a(u) = iµu - aØ2u2/2 + (u) and a,(u) = iµu - aØ2u2/2 + (u) respectively. The rest of the proof is almost identical to the proof of Theorem 6.5.

9.8 Auxiliary results

The following lemma is basic tool to investigate the asymptotic behavior of estimate ~ under historical measure P.
Lemma 9.2. The process -1/2(u) with (u) = |~(u)|2 - |(u)|2 weakly converges to a Gaussian process Z(u) with E[Z(u)] = 0 and Cov(Z(u), Z(v)) = S(u, v), where

S(u, v) : = Re (u - v) + Im (u + v) -(Re (u) + Im (u))(Re (v) + Im (v)).

Proof. We have

|~(u)|2 =

Re ~(u) 2 +

Im ~(u)

2

=

1 n2

n

n
cos(u(Xj - Xk)).

j=1 k=1

Put

Hn(u) =

n 2

-1

c

cos(u(Xj

-

Xk ))

=

2 n(n -

1)

cos(u(Xj - Xk)),
c

where summation c is over all

n 2

combinations of 2 integers chosen from (1, ..., n). Then

-1/2(|~(u)|2 - |(u)|2) = 1/2 + -1/2(1 - )(Hn - |(u)|2) - 1/2|(u)|2.

The first and third terms on the right hand side converge to 0. Consider the middle term. Since Hn(u) is an U -statistic (for each u), -1/2(Hn - |(u)|2) weakly converges to a Gaussian process with zero mean and covariance

Cov [EX2 cos(u(X1 - X2)), EX2 cos(v(X1 - X2))]

belomestny, d.

34

(where EX Y denotes the conditional expectation of Y given X). Let us compute this covariance. For any u, v  R it holds

Cov(EX2 [cos(u(X1 - X2))], EX2 [cos(v(X1 - X2))]) = E[(cos(uX2) - Re (u)) Re (u) + (sin(uX2) - Im (u)) Im (u)]◊ [(cos(vX2) - Re (v)) Re (v) + (sin(vX2) - Im (v)) Im (v)],
where

E(cos(uX2) - Re (u))(cos(vX2) - Re (v)) =

Re

(u

+

v)

+ 2

Re

(u

-

v)

-

Re

(u)

Re

(v),

E(sin(uX2) - Im (u))(sin(vX2) - Im (v)) =

Re

(u

-

v)

- 2

Re

(u

+

v)

-

Im

(u)

Im

(v)

and

E(cos(uX2) - Re (u))(sin(vX2) - Im (v)) =

Im

(v

-

u)

+ 2

Im

(u

+

v)

-

Re

(u)

Im

(v).

References
A®it-Sahalia, Y. and Jacod, J. (2009). Estimating the degree of activity of jumps in high frequency financial data. Annals of Statistics, to appear.
A®it-Sahalia, Y. and Jacod, J. (2006). Volatility estimators for discretely sampled L¥evy processes. Annals of Statistics, 35, 1, 355-392.
Belomestny, D. and Reiﬂ, M. (2006). Spectral calibration of exponential L¥evy models. Finance and Stochastics, 10, 449≠474.
Belomestny, D. and Spokoiny, V. (2007). Local-likelihood modeling via stage-wise aggregation. Annals of Statistics, 35(5), 2287≠2311.
Boyarchenko, S. and Levendorskii, S. (2002). Barrier options and touch-and-out options under regular L¥evy processes of exponential type. Annals of Applied Probability, 12, 4, 1261≠1298.

belomestny, d.

35

Akgiray, V. and Lamoureux, C. G. (1989). Estimation of stable-law parameters: A comparative study. Journal of Business and Economic Statistics, 7, 85-93.
Butucea, C. and Tsybakov, A. (2004). Sharp optimality for density deconvolution with dominating bias. Theory Probab. Appl., 52, 237≠249.
Cont, R., and Tankov P. (2004). Nonparametric calibration of jump-diffusion option pricing models, Journal of Computational Finance, 7(3), 1≠49.
Cont, R., and Tankov P. (2006). Retrieving L¥evy processes from option prices: regularization of an ill-posed inverse problem, SIAM Journal on Control and Optimization, 45(1), 1≠25.
Cont, R. and Tankov, P. (2004). Financial modelling with jump processes. Chapman & Hall/CRC Financial Mathematics Series. Chapman & Hall/CRC, Boca Raton, 535 pp.
DuMouchel, W.H. (1973a). On the asymptotic normality of the maximum-likelihood estimator when sampling from a stable distribution. Annals of Statistics, 1, 948-957.
DuMouchel, W.H. (1973b). Stable distributions in statistical inference: 1. Symmetric stable distributions compared to other symmetric long-tailed distributions. Journal of American Statistical Association, 68, 948-957.
DuMouchel, W.H. (1975). Stable distributions in statistical inference: 2. Information from stably distributed samples. Journal of American Statistical Association, 70, 386-393.
Eberlein, E. (2000). Application of generalized hyperbolic L¥evy motions to finance, in: L¥evy Processes - Theory and Applications, eds.: O.E. Barndorff-Nielsen, T. Mikosch, and S.I. Resnick.
Eberlein, E. and Keller, U. (1995). Hyperbolic distributions in finance, Bernoulli, 1, 281-299.
Eberlein, E., Keller, U. and Prause, K. (1998). New insights into smile, mispricing and value at risk: The hyperbolic model, Journal of Business, 71, 371-406.
Eberlein, E. and Prause, K. (1998). The generalized hyperbolic model: Financial derivatives and risk measures, in Mathematical Finance-Bachelier Congress 2000, H. Geman, D. Madan, S. Pliska, T. Vorst (Eds.), Springer Verlag, 245≠267.
Fenech, A.P. (1976). Asymptotically efficient estimation oflocation for a symmetric stable law. Annals of Statistics, 4, 1088-1100.

belomestny, d.

36

Feuerverger, A. and McDunnough, P. (1981a). On the efficiency of empirical characteristic function procedures. J. R. Statist. Soc., B 43, 20-27.
Feuerverger, A. and McDunnough, P. (1981b). On efficient inference in symmetric stable laws and processes. In Proceedings of the International Symposium on Statistics and Related Topics, Eds. M.Cs®orgo, D.A.Dawson, J.N.K.Rao and A.K.M.E.Saleh, NorthHolland, Amsterdam, 109-121.
Figueroa-Lo¥pez, E. and Houdr¥e, C. (2006). Nonparametric estimation for L¥evy processes with a view towards mathematical finance. Working paper.
Gugushvili, S. (2008). Nonparametric estimation of the characteristic triplet of a discretely observed L¥evy process. J. Nonparametr. Stat., 21, 321≠343.
Koutrouvelis, I. A. (1980). Regression-type estimation of the parameters of stable laws. Journal of American Statistical Association, 75, 918-928.
Lee, S., and Mykland, P.A. (2007). Jumps in Financial Markets: A New Nonparametric Test and Jump Dynamics. To appear in Review of Financial Studies.
Neumann, M. and Reiﬂ, M. (2007) Nonparametric estimation for L¥evy processes from low-frequency observations, to appear in Bernoulli.
Nolan, J.P. (1997). Numerical computation of stable densities and distribution functions. Communications in Statistics-Stochastic models, 13 759≠774.
Press, S. J. (1972). Estimation in univariate and multivariate stable distributions. Journal of Statistical American Association, 67, 842≠846.
Singleton, K. (2001). Estimation of affine asset pricing models using the empirical characteristic function. Journal of Econometrics, 102, 111≠141.
Sato, K. (1999). Levy processes and infinitely divisible distributions. Cambridge University Press.
Tsybakov, A. (2008). Introduction to Nonparametric Estimation, Springer Series in Statistics, Springer.
Ushakov, N. (1999). Selected topics in characteristic functions. Modern Probability and Statistics. VSP, Utrecht.
Van der Vaart, A. and Wellner, J. (1996). Weak Convergences and Empirical Processes, Springer Series in Statistics, Springer.

SFB 649 Discussion Paper Series 2009
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Implied Market Price of Weather Risk" by Wolfgang H‰rdle and Brenda LÛpez Cabrera, January 2009.
002 "On the Systemic Nature of Weather Risk" by Guenther Filler, Martin Odening, Ostap Okhrin and Wei Xu, January 2009.
003 "Localized Realized Volatility Modelling" by Ying Chen, Wolfgang Karl H‰rdle and Uta Pigorsch, January 2009.
004 "New recipes for estimating default intensities" by Alexander Baranovski, Carsten von Lieres and AndrÈ Wilch, January 2009.
005 "Panel Cointegration Testing in the Presence of a Time Trend" by Bernd Droge and Deniz Dilan Karaman ÷rsal, January 2009.
006 "Regulatory Risk under Optimal Incentive Regulation" by Roland Strausz, January 2009.
007 "Combination of multivariate volatility forecasts" by Alessandra Amendola and Giuseppe Storti, January 2009.
008 "Mortality modeling: Lee-Carter and the macroeconomy" by Katja Hanewald, January 2009.
009 "Stochastic Population Forecast for Germany and its Consequence for the German Pension System" by Wolfgang H‰rdle and Alena Mysickova, February 2009.
010 "A Microeconomic Explanation of the EPK Paradox" by Wolfgang H‰rdle, Volker Kr‰tschmer and Rouslan Moro, February 2009.
011 "Defending Against Speculative Attacks" by Tijmen DaniÎls, Henk Jager and Franc Klaassen, February 2009.
012 "On the Existence of the Moments of the Asymptotic Trace Statistic" by Deniz Dilan Karaman ÷rsal and Bernd Droge, February 2009.
013 "CDO Pricing with Copulae" by Barbara Choros, Wolfgang H‰rdle and Ostap Okhrin, March 2009.
014 "Properties of Hierarchical Archimedean Copulas" by Ostap Okhrin, Yarema Okhrin and Wolfgang Schmid, March 2009.
015 "Stochastic Mortality, Macroeconomic Risks, and Life Insurer Solvency" by Katja Hanewald, Thomas Post and Helmut Gr¸ndl, March 2009.
016 "Men, Women, and the Ballot Woman Suffrage in the United States" by Sebastian Braun and Michael Kvasnicka, March 2009.
017 "The Importance of Two-Sided Heterogeneity for the Cyclicality of Labour Market Dynamics" by Ronald Bachmann and Peggy David, March 2009.
018 "Transparency through Financial Claims with Fingerprints ≠ A Free Market Mechanism for Preventing Mortgage Securitization Induced Financial Crises" by Helmut Gr¸ndl and Thomas Post, March 2009.
019 "A Joint Analysis of the KOSPI 200 Option and ODAX Option Markets Dynamics" by Ji Cao, Wolfgang H‰rdle and Julius Mungo, March 2009.
020 "Putting Up a Good Fight: The GalÌ-Monacelli Model versus `The Six Major Puzzles in International Macroeconomics'", by Stefan Ried, April 2009.
021 "Spectral estimation of the fractional order of a LÈvy process" by Denis Belomestny, April 2009.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

