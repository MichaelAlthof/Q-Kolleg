BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2011-034
An estimator for the quadratic covariation of asynchronously observed Itô processes with noise: Asymptotic distribution
theory Markus Bibinger*
* Humboldt-Universität zu Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

An estimator for the quadratic covariation of asynchronously observed Ito^ processes with noise: Asymptotic distribution theory
Markus Bibinger1
Institut fu¨r Mathematik, Humboldt-Universita¨t zu Berlin, Unter den Linden 6, 10099 Berlin, Germany
Abstract
The article is devoted to the nonparametric estimation of the quadratic covariation of non-synchronously observed Ito^ processes in an additive microstructure noise model. In a high-frequency setting, we aim at establishing an asymptotic distribution theory for a generalized multiscale estimator including a feasible central limit theorem with optimal convergence rate on convenient regularity assumptions. The inevitably remaining impact of asynchronous deterministic sampling schemes and noise corruption on the asymptotic distribution is precisely elucidated. A case study for various important examples, several generalizations of the model and an algorithm for the implementation warrant the utility of the estimation method in applications.
Keywords: non-synchronous observations, microstructure noise, integrated covolatility, multiscale estimator, stable limit theorem
MSC Classification: 62M10, 62G05, 62G20, 91B84
JEL Classification: C14, C32, C58, G10
1. Introduction
The nonparametric estimation of the univariate quadratic variation of a latent semimartingale from n observations in a high-frequency setting with additive observation noise has been studied intensively in recent years. It is known from [13] that n1/4 constitutes a lower bound for the rate of convergence. An important motivation which has stimulated an alliance of economists and statisticians to establish estimation techniques for this kind of latent semimartingale models is their utility in estimating daily integrated (co-)volatilities from high-frequency intraday returns that serve as a basis for risk management as well as portfolio optimization and hedging strategies. The last years have seen an enormous increase of the amount of trading activities for many liquid securities. Paradoxically, the availability of high-frequency data necessitated a new angle on financial modeling. In fact, for every semimartingale the discrete realized (co-)volatilities converge in probability to the integrated measures. However, realized volatilities of typical high-frequency financial time series data explode for very high frequencies. This effect is ascribed to market microstructure frictions. Sources of the market microstructure noise are manifold. One important role plays the occurrence of bid-ask spreads. Aside from that transaction costs, strategic trading, limited market depths and discreteness of prices spread out the structure of the long-run dynamics that can be characterized by semimartingales. This strand of literature followed [31] that has attracted a lot of attention to this estimation problem. The so-called two-scales realized volatility by [31] is based on subsampling and a bias-correction and a stable central limit theorem with n1/6-rate has been proved. A refinement of the subsample approach using multiple scales in [30] and related alternative techniques in [4], [23] and [29] have led to rate-optimal estimators and feasible stable central limit theorems. For the more specific nonparametric model with
1Financial support from the Deutsche Forschungsgemeinschaft via SFB 649 `O¨ konomisches Risiko', Humboldt-Universita¨t zu Berlin, is gratefully acknowledged.
1

Gaussian noise, asymptotic equivalence in the Le Cam sense to a Gaussian shift experiment is shown in [26] and an asymptotically efficient estimator whose asymptotic variance equals the parametric efficiency bound is constructed. In the article on hand we are concerned with a multivariate stetting and apart from taking additive microstructure noise into account, we focus on a way to deal with non-synchronous observation schemes. This is also a central theme in financial applications. When realized covolatilities are calculated for fixed time distances and a previous-tick interpolation is applied, the phenomenon of the so-called Epps effect described in [10] appears that the realized covolatility tends to zero at the highest frequencies. A methodology to deal with non-synchronous observations in a bivariate Ito^ processes model has been proposed by [15]. The so-called Hayashi-Yoshida estimator has superseded simpler previous-tick interpolation methods setting the standard for the estimation of the quadratic covariation from asynchronous observations in the absence of microstructure noise effects. Our estimation approach, first proposed in [8], for the most general case in the presence of noise and nonsynchronicity arises as a combination of the multiscale estimator to handle noise contamination on the one hand and a synchronization algorithm in accordance with the Hayashi-Yoshida estimator to cope with nonsynchronicity on the other hand. A first attempt in the same direction, combining one-scale subsampling and the Hayashi-Yoshida estimator, has been given in [22]. In [8] it has been shown in the spirit of [13] that the optimal convergence rate n1/4 carries over to the general multidimensional setup. The mathematical analysis of our generalized multiscale estimator in [8] shows that it is rate-optimal. Alternative approaches to similar statistical models has been suggested by [5], [9] and [1]. In [5] a kernelbased method with a previous-tick interpolation to so-called refresh times is proposed and a stable central limit theorem with sub-optimal n1/5-rate is established for a multivariate non-synchronous design. This estimator, furthermore, ensures that the estimated covariance matrix is positive semi-definite. [9] and [1] come up with combinations of pre-averaging ([23],[19]) and the Hayashi-Yoshida estimator and of the univariate quasi-maximum-likelihood method by [29], the polarization identity and a generalized synchronization scheme which is different from the Hayashi-Yoshida ansatz that we use, respectively, both also attaining the optimal rate. In this article we aim at providing an asymptotic distribution theory for the generalized multiscale estimator. In distinction from alternative methods, the influence of non-synchronicity effects on the expectation is null and on the variance limited up to an interaction of interpolation steps and microstructure noise. The main result is a feasible stable central limit theorem for its estimation error with optimal rate and a closedform asymptotic variance that does not hinge on interpolation errors in the signal term. The stable weak convergence of the estimation error to a centred mixed Gaussian limit and the consistent estimation of the random unknown asymptotic variance are the essential steps towards statistical inference and confidence sets. The theory is grounded on stable limit theorems for semimartingales from [18]. In Section 2 we present the model and our main findings. Section 3 comes up with a concise overview on the construction of the estimator and in Section 4 we develop the asymptotic theory. In Section 5 we propose a consistent estimator for the asymptotic variance and Section 6 comprises various extensions and and a concluding discussion. The proofs are postponed to the Appendix.
2. Model and key result
The considered statistical model of noisy latently observed Ito^ processes at deterministic observation times is precisely described by Assumptions 1-3 in this section.
Assumption 1 (efficient processes). On a filtered probability space (, F, (Ft) , P), the efficient processes X = (Xt)tR+ and Y = (Yt)tR+ are Ito^ processes defined by the following stochastic differential equations:
dXt = µXt dt + tX dBtX , dYt = µtY dt + tY dBtY ,
with two (Ft)­adapted standard Brownian motions BX and BY and t dt = d BX , BY t. The drift processes µXt and µtY are (Ft)­adapted locally bounded stochastic processes and the spot volatilities
2

tX and tY and t are assumed to be (Ft)­adapted with continuous paths. We assume strictly positive

volatilities and the Novikov condition E

exp

(1/2)

T 0

(µ

·

/

·

)t2

dt

<  for X and Y .

Assumption 2 (observations). The deterministic observation schemes T X,n = {0  t(0n) < t1(n) < . . . < t(nn)  T } of X and T Y,m = {0  0(m) < 1(m) < . . . < m(m)  T } of Y are assumed to be regular in
the following sense: There exists a constant 0 <   1/9 such that

nX = sup
i{1,...,n}
mY = sup
j{1,...,m}

ti(n) - t(i-n)1 , t0(n), T - t(nn) = O n-8/9- , j(m) - j(-m1) , 0(m), T - m(m) = O m-8/9-

.

(1a) (1b)

We consider asymptotics where the number of observations of X and Y are assumed to be of the same asymptotic order n = O(m) and m = O(n) and express that shortly by n  m. The efficient processes X and Y which satisfy Assumption 1 are discretely observed at the times T X,n and T Y,m with additive
observation noise:

X~t(in) =

ti(n)
µtX dt +
0

t(in)

0

tX dBtX +

X ti(n)

,0



i



n

,

(2a)

Y~j(m) =

j(m)
µYt dt +
0

j(m)

0

tY dBtY +

Y j(m)

,0



j



m

.

(2b)

Although we consider sequences of deterministic observation times, the case of random sampling that

is independent of the observed processes is included when regarding the conditional law.

It turns out that it is accurate to prove the key result of the article on the following i. i. d. assumption on

the microstructure noise since a closed-form expression for the asymptotic variance is not available for

a combination of general asynchronous observation schemes and serially dependent observation errors.

Since an extension to non-i. i. d. noise is crucial for the utility in financial applications, we comment on the

robustness of our estimator to that case in Section 6.

Assumption 3 (microstructure noise). The discrete microstructure noise processes

,X
ti(n)

,Y
j(m)

0



i



n,

0



j



m

.

are centred i. i. d. , independent of each other and independent of the efficient processes X and Y . We assume that the observation errors have finite fourth moments and denote the variances

X2 = Var

X t(1n)

, Y2 = Var

Y 1(m)

.

The number of synchronized observations N  n  m which appears in the rate of our feasible stable

central limit theorem is introduced in Section 3.

Theorem 1 (feasible stable central limit theorem).The generalized multiscale estimator (12) specified by the later given weights (A.1), with MN = cmulti · N converges on the Assumptions 1, 2, 3 and further
mild regularity conditions on the asymptotics of the sampling schemes, stated below in Assumptions 4 and 5, F -stably in law with optimal rate N 1/4  n1/4  m1/4 to a mixed Gaussian limiting distribution:

multi
N 1/4 [X, Y ]T - [X, Y ]T

st N (0, AVARmulti)

with an almost surely finite random asymptotic variance given in (18) in Theorem 3. With the consistent estimator for the asymptotic variance AVARmulti in Proposition 5.1 , the feasible central limit theorem

N 1/4

multi
[X, Y ]T - [X, Y ]T AVARmulti

st N(0, 1) ,

(3)

holds true.

3

Figure 1: Sketch of the subsampling approach.

The notion of stable weak convergence going back to [27] is essential for our asymptotic theory. Stable weak convergence Xn st X is the joint weak convergence of (Xn, Z) to (X, Z) for every measurable bounded random variable Z. The limiting random variables in stable limit theorems are defined on exten-
sions of the original underlying probability spaces. The reason for us to involve this concept of a stronger
mode of weak convergence is that mixed normal limiting distributions are derived where asymptotic variances are themselves strictly positive random variables. Provided we have a consistent estimator Vn2 for such a random asymptotic variance V 2 on hand, the stable central limit theorem Xn st V Z with Z distributed according to a standard Gaussian law, yields the joint weak convergence (Xn, Vn2) (V Z, V 2) and also Xn/Vn Z and hence allows to perform statistical inference providing tests or confidence intervals.
In the proofs of our limit theorems we will `remove' the drifts in the sense that after a transformation to an
equivalent martingale measure stable central limit theorems for Ito^ processes without drift are proved and,
as illustrated in [21], stability of the weak convergence ensures that the asymptotic law holds true under
the original measure. In this sense stable convergence is commutative with measure change.
From now on, we often omit the superscripts of observation times for a shorter notation.

3. Brief review on the foundation

3.1. Subsampling and the multiscale estimator
In the model imposed by Assumption 1, Assumption 2 with synchronous observations, n = m and tj(n) = j(n), 1  j  n, and Assumption 3, the realized (co-)volatilities do not provide consistent estimators for the quadratic (co-)variations any more. The variance due to noise conditional on the paths of the efficient processes


n
VarX,Y 
j=1

X~tj - X~tj-1

 Y~tj - Y~tj-1  = 4n X2 Y2 ,

increases linearly with n. The error due to noise perturbation can be reduced by the following estimator, which has been proposed for the univariate estimation of integrated volatility as the "second best approach" in [31] and which is called one-scale subsampling estimator in [8] and throughout this article. It can be motivated from two perspectives that are both sketched in Figure 1. On the left-hand side we have visualized that one can calculate simultaneously lower frequent realized covolatilities using subsamples, e. g. to the lag three in Figure 1, and (post-)average them.

sub 1 n

[X, Y ]T

= i

X~tj - X~tj-i

j=i

Y~tj - Y~tj-i .

(4a)

4

This motivation given in [31] is in line with the former common practice of a sparse-sampled low-frequency realized (co-)volatility estimator and proposes to use an average instead of one single lower frequent realized measure. The same estimator arises as the usual realized covolatility calculated from the time series on that a linear filter is run before, what means that non-noisy observations at a time tj are estimated with a (pre-)average of noisy observations at times tj, . . . , tj+i for some i. This is sketched on the right-hand side of Figure 1 for i = 3. Passing over to increments leads to telescoping sums and we end up finally with the one-scale subsampling estimator. Since on the Assumption 3 there is no bias due to noise for the bivariate estimator, it already corresponds to the "first best approach" from [31] whereas in the univariate case a bias-correction completes the two scales realized volatility (TSRV):

T SRV

1n

[X ]T

= i

X~tj - X~tj-i

21 - 2n

n

X~tj - X~tj-1

2
.

j=i i=1

(4b)

There is a trade-off between the signal term and the error due to noise. Choosing i = csubn2/3 dependent on n with a constant csub, the overall mean square error is minimized and of order n-1/3. The onescale subsampling estimator (4a) is hence a consistent and asymptotically unbiased estimator. The rate of convergence n1/6, however, is slow and does not attain the optimal rate n1/4 determined in [8]. For this
reason, we focus on a multiscale extension of the subsampling approach on which the methods developed
in [8] are based on. The multiscale realized covolatility (MSRC), and the univariate multiscale realized
volatility (MSRV) introduced in [30], are linear combinations of one-scale subsampling estimators with
Mn different subsampling frequencies i = 1, . . . , Mn:

multi
[X, Y ]T

=

Mn

io,pMt n i

n

i=1 j=i

X~tj - X~tj-i

Y~tj - Y~tj-i ,

(5a)

multi
[X ]T

=

Mn

io,pMt n i

n

i=1 j=i

X~tj - X~tj-i

2
.

(5b)

The weights are chosen such that the estimator is asymptotically unbiased and the error due to noise mini-

mized. They are given later in (A.1) and can be chosen equally for the bivariate and the univariate case.

Those are the standard discrete weights of [30] and we abstain from giving a more general class of possible

weight functions.

The mean square error of the multiscale realized covolatility (5a) can be split in uncorrelated addends that

stem from discretization, microstructure n/Mn3, and Mn-1, respectively. Hence,

noise and cross a choice Mn =

terms and cmulti n

end-effects. They are of orders Mn/n, leads to a rate-optimal n1/4-consistent

estimator.

The following stable central limit theorems for the multiscale realized covolatility (5a) and the one-scale

estimator (4a) are implied by Theorem 3 and Corollary 4.1:

Proposition 3.1. On Assumptions 1, 2 and 3 in the synchronous setup and if (n/T ) i(ti(n) - ti(-n)1)2 converges to a continuously differentiable limiting function G and the difference quotients converge uniformly
to G on [0, T ], the multiscale realized covolatility (5a) and the subsampling estimator (4a) converge stably
in law to mixed normal limiting random variables:

multi
n1/4 [X, Y ]T - [X, Y ]T

st N (0 , AVARmulti,syn) ,

(6a)

sub
n1/6 [X, Y ]T - [X, Y ]T

st N (0 , AVARsub,syn) ,

(6b)

5

with

AVARmulti,syn

= c-m3ulti24X2 Y2

26 + cmulti 35 T

T
G (t)(t2 + 1)(tX tY )2 dt
0

+

c-m1ulti

12 5

TT

X2 Y2 + X2

(tY )2 dt + Y2

(tX )2 dt

00

,

(6c)

AVARsub,syn

= cs-u2b4X2 Y2

2 + csub 3 T

T
G (t)(t2 + 1)(tX tY )2 dt .
0

(6d)

3.2. Synchronization and the Hayashi­Yoshida estimator
We use the short notation Xti , i = 1, . . . , n from now on for increments Xti -Xti-1 and analogously for Y . The Hayashi-Yoshida estimator

(HY )

nm

[X, Y ]T =

1Xti Yj ,[min (ti,j )>max (ti-1,j-1)]

i=1 j=1

(7)

where the product terms include all increments of the processes with overlapping observation time instants, has been proved in [15] to be consistent in a model of asynchronously observed Ito^ processes with deterministic correlation, drift and volatility functions in the absence of observation noise and on further regularity conditions to be asymptotically normally distributed in [16]. For a combination of the strategy of the Hayashi-Yoshida estimator with techniques to handle noise contamination, we use an iterative algorithm introduced in [22] as `pseudo-aggregation'. Incorporating telescoping sums there are the following rewritings of the estimator (7):

(HY )

n

[X, Y ]T

=

Xti

Y - Yti,+

ti-1,-

i=1

N

= (Xgi - Xli ) (Yi - Yi )
i=1

N

= X - XTiX,+

TiX-1,-

i=1

Y - YTiY,+

TiY-1,-

,

(8)

with the notion of next-tick interpolated times ti,+ := min0jm (j|j  ti) and previous-tick interpolated ones ti,- := max0jm (j|j  ti) in the first equality. This rewriting can be as well done in the symmetric way.
The illustration of (8) that serves as a basis for the construction of the generalized multiscale estimator
relies on an aggregation of the observations according to Algorithm 1. This algorithm, which is a concise version of the construction in [8], stops after (N +1)  min (n, m)+1 steps when all observation times are
grouped. Summation in (8) can start with i = 0 or i = 1. In the last equality only the denotation expres-
sions gi, i, li, i are substituted emphasizing that those sampling times obtained by Algorithm 1 can be interpreted as previous- and next-tick interpolations again with respect to a synchronous sampling scheme Tk := min (gk, k), 1  k  N , which we call the closest synchronous approximation. Increments in (8) are taken from previous-tick interpolations at left-end points of instants [Tk-1, Tk], 2  k  N to next-tick interpolated sampling times at right-end points. Since Tk = max (lk+1, k+1), 1  k  (N - 1) holds true, we split the estimation error of (8) in two uncorrelated parts DTN + ANT with

N
DTN :=
i=1

XTi - XTi-1

Ti

YTi - YTi-1 -

ttX tY dt

Ti-1

t0 0

T

- ttX tY dt - ttX tY dt

0 tnm

(9)

6

Define t+(s) := min {ti  T X,n|ti  s},  +(s) := min {j  T Y,n|j  s}; t-(s) := max {ti  T X,n|ti < s},  -(s) := max {j  T Y,n|j < s}.
first step:

· For t0  0

g0 = t+(0), l0 = t0, 0 = 0, 0 = 0.

· For t0 > 0

g0 = t0, l0 = t0, 0 =  +(t0), 0 = 0.

ith step (given gi-1 and i-1):

· If gi-1 = i-1

­ and t+(gi-1)   +(i-1)

gi = t+( +(i-1)), li = gi-1, i =  +(i-1), i = i-1.

­ and t+(gi-1) >  +(i-1)

gi = t+(gi-1), li = gi-1, i =  +(t+(gi-1)), i = i-1.

· If gi-1 < i-1

­ and i-1  t+(gi-1)

gi = t+(gi-1), li = gi-1, i =  +(t+(gi-1)), i =  -(i-1).

­ and i-1 > t+(gi-1)

gi = t+(i-1), li = gi-1, i = i-1, i =  -(i-1).

· If gi-1 > i-1: symmetrically as for gi-1 < i-1.

Algorithm 1: Iterative synchronization algorithm.

being the discretization error of a synchronous-type realized covolatility including in general non-observable idealized values at the times of the closest synchronous approximation and ANT an additional error due to the lack of synchronicity, in particular next- and previous-tick interpolations. The times Tk equal the so-called refresh times of [5] and thus our synchronization differs from the one in [5] by replacing pure previous-tick interpolation by the above given machinery of previous- and next-tick interpolations. The asymptotic theory for the estimator (8) as N  , concisely repeated here, is separately proved and presented in a more elaborate way in [7]. First, we take up the illustrative example from [8] to motivate the synchronization procedure. For further details and examples we refer to [8] and [22]. Figure 2 visualizes the aggregation carried out by Algorithm 1 and the times Ti, i = 0, . . . , 8 for a toy example. The example emphasizes the important fact that consecutive right-end points of increments can be the same time points. The realized covolatility calculated from previous-tick interpolated values to refresh times equals
(Xt2 - Xt0 )(Y1 - Y0 ) + (Xt3 - Xt2 )(Y3 - Y1 ) + (Xt5 - Xt3 )(Y4 - Y3 )+ (Xt6 - Xt5 )(Y5 - Y4 ) + (Xt7 - Xt6 )(Y6 - Y5 ) + (Xt8 - Xt7 )(Y7 - Y6 )+
(Xt9 - Xt8 )(Y8 - Y7 ) + (Xt10 - Xt9 )(Y10 - Y8 )
and is systematically biased downwards by interpolations, whereas (8) yields
(Xt3 - Xt0 )(Y1 - Y0 ) + (Xt3 - Xt2 )(Y3 - Y1 ) + (Xt6 - Xt3 )(Y4 - Y3 )+ (Xt7 - Xt5 )(Y5 - Y4 ) + (Xt8 - Xt6 )(Y6 - Y5 ) + (Xt8 - Xt7 )(Y8 - Y6 )+
(Xt9 - Xt8 )(Y9 - Y7 ) + (Xt10 - Xt9 )(Y10 - Y8 ) ,
which is not biased due to interpolations.
Definition 1 (quadratic (co-)variations of time). For any N  N let Ti(N), i = 0, . . . , N be the times of the closest synchronous approximation and gi(N), i(N), li(N), i(N) the corresponding observation times that appear in the estimator (8) defined above by Algorithm 1 . T /N is the mean of the time instants

7

i0

1

Hi {t0} {t1, t2, t3}

Gi {0}

{1}

li t0

t0

gi t0

t3

i 0

0

i 0

1

Ti t0=0

1

2 {t3} {2, 3}
t2 t3 1 3 t3=3

3 {t4, t5, t6}
{4} t3 t6 3 4 4

4 {t6, t7}
{5} t5 t7 4 5 5

5 {t7, t8}
{6} t6 t8 5 6 6

6 {t8} {7, 8}
t7 t8 6 8 t8

7 {t9} {8, 9}
t8 t9 7 9 t9

8 {t10} {9, 10}
t9 t10 8 10 t10=10

Figure 2: Example for non-synchronous sampling design with the sets constructed by the synchronization algorithm, interpolated observation times occurring in the estimators and the synchronous approximation.

Ti(N) = Ti(N) - Ti(-N1), i = 1, . . . , N . Define the following sequences of functions

GN (t) = N T

Ti(N )

2
,

Ti(N ) t

F N (t) = N T

(Ti(N) - i(N))(gi(N) - Ti(N)) + Ti(N) - li(N)

Ti(+N1) t

i(N) - Ti(N)

+Ti(+N1) Ti(N) - li(+N1) + Ti(+N1) Ti(N) - (i+N1) ,

(10a) (10b)

HN (t) = N T
Ti(+N1) t

Ti(N) - li(+N1)

gi(N) - Ti(N) + Ti(N) - (i+N1)

i(N) - Ti(N) ,

(10c)

for t  [0, T ] that we call sequences of quadratic (co-)variations of times.

A stable central limit theorem for the estimation error is deduced in [7] on the assumption that the se-
quences defined by (10a), (10b) and (10c) converge pointwise to continuous differentiable limiting func-
tions G, F, H and the sequences of difference quotients uniformly. The asymptotic quadratic variation of time G of the Ti(N)s influences the asymptotics of DTN . The covariation of times F N measures an interaction of interpolation errors between the two processes and HN the impact of the in general non-zero correlations of the products involving previous- and next-tick interpolations at the same Ti(N)s for each process separately.
Consider as easiest example the synchronous equidistant sampling schemes with N = n = m and ti(n) = j(n) = i/n, i = 0, . . . , n. In this case F N and HN are identically zero since interpolations are redundant. The function GN is a step function that will tend to the identity on [0, T ] as N  .
Then, consider a situation of completely non-synchronous sampling schemes that originates from the com-
plete synchronous equidistant one by shifting one time-scale half a time instant 1/2N . We will call this
situation intermeshed sampling. For this example, the synchronous approximation is still equidistant with
instants 1/N and, hence, G is the identity function. F and H are linear limiting functions with slope 1 and
1/4, respectively.
In [7] we show for an important special case, independent homogeneous Poisson sampling, that the conver-
gence assumptions on (10a)-(10c) are fulfilled when replacing deterministic convergence by convergence

8

in probability. Furthermore, the stochastic limits G (t), F (t), H (t) are calculated explicitly. The main result for the estimator (8) is Theorem 2. It serves as preparation to prove the stable limit theorem for the generalized multiscale estimator in Theorem 3 and gives insight into the asymptotic distribution of (8). For the proof we refer to [7]. A similar stable limit theorem for the original Hayashi-Yoshida estimator is provided in [17].

Theorem 2. The estimation error of (8) converges on the Assumptions 1, 2 and convergence assumptions on (10a)-(10c) and the difference quotients stably in law to a centred, mixed Gaussian distribution:

N N (Xgi - Xli ) (Yi - Yi ) - [X , Y ]T
i=1
with the asymptotic variance

st N (0 , vDT + vAT ) ,

(11)

TT

vDT +vAT = T G (t) tX tY 2 t2 + 1 dt + T

F (t) tX tY 2 + 2H (t) ttX tY 2 dt

00

where the two addends come from the asymptotic variances of DTN and ATN , respectively.

3.3. Hybrid approach to non-synchronous and noisy observations
In [8] we have proposed the following combined estimation method for the quadratic covariation or integrated covolatility from noisy asynchronous observations. After applying Algorithm 1 to the observation times, the generalized multiscale estimator is defined by

multi
[X, Y ]T

=

MN

io,pMt N i

N

i=1 j=i

X~ - X~gj(N)

lj(N-i)+1

Y~ - Y~j(N)

j(N-)i+1

.

(12)

It is a weighted sum of MN one-scale subsampling estimators of the type

sub 1 N

[X, Y ]T

= iN j=iN

X~ - X~gj(N)

lj(N-i)N +1

Y~ - Y~j(N)

j(N-)iN +1

(13)

with subsampling frequencies i = 1, . . . , MN and optimal weights given later in (A.1). Owing to the aggregation of non-synchronous observation times before applying subsampling and the multiscale approach,
the resulting estimator has a conformable appearance as in the synchronous case (5a). Recall that in the
synchronous setting gj = j = Tj and lj-i+1 = j-i+1 = Tj-i holds. Choosing MN = cmulti · N and iN = csub · N 2/3, both estimators above provide consistent and asymptotically unbiased estimators with convergence rate N 1/4 and N 1/6, respectively.

4. Asymptotics and a stable central limit theorem for the generalized multiscale estimator

A comprehensive analysis of the asymptotic distribution of the estimation error necessitates an elaborate screening of the conjunction of Algorithm 1 and the joint sampling design T X,n, T Y,m .
Note that the generalized multiscale estimator (12) differs from the other plausible Hayashi-Yoshida version
of a multiscale estimator

MN io,pMt N n i
i=1 j=i kZ

X~t(jn) - X~t(jn-)i

Y~ - Y~ 1 , (14)j(+mk)·i

j(+m()k-1)·i {max (tj(n-)i,j(+m()k-1)·i)<min (tj(n),j(+mk)·i)}

which arises as natural Hayashi-Yoshida multiscale estimator when, on the basis of (non-synchronized) observations of X~ and Y~ , sparse-sample Hayashi-Yoshida estimators are averaged to one-scale subsample
estimators and those extended to a linear combination using different time lags. We state without proof
that this estimator is consistent, asymptotically unbiased and will attain the optimal rate of convergence.
Nevertheless, we benefit from the data aggregation method and applying subsampling to the synchronized

9

i case X case Y relations X relations Y

1 2
1 g1 = g2 = l3
1 = 2

2 1
1 g2 = l3 2 = 3

3 3
1 g3 = l5 3 = 4

4 3
1 g4 = l6 4 = 5

5 2
1 g5 = l7 5 = 6

6 1
3 g6 = l7 6 = 8

7 1
4 g7 = l8
­

8 1 1 ­ ­

Table 1: Allocation of sampling times to cases 1 - 4 for the example.

scheme, since the variance of our estimator (12) is smaller than the one of this alternative estimator and we are able to find a feasible closed-form expression of the asymptotic variance. The crucial difference between both approaches is that for the alternative method next- and previous-tick interpolation errors take place on sparse-sampling time intervals in average of order i/N whereas the interpolation errors of the generalized multiscale estimator (12) take place on the highest-frequency-scale and hence on intervals in average of order 1/N . In particular the decomposition

X - Xgj(N)

lj(N-i)N +1

= X - X + X - X + X - Xgj(N)

Tj (N )

Tj (N )

Tj(-Ni)

Tj(-Ni)

lj(N-i)N +1

=Op(N -1/2)

=Op((i/N )(1/2))

=Op(N -1/2)

of the increments of X and analogously for Y , give an heuristic that the interpolation errors driving the
error due to non-synchronicity asymptotically not affect the variance of the signal term. The stochastic orders are given for time instants of average order N -1.
For a rigorous clarification of the asymptotic error due to noise and the cross term, both influenced by the
i. i. d. observation errors at times gi, li, i, i, we figure out the times gi = gi+1 and the right-end points gi(N) = li(+N1), gi(N) = li(+N2) that are as well preceding left-end points and analogously for the sampling times of Y~ .
All observation times i, i are characterized through one of the following four mutually exclusive cases. Denote j,- the last observation time of Y~ before j and j,+ the first one after j. We illustrate the allocation of the observation times for T Y,m and j , j = 1, . . . , N - 2:

1 j  gj 2 j > gj , j  gj,+ 3 j > gj , j < gj,+ , j,+ > gj,+ 4 j > gj , j < gj,+ , j,+  gj,+

 j = j+1 , j = j+1 , j = j+2 ,  j = j+1 , j = j+1 , j = j+2 ,  j = j+1 , j = j+1 , j = j+2 ,  j = j+1 , j = j+1 , j = j+2 , j,+ = j+2 .

Only sampling times distributed to case 2 lead to repeated i = i+1. In cases 1 , 2 and 3 a subsequent left-end point k, k = i + 1 or k = i + 2 of observation time instants incorporated in the subsampling estimators is designated by i. All other k, k = 2, . . . , N appear in an allocation of sampling times of the type 4 , where j+2 = j,+ = l l. Recall that i = k for all i = k holds true. If 2 holds for j with fixed j  {1, . . . , N - 2} and if k := arg mink{j,...,N-1}(k > gk , k  gk,+) exists, then 2 holds necessarily for one gl, l  {j + 1, . . . , k - 1} or gl = l.
In Table 1 we list the relations for the sampling design of our previous example.

Assumption 4 (asymptotic quadratic variation of time). Assume that for the sequences of sampling schemes and the times Ti(N) of the closest synchronous approximations and for the sequence of quadratic variations of time GN (t) defined in Definition 1, the following holds true:
(i) GN (t)  G(t) as N  , where G(t) is a continuously differentiable function on [0, T ]. (ii) For any null sequence (hN ), hN = O N -1

GN (t + hN ) - GN (t)  G (t) hN
uniformly on [0, T ] as N  .

(15)

10

(iii) The derivative G (t) is bounded away from zero.

Definition 2 (degree of regularity of asynchronicity). For N  N and times gi(N), i(N), i = 0, . . . , N constructed from aggregated sampling schemes T X,n, T Y,m that fulfill Assumption 2, define the following sequences of functions:

IXN (t)

=

1 N

1 ,{gj(N)=gj(N-1) }

gj(N ) t

(16a)

IYN (t)

=

1 N

1 ,{j(N)=j(N-1) }

j(N ) t

(16b)

which describe the degree of regularity of asynchronicity between observation times T X,n and T Y,m.

In the completely asynchronous case, we can directly conclude that |IXN (t) - IYN (t)|  T /N for all t  [0, T ] and one sequence suffices to reflect the regularity of the non-synchronous sampling schemes.

Assumption 5 (asymptotic degree of regularity of asynchronicity). Assume that for the sequences of sampling schemes and for the sequences of functions IXN , IYN defined in Definition 2, the following holds true:
(i) IXN (t)  IX (t), IYN (t)  IY (t) as N  , where IX (t), IY (t) are continuously differentiable functions on [0, T ].
(ii) For any null sequence (hN ), hN = O N -1

IXN (t

+

hN ) hN

-

IXN (t)



IX (t)

,

(17a)

IYN (t + hN ) hN

- IYN (t)



IY (t)

uniformly on [0, T ] as N  .

(17b)

For both, synchronous and intermeshed sampling which have been introduced in the last section, the sequences of functions IXN , IYN are identically zero. The functions defined in Definition 2 are non-negative and bounded above by 1. In Section 6 we explicitly deduce the asymptotic degree of regularity of asynchronicity for mutually independent homogeneous Poisson sampling schemes. The term (asymptotic) degree of regularity of asynchronicity has been chosen since Assumption 5 holds for all non-degenerate sequences where observation times conforming to one of the cases 1 - 4 from above tend to be distributed according to some regular pattern and it gives information on the interaction of allocations of observation times. It is interesting and might seem surprising at first glance that the asymptotics of the estimator (12) hinges on this asymptotic feature whereas, as indicated before, the asymptotic interpolations to the closest synchronous approximation are asymptotically immaterial. This circumstance is caused by the fact that for the construction of an estimator with Algorithm 1, as for the original Hayashi-Yoshida estimator (8), observed values of the processes at next-tick interpolated observation times can appear twice. If there is observation noise, the number of observations allocated conforming to case 2 has an impact on the asymptotics. The influence of interpolations is asymptotically vanishing for the combined method in contrast to the estimator (8) with faster convergence rate N since interpolation steps take place on the time-scale of high-frequency observations, but lower-frequency sparse-sampled increments of the synchronous approximation are involved to reduce the error due to noise. We continue with the central result of this article:

11

Theorem 3 (Central limit theorem for the generalized multiscale estimator). On the Assumptions 1, 2, 3, 4 and 5, the generalized multiscale estimator (12) with noise-optimal weights io,pMt N = (12i2/MN3 ) - (6i/MN2 ) (1 + O(1)), that are explicitly given in (A.1), and MN = cmulti · N converges F -stably in law with optimal rate N 1/4 to a mixed Gaussian limiting distribution:

multi
N 1/4 [X, Y ]T - [X, Y ]T

st N (0, AVARmulti)

with the asymptotic variance

AVARmulti

=

c-m3ulti

(24 + 12 (IX (T ) +

IY (T ))) X2 Y2

+cm-1ulti

12X2 Y2 5

=AVARnoise

26

+ cmulti

T 35

T
G (t)(tX tY )2(1 + 2t ) dt
0

=AVARdis

+ cm-1ulti

12 5

Y2

TT
(1 + T IY (t))(tX )2 dt + X2 (1 + T IX (t))(tY )2 dt
00

(18) .

=AVARcross

The weak convergence is proved to be stable with respect to the -algebra F associated with the efficient processes. As a side result, we also obtain a stable central limit theorem for a simpler one-scale subsampling estimator:

Corollary 4.1 (Central limit theorem for the one-scale subsampling estimator). On the Assumptions
1, 2, 3 and 4, the one-scale subsampling estimator with subsampling frequency iN = csub · N 2/3 converges F -stably in law with rate N 1/6 to a mixed Gaussian limiting distribution:

sub
N 1/6 [X, Y ]T - [X, Y ]T

st N (0, AVARsub) ,

(19)

with the asymptotic variance

AVARsub = cs-u2b

4X2 Y2

+ csub

2 T
3

=AVARnoise,sub

T
G (t)(tX tY )2(1 + 2t ) dt .
0
=AVARdis,sub

(20)

For the proof of Theorem 3, we split the total estimation error of the generalized multiscale estimator in three asymptotically uncorrelated addends due to noise, cross terms and the signal term. For the one-scale subsampling estimator we follow the same ansatz. The orders of the errors have been derived in [8] and we focus on the asymptotic distribution here. The error due to microstructure noise of the one-scale subsampling estimator has expectation zero and the variance yields

N
iN-2 E
j=iN

2
-X X
gj lj-iN +1

2
-Y Y
j j-iN +1

= 4N iN-2X2 Y2 + O N iN-2

,

since observation noises of X~ and Y~ are independent of each other by Assumption 3 and lk = lr for k = r, k = r for k = r and if gk = gk+1  k < k+1 , 0  k  (N1). Hence, the error due to noise is a sum of uncorrelated centred random variables with equal variances and the standard central limit theorem
applies.
For the generalized multiscale estimator, we further decompose the error due to noise in a main part of order N 1/2MN-3/2 and two terms due to end-effects of orders MN-1/2, where all three terms are asymptotically

12

uncorrelated. In Propositions A.1 and A.2 we prove central limit theorems for these terms. Asymptotic normality holds both, conditionally and unconditionally on the paths of the efficient processes. The error due to noise of the one-scale estimator does not depend on any further influence of the sampling schemes except the number of constructed sets N and G . Cross terms are, in contrast to the multiscale case, asymptotically negligible since

 
N
E i-N1
j=iN

X - Xgj lj-iN +1

- + Y - YY Y
j j-iN +1

j j-iN +1

-X X
gj lj-iN +1

2
 


N
= iN-2
j=iN

gj
(tX )2 dt 2Y2 +
lj-iN +1

= O i-N2 = O(1) .

j
(tY )2 dt 2X2
j-iN +1

+ O i-N2

For the generalized multiscale estimator instead the cross terms are of order MN-1/2 and will have effect upon the asymptotic distribution. In Proposition A.11 a limit theorem is stated where the weak conver-

gence also holds conditionally and unconditionally on the paths of the efficient processes. The asymptotic

variance AVARcross includes the influence of the asymptotic degree of regularity of asynchronicity.

The error due to discretization of the one-scale subsampling estimator yields:

1N i
j=i

Xgj - Xlj-i+1

Yj - Yj-i+1 - [X, Y ]T

1N =
i

XTj - XTj-i

j=i

YTj - YTj-i - [X, Y ]T

1N +
i
j=i

Xgj - XTj

YTj - YTj-i + Xgj - XTj

Y - YTj-i

j-i+1

+

X - XTj-i

lj-i+1

Yj - YTj

+

X - XTj-i

lj-i+1

YTj - YTj-i

+ Yj - YTj

XTj - XTj-i

+

Y - YTj-i

j-i+1

XTj - XTj-i

1N =
i
j=i

j
XTk
k=j-i+1

j
YTk
k=j-i+1

- [X, Y ]T



1 N-1

+ i

 Xgj - XTj

j=i

j
YTk
k=j-i+1

+ Xgj - XTj

Y - YTj-i

j-i+1

+

X - XTj-i

lj-i+1

Yj - YTj + XTj - Xlj+1

+ Yj - YTj

j
XTk
k=j-i+1

+ YTj - Yj+1

j

YTk
k=j-i+1

j
XTk
k=j-i+1

  + Op

N -1

1N =
i
j=i

j

XTk YTk +

XTl YTr

k=j-i+1

l=r l,r{j-i+1,...,j}

- [X, Y ]T



1 N-1

+ i

 Xgj - XTj

j=i

j
YTk
k=j-i+1

+ Yj - YTj

j
XTk
k=j-i+1

+ XTj+1

j
YTk - Yk+1
k=j-i+1

+ YTj+1

j
XTk - Xlk+1
k=j-i+1

 

13

+ Op

i-1

N

-

1 2

+ Op N -1

.

We have written the overall discretization error of the one-scale estimator as the sum of a discretization error of the closest synchronous approximation

N ij

XTj

j=1

l=1

1- l i

ij
YTj-l + YTj
l=1

1- l i

XTj-l

+ Op iN -1 + Op N -1/2

(21)

and the asymptotically negligible error due to the lack of synchronicity. A stable central limit theorem using the theory of [18] for the leading term of order i1/2N -1/2 that will drive the asymptotic distribution

is postponed to Proposition A.4. The error due to asynchronicity is treated in Proposition A.10.

The discretization error of the generalized multiscale estimator is of order MN1/2N -1/2 and that of the onescale estimator of order iN1/2N -1/2. There is a trade-off between the error due to noise and the discretization error for both estimators. For the generalized multiscale estimator these are of orders N 1/2MN-3/2 and MN1/2N -1/2, respectively. Remaining other terms are of orders MN-1/2. Thus, choosing MN = cmulti ·N 1/2, the total estimation error is minimized and of order MN-1/2 = N -1/4 which constitutes the optimal rate of
convergence in Theorem 3.

The weak convergence of the discretization error is proved to be stable, so it converges jointly in law with

every bounded F-measurable random variable defined on the same probability space. Since the asymptotic

normality of the cross term and the error due to noise holds both, conditionally and unconditionally given

the efficient processes, and the discretization error is independent of X and Y we can apply a central

limit theorem for mixing triangular arrays as in [28] to the sum that is adapted with respect to Aj =



X tk

,

tk

<

Tj+1,

Y k

,

k

<

Tj+1, FTj

where F is the -algebra associated with the efficient processes.

The asymptotic variance is the sum of those of the uncorrelated addends. With the Crame´r-Wold device

joint normality and asymptotic independence of the different errors can be concluded.

This is likewise for the one-scale estimator and Corollary 4.1. Choosing the subsampling frequency iN = csub · N 2/3 balances the variance of the error due to noise which is of order N i-2 and the discretization variance of order iN -1.

5. Asymptotic variance estimation

The asymptotic variances (18) and (20) of the generalized multiscale estimator (12) and the one-scale
subsampling estimator (13), appearing in the stable central limit theorems in Theorem 3 and Corollary 4.1,
are random and depend on unknown quantities. In this section, we aim at estimating these asymptotic
variances consistently to make our limit theorems feasible.
It is a known result that a consistent estimator of the noise variance is given by (24) (cf. [31]). Furthermore, the estimators for X2 and Y2 are asymptotically uncorrelated on Assumption 3, since the uncorrelated noise terms dominate the correlated Brownian parts. The constant IX (T ) + IY (T ) in the noise part of (18) can be estimated with the empirical version IXN (T ) + IYN (T ) that converges as N   on Assumption 5. Eventually, consistent estimators for the discretization variances and the variance due to cross terms for
the multiscale estimator are required.
We propose histogram-type estimators using bins according to timescales associated with the quadratic
variation of synchronized sampling times and associated with the degree of regularity of asynchronicity, respectively. For this purpose, given a chosen number of bins KN , with KN   and KN-1N   as N  , we determine the assigned non-equispaced bin-widths GNj = GjN - GjN-1, (IX )jN = (IX )Nj - (IX )jN-1 and (IY )jN = (IY )Nj - (IY )Nj-1, j  {1, . . . , KN }, where

GNj := inf t  [0, T ] GN (t) = (N/T )

Tk(N) 2  (j/KN ) · GN (T ) ,

Tk(N ) t

j  {1, . . . , KN }, and analogously for the functions IXN and IYN if IXN (T ) > 0 and IYN (T ) > 0. Set GN0 = (IX )0N = (IY )N0 := 0 and recall that those functions are monotone increasing on [0, T ]. On each

14

bin we calculate multiscale estimators in the same spirit as (12) and its univariate version from [30] for the
increase of the quadratic (co-) variations that are denoted  [X]GNj ,  [Y ]GjN ,  [X, Y ]GjN ,  [X](IY )Nj
and  [Y ](IX)jN in the following. The underlain idea is to approximate the continuous random processes (tX tY t)2, (tX )2 and (tY )2, or rather their time-transformed versions, by locally constant functions. This construction leads to time-adjusted histogram estimators

 2

I^1

=

KN j=1

 [X, Y ]GNj  GNj



GN (T ) KN



I^2

=

KN j=1

 [X]GjN  [Y  GjN 2

]GNj



GN (T ) KN



I^3

=

KN j=1

 [X ](IY )jN  (IY )Nj



IYN (T ) KN



I^4

=

KN j=1

 [Y ](IX )Nj  (IX )jN



IXN (T ) KN

T
for G (t)(tX tY t)2 dt,
0
T
for G (t)(tX tY )2 dt,
0
T
for IY (t)(tX )2 dt,
0
T
for IX (t)(tY )2 dt.
0

(22a) (22b) (22c) (22d)

Proposition 5.1. The asymptotic variances (18) and (20) of the generalized multiscale estimator (12) and the one-scale subsampling estimator (13) with MN = cmultiN 1/2 and iN = csubN 2/3, can be estimated
consistently by

AVARmulti =

c-m3ulti 24 + 12 IXN (T ) + IYN (T )

+

12 5

cm-1ulti

X2 Y2

26 + cmulti 35 T

I^1 + I^2

+

cm-1ulti

12 5

Y2 (1 + T I^3) + X2 (1 + T I^4)

,

(23a)

AVARsub

=

cs-u2b4X2 Y2

2 + csub 3

I^1 + I^2

,

where I^1-I^4 are the estimators (22a)-(22d) and

nm
X2 = (2n)-1 (Xti )2 , Y2 = (2m)-1 (Yj )2 .
i=1 j=1

(23b) (24)

Remark 1. Convergence rates of the estimators (23a) and (23b) for the asymptotic variances depend on the

smoothness of X , Y and . For current stochastic volatility models as the Heston model, they are N 1/5-

consistent when choosing KN = cK N 1/5 for a constant cK and MN  N 3/5 for the binwise multiscale

estimators.

In the absence of realized volatility

noise, a consistent estimator for the has been proposed in [6] as (2n/3)

asymptotic variance

n i=1

(Xti

)4

.

In

the

2T

T 0

GX (t)(tX )4dt

of

the

bivariate synchronous setting

(n/2)

n-1 i=1

(Xti

)2

(Yti )2 + (Yti+1 )2

is a convenient estimator. Consistency can be proved with

Ito^'s formula and partial integration and comprehended by the analogy to a bivariate Gaussian distribution

(X, Y )  N(0, ) with a covariance matrix  with entries X2 , Y2 , X Y . Then, EX4 = 3X4 and E X2Y 2 = 22X2 Y2 + X2 Y2 hold true. In the noisy case smoothed versions of the estimators (using multiscale or alternative methods) are adequate

(cf. [9]). However, in the non-synchronous non-noisy setting, there is no direct extension available and for

that reason we have made the effort to construct the consistent histogram-based estimators (22a)-(22d)

above.

15

6. Discussion and application

6.1. A case study
We have learned by now that in a synchronous setting the special version of the central limit Theorem 3 from Proposition 3.1 holds true. Since asymptotics of the estimator (12) not hinge on interpolations in the signal term the same central limit theorem applies in the case of intermeshed sampling introduced in Section 3. Now we focus on observation schemes that arise as realizations of two homogeneous Poisson processes that are mutually independent and independent of the processes X~ and Y~ . Although this model can be criticized for its flaw that sampling schemes of two correlated processes follow two independent processes and time homogeneity, what might seem to be unrealistic in financial applications, independent and homogeneous Poisson sampling constitutes the most commonly used model in this research area (cf. [30], [15] among others) and appertains to show that the general form of (18) is tractable. Let n~(n)(t) and m~ (n)(t) be sequences of two independent homogeneous Poisson processes with parameters T n/1 and T n/2 (n  N), such that the waiting times between jumps of n~(n) and m~ (n) are exponentially distributed with expectations E t(in) = 1/n and E j(n) = 2/n , i  N, j  N. In this case

Tk(n)  F (t) = 1 - exp

- tn 1

- exp

- tn 2

+ exp

-tn

11 +
1 2

,k  N,

IXN (t)

-p

12t (1 + 2)2

,

IYN (t)

-p

12t (1 + 2)2

zt = (z + 1)2 if 1 = z2 ,

(25)

hold true and we derive the following Poisson sampling version of Theorem 3:

Corollary 6.1. On the Assumptions 1and 3, the generalized multiscale estimator (12) with noise-optimal weights (A.1), and MN = cmulti · N , converges conditionally on the independent Poisson sampling scheme with 0 < 1 <  and 0 < 2 <  stably in law with rate N 1/4 to a mixed normal limit:

multi
N 1/4 [X, Y ]T - [X, Y ]T

st N 0, AVARmpouisltsi

with the asymptotic variance

AVARmpouisltsi = cm-3ulti

24

+

12

212 (1 + 2)2

X2 Y2

+ c-m1ulti

12X2 Y2 5

26 T + cmulti 35 0 2

1

-

1222

+

21222 (12 + 22)(1

+

2)2

(tX tY )2(1 + 2t ) dt

+

c-m1ulti

12 5

Y2

T
(1
0

+

12 1 + 2

)(tX

)2

dt

+

X2

T
(1
0

+

12 1 + 2

)(tY

)2

dt

(26) .

The asymptotic variance of the N 1/6-consistent one-scale estimator becomes

AVARspuoibss = cs-u2b 4X2 Y2 2T
+ csub 3 0 2

1

-

1222

+

21222 (12 + 22)(1

+

2)2

(tX tY )2(1 + t2) dt .

(27)

The order for the supremum of time instants in Assumption 2 holds in probability and the proof in
Appendix A stays valid. A Poisson sampling version of Theorem 2 is given in [7], where the stochastic limit of GN is deduced using the distribution of a maximum of two exponentials stated above.

16

6.2. A bridge between the noisy and the non-noisy setup

So far we considered noise variances not dependent on N , but from an applied point of view there

is interest in the case where the noise level may vary with N  n  m. The primary motivation to

accommodate dependence of the noise on the sample size in the model originates from the economic

background. Empirical studies of (ultra) high-frequency financial data suggest to rather model the observed

log-prices as sum of a latent semimartingale and noise for that the variance decreases in N as reported in

[20] and [3], among others.

If an estimation approach uses previous-tick interpolations, as the one proposed in [5], these methods are

not accurate for that setting any more. This also becomes apparent in the simulation study in [8] when the

performance of the estimators is compared for varying noise levels. The generalized multiscale estimator

is not biased due to asynchronicity and passes over to the Hayashi-Yoshida estimator (8) for MN = 1, a N -consistent estimator in the complete absence of noise. For that reason, our estimation method achieves

an improved convergence rate in the model with decreasing noise variances. The next Corollary is obtained

by a direct extension of the proof of Theorem 3 in Appendix A when replacing the moments of the noise

processes.

A

similar

extension

for

the

one-scale

estimator

where

we

obtain

the

rate

N

1 6

+

 3

for

a

subsample

frequency

iN

=

csubN

2 3

(1-)

holds

analogously.

Corollary 6.2. Consider the model imposed by Assumption 1, 2 and 3, but with noise variances X2 (N ) =

X N - , Y2 (N ) = Y N - , 0 <  < 1 and constants 0 < X <  , 0 < Y < . The generalized

multiscale

estimator

(12)

with MN

=

cmultiN

1 2

-

 2

and

optimal

weights

(A.1) converges

stably in law

to

a mixed Gaussian limit:

N1 4

+

 4

multi
[X, Y ]T - [X, Y ]T

st N (0, AVARmulti)

(28)

with the asymptotic variance

AVARm ulti = c-m3ulti

24 + 12 IX (T ) + IY (T ) T

X Y

+ c-m1ulti

12X Y 5

26 + cmulti 35 T

T
G (t)(tX tY )2(1 + t2) dt
0

+

cm-1ulti

12 5

Y

TT
(1 + IY (t))(tX )2 dt + X (1 + IX (t))(tY )2 dt
00

.

Incorporating a pure previous-tick interpolation strategy as in [5], one cannot gain an improved convergence rate in that setting due to the bias by non-synchronicity effects.

6.3. Application

6.3.1. Note on modeling assumptions

For an application to financial time series data the conditions imposed by Assumptions 1-3 seem to be

restrictive and the model will not describe stylized facts of the data in an adequate way. In particular relax-

ing the i. i. d. assumption on the noise is important. On the other hand, the underlying model in the sections

before is convenient to establish an asymptotic distribution theory and ascertains a closed-form expression

for the asymptotic variance. Yet, the generalization for serially dependent observation errors as carried out

in [2] for the one-dimensional case is possible for the generalized multiscale estimator (12) as well. On

the assumption of stationary strong mixing noise processes the multiscale estimator remains consistent and

rate-optimal without any further adjustment. The analysis for the synchronous case can be adopted from

[2], but for the general non-synchronous noisy setting a closed-form expression of the asymptotic variance

and a corresponding limit theorem is not available. Furthermore, the condition that noise processes are mu-

tually independent can be relaxed if one wants to allow some correlation E

XY ti j

= Xi,j,Y for ti and j

located near each other. In any case the generalized multiscale estimator remains asymptotically unbiased

and N 1/4-consistent. This does not necessarily hold true for the one-scale estimator that would have to be

bias-corrected as the TSRV estimator by [31] in the one-dimensional case.

17

More general efficient processes including jumps can be covered in the model when we combine the method to a two-stage approach as presented by [11] for the one-dimensional estimation approach. Considering semimartingales

Xt =

t
µXs ds +
0

t JtX
sX dBsX + LlX , Yt =
0 l=1

t
µYs ds +
0

t JtY
sY dBsY + LYl ,
0 l=1

with locally bounded drifts, continuous volatilities and counting processes JtX , JtY counting the jumps of X and Y with jump sizes LXl , l = 1, . . . , JtX and LYl , l = 1, . . . , JtY , respectively, the generalized multiscale estimator converges in probability to the total quadratic covariation

T

ttX tY +

XsYs

0 0st

where Xs = Xs - Xs,-, Ys = Ys - Ys,-, and the second addend is the sum of the simultaneous co-jumps. When one is interested in disentangling the continuous part from the jumps, one convincing possibility following [11] is to use wavelet methods that locate the jumps in the sample paths, estimate jump sizes and afterwards use our estimation approach for the validated observations. In conclusion the generalized multiscale estimator (12) is capable for usage in various applications. In [8], we have approved that the estimator performs well and has satisfying finite sample size features in simulations including serially dependent noise and typical stochastic volatility models.

6.3.2. Choice of tuning parameters

An implementation of the estimation approach requires first a rule to choose tuning parameters. We

provide an accurate algorithm to implement the estimators and to obtain estimates for their asymptotic

variances.



One plausible selection of the constants cmulti = N /MN and csub = N 2/3/iN can be derived as solu-

tions of the minimization problems of the asymptotic variances. This leads to formula (29) in Algorithm 2.

The tactic of Algorithm 2 is the following: Evaluate a pilot estimate c^m(pu) lti for cmulti as solution of formula

(29) inserting a sparse-sampled estimator for the signal term. Then set up the estimation of the asymptotic variances involving the estimators (22a)-(22d). Take MNb = cmb ulti N KN fixed for the multiscale esti-

mators on all bins and set MNb = cbmulti N cK N 1/5 where cK = KN-1N 1/5. This selection is optimal

for common volatility models. We obtain cbmulticK-1/2 = c^(mpu) lti and from the orders of the different errors

of the histogram estimators cmb ulti = cK5/2. Hence, cbmulti =

cm(pu) lti

5/4
and cK

=

c(mpu) lti is derived.

Using estimators (22a)-(22d), we calculate estimates for the addends of the asymptotic variance and c^multi according to formula (29) again and MN = c^multi N is used for the final estimator. It turns out that

this strategy it quite robust to the a priori chosen sparse-sample frequency that can be chosen under the

impression of usual diagnostic tools as signature plots and acfs.

6.3.3. Simulation and data analysis check
As completion to the detailed simulation study in the supplementary material to [8] we investigate the performance of Algorithm 2 and the histogram-estimators (22a)-(22d) here. For this purpose we simulate from an simple Brownian motion model with zero drifts and constant volatilities X = Y = 1 and  = 1/2 with equal noise variances 2. Sampling schemes are generated by independent time-homogeneous Poisson sampling with 30.000 expected observation for both processes on [0, 1]. Results of the estimates are listed in Table 2. In addition, our approach is tested in an application to EUREX future tick-data taken from a database provided by the Research Data Center (RDC) of the CRC 649 `Economic Risk' in Berlin. We aim at estimating integrated covolatilities between the four financial securities with the highest tick-frequencies in the database. These are the Euro-Bund Future (FGBL), that is based on a notional long-duration debt instrument issued by the Federal Republic of Germany, the Euro-Bobl Future (FGBM), a likewise medium-duration contract, and futures on the EURO STOXX 50 (FESX) and the German DAX (FDAX).

18

p
· Choose a priori L and calculate pilot estimator AVARmulti with

N/L
pN AVARdis= 2
k=1

X~gkL - X~l(k-1)L+1

2
+

X~gkL+2 - X~l(k-1)L+3

2

Y~kL - Y~(k-1)L+1 2

p
and [X]T =

j=kL,k1

X~tj - X~tj-L

2p
and [Y ]T analogously and IX (t)  IXN (T ) and IY (t) 

IYN (T ). Calculate X2 and Y2 according to (24).

· Use pilot estimates to estimate optimal constant(s)

p

-AVARcross,n +

c^m(pu) lti

=

 



p2

p p -1/2

AVARcross,n + 12AVARdisAVARn



p
6AVARn

 

(29)

and c^(spu)b =

3

pp
2AVARn,sub/AVARdis,sub.

· Calculate I^1 - I^4, given in (22a)-(22d), with

KN =

c^m(pu) ltiN 1/5 bins and MN (j) =

c^m(pu) lti

5/4
N 3/5  j .

· Estimate asymptotic variance with I^1 - I^4 and X2 , Y2 and determine c^multi and c^sub with the above given formulae.
· Calculate the generalized multiscale estimator (12) with optimal weights (A.1) (and the one-scale subsample estimator) with MN = c^multi N (and iN = c^subN 2/3)
Algorithm 2: Algorithm for the estimation procedure.

We apply the procedure with Algorithm 1 and Algorithm 2 to a suitable filtered dataset and give the results for two days in Table 3 with associated estimated optimal multiscale frequencies. The estimates for the quadratic covariations are given ± estimated standard deviation from the estimated asymptotic variances and the pertaining N for each pair. Although there are characteristics of the dataset not in accordance with the model assumptions, above all price discreteness and the fact that most returns are zero, the estimation approach passes this intuition check. Since the ESX and the DAX share 13 companies constituting c. 28.5% weighting in the ESX and c. 72.4% in the DAX there is a big systematic positive correlation between both and we presume that there is as well a high correlation between the two debt instruments which is both revealed by the estimates. On 09/11/2001, there has been a tremendous impact so that FGBL/FGBM have increased and the FESX/FDAX decreased. For that day we have significantly negative integrated covolatilities between debt instruments and stock indices which is not the case for the ordinary trading day in comparison. As answer to the great amount of zero returns the only adjustment of the method that we undertake is to estimate noise variances in (24) by dividing the realized volatility by twice the number of non-zero returns instead of all returns. To sum up, the estimation approach based on Algorithm 1, a multiscale extension of subsampling and Algorithm 2 provides a convincing method to obtain integrated covolatility estimates for very general high-frequency data.

19

Table 2: Estimators (22a)-(22d), estimators for the asymptotic variances of the multiscale (18) and the one-scale estimator (20), calculated asymptotic variances and estimates for the quadratic covariation. The estimates are given ± empirical standard deviations.

noise var. 2
I^1 I^2 I^3 I^4

0.0001 0.392 ± 0.038 1.557 ± 0.067 0.250 ± 0.007 0.250 ± 0.007

 (0.001/ 10) 0.390 ± 0.047 1.552 ± 0.085 0.249 ± 0.010 0.249 ± 0.009

0.001 0.394 ± 0.073 1.538 ± 0.141 0.249 ± 0.016 0.249 ± 0.016

 (0.01/ 10) 0.413 ± 0.144 1.529 ± 0.276 0.247 ± 0.031 0.247 ± 0.030

0.01 0.423 ± 0.128 1.462 ± 0.230 0.234 ± 0.085 0.233 ± 0.083

AVARmulti 0.090 ± 0.003 0.143 ± 0.005 0.246 ± 0.015 0.434 ± 0.050 0.778 ± 0.082

AVARmulti

0.0663

0.1185

0.2159

0.3774

0.6737

AVARsub
AVARsub
multi
[X, Y ]T
sub
[X, Y ]T

0.0086 ± 0.0002 0.0077
0.501 ± 0.024
0.500 ± 0.022

0.017 ± 0.001 0.0166
0.499 ± 0.029
0.499 ± 0.028

0.037 ± 0.002 0.0357
0.498 ± 0.038
0.499 ± 0.042

0.080 ± 0.009 0.0768
0.499 ± 0.049
0.500 ± 0.058

0.157 ± 0.017 0.1656
0.501 ± 0.065
0.503 ± 0.074

multi
[X, Y ]T (MSFR)

FGBL

FGBL

5.46 ± .87 (7)

FGBM

FESX

FDAX

multi
[X, Y ]T (MSFR)

FGBL

FGBL

27.89 ± 4.1 (15)

FGBM

FESX

FDAX

FGBM
3.32 ± .74 (7) 2.42 ± .47 (6)

FESX
0.98 ± .99 (9) 0.78 ± .69 (7) 68.26 ± 7.1 (10)

FDAX
0.52 ± .74 (6) 0.64 ± .51 (4) 29.39 ± 2.4 (7) 61.43 ± 3.5 (5)

FGBM
12.94 ± 1.7 (12) 18.10 ± 2.5 (8)

FESX
-52.55 ± 18 (8) -26.44 ± 14 (6) 3070 ± 172 (6)

FDAX
-34.13 ± 11 (7) -25.01 ± 28 (3)
757 ± 15 (4) 1870 ± 94 (4)

Table 3: Estimates for integrated covolatilities, standard deviations (· 106) and used multiscale frequencies for 10/01/2008 (top) and 09/11/2001 (bottom).

Appendix A. Proof of Theorem 3

Appendix A.1. Error due to noise and choosing the weights The error due to microstructure noise of the generalized multiscale estimator is given by

MN i,MN N i
i=1 j=i

-X X
gj lj-i+1

-Y Y
j j-i+1

= MN i,MN i
i=1

N j=1

+X Y
gj j

XY lj j

N
-
j=i

+X Y
gj j-i+1

YX j lj-i+1

i-1
-
j=1

N

X gj

Y j

-

XY lj j

j=N -i+1

.

Additionally to the standardization condition

MN
i,MN = 1 ,
i=1

(C1)

that is necessary for asymptotic unbiasedness and consistency, we now impose the auxiliary condition

MN i,MN = 0 , i
i=1

(C2)

20

on the weights which assures that the leading term of the noise error equals zero. Hence, there remain three uncorrelated addends in the error induced by microstructure noise.

Proposition A.1. Let Assumptions 2 and 5 on the observation times and Assumption 3 on the observation errors hold true. The asymptotic variance of the term

MN
-

i,MN

N

i

i=1 j=i

+X Y
gj j-i+1

YX j lj-i+1

is minimized by the weights

io,pMt N =

12i2 (MN3 - MN )

-

6i (MN2 -

1)

-

(MN3

6i -

MN )

=

12i2 MN3

-

6i MN2

(1 +

O(1))

(A.1)

as MN , N   and MN /N  0 with N = O MN4 . The following asymptotic normality result holds true:

 MN3 MN io,pMt N N
 Ni
i=1 j=i



XY
- gj j-i+1

YX j lj-i+1

N (0 , AVARnoise) ,

(A.2)

with the asymptotic variance

AVARnoise = (24 + 12(IX (T ) + IY (T )))X2 Y2

(A.3)

with the functions IX and IY defined in Assumption 5. The weak convergence also holds true conditionally given the paths of the efficient processes.

Proof. The term is centred and we illustrate it in the way

MN
-

i,MN

N

i

i=1 j=i

+X Y
gj j-i+1

YX j lj-i+1

= - N MN j i,MN i
j=1 i=1

XY gj j-i+1

1 1 1 1( + ) + ( + ) .{gj=gj+1}

{gj =gj+1}

YX j lj-i+1 {j =j+1}

{j =j+1}

For fixed i the addends of the inner sum are uncorrelated because li = lj and i = j for all i = j. Consecutive right-end points gi, i can be the same observation times instead, so that the inner sums are 2-dependent random variables. Thus, the variance is given by



N
Var 

i,MN MN j i

j=1

i=1



XY
- gj j-i+1

YX j lj-i+1

N MN j
=
j=1 i=1

i,MN i

12
2X2 Y2

+

N

(MN -1)(j-1)

i,MN i+1,MN i(i + 1)

X2 Y2

(1

-

) .{gj =gj+1 , j =j+1}

j=1

i=1

The weights that minimize the first addend of the above variance and also the total variance asymptotically

have been determined in [8]. Those weights are in line with the standard weights from [30] in the univariate

setting and correspond to a cubic kernel for the kernel estimator by [5].

Inserting the noise-optimal weights (A.1), we can apply a central limit theorem for strong mixing triangular

arrays from [28] to

MN3 N io,pMt N MN j

Ni
j=1

i=1

+X Y
gj j-i+1

XY lj-i+1 j

.

21

The sequence of variances with the chosen weights according to (A.1)

 Var 

MN3 N io,pMt N MN j

Ni
j=1

i=1



XY
+ gj j-i+1

XY lj-i+1 j

= MN3 N MN (j+1) N
j=0 i=1

io,pMt N i

2
1X2 Y2 (3 - {gj ¬j+1 , )j =j+1} + O(1)

- 36X2 Y2 - 12(1 - (IX (T ) + IY (T )))X2 Y2

converges to AVARnoise on the Assumption 5. Since the inner sums are 2-dependent and hence in particular -mixing, the Lyapunov condition that holds obviously suffices to apply the central limit theorem of [28]. This completes the proof of the proposition.

Next, we consider the remaining addends of the error induced by microstructure frictions and insert the weights (A.1):

Proposition A.2. On the Assumptions 2, 5 and 3, the following weak convergence to a centred normal distribution holds true:





MN

MN


io,pMt N i

i-1


X gj

Y j

+

N

XY
lj j 

i=1

j=1

j=N -i+1

N

0,

12 5

X2 Y2

.

(A.4)

This convergence also holds conditionally on the paths of the efficient processes.

Proof.



MN io,pMt N

i-1

i

X gj

Y j

+

N

MN -1

X lj

Y j



=

i=1

j=1

j=N -i+1

j=1

+X Y
gj j

XY lN-j N-j

MN io,pMt N i
i=j+1

BoMthNaddeMjn=Nd1s-a1reXguj nYcjorreiMl=aNtje+d1aniod,pMttrNea/tiedisanthaeloegnodupsolyi.ntWoef

restrict ourselves to a discrete centred

the proof for the martingale with

first term. respect to

the filtration ANj := 

X tk

|tk



gj

,

Xtk |0



k



n



Y k

|k



j ,

Yk |0



k



m

.

Namely, since

gj = gj-1  j > j-1 and j = j-1  gj > gj-1 analogously:

E

MN

MN

X gl

Y l

io,pMt N i

AlN-1

i=l+1

1 1 1= MN

E + E + E E{gl=gl-1}

YX l gl-1

{l =l-1 }

XY gl l-1

{gl=gl-1 , l=l-1}

X gl

Y l

=0.

A central limit theorem for martingale triangular arrays from [14] is applied, in particular the non-stable version of Corollary 3. 1 (cf. the following remark in [14] and references cited therein). The conditional Lindeberg condition can be verified by the stronger conditional Lyapunov condition. The proof of it is obtained by a similar calculation as the following one and we omit it. The conditional variance equals

   2

MN -1

MN

Var 

X gj

Y j

MN

io,pMt N i

MN -1

AN,j-1 = MN



MN

io,pMt N 
i

j=1

i=j+1

j=1 i=j+1

1× X2 Y2 +{gj =gj-1 , j =j-1}

2

1X
gj

2
{gj =gj-1} Y

+

2
1 Y 2
j {j =j-1} X

-p

6 5

X2

Y2

.

We have used the formula

MN -1 j=1

i=j+1 MN (io,pMt N /i) 2 = (6/5)MN-1 + O(MN-1).

22

A.2. Discretization errors of the estimators
Proposition A.3. On the Assumptions 1, 2 and 4, the discretization error of the one-scale subsampling estimator with subsampling frequency iN converges stably in law to a centred mixed normal limit as iN  , N  , iN /N   0 for every  > 2/3:

 NN

iN


j=i

Xgj - Xlj-i+1

 Yj - Yj-i+1 - [X, Y ]T  st N (0, AVARdis,sub) ,

with asymptotic variance

2

AVARdis,sub

=

T 3

T
G (t)(tX tY )2(1 + 2t ) dt .
0

(A.5)

Proposition A.4. On the Assumptions 1,2 and 4, the discretization error of the generalized multiscale
estimator with the noise-optimal weights given in (A.1) converges with rate N/MN stably in law to a centred mixed Gaussian limit as MN  , N  , MN /N   0 for every  > 2/3:

 N MN io,pMt N N
 MN i=1 i j=i

Xgj - Xlj-i+1

 Yj - Yj-i+1 - [X, Y ]T  st N (0, AVARdis,multi) ,

with asymptotic variance

26

AVARdis,multi

=

T 35

T
G (t)(tX tY )2(1 + 2t ) dt .
0

(A.6)

A.2.1. Time-change in the asymptotic quadratic variation of time
Proposition A.5. In the proof of a central limit theorem for the discretization error of the closest synchronous approximation Tk(N), k = 0, . . . , N , of our generalized multiscale estimator (12) on the Assumptions 2 and 5, we can additionally, without loss of further generality, assume that

N

Tk(N )

-

T N

2
= O N -1

.

k=1

(A.7)

Remark 2. From Assumptions 1 and 2, we can deduce directly that the sum above is at most of order N -1. The stronger assertion, that the closest synchronous approximation defined by the times Tk(N), k = 0, . . . , N introduced in paragraph 3.2 is close to equidistant sampling in the sense that the sum above is of smaller asymptotic order than N -1, is derived by the concept of a time-change in the asymptotic quadratic
variation of time from Assumption 4. For the proof of (A.7) we refer to Lemma 1 from [30] where this
concept has been presented for the univariate multiscale approach and it directly carries over to the syn-
chronous multivariate case. On the Assumption 4, a transformation g can be defined that maps the refresh times Tk(N) to values g(Tk(N)), so that (A.7) holds true for the transformed synchronous observation scheme. Thanks to the fact that the
corresponding time-changed processes Lg(t) and Mg(t) fulfill Assumption 1 again and the transformed observation scheme Assumption 2, we are able to prove a central limit theorem for the time-changed version
of the discretization error if (A.7) did not hold.
Since the resulting asymptotic variance will be invariant under the transformation g, the central limit the-
orem will analogously hold true for the original sampling scheme. Hence, no further restriction has to be
made when assuming (A.7).

A.2.2. Discretization error of the closest synchronous approximation

Note that it suffices to prove the foregoing limit theorems for the zero-drift case. Since our limit

theorems are stable, asymptotic mixed normality is assured to hold for the general setting on Assumption

1. Denote Lt =

t 0

sX dWsX

and

Mt

=

t 0

sY

dWsY

the continuous martingales that represent the efficient

23

processes under the equivalent martingale measure after a Girsanov transformation. The Novikov condition has been imposed in Assumption 1 to allow for this transformation. The asymptotic mixed normality result is implied as marginal distribution at t = T of a limiting timechanged Brownian motion which is proven to be the stable weak limit of the process corresponding to the discretization error (21) with the theory of [18]. We begin with the discretization error of the closest synchronous approximation of a one-scale subsampling estimator.

Proposition A.6. On the same assumptions as in Proposition A.3, the continuous martingale

DNt :=


N 
iN T Tkt

LTk +

t
sX dWsX
Tk

+
Tk t

MTk +

t
sY dWsY
Tk

ik l

1- i

MTk-l

l=1

ik l

1- i

LTk-l

l=1

 

for t  [0, T ], where  · Tk = · Tk - · Tk-1 is the backward difference operator, converges stably in law as N  , iN  , iN /N  0 to a limiting time-changed Brownian motion

where W is independent of F and

DNt st

t

 vDs

dWs

,

0

vDs

=

2 G
3

(s)(sX sY

)2(1

+

2s )

.

Proof of Proposition A.6:
The subscript of the subsampling frequency is omitted in the following proof and C denotes a generic constant and N = supi{1,...,N} (Ti - Ti-1). We apply a simplified martingale version of the stable central limit theorem 2­1 from [18]. For other applications and expositions of the theory from [18] we refer to [24], [12] and [7]. The above limit theorem is implied by the following three conditions:

t
[D]t -p vDs ds ,
0

(A.8a)

[D, L]t -p 0 , [D, M ]t -p 0,

(A.8b)

D, L t -p 0 , D, M  t -p 0,

(A.8c)

for all t  [0, T ] and for all M   M and L  L that denote the set of (F )t-adapted bounded martingales orthogonal to M and L in the sense that L, L = 0, respectively. Calculating the quadratic variation of DNt yields



DN

t=

N iT



 [L]Tk

Tk t

ik l 1- i
l=1

2
MTk-l +  [M ]Tk

ik l 1- i
l=1

2 LTk-l 

+ 2  [L, M ]Tk
Tk t

ik 1 - l i
l=1

LTk-l



ik

1- l i

MTk-l

 + Op(1)

l=1

24



N ik

= iT 

 [L]Tk

Tk t

l=1

1- l i

2

MTk-l 2 +

 [M ]Tk

Tk t

ik
×
l=1

1- l i

2 ik

LTk-l 2 + 2

 [L, M ]Tk

Tk t

l=1

1- l i


2
LTk-l 2 + Op(1)



=

N 
iT
Tk t

Tk
(sX )2ds
Tk-1

ik l=1

1- l i

2

Tk-l
(sY )2ds
Tk-l-1

Tk
+ (sY )2ds
Tkt Tk-1

ik l=1

Tk
+ 2 ssX sY ds
Tkt Tk-1

1- l i

2

Tk-l
(sX )2ds
Tk-l-1

ik l=1

1- l i

2 Tk-l
ssX sY ds
Tk-l-1

  + Op(1)

N = iTLemma A.7

ik

2(1

+

2
Tk-1

)(TXk-1

Y
Tk-1

)2

(Tk

)2

Tk t

l=1

1- l i

2
+ Op(1)

= 2 GN (Tk) - GN (Tk-1)

3
Tk t

Tk - Tk-1

2
Tk-1

+

1

2

 X Y
Tk-1 Tk-1

Tk + Op(1)

-p 2 3

t
(1 + s2)(sX sY )2G (s) ds .
0

In the first step cross terms of the inner sums have been neglected since they are centred and by Ito^ isometry

it can be shown that their second moments are bounded from above by Ci3N3 . We frequently use estimates

Nl-1 for sums of the type

N i

(Ti

)l

,l

>

1,

by

Ho¨ lder's

inequality

with

the

supremum

norm

to

obtain

upper bounds.

Subsequently, squared increments of L and M and the increments of the product L · M in these inner

sums are substituted by the increments of the quadratic (co-)variation processes. The induced error terms

are centred by Ito^ isometry and involving the Cauchy-Schwarz inequality it follows that CN is an upper

bound for their second moments.

The crucial non-standard approximation is that on each block (Tk-1, . . . , Tk-i0) the increments of the

form

Tk-l Tk-l-1

f (t)dt

with

continuous

functions

f

for

l

=

1, . . . , k



i

are

approximated

by

Tk f

(Tk-1).

This blockwise approximation is treated in Lemma A.7 and makes use of the concept of a time-changed

quadratic variation of times and particularly (A.7). Finally, 1/i

i l=1

(1

-

(l/i))2

=

1/3

+

O(1)

and

the

convergence in probability is ensured by Assumption 4 and the convergence of the Riemann sums to the

integral.

Lemma A.7. On the same assumptions as in Proposition A.3, it holds true that the term

N iT
Tk t

Tk
(sX )2ds
Tk-1

ik l=1

1- l i

2

Tk-l
(sY )2ds
Tk-l-1

ik

-

(TXk-1

Y
Tk-1

Tk )2

l=1

1- l 2 i

,

and the analogous blockwise approximations of [M ]Tk and [M ]Tk by constant left-end points converge to zero in probability.

Proof. The approximation uses the concept of a time-change in the asymptotic quadratic variation of refresh times introduced in [30] which is expounded in Proposition A.5. By virtue of that concept we may suppose without loss of generality that the sampling design of the closest synchronous approximation satisfies (A.7). The asymptotic orders of the three terms are deduced analogously and we restrict us to the proof of the

25

above given first term. An application of the mean value theorem yields

N iT
Tk t

Tk
(sX )2ds
Tk-1

ik l=1

1- l i

2

Tk-l
(sY )2ds
Tk-l-1

N =
iT

(Xk )2Tk

ik

1- l i

2
(Yk-l )2Tk-l

Tk t

l=1

with k  [Tk-1, Tk], q  [Tq-1, Tq]. Since the volatility processes X , Y are uniformly continuous on [0, T ] by Assumption 1

ik l=1

1- l i

2

(Yk-l )2

- (TYk-1 )2

Tk-l



iN

sup
|t-s|iN

(tY )2 - (sY )2

= Oa. s.(iN ) ,

ik

(Xk )2 - (TXk-1 )2 (TYk-1 )2Tk

Tk t

l=1

1- l i

2
Tk-l  iN sup (tY )2 -(sY )2 = Oa. s.(iN)
|t-s|N

hold almost surely (denoted a. s. ). With the Cauchy-Schwarz inequality and (A.7), we obtain

N iT

(TXk-1

Y
Tk-1

)2

Tk

ik

1- l i

2

Tk-l

-

T N

Tk t

l=1

 N sup iT s[0,t]

tX tY

i N -l 2
l=1 j=1

Tj

-

T N

Tj+l





N iT

C



N

N
T(j+i)N - Tj 2

j=1

j=1

Tj

-

T N

1/2
2
 = Oa. s. (1) .

Furthermore,

 1/2

N iT

(TXk-1

Y
Tk-1

)2

Tk

T Tk - N

ik

1- l i

2


N T C

N

(Tj )2

N

T2 Tj - N 

Tk t

l=1

j=1

j=1

holds, where the right-hand side converges to zero almost surely due to (A.7) and the Cauchy-Schwarz inequality. The preceding estimates imply the statement of the lemma.
We proceed proving (A.8b) that the quadratic covariations DN , L t and DN , M t converge to zero in probability for all t  [0, T ].

DN , L t =

N ik l

iT  [L]Tk

1- i

Tk t

l=1

MTk-l +  [L, M ]Tk

ik 1 - l i
l=1

LTk-l

has an expectation equal to zero for all t  [0, T ] and the second moment is bounded above by iN N2 . The order follows from the evaluation of the second moment that is carried out analogously as for the calculation of DN t before. For this reason DN , L converges to zero in probability on [0, T ]. It can be directly deduced that DN , M t = Op(1) as well. If L is a bounded (Ft)-martingale with L, L  0, the quadratic covariation

DN , L t =

N iT

 L, M Tk

Tk t

ik l 1- i
l=1

LTk-l

26

converges to zero in probability on [0, T ] what can be concluded following the same principles and also that DN , M  t = Op(1) M   M, t  [0, T ]. An application of Jacod's Theorem from [18] completes the proof of Proposition A.6.

Proposition A.8. On the same assumptions as in Proposition A.4, the continuous martingale

MtN :=

 N MN
 MN i=1 Tkt

LTk +

t
sX dWsX
Tk

+
Tk t

MTk +

t
sY dWsY
Tk

ik l

1- i

MTk-l

l=1



ik l

1- i

LTk-l



l=1

for t  [0, T ] converges stably in law as N  , MN  , MN /N   0 for every  > 2/3 to a limiting time-changed Brownian motion

MNt st where W~  is independent of F and with

t

 vMs

dW~ s

,

0

vMs

=

26 TG
35

(s)(sX sY

)2(1

+

s2)

.

Proof of Proposition A.8: The discretization error of the generalized multiscale estimator calculated with the closest synchronous approximation under the equivalent martingale measure where the drift terms equal zero

MN io,pMt N N i
i=1 j=i

LTj - LTj-i

MTj - MTj-i - [X, Y ]T



=

MN

io,pMt N

1 i

N

i=1 j=i

LTj - LTj-i

 MTj - MTj-i - [X, Y ]T 

equals the weighted sum of MN   discretization errors of the type considered in Proposition A.3

because converge

MN i=1

io,pMt N

=

1.

Note,

to zero in probability as

that long

all as

approximation errors in N  , i/N   0 for

the preceding proof every  > 2/3.

of

Proposition

A.6

We begin with the proof of a multivariate stable central limit theorem for a finite-dimensional vector:

Lemma A.9. Consider the sequence of K-dimensional vectors DN = DiN1 , . . . , DiNK where the entries DikN , k = 1, . . . , K <  are the continuous martingales


DitNk = 
Tr t

LTr +

t
sX dWsX
Tr

ikN r 
l=1

1

-

l ikN

 MTr-l 

+
Tr t

MTr +

t
sY dWsY
Tr

iNk r 
l=1

1

-

l ikN

 LTr-l 

with a sequence of integers ikN , k = 1, . . . , K. On the Assumptions 1, 2 and 4 and if for every k  {1, . . . , K} there exists a constant qk with iNk /MN  qk, the following stable convergence holds true as N  , MN  , MN /N   0 for every  > 2/3:

N MN

DtN

st

t
wsdWs ,
0

(A.9)

27

with a K-dimensional Brownian motion W independent of F and a predictable process ws with

(wsws)mn

=

T 3

min (qm, qn)

3 - min (qm, qn) max (qm, qn)

(1 + 2s) sX sY 2 G (s)

with the convention that for qm = qn = 0 the ratio is one. For DNT we obtain the following multivariate stable central limit theorem

N MN

DNT

st

N

0, 2

,

with 2 = 2T

T 0

(1

+

t2)(tX

tY

)2G

(t)dt

and

1 mn = 6 min (qm, qn)

3 - min (qm, qn) max (qm, qn)

.

Proof. Define for k  {1, . . . , K} the continuous martingales

(A.10) (A.11)

MtiNk =

N MN

DitkN

.

By virtue of Proposition A.3, we already have that

MikN

t

-p

2 3 T qk

t
(1 + s2)(sX sY )2G (s) ds .
0

The limit of the quadratic covariations MimN , MiNk is derived using the same approximations as for the quadratic variation in the preceding proof:

MimN , MikN

 N

min (imN ,ikN ,r)

t

=

MN

  [L]Tr
Tr t



l=1

1

-

l imN

1

-

l ikN



MTr-l

2


min (iNm,iNk ,r)

+  [M ]Tr 
Tr t

l=1

1

-

l iNm

1

-

l iNk



LTr-l

2


min (iNm,ikN ,r)

+ 2 [L, M ]Tr 
Tr t

l=1

1

-

l imN

1

-

l iNk

 LTr-l MTr-l  + Op(1)

=

N

Tr t

2

G(N ) (Tr )

- G(N Tr

)

(Tr-1

)

(T2 r-1

+

1)(TXr-1

Y
Tr-1

)2

Tr

min (imN ,iNk ,r) ×
l=1

1

-

l imN



1

-

l iNk

 + Op(1)

-p 2T

t
(s2 + 1)(sX sY )2G (s)
0

1 6 min (qm, qk)

3 - min (qm, qk) max (qm, qk)

ds ,

since

m l=1

(1

-

(l/m))(1

-

(l/M

))

=

(1/2)m - (m2/6M ) - 1/8 + 1/(12M ) for m, M



Z.

The

multi-dimensional version of Jacod's stable central limit Theorem 2­1 from [18] enables us to prove the

result of stable weak convergence of the vector provided we can verify the conditions

DN , L t -p 0 , DN , M t -p 0, t  [0, T ] ,

where L denotes the vector with entries Lj = L, j = 1, . . . , K and M with Mj = M, j = 1, . . . , K,

respectively, and

DN , L t -p 0 , DN , M t -p 0, t  [0, T ]

28

where L and M are bounded (Ft)-adapted martingales orthogonal to L and M, respectively. That is because the reference continuous martingales for all entries of the vector DN are L and M . The componentwise proof of the conditions above is yet analogous as for the univariate case in the preceding proof. We conclude that the asymptotic distribution of the vector is described by a limiting time-changed Brownian motion on [0, T ], and the marginal distribution at time T by a mixed Gaussian limit, where the normal distribution is defined as well as for all componentwise marginals on an orthogonal extension of the original underlying probability space.

From the preceding multivariate limit theorem the Crame´r-Wold device allows to conclude the weak convergence of all one-dimensional linear combinations of the transformed discretization errors of a finite collection of one-scale subsampling estimators. For an asymptotically N (0, )-distributed random vector the sum of all components is asymptotically normally distributed with variance i,j(ij) by the Crame´rWold device and the normality of any linear sum of components of a multivariate normal distribution (see e. g. pp. 516-517 in [25]). The asymptotic variance in Proposition A.4 is deduced from the multivariate limit and

MN k

l

k,l

(k,l)

=

2
k=1

l=1

6MN

3- l k

kop,Mt N lo,pMt N

+ O(1)

=

13 35

+ O(1)

with the weights (A.1) inserted. For the completion of the proof of Propositions A.8 and hence A.4, it remains to extend the result for asymptotically infinitely many addends. This part of the proof can be adopted from [30] where a stable central limit theorem for a multiscale estimator for the integrated volatility in the univariate setting is proved.

A.2.3. Discretization error due to the lack of synchronicity Proposition A.10. On the Assumptions 1 and 2, it holds true that



ATN

=

1 N-1 i

Lgj

- LTj

j=i


j



 MTk  +
k=j-i+1

Mj - MTj


j



 LTk 
k=j-i+1


j


j



+ LTj+1 

MTk - Mk+1  + MTj+1 

LTk - Llk+1  = Op

k=j-i+1

k=j-i+1

 iN

.

for the error associated with interpolation errors ANT for a one-scale subsampling estimator.
Proof. ATN is the endpoint of a Fj,N = FTj(+N1) -measurable discrete martingale with conditional expectation zero, since the addends incorporate products of Brownian increments over disjoint time intervals. The conditional variance yields



1 i2

N -1
E 

Lgj

- LTj

j=i


j



 MTk  +
k=j-i+1

Mj - MTj


j



 LTk 
k=j-i+1


j


j

2



+ LTj+1 

MTk - Mk+1  + MTj+1 

LTk - Llk+1 

FTj(N

)

 

k=j-i+1

k=j-i+1

  2

 2

1 N-1

= i2

E

(Lgj - LTj )2



j

MTk  + E (Mj - MTj )2 

j

LTk 

j=i k=j-i+1

k=j-i+1


j

2 

2

j

+ E (LTj+1 )2 

MTk - Mk+1  + E (MTj+1 )2 

LTk - Llk+1 

k=j-i+1

k=j-i+1

29

+E

gj
(tX )2dt
Tj


j

k=j-i+1


j



MTk - Mk+1  

MTk 

k=j-i+1

+E

j
(tY )2dt
Tj


j

k=j-i+1


j



LTk - Llk+1  

LTk 

k=j-i+1

+E

gj
ttX tY dt
Tj


j

k=j-i+1


j



LTk - Llk+1  

MTk 

k=j-i+1

+E

j
ttX tY dt
Tj


j

k=j-i+1


j



MTk - Mk+1  

LTk 

k=j-i+1

= Op i-1N -1 .

The variance of the term is of order (iN )-1 which can be proved by taking the expectation of the above given conditional variance and an upper bound of the second moment. The asymptotic orders of the addends follow from taking the expectations using Ito^ isometry and analyzing the differences of the addends minus their expectations, that converge to zero at a faster rate. That part is similar to the proofs above and we forgo a more detailed computation here.

Denote ATN,i the error due to non-synchronicity and interpolations for a fixed subsampling frequency

i = 1, . . . , MN in the following. The error due to asynchronicity of the generalized multiscale estimator

(12) equals the weighted sum

MN i=1

io,pMt N

ATN,i.

It

has

expectation

zero

and

the

variance

is

of

order

MN

Var

io,pMt N ATN,i =

io,pMt N kop,Mt N Cov ATN,i , ATN,k

i=1 i,k

MN
=
i=1

io,pMt N

2
E

ANT ,i 2 +

io,pMt N kop,Mt N E ANT ,iATk,N = O

i=k

MN N

.

( )=O MN-2N -1

( )=O MN-1N -1

Thus, the error due to interpolations is of smaller asymptotic order than the discretization error of the closest synchronous approximation and asymptotically negligible.

A.3. Asymptotics of the cross term
For a one-scale subsampling estimator cross terms are asymptotically negligible and hence the stable central limit theorem in Theorem 4.1 is implied by Theorem A.3. For the proof of the stable central limit theorem in Theorem 3 for the multiscale approach, we cope with the asymptotics of the cross terms in this subsection.

Proposition A.11. On the Assumptions 1, 2, 3 and 5, the cross terms of the generalized multiscale estimator (12) with noise-optimal weights (A.1) weakly converge to a mixed normal limit as MN  , N  , MN N  0:

MN

MN

io,pMt N i

N

i=1 j=i

(Xgj

- Xlj-i+1 )(

Y j

-

Y j-i+1

)

+

(Yj

- Yj-i+1 )(

X gj

-

)X
lj-i+1

N (0, AVARcross) , (A.12)

with asymptotic variance

12 AVARcross = 5

TT
Y2 (1 + T IY (t))(tX )2 dt + X2 (1 + T IX (t))(tY )2 dt
00

.

(A.13)

The convergence holds conditionally given the paths of the efficient processes.

30

Proof. This proof affiliates to the discussion in Section 4, where degrees of regularity of non-synchronous sampling schemes have been defined in Definition 2 that are assumed to converge to continuously differentiable functions. On the Assumption 3 of independent observation noise of X and Y , the two different cross terms are uncorrelated and we prove a central limit theorem for the first one:

MN

MN

io,pMt N i

i=1

N

(Xgj

- Xlj-i+1 )(

Y j

-

j=i

)Y
j-i+1

N

0,

12 5

Y2

T
(1 + T IY (t))(tX )2 dt
0

.

The parallel result for the other term can be proved analogously.
For the purpose of a shorter notation we have left out superscripts of the observation times, and write
i, i = 1, . . . , MN for the weights although we are interested in the specific weights (A.1). Denote N = supi{1,...,N} Ti and j,+ = min k  T Y |k  Gj+1 , gj,+ = min tk  T X |tk  Hj+1 and C a generic constant as before. From

 

E


 

MN

MN

i i

N

(Xgj

- XTj )(

Y j

-

i=1 j=i

Y j-i+1

)

+

(XTj-i

- Xlj-i+1 )(

Y j

-

2

Y
)j-i+1

 

 MN



ik ik

2Y2



N

N -(ik)



E(Xgj - XTj )2 +

E(XTj - Xlj+1 )2

i,k{1,...,MN }

j=ik

j=0

 MN C4Y2

ik ik

=O

MN-1

,

i,k{1,...,MN }

for the errors due to interpolations and

 E

MN

MN

i i

i=1

Ni

Y k

(XTk

-

XTk-i )

-

Y k

(XTk+i

-

XTk )

k=N -i+1

k=1

2 



= MN

ik ik

Y2



N

ik

E(XTr - XTr-i )2 +

E(XTr+i - XTr )2

i,k{1,...,MN }

r=N -(ik)+1

r=1

= O (MN N )

for boundary terms, we conclude that

MN

MN

i i

N

(Xgj

- Xlj-i+1 )(

Y j

-

)Y
j-i+1

i=1 j=i



=

MN

MN

i i

N -i


Y j

(XTj

-

XTj-i )

-

(XY
j+1

Tj+i

-

XTj )

+

Op(1)

i=1 j=i

=

MN


N -2


Y j

MN (j)

i i

(XTj

- XTj-i ) -

MN (j)



Y j+1

(XTj+i - XTj ) + Op(1)

j=2

i=1

i=1

 = MN 

Y j

MN (j)

i i

i1,j

+

Y j

MN (j)

i i

i2,j

+

Y j

MN (j)

i i

i3,j

jY1

i=1

jY2

i=1

jY3

i=1

+
jY4

Y j

MN (j)

i i

i4,aj

-

i=1 jY4

Y j,+

MN (j)

i i

 i4,bj 

+

Op(1)

.

i=1

31

Here, we aggregate the observation times j, j, j = 2, . . . , N - 2 in disjoint sets conforming to the four cases discussed in Section 4. Denote thereto

Y1 = {j  {2, . . . , N2}|j = j-1 , j  gj} , Y2 = {j  {2, . . . , N2}|j > gj , j  gj,+} , Y3 = {j  {2, . . . , N2}|j > gj , j < gj,+ , j,+ > gj,+} , Y4 = {j  {2, . . . , N2}|j > gj , j < gj,+ , j,+  gj,+} ,

and MN (j) = min (j, N - j, MN ). The increments of X that are multiplied with each observation error differ according to the set Yk, 1  k  4 to which j belongs. We use the notation

i1,j = (XTj - XTj-i ) - (XTj+i - XTj ) , i2,j = (XTj - XTj-i ) + (XTj+1 - XTj-i+1 ) - (XTj+i+1 - XTj+1 ) , i3,j = (XTj - XTj-i ) - (XTj+i+1 - XTj+1 ) , i4,aj = (XTj - XTj-i ) , i4,bj = (XTj+i+1 - XTj+1 ) .

The resulting aggregated leading term above of the cross term is the endpoint of a discrete martingale

with respect to the filtration Fj,N := 

Y k

|k

< j+1 , X, Y

.

Since if j  Y4  j,+ < j+1, the

martingale property with respect to the filtration Fj,N is assured by Assumption 3.

An application of the non-stable version of the central limit theorem for martingale triangular arrays from

[14] will proof the asymptotic normality of the cross term conditionally on the paths of the efficient pro-

cesses. The conditional Lindeberg condition can be verified (using Chebyshev's inequality or directly

verifying the conditional Lyapunov condition) in the same way as before and we omit it here. The sum of

conditional variances yields


E
l{1,2,3,4a} jYl

MN

Y j

MN (j)

i i

il,j

i=1

2
Fj-1,N +

E

jY4

-

MN

Y j,+

MN (j)

i i

i4,bj

i=1


2
Fj-1,N 



=

MN Y2

 

MN (j) 

i i

2 i1,j 

+

MN (j) 

i i

2

i2,j 

 

+

Op(1)

j Y1 Y3 Y4

i=1

jY2 i=1



= MN Y2 

ik ik

jY1Y3Y4 i,k{1,...,MN (j)}



i1k,j 2+ 

ik ik

jY2 i,k{1,...,MN (j)}

 i2k,j 2+ Op(1)



= MN Y2 

ik ik

jY1Y3Y4 i,k{1,...,MN (j)}

(XTj

-

X )2
Tj-(ik)

+

(XTj+(ik)

- XTj )2

+ ik ik
jY2 i,k{1,...,MN (j)}



4(XTj

- X )2
Tj-(ik)

+

(XTj+(ik)

-

XTj )2

 + Op(1)

N -2
= MN Y2

1ik (2 +
ik

{jY2})(XTj

-

X )2
Tj-(ik)

+

Op(1)

j=2 i,k{1,...,MN (j)}





= MN Y2 

ik ik

2(i



sub,ik
k)[X ]T

+

N

1{jY2}(XTj - XTj-(ik) )2 + Op(1)

i,k{1,...,MN (j)}

j=ik

-p

12 5

Y2

T
[X]T + T IY (t)(tX )2 dt
0

.

Since for the shifted increments (XTj+i+1 - XTj+1 ) = (XTj+i - XTj ) + Op N -1/2

32

holds, where the order is for time instants of average length N -1, the variances of the sums over all j  Y1 and j  Y3 are asymptotically equal. The variance of both uncorrelated sums over maxima j and minima j,+ distributed according to the fourth case is also asymptotically equal to the variances of those two addends. Only the asymptotic variance of the sum over all j  Y2 is bigger. For this reason the total asymptotic variance hinges on the asymptotic degree of regularity of the non-synchronous sampling scheme (T X , T Y ) defined in Definition 2.
In the calculation of the asymptotic variance we have used that

i1,j i1,k =

 j-(ik) i1k,j 2 + i1k,j 

XTl +

j+(ik)

 XTl  ,

l=j-(ik)+1

l=j+(ik)+1

where the second remainder addend has an expectation equal to zero, and analogous formulae for i2,j, for all 1  i  MN , 1  k  MN , k  i  j  N - (i  k).
Furthermore, an application of the mean value theorem, Ito^ isometry and approximations in the same spirit
as in the calculation of the asymptotic variance in the proof of the central limit theorem for the discretization
errors of the estimators, lead to the Riemann sum in the calculation of the asymptotic variance above. The cross terms in (il,j)2, l = 1, 2 are asymptotically negligible. Since in Y4 repeating maxima i = i+1 are considered only once, it holds true that |Y1| + |Y3| + |Y4| + 2|Y2| = N - 3 ± 1 (the last addend can appear
due to boundary term effects). In the last step we have used that

MN

io,pMt N kop,Mt N (i  k) = 6/5 + O(1) ik

i,k{1,...,MN }

when inserting the weights (A.1).

From the analysis for the asymptotic discretization error of a one-scale subsampling estimator, we know

that

sub,ik

1

[X ]T

= ik

N

(XTj

-

X )2
Tj-(ik)

=

[X ]T

+

Op

j=ik

(i  k) N

holds true. Similarly, it can be deduced that

1 i

N

1{jY2}(XTj

- XTj-i )2

=

1 i

N

(XTl )2

j=i l=1

i
1{(k+l-1)Y2}
k=1

T
= T IY (t)(tX )2 dt + Op
0

i/N

+ Op ,

on Assumption 5.

i/N

B. Proof of Proposition 5.1

Let RjN , Rjn, Rjm, SjN,X and SjN,Y denote the number of times Tk(N), 0  k  N , t(in) and j(m) in the bins [GNj , GNj+1), [(IY )Nj , (IY )Nj+1), [(IX )jN , (IX )jN+1), 0  j  KN - 1,. Define the generalized
multiscale estimator in the fashion of (12)

 [X, Y ]GNj+1

MN (j)
=

io,pMt N (j) i

RjN

i=1 r=i

X~gr - X~lr-i+1

Y~r - Y~r-i+1

for the increase of the quadratic covariation  [X, Y ]GNj+1 and the univariate multiscale estimators

 [X ]GNj+1

=

Mn (j )

io,pMt n(j) i

Rjn

i=1 r=i

X~tr - X~tr-i

2
,

 [Y ]GNj+1

= Mm(j) io,pMt m(j) i

Rjm

i=1 r=i

2
Y~r - Y~r-i ,

33

 and  [X](IY )jN+1 ,  [Y ](IX)jN+1 analogously, where all binwise multiscale frequencies are of order N KN with possibly differing constants. Essential when considering the multiscale estimators on bins is that on Assumption 4 the distances between sampling times are of order N -1  n-1  m-1, whereas the numbers of observations Rj· , Sj· , 1  j  KN in the specific bin are at most of order N KN-1. Following the analysis for the four uncorrelated parts of the estimation error in sections Appendix A, orders of the
discretization variances yield

io,pMt N (j)kop,Mt N (j)

i,k{1,...,MN (j)}

ik

·

i

·

RjN

i2 N2



MN

(j)

RjN N2



MN (j) KN N

,

Mn(j)/(nKN ),

Mm(j)/(mKN ),

Mn

(j

)

SjN,X N2

and

Mn

(j

)

SjN,Y N2

,

respectively.

Cross terms are of order

RjN /(N MN (j))  (MN (j)KN )-1 and analogous orders for the univariate estimators. The errors due to

noise instead depend only on the number of observations in the considered interval. Therefore, the addends

are of orders RjN /MN3 (j)  N/ KN MN3 (j) and MN-1(j) and analogous for the univariate estimators.

Choosing all multiscale frequencies M·(j)  N 1/2KN1/2 for every j, so that MN (·)N 1/2  , the error due

to end-effects in the noise part and the discretization error dominate asymptotically the two other addends

and are of order N -1/4KN-1/4. This holds as long as KN N -1/3  0, such that MN (j)(N/KN )-1  0 as

N  .

The estimators (22a)-(22d) are consistent as KN   with KN N -1/3  0 as N  , since



I^2

=

KN j=1

 

[X]GNj  GNj

[Y
2

]GjN

GN (T ) 
KN


KN
= 
j=1

GNj GNj-1

tX 2 dt

GjN GNj-1

tY 2 dt + Op GjN

N -1/4KN-1/4

2
GN (T )   KN

KN

=

X

2 GjN

j=1

Y

2 GjN

GN (T ) KN

+ Op

KN1/4N -1/4

KN
= XY
j=1

2 GjN-1

GN (T ) KN

+ Op

KN1/4N -1/4

and similar conclusions for the other three estimators. We have used that GjN  N -1 and apply the mean value theorem. GNj is some value GjN-1  GNj  GjN . Finally, elementary inequalities

,X

2 GNj

Y

2 GNj

-

X Y

2 GjN-1



X

2 GjN

Y

2 GjN

-

Y

2 GjN-1

+

Y

2 GNj-1

X

2 GNj

-

X

2 GNj-1

KN j=1

X Y

2 GjN

-

X Y

2 GNj-1

GN (T ) KN



sup|t-s| supj Gjn

ttX tY - ssX sY

GN (T ) = Oa. s. (1)

are involved in the approximations of the type above. Considering (22c) and (22d), note that bin-widths

chosen accordingly to IYN are asymptotically of order KN-1 in any interval of [0, T ] on that the corresponding part of the integral IY (t)(tX )2 dt is strictly positive. Denote RNk , k = 1, . . . , 4, the orders of the approximation errors of the four above given integrals and their

Riemann sums evaluated on the partition given KN bins. The variance of the estimators X2 and Y2 for the

noise variances are known to be E

X t1

4

N -1 and E

Y 1

4

N -1 and hence O

N -1

on Assumption

3 from [31]. From

I^k = Ik + Op RNk + KN1/2N -1/2 , k = 1, . . . , 4 ,

we derive that

AVARmulti = AVARmulti +Op

max
k

RNk

+

KN1/2N -1/2

and the same result for the one-scale estimator.

,

34

References
[1] Y. A¨it-Sahalia, J. Fan, D. Xiu, High-frequency estimates with noisy and asynchronous financial data, Journal of the American Statistical Association 105 (2010) 1504­1516.
[2] Y. A¨it-Sahalia, L. Zhang, P.A. Mykland, Ultra high frequency volatility estimation with dependent microstructure noise, Journal of Econometrics, 160 (2011) 160­165.
[3] B. Awartani, V. Corradi, W. Distasor, Assessing market microstructure effects via realized volatility measures with an application to the dow jones industrial average stocks, Journal of Business and Economic Statistics 27 (2009) 251­265.
[4] O.E. Barndorff-Nielsen, P.R. Hansen, A. Lunde, N. Shephard, Designing realised kernels to measure the ex-post variation of equity prices in the presence of noise, Econometrica 76 (2008) 1481­1536.
[5] O.E. Barndorff-Nielsen, P.R. Hansen, A. Lunde, N. Shephard, Multivariate realised kernels: consistent positive semi-definite estimators of the covariation of equity prices with noise and nonsynchronous trading, SSRN working paper 1154144, University of Aarhus (2008).
[6] O.E. Barndorff-Nielsen, N. Shephard, Econometric analysis of realized volatility and its use in estimating stochastic volatility models, Journal of the Royal Statistical Society 64 (2002) 253­280.
[7] M. Bibinger, Asymptotics of asynchronicity, Technical Report, Humboldt-Universita¨t zu Berlin (2011) URL=http://sfb649.wiwi.hu-berlin.de/papers/pdf/SFB649DP2011-033. pdf.
[8] M. Bibinger, Efficient covariance estimation for asynchronous noisy high-frequency data, Scandinavian Journal of Statistics 38 (2011) 23­45.
[9] K. Christensen, S. Kinnebrock, M. Podolskij, Pre-averaging estimators of the ex-post covariance matrix in noisy diffusion models with non-synchronous data, Journal of Econometrics, 159 (2010) 116­133.
[10] T.W. Epps, Comovements in stock prices in the very short run, Journal of the American Statistical Association 74 (1979) 291­298.
[11] J. Fan, Y. Wang, Multi-scale jump and volatility analysis for high-frequency data, Journal of the American Statistical Association 102 (2007) 1349­1362.
[12] M. Fukasawa, Realized volatility with stochastic sampling, Stochastic Processeses and their Applications 120 (2010) 209­233.
[13] A. Gloter, J. Jacod, Diffusions with measurement errors 1 and 2, ESAIM Probability and Statistics 5 (2001) 225­242.
[14] P. Hall, C. Heyde, Martingale Limit Theory and its Application, Academic Press, Boston, 1980.
[15] T. Hayashi, N. Yoshida, On covariance estimation of non-synchronously observed diffusion processes, Bernoulli 11 (2005) 359­379.
[16] T. Hayashi, N. Yoshida, Asymptotic normality of a covariance estimator for nonsynchronously observed diffusion processes, Annals of the Institute of Statistical Mathematics 60 (2008) 367­406.
[17] T. Hayashi, N. Yoshida, Nonsynchronous covariation process and limit theorems, Stochastic Processes and their Applications In Press, Uncorrected Proof (2011).
[18] J. Jacod, On continuous conditional gaussian martingales and stable convergence in law, Se´minaire de Probabilitie´s (1997) 232­246.
35

[19] J. Jacod, Y. Li, P.A. Mykland, M. Podolskij, M. Vetter, Microstructure noise in the continous case: the pre-averaging approach, Stochastic Processes and their Applications 119 (2009) 2249­2276.
[20] I. Kalnina, O. Linton, Estimating quadratic variation consistently in the presence of endogenous and diurnal measurement error, Journal of Econometrics 147 (2008) 47­59.
[21] P. Mykland, L. Zhang, Inference for continuous semimartingales observed at high frequency, Econometrica 77 (2009) 1403­1445.
[22] A. Palandri, Consistent Realized Covariance for Asynchronous Observations Contaminated by Market Microstructure Noise, Technical Report, University of Copenhagen, 2006.
[23] M. Podolskij, M. Vetter, Estimation of volatility functionals in the simultaneous presence of microstructure noise and jumps, Bernoulli 15 (2009) 634­658.
[24] M. Podolskij, M. Vetter, Understanding limit theorems for semimartingales: a short survey, Statistica Nederlandica 64 (2010) 329­351.
[25] C.R. Rao, Linear Statistical Inference and its Applications, Wiley, New York, 2 edition, 2001. [26] M. Reiß, Asymptotic equivalence for inference on the volatility from noisy observations, Annals of
Statistics, Forthcoming (2011). [27] A. Re´nyi, On stable sequences of events, Sankhya: The Indian Journal of Statistics, Series A 25
(1963) 293­302. [28] S. Utev, Central limit theorem for dependent random variables, In Grigelionis et al., Probability theory
and mathematical statistics 2 (1990) 519­528. [29] D. Xiu, Quasi-maximum likelihood estimation of volatility with high frequency data, Journal of
Econometrics 159 (2010) 235­250. [30] L. Zhang, Efficient estimation of stochastic volatility using noisy observations: A multi-scale ap-
proach, Bernoulli 12 (2006) 1019­1043. [31] L. Zhang, P.A. Mykland, Y. A¨it-Sahalia, A tale of two time scales: Determining integrated volatility
with noisy high-frequency data, Journal of the American Statistical Association 100 (2005) 1394­ 1411.
36

SFB 649 Discussion Paper Series 2011
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Localising temperature risk" by Wolfgang Karl Härdle, Brenda López Cabrera, Ostap Okhrin and Weining Wang, January 2011.
002 "A Confidence Corridor for Sparse Longitudinal Data Curves" by Shuzhuan Zheng, Lijian Yang and Wolfgang Karl Härdle, January 2011.
003 "Mean Volatility Regressions" by Lu Lin, Feng Li, Lixing Zhu and Wolfgang Karl Härdle, January 2011.
004 "A Confidence Corridor for Expectile Functions" by Esra Akdeniz Duran, Mengmeng Guo and Wolfgang Karl Härdle, January 2011.
005 "Local Quantile Regression" by Wolfgang Karl Härdle, Vladimir Spokoiny and Weining Wang, January 2011.
006 "Sticky Information and Determinacy" by Alexander Meyer-Gohde, January 2011.
007 "Mean-Variance Cointegration and the Expectations Hypothesis" by Till Strohsal and Enzo Weber, February 2011.
008 "Monetary Policy, Trend Inflation and Inflation Persistence" by Fang Yao, February 2011.
009 "Exclusion in the All-Pay Auction: An Experimental Investigation" by Dietmar Fehr and Julia Schmid, February 2011.
010 "Unwillingness to Pay for Privacy: A Field Experiment" by Alastair R. Beresford, Dorothea Kübler and Sören Preibusch, February 2011.
011 "Human Capital Formation on Skill-Specific Labor Markets" by Runli Xie, February 2011.
012 "A strategic mediator who is biased into the same direction as the expert can improve information transmission" by Lydia Mechtenberg and Johannes Münster, March 2011.
013 "Spatial Risk Premium on Weather Derivatives and Hedging Weather Exposure in Electricity" by Wolfgang Karl Härdle and Maria Osipenko, March 2011.
014 "Difference based Ridge and Liu type Estimators in Semiparametric Regression Models" by Esra Akdeniz Duran, Wolfgang Karl Härdle and Maria Osipenko, March 2011.
015 "Short-Term Herding of Institutional Traders: New Evidence from the German Stock Market" by Stephanie Kremer and Dieter Nautz, March 2011.
016 "Oracally Efficient Two-Step Estimation of Generalized Additive Model" by Rong Liu, Lijian Yang and Wolfgang Karl Härdle, March 2011.
017 "The Law of Attraction: Bilateral Search and Horizontal Heterogeneity" by Dirk Hofmann and Salmai Qari, March 2011.
018 "Can crop yield risk be globally diversified?" by Xiaoliang Liu, Wei Xu and Martin Odening, March 2011.
019 "What Drives the Relationship Between Inflation and Price Dispersion? Market Power vs. Price Rigidity" by Sascha Becker, March 2011.
020 "How Computational Statistics Became the Backbone of Modern Data Science" by James E. Gentle, Wolfgang Härdle and Yuichi Mori, May 2011.
021 "Customer Reactions in Out-of-Stock Situations ­ Do promotion-induced phantom positions alleviate the similarity substitution hypothesis?" by Jana Luisa Diels and Nicole Wiebach, May 2011.
SFB 649, Ziegelstraße 13a, D-10117 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2011
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
022 "Extreme value models in a conditional duration intensity framework" by Rodrigo Herrera and Bernhard Schipp, May 2011.
023 "Forecasting Corporate Distress in the Asian and Pacific Region" by Russ Moro, Wolfgang Härdle, Saeideh Aliakbari and Linda Hoffmann, May 2011.
024 "Identifying the Effect of Temporal Work Flexibility on Parental Time with Children" by Juliane Scheffel, May 2011.
025 "How do Unusual Working Schedules Affect Social Life?" by Juliane Scheffel, May 2011.
026 "Compensation of Unusual Working Schedules" by Juliane Scheffel, May 2011.
027 "Estimation of the characteristics of a Lévy process observed at arbitrary frequency" by Johanna Kappus and Markus Reiß, May 2011.
028 "Asymptotic equivalence and sufficiency for volatility estimation under microstructure noise" by Markus Reiß, May 2011.
029 "Pointwise adaptive estimation for quantile regression" by Markus Reiß, Yves Rozenholc and Charles A. Cuenod, May 2011.
030 "Developing web-based tools for the teaching of statistics: Our Wikis and the German Wikipedia" by Sigbert Klinke, May 2011.
031 "What Explains the German Labor Market Miracle in the Great Recession?" by Michael C. Burda and Jennifer Hunt, June 2011.
032 "The information content of central bank interest rate projections: Evidence from New Zealand" by Gunda-Alexandra Detmers and Dieter Nautz, June 2011.
033 "Asymptotics of Asynchronicity" by Markus Bibinger, June 2011. 034 "An estimator for the quadratic covariation of asynchronously observed
Itô processes with noise: Asymptotic distribution theory" by Markus Bibinger, June 2011.
SFB 649, Ziegelstraße 13a, D-10117 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

