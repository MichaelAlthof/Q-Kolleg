BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2015-008
Nonparametric change-point analysis of volatility
Markus Bibinger* Moritz Jirak*
Mathias Vetter**
*Humboldt-Universit‰t zu Berlin, Germany ** Philipps-Universit‰t Marburg, Germany This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

Nonparametric change-point analysis of volatility
Markus Bibinger1,,, Moritz Jirak2,,, Mathias Vetter3,
1 Institut fu®r Mathematik, Humboldt-Universita®t zu Berlin, Unter den Linden 6, 10099 Berlin, Germany, bibinger@math.hu-berlin.de
2 Institut fu®r Mathematik, Humboldt-Universita®t zu Berlin, Unter den Linden 6, 10099 Berlin, Germany, jirak@math.hu-berlin.de
3Fachbereich Mathematik und Informatik, Philipps-Universita®t Marburg, Hans-Meerwein-Straﬂe 6, 35032 Marburg, Germany, vetterm@mathematik.uni-marburg.de
Abstract: This work develops change-point methods for statistics of high-frequency data. The main interest is the volatility of an Ito^ semi-martingale, which is discretely observed over a fixed time horizon. We construct a minimax-optimal test to discriminate different smoothness classes of the underlying stochastic volatility process. In a high-frequency framework we prove weak convergence of the test statistic under the hypothesis to an extreme value distribution. As a key example, under extremely mild smoothness assumptions on the stochastic volatility we thereby derive a consistent test for volatility jumps. A simulation study demonstrates the practical value in finite-sample applications.
AMS 2000 subject classifications: Primary 62M10; secondary 62G10. JEL classification: Primary C12; secondary C14. Keywords and phrases: high-frequency data, nonparametric change-point test, minimax-optimal test, stochastic volatility, volatility jumps.

1. Introduction

Change-point theory classically focuses on detecting one or several structural breaks in the trend of

time series. Statistical methods to infer change-points have a long and rich history, dating back to the

pioneering work of Page (1955). Prominent approaches as e.g. by Hinkley (1971), Pettitt (1980), An-

drews (1993) or Bai and Perron (1998), among many others, provide statistical tests for the hypothesis

of no change-point against the alternative that changes occur. Moreover, they allow for localization of

change-points (estimation) and confidence intervals. Change-point methods usually rely on maximum

statistics and exploit limit theorems from extreme value theory; see Cso®rgo and Horva¥th (1997) for

an overview. Less focus has been laid on discriminating jumps from continuous motion in a nonpara-

metric framework. Important exceptions are Mu®ller (1992), Mu®ller and Stadtmu®ller (1999), Spokoiny

(1998) and Wu and Zhao (2007) in the framework of nonparametric regression analysis. The latter

serves as an important point of orientation for this work.

Statistics of high-frequency data is concerned with discretizations of continuous-time stochastic

processes, most generally Ito^ semi-martingales. The continuous part of an Ito^ semi-martingale is of

the form

tt
Xt = X0 + as ds + s dWs ,
00

(1)

defined on a filtered probability space (, F , (Ft), P) with a standard (Ft)-Brownian motion W and adapted drift and volatility processes a and . One key topic is statistical inference on the volatility

Financial support from the Deutsche Forschungsgemeinschaft via SFB 649 O® konomisches Risiko and FOR 1735 Structural Inference in Statistics: Adaptation and Efficiency is gratefully acknowledged.
We thank Marc Hoffmann for helpful remarks on testing hypotheses of smoothness classes.
1

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

2

FIGURE 1. Log-price intra-day evolutions (top) and estimated spot squared volatilities (bottom) for MMM (left) and GE (right) on March 18th, 2009.
under high-frequency asymptotics when the mesh of a discretization on a fixed time horizon tends to zero. There is a vast body of works related to this problem and its economic implications; see e.g. Andersen and Bollerslev (1998), Mykland and Zhang (2009) and Jacod and Rosenbaum (2013), among many others. Statistics for a discretized continuous-time martingale is closely related to Gaussian calculus as highlighted by Mykland (2012) what is also at the heart of our analysis. Many contributions evolve around the question if jumps are present in the Ito^ semi-martingale modeling the log-price of a financial asset; see A®it-Sahalia and Jacod (2009) for a statistical test.
A more involved problem which is of key interest for economics and finance is to infer the smoothness of the underlying stochastic volatility process and to check whether volatility jumps occur. In particular, inference on volatility jumps allows to investigate the impact of certain news arrivals on financial risk. A first empirical study by Tauchen and Todorov (2011) indicates that volatility jumps can occur but, due to the lack of statistical methods, has been based on direct observations of the VIX, the most prominent available volatility index. Further contributions consider joint price-volatility jumps. Jacod and Todorov (2010) have designed a test to decide from high-frequency observations if contemporaneous jumps of an Ito^ semi-martingale and its volatility process have taken place at least once over some fixed time interval. These methods do not generalize to test directly for volatility jumps without restricting to a finite set of large price adjustments first. One main profit from our change-point analysis of high-frequency data is a general test for volatility jumps. Moreover, results on estimation of the time of a volatility jump are provided.
As an example, we illustrate in Figure 1 the evolution of log-prices of two blue-chip stocks, 3M and GE, over the NASDAQ intra-day trading period (6.5 h rescaled to the unit interval) on March 18th, 2009. We consider one minute returns from executed trades1 to ensure the semi-martingale model is adequate and limit a manipulation by market microstructure frictions. Available tests and criteria
1reconstructed from the order book using LOBSTER, https://lobster.wiwi.hu-berlin.de/

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

3

do not identify price adjustments so large to be ascribed to jumps such that the test by Jacod and Todorov (2010) is not applicable. It seems as if a common source of news drives price dynamics at the end of that day concertedly. The picture becomes much clearer when focusing on the estimated spot squared volatilities in Figure 1, for which we average at each time point the previous 20 rescaled squared returns. This example suggests that volatility dynamics vary over time. Here, the volatilities of both assets sky-rocket at exactly the same time. This common volatility jump exactly coincides in time with a press release at 02:15 p.m. EST subsequent to a meeting of the Federal Open Market Committee. The time is marked in Figure 1 by the dashed lines. In light of increasing economic slack, the FOMC announced "to employ all available tools to promote economic recovery and to preserve price stability"2, including a guarantee for an exceptionally low level of the federal funds rate for an extended period and a considerable increase of the size of the Federal Reserve's balance sheet. The mathematical concepts developed in this work provide a novel device for assessing volatility dynamics and jumps.
Quasi-likelihood estimation of a change-point in a diffusion parameter in a high-frequency setting has been considered by Iacus and Yoshida (2012), pointing out already one very useful bridge between change-point theory and high-frequency statistics. Our main focus is on testing for the presence of changes in a general setup exploiting localization techniques. Beyond the analysis of possible jumps of volatility there is great interest in the smoothness regularity of volatilities; see e.g. Gatheral et al. (2014) for a recent work, not least because of its crucial role for setting up volatility models.
We focus on volatilities which are almost surely locally bounded and strictly positive adapted processes. For our testing problem we consider classes of squared volatilities

(a, L) = (t2())t[0,1] sup t2() - s2()  L()a ,
s,t[0,1],|s-t|<

(2)

for an almost surely bounded random variable L; cf. Assumption 3.1 for a precise statement about the conditions under the null hypothesis. The regularity exponent a > 0 is the key parameter to describe the null hypothesis H0. We may now more formally ask the following questions:
(i) Is there a jump in the volatility, i.e. 2 = 2 - lims s2 > 0 for some   (0, 1)? (ii) Does volatility get rougher in the sense of a regularity exponent a < a on (, 1]? (iii) Can we discriminate different regularity exponents by a statistical test?
From a statistical perspective, the key question is which sizes of volatility jumps or which changes in the regularity exponent can be detected. For example, it is clear that we cannot detect jumps of arbitrarily small size. Loosely speaking, if we say that `no jump' is our null hypothesis H0, and `there is a jump' our alternative H1, then we face the problem of distinguishability between H0 and H1. The minimum size bn of a jump 2, such that we are still able to uniformly control the type I and type II errors, is called detection boundary. If we are interested to test for the presence of jumps, we are thus led to consider for   (0, 1) alternatives of the form

SJ (a, bn, L) = (vt)t[0,1] (vt - vt)t[0,1]  (a, L) ; |v|  bn

(3)

with a decreasing sequence bn. We then address the testing problem H0 : (t2())t[0,1]  (a, L) vs. H1 :    (0, 1) with (t2())t[0,1]  SJ (a, bn, L) .
2source: www.federalreserve.gov/monetarypolicy/fomcminutes20090318.htm

(4)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

4

In this context  is commonly referred to as a change-point. The test alternative means that we demand at least one jump but do not exclude multiple jumps. The dependence on  in (4) is natural in the definition of the hypotheses, as different realizations might lead to different paths on [0, 1].
For the testing problem (4), we establish the minimax-optimal rate of convergence under highfrequency asymptotics. We follow the notion of minimax-optimality of statistical tests from the seminal contributions of Ingster (1993). For tests  that map a sample Xn to zero or one, where  accepts the null-hypothesis H0 if  = 0 and rejects if  = 1, we consider the maximal type I error  a = sup2(a,L) P  = 1 and the maximal type II error  a, bn = sup2SJ (a,bn,L) P  = 0 and define the global testing error as

 a, bn =  a +  a, bn .

(5)

The primary interest now lies on tests that minimize  a, bn , given the boundary bn. We aim to find sequences of tests n and boundaries bn with the property that

n a, bn  0 as n  .

The smaller bn > 0, the harder it is for a test to control the global testing error, i.e. to distinguish between H0 and H1. It is thus natural to pose the question given a, what is the minimal size of bn > 0 such that

lim
n

inf




a, bn

=0

(6)

holds? The optimal bonpt is called minimax distinguishable boundary, and a test n that satisfies (6) for all bn  bonpt minimax-optimal.
-a
If L in (2) is deterministic, we prove that bn  (n/ log(n)) 2a+1 constitutes the minimax distinguishable boundary for testing (4) and our constructed test is eligible to attain minimax-optimality. If L() is only almost surely bounded, the rate sightly changes; see Section 4 for precise results. The particular form of this (lower) bound also appears in Spokoiny (1998), where the focus lies on nonparametric estimation of regression functions in the presence of jumps and where the jump size does not depend on n, see also Loader (1996). Yet, this estimation setup is very different from our situation.
For the lower bound proof we simplify the problem by information-theoretic reductions passing to more informative sub-classes of the parameter space. The lower bound established for the sub-class then serves a fortiori as a lower bound in the more general and less informative model. After gradually transforming the problem by showing strong Le Cam equivalences of the considered sub-experiment to more common situations with i.i.d. chi-square and Gaussian variables, the lower bound is proved by classical arguments based on the theory in Ingster and Suslina (2003).
Here we have outlined the theory with the focus on (4) and question (i). Moreover, we shall consider minimax-optimal tests to address questions (ii) and (iii). In the process, we may keep to a change-point setup with possible changes of the regularity exponent. However, the developed methods allow as well for tests of certain (global) smoothness regularities of the squared volatility.
The paper is organized as follows: Section 2 serves as an illustration for the benefit of cusum-based statistics in the simple, yet important model of a continuous Ito^ semimartingale with constant volatility. This illuminates the connection of classical change-point methods and high-frequency statistics. More involved, but also more important in practice is the case where the volatility is both time-varying and random. Section 3 is devoted to this nonparametric problem. As the volatility process is latent, which requires estimation based on smoothed squared increments of the semi-martingale, this poses an intricate statistical problem which to the best of the authors' knowledge had not been addressed

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

5

so far. We establish a consistent test and derive a limit theorem under the hypothesis. The asymptotic analysis utilizes nonparametric change-point theory, stochastic calculus and bounds on the approximation error in the invariance principle. Our test allows to distinguish paths with jumps from continuous paths under remarkably general smoothness assumptions on the hypothesis. In Section 3.2 we discuss the situation in which the underlying Ito^ semimartingale might have jumps as well. Section 4 provides the theory on minimax-optimality with the lower bound, while Section 5 deals with the estimation of the location of the change in volatility under the alternative. A simulation study that investigates the finite-sample performance of the proposed methods and discusses some practical issues can be found in Section 6. All proofs are postponed to the Appendix.

2. Change-points in a parametric volatility model

Arguably, the simplest model of a continuous-time Ito^ diffusion X is the case of no drift and a constant volatility, such that X is given by

t
Xt = X0 +  dWs ,
0

(7)

where W denotes a standard Brownian motion. Throughout this work, the underlying process X is
recorded at discrete regular times in with a mesh n  0. To keep the notation uncluttered, we assume to be on the fixed time interval [0, 1] and set n = n-1  N, so that we have observations Xin, i = 0, . . . , n.
Inference on the squared volatility 2 is usually based on increments ni X = Xin - X(i-1)n. In case one is interested in changes in the volatility, a natural quantity to discuss is the cusum statistic
which reads

Sn,m

=

1 n

m

n
n ni X 2 -

jnX 2 , m  {1, . . . , n} .

i=1 j=1

(8)

In order to derive the asymptotics of the cusum statistic, recall the functional (stable) central limit theorem for the realized volatility from observations of a continuous Ito^ semi-martingale (1) by Jacod (1997). Under mild assumptions, we have

 n

nt
ni X 2 -

t
s2 ds 

t 2s2 dBs , t  [0, 1] ,

i=1 0 0

(9)

as n   weakly in the Skorokhod space with a standard Brownian motion B independent of W . In particular, if s =  is constant, this result directly implies

Sn, nt   Bt - tB1 ,

(10)

with 2 = limn n Var

n i=1

ni X

2

= 24, which coincides with a standard cusum limit

theorem in the vein of Phillips (1987). The quarticity estimator by Barndorff-Nielsen and Shephard

(2002), ^2 = (2n/3)

n i=1

inX

4, may be used to obtain a self-normalizing version:

2n n 3

-1/2

ni X 4

Sn, nt  Bt - tB1 ,

i=1

(11)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

6

FIGURE 2. Left: One realized path of X with structural break in volatility at t = 1/2. Right: Empirical results for the test statistic from 10000 iterations under both alternative and hypothesis.

where the limit process is a standard Brownian bridge. Testing for jumps (resp. structural breaks, change-points) of the volatility is then pursued based on

Tn = sup ^2 -1/2 Sn,m ,
m=1,...,n

(12)

as the test statistic which (under the null that the volatility is constant) tends as n   to a Kolmogorov-Smirnov law; see Marsaglia et al. (2003). Under the alternative Tn diverges almost surely.
Figure 2 shows an example in which we observe n = 10000 values of a standard Brownian motion under the hypothesis, while under the alternative the volatility jumps in t = 1/2 from 1 to 1.1. Out of 10000 Monte Carlo iterations for hypothesis and alternative, only 21 realizations of (12) under the hypothesis are larger than the minimum under the alternative. The other way round, in 11 iterations the values under the alternative fall below the maximum of the generated values from the hypothesis. The cusum approach hence clearly allows to separate hypothesis and alternative here, even for the relatively small volatility jump which is not readily identifiable from the path of X in Figure 2.
This is illustrated within the histogram in Figure 2. The left part stems from realizations under the hypothesis which closely track the asymptotic Kolmogorov-Smirnov law. The right part instead is due to realizations under the alternative. For larger volatility jumps the right part moves further to the right such that the two distributions separate even more clearly. This test based on (12) of KolmogorovSmirnov type permits to test the hypothesis of a constant volatility against structural breaks in an efficient way.
Beyond this bridging of classical change-point analysis and structural breaks in a parametric volatility model, our main focus in the sequel is nonparametric: to distinguish volatility jumps from a continuous motion of volatility or to identify changes in the regularity exponent.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

7

3. Nonparametric change-point test for the volatility

3.1. Construction and limit behavior under the hypothesis

Suppose we observe a continuous Ito^ semi-martingale (1) at the regular times in, i = 0, . . . , n  N. In this setting, we want to construct a test for (4). We write shortly

|(t2())t[0,1]  (a, L) = c .

(13)

With the volatility process being time-varying, it becomes apparent from (9) that the test statistic (12) is not suitable to test H0 against H1. Our core idea is to utilize local two-sample t-tests over asymptotically small time blocks instead, thereby identifying breaks where segments are not smooth, in particular jumps, from too large deviations between two successive local estimators for the volatility.
As a first test statistic, we consider

Vn =

max

|Xn,i/Xn,i+1 - 1|,

i=0,..., n/kn -2

(14)

where kn   is an auxiliary sequence of integers depending on n and

Xn,i

=

n kn

kn
(nikn+j X)2
j=1

,i

=

0, . . . ,

n/kn

-1,

(15)

is a rescaled local version of realized volatility over blocks of the partition [iknn, (i + 1)knn]. The Xn,i estimate a block-wise constant proxy of the spot volatility iknn on the respective blocks. Asymptotic properties of Xn,i were e.g. derived in Alvarez et al. (2012). As mentioned above, a large distance between Xn,i and Xn,i+1 suggests the presence of a jump or unsmooth breaks in the volatility close to time iknn, which is why Vn appears to be a reasonable test statistic for our problem.
Our second test statistic is of the same nature as (14), but instead of non-overlapping blocks it takes
into account all overlapping blocks of kn increments:

Vn

=

max
i=kn,...,n-kn

n kn
n kn

i j=i-kn

+1

(jnX

)2

i+kn j=i+1

(jnX

)2

-1

.

(16)

In comparison to nonparametric change-point approaches like the one by Wu and Zhao (2007), both
statistics (14) and (16) are based on ratios rather than differences. This makes sense intuitively, since
we are not dealing with the typical additive error structure of time series models. In our setting, we have e.g. n(ni X)2  i2n2i , i = 1, . . . , n, with i.i.d. 12-distributed random variables i2, so that the volatility  plays the role of a multiplicative error. Therefore, by computing ratios first, we
basically deal with a maximum of identically distributed variables in the asymptotics. This is of key
importance to obtain a distribution free limit under the hypothesis. In order to discuss the asymptotics of Vn and Vn under the null-hypothesis we need a couple of
additional assumptions, all of which are rather mild and are covered by a variety of stochastic volatility
models.

Assumption 3.1. The following assumptions on the processes a and  are in order:

(1) a and  are locally bounded processes. (2)  is almost surely strictly positive, i.e. inft[0,1] t2  -2 > 0.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

8

(3) On c, the modulus of continuity

w()t = sup {|s - r| : |s - r| < }
s,rt

is locally bounded in the sense that there exists a > 0 and a sequence of stopping times Tn   such that w()(Tn1)  Lna, for some a > 0 and some (a.s. finite) random variables Ln.
We choose the sequence kn  , as n  , such that the following growth condition holds:

kn-1n- + kn(knn)a log(n)  0 ,

(17)

for some > 0 and with a > 0 from Assumption 3.1 (3). There are two conditions contained in (17). First, kn   faster than some power of n which is a
mild lower bound on the growth of kn as n  . The second condition gives an upper bound related to the continuity of , since a equals the Ho®lder index for an a-Ho®lder smooth volatility. Naturally, the smaller a (and the less smooth ), the smaller we have to choose the size of the blocks over which we estimate .

Theorem 3.2. Set mn = n/kn and mn = [4 log(mn) - 2 log(log(mn))]1/2. If Assumption 3.1 holds and kn satisfies condition (17), then we have on c (under H0)

log(mn)

 kn1/2/ 2 Vn - mn

-w V,

log(mn)

 kn1/2/ 2

Vn

- 2 log (mn) -

1 2

log

log

(mn)

-

log

(3)

-w V,

(18) (19)

where V follows an extreme value distribution with distribution function

P(V  x) = exp(--1/2 exp(-x)) .

(20)

Remark 3.3. It is remarkable that Theorem 3.2 in combination with condition (17) allows asymptot-
ically to distinguish between volatility paths with jumps and volatility paths without jumps, where we only require some granted smoothness a > 0 in Assumption 3.1 (3). Note that less smooth paths require smaller block lengths kn by (17) which reduces the rate in Theorem 3.2 and the power of the test. Most importantly, we can cope with standard models for . For a continuous semi-martingale volatility, we have a  1/2. In this case, we take kn  n1/2- for > 0 and small to preserve the highest possible power. Similarly, for a Lipschitz volatility, i.e. a = 1, one might choose kn  n2/3- .
As we show in Theorem 4.3 that Vn and Vn diverge under the alternative almost surely, Theorem 3.2 provides a consistent test with asymptotic power 1 by critical values from the limit law under the
hypothesis.

3.2. A test in presence of jumps in the observed process

In order to provide a valid approach for various economic applications an important aim is to account for possible jumps in the process X as well. Thereto, consider a general Ito^ semi-martingale

tt

t

Xt = X0 + as ds + s dWs +

((s, x))(µ - )(ds, dx)

00

0R

t

+ Ø((s, x))µ(ds, dx) ,

0R

(21)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

9

where a truncation function , Ø(x) = x - (x), separates large from compensated small jumps. The compensating intensity measure  of the Poisson random measure µ admits the form (ds, dx) = ds  (dx) for a -finite measure . Our notation follows Jacod (2008).
Assumption 3.4. Grant Assumption 3.1 for the continuous part of X. Suppose sup,x |(s, x)|/(x) is locally bounded for some deterministic non-negative function  which satisfies for some r < 2:

(1  r(x))(dx) <  .
R

(22)

In condition (22), r is a jump activity index that bounds the path-wise generalized BlumenthalGetoor index from above. Imposing r < 1 restricts to jumps of finite variation and r = 0 to finite jump activity. To develop test statistics which are robust against jumps we employ a truncation principle as introduced for integrated volatility estimation by Mancini (2009) and Jacod (2008). The analogue of (14) with truncated squared increments reads

Vn,un

=

max
i=0,..., n/kn

-2 |Xn,un,i/Xn,un,i+1

- 1|,

1Xn,un,i

=

n kn

kn
(inkn+j X)2
j=1

{|nikn+jX|un} , i = 0, . . . ,

n/kn

-1.

(23) (24)

The truncation sequence un  n- ,   (0, 1/2), is used to exclude large squared increments which can be ascribed to jumps. In the same way we can generalize statistic (16) with overlapping blocks:

Vn,un

=

max
i=kn,...,n-kn

n kn
n kn

i
1j

=i-kn+1(nj

X

)2

{|nj X|un}

1ji+=ki+n 1(jnX )2 {|nj X|un}

-1

.

(25)

We prove below that truncation is an appropriate concept to asymptotically eliminate the influence by jumps, at least under certain restrictions on the jump activity, on kn and on  . In particular, under the hypothesis we obtain the same limit behaviour of the test statistics as in Theorem 3.2.
Proposition 3.5. Suppose kn  n for 0 <  < 1, such that condition (17) is satisfied. Furthermore, grant Assumption 3.4 for some

r < min 2 2 -  -1(1 - /2) ,  -1 min(1/2, 1 - ) , 2 -  -1/2

(26)

as well. Then, with mn = n/kn and mn = [4 log(mn) - 2 log(log(mn))]1/2 as before, and if either r = 0 or the jump process is a time-inhomogeneous Le¥vy process, we have on c (under H0)

for the statistics (23) and (25) the weak convergence

log(mn)

 kn1/2/ 2 Vn,un - mn

-w V,

log(mn)

 kn1/2/ 2

Vn,un

- 2 log (mn) -

1 2

log

log

(mn)

-

log

(3)

-w

V,

(27) (28)

where V is distributed according to (20).

Remark 3.6. Arguably, it is most relevant from an applied perspective that the test based on (25) copes with finite activity jumps. In this case (26) reads as  > 1/2 - /4, and the only requirement is that the threshold is not chosen too small. Beyond the finite activity case we restrict to time-inhomogenous Le¥vy jumps with independent increments where condition (26) becomes r < 1 for the typical case

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

10

  1/2 and   1/2. When   1/2 the third term in (26) is obsolete and the two others are equally weighted in case that   1/2. Thus, for other choices of  one makes (26) more restrictive, e.g. r < 2/3 for   2/3 under a Lipschitz volatility. The restrictions on the jump activity are stronger than what is usually needed for truncated realized volatility, i.e. r < 1 for general Ito^ semimartingales; cf. Jacod (2008). This is due to the maximum in (25) compared to linear estimators.

4. Consistency and minimax-optimal rate of convergence

In this section it becomes important that stochastic squared volatility processes lie under H0 in
(a, Ln), defined in (2), where we take into account strictly positive monotone increasing sequences
Ln. This is crucial as we cannot describe the random processes as members of a fixed Ho®lder class. If t2 satisfies

E |t2 - s2|b  C t - s C+ba for some b, C > 1,

then the Kolmogorov-C entsov Theorem implies that limn P (t2)0t1  (a, Ln) = 1, provided Ln   arbitrarily slowly. Hence, up to a negligible set, (a, Ln) contains the paths generated by a huge number of popular volatility models when considering Ln  . On the other hand, if L is fixed, we are in the familiar framework of Ho®lder classes.
At this stage, we integrate alternatives where the volatility is less smooth than under the hypothesis,
but which require not necessarily jumps. Note that the statistical devices developed above may be
applied to discriminate H0 from two kind of alternatives without jumps:

(R1) Until some change-point   (0, 1), the process (t2) behaves as a process in (a, Ln). After , the regularity exponent drops to some 0 < a < a. Since  a, L   a , L , we require
functions that `exploit their roughness' in a certain sense; see below for a more detailed expla-
nation. This change in the regularity exponent at time  embeds into change-point theory. More
precisely, we test the null of no change in regularity a against a change at , where a drops to
a.
(R2) Under H0 the regularity exponent is a, and we would like to validate this hypothesis against the alternative hypothesis where the regularity is a < a. Processes in the alternative set may be
smoother on parts of the interval, but we require that they `exploit their roughness' somewhere on [0, 1], such that in particular (t2)t[0,1]   a, L .

Though different, both problems are intimately connected. In fact, we demonstrate in the sequel that the same statistic can be applied to reach the optimal minimax rate. We also use the notation R1/2 to address both alternatives. To describe the alternative sets, define

ha ft

=

ft+h - |h|a

ft ,

t  [0, 1], h  [-1, 1].

The terminology `exploiting roughness' is specified and captured in the following sets. We then express the set of possible alternatives for testing for a change in the regularity exponent:

SR1 a, a , bn, Ln, C =

vt

t[0,1]



(a, Ln)

inf
0hb1n/a

ah

v

>

C

or sup
0hb1n/a

ah

v

<

-C

,

for some C > 0. If we want to test for regularity a in t2 against a < a, the set in question is slightly different:

SR2 a, a , bn, Ln, C =

vt

t[0,1]



(a

, Ln)

inf
|h|b1n/a

ah

v

>C

or sup ha v < -C
|h|b1n/a

.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

11

In contrast to SR1, volatilities in SR2 need not to have regularity a up to a change-point. On the other hand, it is crucial that we pose a condition on a centered window around  here. We integrate both
alternatives in the testing problem

H0 : (t2())t[0,1]  (a, Ln) vs. H1R1/2 :    (0, 1) |(t2())t[0,1]  SR1/2 a, a , bn, Ln, C . (29)

Let us elaborate on the specific form of the alternative sets. In general, it is impossible to test (a, Ln) against (a , Ln) for a > a , and it is necessary to consider special subsets of (a , Ln). Intuitively, it is clear that one needs at least to remove (a, Ln) from (a , Ln), but this is not sufficient. In fact, one needs to focus on the functions which exploit their roughness in the sense of the conditions in SR1/2; cf. Hoffmann and Nickl (2011) for a detailed discussion in a related context. Geometrically, this means that the functions of interest are those which fluctuate considerably more, induced by
demanding a < a. However, as the sample size n grows, we only require this difference on sets that
become smaller and smaller, which is expressed above in terms of bn. Observe that for appropriate C > 0, for any   (0, 1) we have

SR1/2 a, a , bn, Ln, C  (a , Ln)



(vt)t[0,1]



(a

,

Ln)

inf
2(a,Ln)

sup
t[0,1]

|vt

-

t2|



bn

,

where the right hand set has been used as alternative in Hoffmann and Nickl (2011). For the testing problem at hand, which is more complicated, this slightly larger set appears to be a too large alternative. For the testing problems (4) and (29), we first present a negative result, that also serves as minimax lower bound for the problem depicted in (6).

Theorem 4.1. Assume that a > a > 0 and inft t2  -2 > 0. Consider either set of hypotheses H0, H1J or H0, H1R1 or H0, H1R2 . Then for

bn 

n/ log(mn)

-

a 2a+1

Ln-4

1
,2a+1

(30)

we have in all three cases limn inf  a, bn = 1.
Remark 4.2. Observe that for (29), the lower bound does not depend on the value of a , only the fact that a < a is relevant. This is an asymptotic result though, and in practice the size of the difference (a - a ) may have a significant impact.

Theorem 4.1 reveals that it is impossible to construct a minimax-optimal test in the sense of (6) if bn is bounded as in (30). Consequently, we deduce that

bnopt 

n/ log(mn)

-

a 2a+1

Ln-4

1
.2a+1

(31)

In Theorem 4.3 we shall establish a corresponding upper bound up to a multiplicative constant, and thus (31) already gives the optimal rate for the minimax distinguishable boundary. Observe that based on Vn from (16), we can obtain the following test  .
 (Xin )0in : reject H0 if Vn  2C 2 log(mn)/kn, i.e.  (Xin )0in = 1, (32)

where C > 2 and kn =

log(mn)na/Ln

2
,2a+1

mn = n/kn .

Alternatively, one might base a test on Vn from (14).

(33)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

12

To simplify the discussion, we restrict to positive volatility jumps, i.e. inft t  0, which appears natural from an economic point of view. We point out that an analogue result can be shown for negative, or positive and negative jumps, which however requires a further technical structural condition in case of multiple jumps in a vicinity for the alternative set.
Theorem 4.3. Consider (4) with inft t  0, or (29) with 0 < a < a  1 and Ln = O (n/kn)a-a . If

bn > 2C 2 log(mn)/kn + 2Ln (knn)a sup t2 ,
t[0,1]

(34)

where kn, mn and C are as in (33), then limn  a, bn = 0. This implies that

bnopt 

n/ log(n)

-

a 2a+1

Ln1/(2a+1)

.

Remark 4.4. If L defined in (2) is deterministic, we get the minimax distinguishable boundary bn  -a
(n/ log(n)) 2a+1 .

5. Estimating the change-point

Once one has opted to reject the null hypothesis of no jump or break, the actual locations of jumps become of interest for further inference. This location problem has been extensively discussed in the literature in different frameworks; see for instance Cso®rgo and Horva¥th (1997) and Mu®ller (1992). Here we develop a similar approach as in Aue et al. (2009). For the further analysis, we restrict ourselves to the `one change-point alternative' involving a jump in the volatility, i.e. we specify the alternative hypothesis H1 as
H1 :  - - =:  for a unique   (0, 1).

To assess the possible time of change, we use slightly modified versions of the building blocks of the test statistic Vn from (16), defined as

Vn,i =

1 kn

i i+kn

n(nj X)2 -

n(jn X )2

j=i-kn+1

j=i+1

,

for i = kn, . . . , n - kn, and Vn,i = 0 else. In contrast to the construction of Vn, we may employ a simpler unweighted version. One can also consider the rescaled versions as in Vn, and the theoretical properties of these estimators coincide. The possible time of change is then estimated via

nn = argmaxi=kn,...,n-kn Vn,i .

(35)

The following proposition establishes quantitative bounds for the quality of estimation. Proposition 5.1. Assume that the assumptions of Theorem 3.2 hold and that H1 is valid. Then, for   2kn-1/2 log(n) supt[0,1] t2, we have that

n -  = OP

kn log(n) . n

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

13

Remark 5.2. The estimator n is consistent as long as kn log(n)/(n) = O 1 . Note that jump sizes  dependent on n may be considered, with  = n  0 as n increases. If  does not tend to zero, the condition on  in the proposition is always satisfied. The estimator extends to jumps of X using truncation as in (25), and Proposition 5.1 then applies to the generalized estimator under the assumptions of Proposition 3.5.
Obviously, the quality of the estimator n depends on the bandwidth kn, and the smaller, the better. This is the complete opposite case compared to the test based on statistic Vn, where a larger choice of kn increases the power. This is no contradiction, since both problems have a different, essentially reciprocal nature. Also note that kn cannot be chosen arbitrarily small; seecondition (17). While classical estimators as the argmax of statistic (8) attain a standard n-rate, corresponding to kn  n, our nonparametric localization approach readily facilitates improved convergence rates as known for state-of-the-art change-point estimators. The following proposition sheds light on optimal convergence rates for the estimation problem.
2
Proposition 5.3. On the assumptions of Proposition 5.1 for kn  log(n)na 2a+1 , a consistent estimator for  does not exist in the case that knn = O log(n) .

6. Simulations

We examine finite-sample properties of the proposed methods in a simulation study. First, consider n = 10000 observations at regular times of (1) with deterministic volatility function

t = 1 - 0.01 sin

3 16



t),

t



[0,

1]

,

(36)

with start value X0 = 4 and with constant drift a = 0.1. We analyze the performance of the test with overlapping blocks based on test statistic Vn from (16) by simulating this model as hypothesis and add one jump of size 0.2 at fixed time t = 0.425 to t as one specific alternative. Shifting the time of the volatility jump does not affect the results substantially. Also, alternatives with a rough but smooth
movement of the same range result in similar effects.
The function (36) mimics a realistic volatility shape with strong decrease after opening and slight
increase before closing and poses an intricate setup to discriminate jumps from continuous motion based on the n = 10000 discrete recordings of X. We have taken a jump size under the alterna-
tive which equals the range of the continuous movement. This means, that under the alternative the volatility jumps back at t = 0.425 to its maximum start value. This is in line with effects evoked
by surprise elements from macroeconomic news in the financial context; see for instance Figure 1.
Particularly, a decreasing continuous movement of volatility after opening (and slight U-shape) and a
positive volatility jump appear as a realistic setup to us. We have implemented the methods for various block sizes kn, and all simulation results involve
5000 Monte Carlo iterations. We focus on Vn with overlapping blocks as it significantly outperforms the test with non-overlapping blocks using (14). For k10000 = 500, Figure 3 confirms a high finitesample accuracy of the test. The empirical distribution under the hypothesis is remarkably close to the theoretical limit distribution. Besides, the power for an 0.05-level test is almost 95%. The configuration k10000 = 500 thus guarantees high power and a perfect fit by the limit theorem under the hypothesis.
Minor modifications of kn do not change the results substantially. However, when we choose kn much smaller, the power deteriorates. On the other hand, choosing kn much larger increases the power close to 1 ≠ but at the same time the fit by (19) becomes less accurate, as expected from condition (17).

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

14

FIGURE 3. Top: Histograms of (16) for k10000 = 500 under hypothesis and alternative (right) and rescaled version comparing left hand side and limit law of (19) (left); limit law density marked by solid line. Bottom: Empirical size (left) and power (right) of the test by comparing empirical percentiles to ones of limit law under H0.

This is illustrated in Figure 4 for k10000 = 1000. As limit theorems with extreme value distributions as limit laws are often imprecise in finite-sample applications, it is common practice in change-point literature to apply bootstrap-procedures; see e.g. Wu and Zhao (2007). This could be done here as well to access the law of (16) for larger kn under the hypothesis when the fit by the limit law from (19) is not accurate. Such an approach allows to exploit that hypothesis and alternative separate even more clearly (we attain higher power) for such values of kn.
In the sequel, we consider two further simulation experiments. In the first one, X additionally comprises jumps. Precisely, for the volatility as above in (36) one jump of X at a uniformly drawn jump arrival time is implemented for both the hypothesis and the alternative. Under the alternative X additionally exhibits a common jump of X and  at t = 0.425. The jumps are N (0.5, 0.1) distributed.
In the third simulation experiment, a stochastic volatility model is considered. We choose

vt =

tt

c ∑  dWs +

1 - 2 ∑ c dWs ∑ t

00

(37)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

15

FIGURE 4. Empirical size (left) and power (right) of the test by comparing empirical percentiles to ones of the limit law under H0, k10000 = 1000.
with c = 0.1 and  = 0.5, where W  is a standard Brownian motion independent of W and t is the deterministic Lipschitz function (36) from above. Here, the volatility vt takes the role of t in (21) and follows a deterministic seasonality function, but for each path a random motion around that function is considered as well. The jumps are present in this experiment like in our second example.
In presence of jumps, X is of the form (21). Therefore, we apply the test statistic (25). For the truncation sequence we set un = 2 log (n)n-1/2  18.42 for n = 10000, motivated from extreme value theory and the magnitude of the increments from the continuous motion. In all cases, we simulate n = 10000 recordings and iterate 5000 Monte Carlo runs. Results for all three simulation scenarios are summarized in Table 1, i.e. the empirical power and size of tests with significance levels 1%, 5% and 10% are listed.
In all three experiments the power is very close to 1 for kn = 1000 and slightly lower for kn = 500. The fit of the empirical distribution by the limit V in (20) under the hypothesis is highly accurate for kn = 500 in all setups and slightly deteriorates when kn = 1000. Furthermore, the semi-martingale component of volatility in the third experiment slightly reduces the performance in terms of empirical power and size. Still, results are promising in view of the challenging model discriminating a volatility described by a continuous Ito^ semi-martingale from one with a jump. Comparing with Figures 3 and 4, we may conclude that there are basically no differences between the results for Vn from (16) applied to a continuous semi-martingale and for Vn,un from (25) applied to a process with jumps.
We have investigated in simulations also the influence of the rescaling factor in (16) by local volatility estimates. Thereto, we have compared the estimator to an oracle version where we rescale in each iteration with the generated volatility path. Surprisingly, the oracle version does not attain significant higher power than the original test. For instance, in the random volatility experiment, the power of the level 0.01 oracle test is 83.29% for kn = 500 and 96.90% for kn = 1000 and thus similar as listed for the test in Table 1. The statistics supx |Fn(x) - F (x)|, with F the distribution function of V from (20) and Fn the empirical distribution of realizations under the hypothesis, take values 0.1453 and 0.3702 for kn = 500, 1000, respectively, for the oracle test and 0.1527 and 0.5102 for the original test. This

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

16

Scenario kn level 0.01 level 0.05 level 0.10

1 power 500 84.96

94.58

97.30

1 size 500 99.12

95.04

89.46

1 power 1000 99.08

99.96

99.98

1 size 1000 98.96

91.86

81.14

2 power 500 84.46

94.32

97.02

2 size 500 98.80

93.86

88.52

2 power 1000 99.10

99.88

100

2 size 1000 98.98

91.90

80.66

3 power 500 82.12

91.84

94.54

3 size 500 95.36

87.30

79.10

3 power 1000 97.08

99.18

99.64

3 size 1000 92.66

70.32

52.88

TABLE 1

Empirical size and power of tests in %, each time from 5000 Monte Carlo iterations. Theoretical asymptotic size is (1 - )100 for level  and theoretical asymptotic power 100.

FIGURE 5. Running local statistics for data example, MMM (left) and GE (right).
indicates that the fit by the theoretical limit law is again just slightly more accurate for the oracle test.
Coming back to our introductory data example for intra-day prices on March 18th, 2009, we highlight in Figure 5 the evolution of the local rescaled averages over 10 squared returns, namely the numerator of the first term in the test statistic (16). The test rejects the null for both, 3M and GE with p-values very close to zero. The point in time where the difference of adjacent statistics is maximized estimates the timing of the structural change under the alternative. In both examples we find grid point 285 corresponding to 02:15 p.m. EST as estimated change-point.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

17

Appendix A: Proof of Theorem 3.2

First, we reduce the proof of Theorem 3.2 to Propositions A.1-A.5. The main part in the analysis of Vn from (14) is to replace it by the statistic

Un =

max

|Yn,i/Yn,i+1 - 1|,

i=0,..., n/kn -2

(38)

in which the original statistics Xn,i from (15) are approximated by

Yn,i

=

n kn

kn
i2knn (nikn+j W )2.
j=1

(39)

Up to different (random) factors in front, the maximum in Un is constructed from functionals of the i.i.d. increments of Brownian motion, which helps a lot in the derivation of its asymptotic behaviour. We start with a result on the approximation error due to replacing Vn by Un.

Proposition A.1. Suppose that we are under the null. If Assumption 3.1 and (17) hold, then we have

log (n) kn Vn - Un -P 0.

Recall that the variables Yn,i are not only computed over different intervals, but come with different volatilities in front as well. In order to obtain a statistic which is independent of  let us define

Yn,i

=

n kn

kn
(2i-1)knn (inkn+j W )2,
j=1

where the volatility factor is shifted in time now. Set then

(40)

Un =

max

|Yn,i/Yn,i+1 - 1|.

i=0,..., n/kn -2

(41)

Proposition A.2. Suppose that we are under the null. If Assumption 3.1 and (17) hold, then we have

log (n) kn Un - Un -P 0.

In the final step, we replace Yn,i+1 in the denominator by its limit i2knn. Set

Vn = max
i=0,..., n/kn -2

Yn,i - Yn,i+1 i2knn

.

(42)

Proposition A.3. Suppose that we are under the null. If condition (17) is satisfied, then we have

log (n) kn Un - Vn -P 0.

From Propositions A.1 to A.3 we have log (n) kn Vn - Vn -P 0, while

Vn = max
i=0,..., n/kn -2

1 kn

kn (nnikn+j W )2
j=1

-

1 kn

kn (nn(i+1)kn+j W )2
j=1

.

(43)

This statistic corresponds to the statistic Dn given in (13) of Wu and Zhao (2007); see as well Proposi(tiIonnntAhenk.5Ws.aPm)r2ee)c-fisaes1lhyi,1oanfktwenre,scuwabhntircaphcrtofivonergmtthhsaeatnmthie.eia.ndasosyenmqbupoettnohctiescisodfeossfhaVibfntoevdien, t(12h1-e6via)rrc(iaaXbnkleb)s1e.tkracnecdobrraecskpotondthtoe statistics Dn in (12) of Wu and Zhao (2007). See again also Proposition A.5.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

18

Proposition A.4. We have that log (n) kn Vn - V~n -P 0, with

Vn

=

max
i=kn,...,n-kn

1 i+kn kn j=i+1

(nnj W )2 - (njn-kn W )2

.

(44)

Theorem 1 of Wu and Zhao (2007) establishes limit theorems of the form (18) and (19) under more restrictive assertions on kn than (17), as they consider the behavior for a class of weakly dependent random sequences (Xk)k1. The next proposition provides a more specific limit theorem tailored to the asymptotic analysis of the statistics (43) and (44). In particular, instead of using the strong approximation theory under weak dependence from Wu (2007) employed by Wu and Zhao (2007) to prove their Theorem 1, we rely on classical bounds for the approximation error in the invariance principle for i.i.d. variables with existing moments. This is applicable in a more general setup with much smaller block lengths kn.
Proposition A.5. Consider a sequence (Xk)kN of i.i.d. random variables with Var Xk = 2 and E |Xk|p <  for some p  4. If

kn-p/2n = O (log(n))-p/2 ,

(45)

then with mn = n/kn the statistic

Dn

=

1 kn

max
knin-kn

kn+i
Xj
j=i+1

i
- Xj
j=i-kn+1

.

obeys the weak convergence:

log(mn )(kn1/2  -1 )Dn

-

2 log

(mn)

-

1 2

log

log(mn)

-

log

3

-w

V

,

where V is distributed according to (20). The statistic

kn

Dn = max
1i n/kn -2

Xikn+j - X(i+1)kn+j
j=1

using non-overlapping blocks satisfies under the same assumptions
log(mn) kn1/2-1 Dn - [4 log(mn) - 2 log(log(mn))]1/2 -w V .
As all moments of the 21 distribution exist and kn is at least of polynomial growth in n, Proposition A.5 applied to (43) and (44) implies Theorem 3.2. We start with the proof of Proposition A.5 and then show by proving Propositions A.1-A.4 that the preliminary reductions are in order.

Proof of Proposition A.5. By a simple rescaling argument, we can restrict ourselves to the case
Var Xk = 1. The Donsker-Prokhorov invariance principle guarantees weak convergence of partial sums of (Xk)kN, rescaled with n, to the law of the standard Brownian motion as n  . Let Zj jN be a sequence of centered i.i.d. Gaussian random variables with E Zj2 = E Xj2 = 1. Observe that

kn+i

i

max

Xj - Zj -

Xj - Zj

knin-kn j=i+1

j=i-kn+1

i

 4 max

Xj - Zj .

knin j=1

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

19

We exploit the classical theory on bounds for the approximation error of partial sums of the above type associated with the invariance principle provided by the seminal works of Komlo¥s et al. (1975), Komlo¥s et al. (1976), Zaitsev (1987), and related literature. Let (xn)nN be a sequence with xn  0 for all n. According to Theorem 4 of Komlo¥s et al. (1976) or equivalently (1.6) of Sakhanenko (1996) with Markov inequality, the sequence Zj jN can be constructed in such a manner that

i

P max

Xj - Zj

knin j=1

 xn



1 C1 xpn

n
E
j=1

|Xj |p



n C2 xnp

,

with

constants

C1, C2

which

may

depend

on

p.

Selecting

xn

=

 knn

with

n

=

(log(n))-1/2,

the

conditions to apply Theorem 4 of Komlo¥s et al. (1976) are in order and we get from condition (45)

and the above that

kn+i

i

max

Xj - Zj -

Xj - Zj

knin j=i+1

j=i-kn+1

= OP

kn(log(n))-1/2 .

(46)

Denote with B(k) =

k j=1

Zj

and

define


H(u) = 1(0  u < 1) - 1(-1 < u < 0) / 2.

Then by (46), it follows that

knDn 2

=

1 2kn

max
knin-kn

B(i

+

kn)

-

2B(i)

+

B(i

-

kn)

+

= 1

sup

H

kn s[kn,n-kn] R

s-u kn

dB(u) + O(Rn) + kn

OP(1) log(n) OP(1) , log(n)

where Rn = sup |B(u) - B(u )| : u, u  [0, n], |u - u |  1 = OP log(n) by standard properties of Brownian motion. Then, since (log(n))6 = O kn) by condition (45), we may apply the limit theorem from Lemma 2 in Wu and Zhao (2007) with  = 1, DH,1 = 3 and bn = mn-1 for
mn = n/kn ; see Definition 1 and Lemma 2 of Wu and Zhao (2007).
In the same manner, we can use that

kn+i

i

kn+i

i

kn Xj -

Xj = kn

Zj -

Zj + OP

j=i+1

j=i-kn+1

j=i+1

j=i-kn+1

log (n) ,

for E[Xj2] = 1 with Zj jN again a sequence of centered i.i.d. Gaussian random variables. Lemma 1 of Wu and Zhao (2007) then ensures the limit theorem for non-overlapping blocks. This completes the proof of Proposition A.5.

Proof of Proposition A.1. First, a standard argument as e.g. laid out in Section 4.4.1 in Jacod and
Protter (2012) allows us to strengthen Assumption 3.1 and to assume that all local conditions are in fact global. That is, we assume without loss of generality that |as|  K, 0 < -2 < s2 < K and w()1  Ka for a generic constant K.
Let (ai)i=1,...,m and (bi)i=1,...,m be arbitrary reals. Obviously, for an arbitrary i we have

|ai|  |ai - bi| + |bi|  max |ai - bi| + max |bi|.

i=1,...,m

i=1,...,m

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

20

Therefore the inequality holds with the left hand side replaced with maxi=1,...,m |ai| as well. Applied to Vn and Un it is simple to deduce

|Vn - Un|  max |Xn,i/Xn,i+1 - 1 - (Yn,i/Yn,i+1 - 1)|
i=0,..., n/kn -2

 max

Xn,i

i=0,..., n/kn -2

11 -
Xn,i+1 Yn,i+1

+ max
i=0,..., n/kn -2

Xn,i - Yn,i . Yn,i+1

(47)

Let us begin with the second term on the right hand side above. For all > 0 and all constants D > 0, we have

P max
i=0,..., n/kn -2

kn log(n)(Xn,i - Yn,i) > Yn,i+1

 P max

kn log(n)|Xn,i - Yn,i| ∑ max 1/|Yn,i+1| >

i=0,..., n/kn -2

i=0,..., n/kn -2

P

max
i=0,..., n/kn -2

kn log(n)|Xn,i - Yn,i| > D

+P

max 1/|Yn,i+1| > D . (48)
i=0,..., n/kn -2

To keep the notation readable, here and below we use standard probabilities and expectations without an extra indication that we are on the set c.
Since we have t2  -2 > 0, we can use the same arguments as in the proof of equation (22) in Vetter (2012) to derive

P max 1/|Yn,i+1| > D = P min |Yn,i+1| < D-1  0

i=0,..., n/kn -2

i=0,..., n/kn -2

with e.g. D-1 = -2 /2. The intuition behind this result is that the probability of a mean of kn i.i.d. variables with all moments deviating too much from its expectation becomes exponentially small in kn. A similar argument will be given in (56) later. Also, here we need that kn is of (at least) polynomial growth, which is included in (17).
On the other hand, using Ito^ formula we obtain

kn log(n)(Xn,i - Yn,i) = n

log(n) kn kn j=1

(inkn+j X)2 - i2knn (nikn+j W )2

(49)

n =

log(n)

kn

kn (ikn+j)n

kn

2 (Xs - X(ikn+j-1)n )as ds +

j=1 (ikn+j-1)n

j=1

(ikn+j)n
(s2 - i2knn ) ds
(ikn+j-1)n

n +

log(n) kn 2 (ikn+j)n kn j=1 (ikn+j-1)n

(Xs - X(ikn+j-1)n )s - (Ws - W(ikn+j-1)n )i2knn

dWs .

Using this decomposition, we split the discussion of

P max

kn log(n)|Xn,i - Yn,i| > /D

i=0,..., n/kn -2

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

21

into three parts. For the first term, observe that

P

n max
i=0,..., n/kn -2

log(n) kn

kn
2
j=1

(ikn+j)n
(Xs - X(ikn+j-1)n )as ds
(ikn+j-1)n

>

/(3D)

n/kn -2
P
i=0

n log(n)

kn
2

kn j=1

(ikn+j)n
(Xs - X(ikn+j-1)n )asds > /(3D)
(ikn+j-1)n

n/kn -2

 ( /(3D))-r

E

i=0

n

log(n) kn 2 kn j=1

(ikn+j)n

r

(Xs - X(ikn+j-1)n )as ds
(ikn+j-1)n

,

for all integers r. Applying a standard bound based on Jensen's and Minkowski's inequalities yields

n log(n) (ikn+j)n

r

E

 kn

2 (Xs - X(ikn+j-1)n )as ds
(ikn+j-1)n

 Kr

n log(n) kn

(ikn+j)n
E[|Xs - X(ikn+j-1)n |r]1/rds
(ikn+j-1)n

r
.

Kr here and below denotes a generic constant depending on r. Burkholder-Davis-Gundy inequality gives for any s  [(ikn + j - 1)n, (ikn + j)n]:

E[|Xs - X(ikn+j-1)n |r]  Krn-r/2 ,

E

n log(n) 2 kn

(ikn+j)n

r

(Xs - X(ikn+j-1)n )as ds

(ikn+j-1)n

 Kr(nkn)-r/2 logr/2(n) .

We conclude that

P

n max
i=0,..., n/kn -2

log(n) kn

kn
2
j=1

(ikn+j)n
(Xs - X(ikn+j-1)n )as ds
(ikn+j-1)n

>

/(3D)

 ( /(3D))-r n/kn Krknr/2n-r/2 logr/2(n)  0

(50)

for r > 2 arbitrary. Regarding the second term in (49), on c we have

n log(n) kn

max 

i=0,..., n/kn -2

kn j=1

(ikn+j)n
(s2 - i2knn ) ds
(ikn+j-1)n

 max n log(n) kn

i=0,..., n/kn -2

kn j=1

(ikn+j)n
|s2 - i2knn |ds
(ikn+j-1)n

 knwknn()1 log(n)  K kn(knn)a log(n) ,

which converges to zero by (17). Observe that addends above involve interlacing time intervals such that for  a continuous Ito^ semi-martingale the bound above applies with a = 1/2 and is sharp.
Finally, we have the further decomposition

s

(Xs - X(ikn+j-1)n )s - (Ws - W(ikn+j-1)n )i2knn = s

au du

(ikn+j-1)n

(51)

ss

+ (s - iknn )

u dWu + iknn

(u - iknn ) dWu .

(ikn+j-1)n

(ikn+j-1)n

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

22

We proceed in a similar way as above:

P

n max
i=0,..., n/kn -2

log(n) kn

kn
2
j=1

(ikn+j)n
s
(ikn+j-1)n

s
aududWs > /(9D)
(ikn+j-1)n

n/kn -2

 ( /(9D))-r

E

i=0

n log(n) kn 2 kn j=1

(ikn+j)n
s
(ikn+j-1)n

sr
au du dWs
(ikn+j-1)n

.

(52)

Precisely, let r = 2m and set

kn
cs = s
j=1

s
au du1[(ikn+j-1)n,(ikn+j)n)(s) .
(ikn+j-1)n

Then we have in a similar way as before

E

n

log(n) kn 2 kn j=1

(ikn+j)n
s
(ikn+j-1)n

s 2m
au du dWs
(ikn+j-1)n

= 22m

n

log(n) kn

2m
E

(i+1)knn

2m

cs dWs

iknn

= 22m

n

log(n)

2m
E

kn

(i+1)knn
cs2ds

m

iknn

 Km

n

log(n) kn

2m

(i+1)knn
E[c2sm]1/mds

m
.

iknn

With

kn
E[c2sm] = E s2m
j=1

s audu 2m 1[(ikn+j-1)n,(ikn+j)n)(s)  Kmn2m ,
(ikn+j-1)n

we obtain n log(n) 2m kn

(i+1)knn
E[c2sm]1/mds
iknn

m
 Km

n

log(n) kn

2m(kn3n)m

= Kmnm log2m(n).

(53)

By choosing m large enough, the term in (52) converges to zero. Similarly,

E

n

log(n) kn 2 kn j=1

(ikn+j)n
(s - iknn )
(ikn+j-1)n

s 2m
u dWudWs
(ikn+j-1)n

 Km

n

log(n) kn

2m

(i+1)knn iknn

kn
E (s - iknn )2m
j=1

s 2m

◊

udWu

1[(ikn+j-1)n,(ikn+j)n)(s)

(ikn+j-1)n

1/m m
ds

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

23

 Km

n

log(n) kn

2m

 Km

n

log(n) kn

2m

(i+1)knn iknn

kn
E wknn ()21m
j=1

s 2m

1/m m

◊

udWu

1[(ikn+j-1)n,(ikn+j)n)(s)

ds

(ikn+j-1)n

(i+1)knn (knn)2manm 1/m ds m  Km(knn)2ma.
iknn

The same upper bound is obtained for the third term in (51). Again, choosing m large enough yields convergence to zero. Altogether, we conclude

P max

kn log(n)|Xn,i - Yn,i| > /D  0,

i=0,..., n/kn -2

and we are done with the second term on the right hand side of (47). Next, consider the first term on the right hand side of (47). For any > 0 and any D > 0:

P max
i=0,..., n/kn -2

kn log(n) Xn,i

1 -1 Xn,i+1 Yn,i+1

>

 P max

kn log(n)|Xn,i(Yn,i+1 - Xn,i+1)| > /D

i=0,..., n/kn -2

+ P max 1/|Yn,i+1Xn,i+1| > D .
i=0,..., n/kn -2

Observe that

P

min

|Yn,i+1Xn,i+1| < D-1

i=0,..., n/kn -2

P

min |Yn,i+1| < D-1/2 + P

min

|Xn,i+1| < D-1/2

i=0,..., n/kn -2

i=0,..., n/kn -2

 P min |Yn,i+1| < D-1/2 + P min |Yn,i+1| < 2D-1/2

i=0,..., n/kn -2

i=0,..., n/kn -2

+P

max

|Xn,i+1 - Yn,i+1| > D-1/2 .

i=0,..., n/kn -2

All three terms on the right hand side have already been discussed above for an appropriate choice of D, the latter term even with an additional factor kn log(n). Similarly, for all  > 0 we have

P max

kn log(n)|Xn,i(Yn,i+1 - Xn,i+1)| > /D

i=0,..., n/kn -2

 P max |Xn,i| >  + P max

kn log(n)|Yn,i+1 - Xn,i+1| > /(D) .

i=0,..., n/kn -2

i=0,..., n/kn -2

Here we only have to focus on the first term, for which we use

P max |Xn,i| > 
i=0,..., n/kn -2

(54)

 P max |Yn,i| > /2 + P max |Yn,i+1 - Xn,i+1| > /2 .

i=0,..., n/kn -2

i=0,..., n/kn -2

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

24

The same arguments which were leading to equation (22) in Vetter (2012) show that the first probability becomes arbitrarily small for large enough , this time because we may assume  is bounded from above. The second probability has already been discussed above.

Proof of Proposition A.2. We have to show convergence in probability to zero of

kn log(n) max
i=0,..., n/kn -2

Yn,i - Yn,i Yn,i+1 Yn,i+1

= max
i=0,..., n/kn -2

kn log(n)Yn,i(Yn,i+1 - Yn,i+1) . Yn,i+1Yn,i+1

Using equation (22) in Vetter (2012) again, we may focus on the numerator above only, and for the same reason as in (54) it suffices to prove convergence to zero of

P max

kn log(n)|Yn,i+1 - Yn,i+1| >

i=0,..., n/kn -2

= P max
i=0,..., n/kn -2

kn log(n) i2knn - (2i+1)knn

n kn

kn
(n(i+1)kn+j W )2
j=1

>

 P max
i=0,..., n/kn -2

kn log(n) i2knn - (2i+1)knn > /2



+ P  max
i=0,..., n/kn -2

n kn

kn
((ni+1)kn+j W )2
j=1

> 2

(55)

for all > 0. Regarding the first quantity, recall that on c by (17)

max
i=0,..., n/kn -2

kn log(n)|i2knn - (2i+1)knn |  kn log(n)wknn ()1  K kn(knn)a log(n)  0 .

On the other hand,

n P max
i=0,..., n/kn -2

log(n) kn

kn
(n(i+1)kn+j W )2
j=1

>2

n/kn -2
P
i=0

n

log(n) kn

kn
((ni+1)kn+j W )2
j=1

>2

n/kn -2
P
i=0

log(n) kn kn j=1

(nn(i+1)kn+j W )2 - 1

>1

n/kn -2
E
i=0

log(n) kn kn j=1

(n(ni+1)kn+j W )2 - 1

2m

(56)

for all integers m. Due to the i.i.d. structure, the latter term is bounded by Km(n/kn)kn-m logm(n), which converges to zero for m large enough.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

25

Proof of Proposition A.3. We have to show convergence to zero in probability of

kn log(n) max
i=0,..., n/kn -2

Yn,i - Yn,i+1 Yn,i+1

-

Yn,i - Yn,i+1 i2knn

=

kn log(n) max
i=0,..., n/kn -2

(Yn,i - Yn,i+1)(Yn,i+1 - i2knn ) Yn,i+1i2knn

.

It is sufficient to focus on the numerator, and we discuss two terms separately, using

P max
i=0,..., n/kn -2

kn log(n)|(Yn,i - Yn,i+1)(Yn,i+1 - i2knn )| >



 P max

kn log(n)|Yn,i - Yn,i+1| >

i=0,..., n/kn -2

+P

max
i=0,..., n/kn

|Yn,i+1
-2

- i2knn |

>



.

The first term has already been discussed in (55), while

P

max
i=0,..., n/kn

|Yn,i+1
-2

- i2knn |

>





=

P  max
i=0,..., n/kn

-2 i2knn

1 kn

kn ((n(ni+1)kn+j W )2
j=1

-

1)

 >



 P  max
i=0,..., n/kn -2

1 kn

kn ((n(ni+1)kn+j W )2
j=1

-

1)

 > /K

using 2  K. The claim follows from (56).

Proof of Proposition A.4. For the test statistic Vn from (16) our proof follows the same stages as the one for Vn via Propositions A.1, A.2 and A.3 above. We start proving

kn log(n) Vn - Un -P 0

for

n

Un

=

max
i=kn,...,n-kn

kn

i j=i-kn+1

(2i-kn)n

(jnW

)2

n kn

i+kn j=i+1

i2n

(jnW

)2

-1

.

Similar to (47), we find that

i

|Vn

-

Un|



max
i=kn,...,n-kn

(jn X )2
j=i-kn+1

n

+ max

kn

i=kn,...,n-kn

i j=i-kn+1
n kn

i+kn
(jn X )2

-1
-

j=i+1

i+kn
i2n (jnW )2
j=i+1

(jnX)2 - (2i-kn)n (jnW )2

i+kn j=i+1

i2n

(nj

W

)2

.

-1

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

26

Following an inequality analogous to (48), the key step is to show that

P

log(n)kn max
i=kn,...,n-kn

ni kn j=i-kn+1

(jnX)2 - (2i-kn)n (jnW )2

> /D  0 ,

(57)

while for t bounded from below we readily obtain

P

n min i=kn,...,n-kn kn

i+kn
i2n (nj W )2
j=i+1

< D-1

 0.

For the proof of (57) we proceed with a decomposition analogous to (49) and for the first term along

the same lines as above leading to (50). However, the maximum extends now over the larger set of

all

indices

i

=

kn, . . . , n - kn,

and

thus

instead

of

(50)

the

upper

bound

yields

(

/(3D))-r

n1-

r 2

knr/2

logr/2(n), which is a factor kn larger than above. Still, choosing r sufficiently large the term tends

to zero. The same reasoning applies to all terms for which we have used Jensen's and generalized

Minkowski's inequalities above as (53).

Upper bounds exploiting the smoothness of the volatility remain as before, for instance

log(n)kn max
i=kn,...,n-kn

n kn kn j=1

(j+i+kn-1)n
(s2 - i2n ) ds
(j+i-1)n

 Kn

log(n) kn

kn
(jn)an
j=1

 K kn(knn)a log(n)

with a constant K on Assumption 3.1. In this fashion, all terms generalizing the expressions in the proofs of Propositions A.1, A.2 and A.3 are controlled and we conclude Proposition A.4.

Appendix B: Proof of Proposition 3.5

Recall the definition of the general Ito^ semi-martingale in (21). Again, by the usual localization pro-
cedure, we can work under the reinforced assumption that the process Xt and its jumps Xt are bounded as well. We will then work with the decomposition Xt = X0 + Ct + Jt, where Jt denotes the pure jump martingale
t
Jt = (s, x)(µ - )(ds, dx)
0R
and the continuous part becomes

tt
Ct = a~s ds + s dWs
00

with a~s = as + R Ø((s, x))(dx). The latter integral is finite for bounded jumps. We shall prove only (28) of Proposition 3.5 by showing that

kn log(n)

max
i=kn,...,n-kn

n kn
n kn

i
1j=i-kn

+1

(jn

X

)2

{|jn X |un }

i+kn
1j=i+1

(jn

X

)2

{|jn X |un }

-1

- max
i=kn,...,n-kn

n kn
n kn

i j

=i-kn+1(nj

C

)2

ji+=ki+n 1(jnC)2

-1

-P 0 . (58)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

27

Following a decomposition of the error term as in (47), we have to show that

1kn log(n) max 1i=kn,...,n-kn

n kn
n kn

i j

=i-kn+1(jn

X

)2

{|nj X|un}

i+kn j=i+1

(jn

X

)2

{|nj X|un}

-

n kn

1i
j=i-kn

+1

(jnX

)2

{|nj X|un}

n kn

i+kn j=i+1

(jn

C

)2

n

+ kn log(n) max

kn

i=kn,...,n-kn

1i
j=i-kn+1

(jnX)2 {|jnX|un} - (nj C)2

n kn

ji+=ki+n 1(jnC)2

-P 0 .

Both terms are handled similarly and we restrict to the second one. It suffices to prove that

P

n max
i=kn,...,n-kn

log(n) kn

i j=i-kn+1

1(jnX)2 {|nj X|un} - (jnC)2

> D

 0,

(59)

for all > 0 and constants D > 0, as (58) then follows with (48) and the same bound for the second probability as in the proof of Proposition A.1. As max1in |ni C| = Oa.s.(un) by basic extreme value theory we can work on a subset of  where max1in |ni C| = O(un). Observe that on this subset

i

1max
i=kn,...,n-kn

(jn X )2
j=i-kn+1

{|nj X|un} - (nj C)2

 K max
i=kn,...,n-kn

ii

1{|jnX|>un}(nj C)2 +

(|nj J |  un)2 + (|jnJ |  un)|nj C|

j=i-kn+1

j=i-kn+1

with some constant K. Pertaining the first addend and using maxi(ni C)2 = OP(n log(n)), we have to ensure that

i

1max
i=kn,...,n-kn j=i-kn+1

{|jnX|>un} = OP

kn/ log3/2 (n) .

Let p with 1 < p < (2r )-1 be arbitrary. We use the decomposition X = X n + X n with

t

Xt n =

(s, x)1{(x)>upn}µ(ds, dx),

0R

Xtn = Xt - Xt n,

and define Ajn = {|nj X n|  un/2}. Finally, N n is the counting process

t

Ntn =

1{(x)>upn}µ(ds, dx).

0R

We know from (13.1.10) in Jacod and Protter (2012) that

in

1 1E

max
i=kn,...,n-kn j=i-kn+1

{|jn X |>un }

{(Anj ) }

 P (Ajn)
j=1

0

for all such p. Then, using 1{|nj X|>un}1{Ajn} 1 {|nj X n|>un/2}, all we have to show are conditions
under which

i

1max
i=kn,...,n-kn j=i-kn+1

{|jnN n|1} = OP

kn/ log3/2 (n) .

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

28

Obviously,

i
1{|jnN n|1}  Ninn - N(ni-kn)n ,
j=i-kn+1

and N n is a Poisson process with parameter R 1{(x)>upn}(dx)  Kun-rp; see (13.1.14) in Jacod
and Protter (2012). It is clearly enough if the probability of more than l <  jumps on one block

converges to zero, i.e.

n
P N(nj+1)n - N(nj-kn+1)n  l
j=kn

 nP Nknnn  l  Knnl knl un-rpl = Kknl nl(1-rp )-1 .

Thus, we need the condition that for some p > 1 and some l < :

knl nl(1-rp)-1  0 and 2r < 1 .

(60)

Bounding the second term above comprising small jumps in case of non-truncation poses a more deli-
cate mathematical problem. We restrict to the quadratic jump terms as the cross terms lead in the same way to an obsolete weaker criterion. For finite activity it is enough to ensure that nkn-1/2 log(n)u2n  0. Else, define the sequence of random variables

Zi = |iJ |  un 2 - E |iJ |  un 2 , i = 1, . . . , n .

Note from equation (54) in A®it-Sahalia and Jacod (2010) that we can bound moments of |iJ|un 2 in the following way:

E |ni J |  un 2 F(i-1)n  Knun2-r , Var |inJ |  un 2 F(i-1)n  E |ni J |  un 4 F(i-1)n  u2nKnun2-r = Knu4n-r ,

for all i = 1, . . . , n. We decompose

max
i=kn,...,n-kn

i j=i-kn+1

|jJ |  un 2

i

 max

Zj

i=kn,...,n-kn j=i-kn+1

i

+ max

E

i=kn,...,n-kn j=i-kn+1

|jJ |  un 2 ,

where the condition

knun2-r log(n)  0

(61)

renders the second term with the expectation asymptotically negligible. Yet, the derivation of the maximum in the first term from its expectation can in general become much larger. Observe that

max
i=kn,...,n-kn

i
Zj
j=i-kn+1

= max
i=kn,...,n-kn

i i-kn
Zj - Zj
j=1 j=1

 2 max
i=kn,...,n

i
Zj .
j=1

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

29

Having a sequence of independent and centered random variables, we can apply Kolmogorov's maximal inequality:

P

max
i=kn,...,n-kn

i
Zj > 
j=i-kn+1



n 2

Va

r(Z1)



-2un4-r

.

(62)

Thereby we conclude that maxi=kn,...,n-kn

i j=i-kn+1

Zj

= OP u2n-r/2 . We obtain the condition

n

log(n) kn

un2-r/2



0

.

In conclusion, the conditions (60), (61) and (63) ensure (58), what yields our claim.

(63)

Appendix C: Proof of the lower bound and consistency

Proof of Theorem 4.1. The proof is based on equivalences of statistical experiments in the strong Le Cam sense. After information-theoretic reductions, we subsequently move to statistical experiments that allow a simpler treatment; see (67) below. Our final experiment E4 is a special high-dimensional signal detection problem, from which we will deduce the lower bound by classical arguments.
First consider alternatives with a jump as in (4). Here, throughout this proof, we set

kn = ck

log(mn)-2 na/Ln

2
,2a+1

(64)

with a constant ck > 0. In the preliminary step, we first grant the experimenter additional knowledge. We restrict to a sub-class of SJ a, bn, L from (3), where we have one jump at time   (0, 1) in the volatility, |2 - 2-|  bn. Then, we assume that nkn-1  {1, 2, . . . , n/kn - 1}, such that the jump time is in the set of observation grid points which are multiples of kn. Furthermore, we can stick to X0 = 0 and as = 0, s  [0, 1]. From an information-theoretic view, obtaining this additional
knowledge can only decrease the lower boundary on minimax distinguishability. Consequently, a
lower bound derived for the sub-model carries over to the less informative general situation. To ease the exposition, we first set -2 = 1 and Ln = 1 and generalize the result at the end of this
proof. Next, denote with [a]b = a mod b and let

j2n =

1 + (kn - [j]kn )an-a, 1,

n  j < n + kn, else.

(65)

The discretized squared volatility exhibits a jump (resp. change-point) of order bn at  and then decays
on the window [,  + knn] smoothly with regularity a and is constant elsewhere. It suffices to consider the sub-class   SJ a, bn, L of squared discretized volatility processes of the above form for which it remains unknown on which window the jump occurs.
Introduce a sequence rn with rn   such that rnkn-1  0 as n  . We specify the following stepwise approximation of (j2n)0jn  :

j2n =

1 + (kn - irn)an-a, 1,

n + (i - 1)rn  j  n + irn, 1  i  knrn-1, else.

(66)

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

30

Denote the observations by j = (j-1)n Wjn - W(j-1)n and j = (j-1)n Wjn -
W(j-1)n , j = 1, . . . , n, respectively, with W the Wiener process in (1). In the sequel, it is convenient to distinguish the two cases where a > 1/2 and a  1/2.

Case a > 1/2: As alluded to above, we relate different experiments:
E1 : Observe j 1jn and information nkn-1  {1, 2, . . . , n/kn - 1} is provided. E2 : Observe j 1jn and information nkn-1  {1, 2, . . . , n/kn - 1} is provided. E3 : Observe  = i2knn i iI1 , 2+(i-1)rnn ~i iI2 , where indices (ikn, i  I1) expand
over all multiples of kn, except the one where the jump is located, i.e. I1 = {1, . . . , nkn-1 - 1, nkn-1 + 1, . . . , n/kn - 1}, and (n + (i - 1)rn, i  I2) over all multiples of rn in the window of length knn where (j2) is non-constant, i.e. I2 = {1, 2, . . . , knrn-1}. (i)iI1 and (~i)iI2 are i.i.d. random variables having chi-square distribution with degrees of freedom kn for i  I1 and rn for i  I2. Moreover, information nkn-1  {1, 2, . . . , n/kn - 1} is provided. E4 : We observe  = kn-1/2ii2knn + i2knn iI1 , rn-1/2~i2+(i-1)rnn + 2+(i-1)rnn iI2 where (i, ~i) are i.i.d. standard normal random variables. Moreover, information nkn-1  {1, 2, . . . , n/kn - 1} is provided.
When considering the above experiments, we always have (j2n)   (or (j2n)  ) as unknown parameter that index a family of probability measures {P(j2n)}. For the sake of readability, we move this formalism to the background and omit subscripts indicating the parameter space. We
show the following relations for the experiments, where  marks strong Le Cam equivalence and 
asymptotic equivalence:

E1  E2  E3  E4.

(67)

Finally, we shall derive the lower bound in E4 which carries over to E1 by the above relations and thus also to our general model. The proof is now divided into four main steps.

Step 1 E1  E2: For random variables U, V and their laws PU , PV , we denote the Kullback-Leibler divergence D U V = D PU PV = log dPU /dPV dPU . For normal families with unknown variance P = N (0, ), it is known that

D P P

= E log

dP dP

= - 1 log  + 1 -  ,

2



such that for  =  +  and considering asymptotics where   0, we obtain

D P + P

= -1

log

 1+

2

- 

= 2 + O 3 . 4

(68)

As E1 and E2 share a common space on which the considered random variables are accommodated,
asymptotic equivalence holds if P(j) - P(~j) T V  0 as n   where ∑ T V denotes the total variation distance and P(j) the law of observations (j). We exploit Pinsker's inequality

P(j ) - P(~j )

2 TV



1 D

2

(j )

(~j )

.

(69)

By Gaussianity and independence of Brownian increments, implying additivity of the KullbackLeibler divergences, it follows with (68) for any piecewise constant approximation of a function with

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

31

regularity a on knrn-1 intervals of length rnn that

knrn-1 rn

D (j) (~j) = O 1

jn 2a = O n-2aknrn2a ,

i=1 j=1

which tends to zero for rnkn-1 = O(n- ) for some > 0. Step 2 E2  E3: The vector of averages

kn

kn-1

i2kn+j-1

j=1

,
iI1

rn

rn-1 2n+(i-1)rn+j-1
j=1

iI2

forms a sufficient statistic for (j2-1)1jn. Thereby we conclude, see e.g. Lemma 3.2 of Brown and Low (1996), the strong Le Cam equivalence.
Step 3 E3  E4: Let  = kn-1/2 i2knn (i -kn) iI1 , rn-1/2 2+(i-1)rnn (~i -rn) iI2 and
 = ii2knn iI1 , ~i2+(i-1)rnn iI2 . In both experiments random variables are accommodated on the same space. Rescaling and a location shift yield with Pinsker's inequality

P - P

2 TV

=

P

- P

2 TV



1D 2





.

By independence, it follows that

D 



D

kn-1/22ikn (i - kn)

i

2
ikn

iI1

n

n

+D
iI2

rn-1/22+

(i-1)rn n

(~i

-

rn)

~i

2
+

(i-1)rn n

.

An application of Theorem 1.1 in Bobkov et al. (2013) yields

D kn-1/2i2knn (i - kn) ii2knn = O nkn-2 ,
iI1
D rn-1/22+(i-1)rnn (~i - rn) ~i2+(i-1)rnn = O knrn-2
iI2

.

For a > 1/2, we have nkn-2 = O(1). Choosing rn sufficiently large such that knrn-2 = O(1), it follows that

P - P T V = O 1 ,

(70)

what ensures the claimed asymptotic equivalence.

Step 4: By the previous steps, it suffices to establish a lower bound for the distinguishability in ex-
periment E4. Adding an additional drift, which gives clearly an equivalent experiment, we consider observations  = kn-1/2ii2knn + i2knn - 1 iI1 , rn-1/2~i2+(i-1)rnn + 2+(i-1)rnn - 1 iI2 . Then, the testing problem can be interpreted as a high dimensional location signal detection problem
in the sup-norm. More precisely, we test the hypothesis

H0 : sup(~j2 - 1) = 0 against the alternative H1 : sup(~j2 - 1)  bn ,
jj

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

32

and we are interested in the maximal value bn  0 such that the hypothesis H0 and H1 are nondistinguishable in the minimax sense. Non-distinguishability in the minimax sense is formulated as

lim
n

inf




a, bn

= 1,

(71)

and

the

detection

boundary

here

is

bn



(knn)a



n-

a 2a+1

.

In

order

to

show

(71),

we

proceed

in

the fashion of Section 3.3.7 of Ingster and Suslina (2003). Let P be the law of the observations. We

consider the probability measures

P0 = P ◊ P0 and P1 = P ◊ P1 ,

where P0 means the hypothesis of the test applies (no jump) and P1 draws a jump-time  with nkn-1  {1, . . . , n/kn - 1} uniformly from this set. Therefore, P0 represents the probability measure without signal, and P1 the measure where a signal is present. It then follows that

inf  a, bn


1- 1 2

P1 - P0

TV

1- 1 2

EP0

L20,1 - 1

1/2,

with L0,1 = dP1/dP0 the likelihood ratio of the measures P1 and P0. For the validity of (71), it thus suffices to establish

EP0 L20,1  1 as n  .

(72)

To this end, for given  we denote with ui nkn-1 = 4+(i-1)rnn for i  I2, vinkn-1 = (ui1/2 - 1)rn1/2. We first perform some preliminary computations. Denote with Y (x) the density function of
a Gaussian random variable Y , not necessarily standard normal, and for a, b  {1, . . . , n/kn - 1}

  

Ia,b(x, y)

:=


iI2

~i(uai )1/2+via (xi)

~i (xi)


iI2

~i(uib)1/2+vib (yi)  . ~i (yi)

Then, we have that Ia,b := Ia,b(x, y) iI2 ~i (xi)dxi iI2 ~i (yi)dyi = 1. Next, for a  {1, . . . , n/kn - 1}, consider

IIa(x) :=
iI2

~i(uai )1/2+via (xi) ~i (xi)

2
.

Observe that for a standard Gaussian random variable Z and s, t  R, |s| < 2, we have

E exp(sZ2 + tZ)

exp =

t2 2-4s

1 - 2s

.

This, together with the inequality

(73)

kn/rn-1

C0kn (knn)2a  rn

((kn - irn)n)2a  kn (knn)2a

i=0

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

33

for some constant C0 > 0 and routine calculations yield that for some C0  C1  1:

IIa :=

I Ia (x)

~i (xi)dxi  eC1kn(knn)2a 1 + O(1) .

iI2

With all the preliminary calculations completed, we are now ready to derive a bound for

n/kn -1

EP0 L20,1 - 1 =

P nkn-1 = a P nkn-1 = b

a,b=1 a=b

n/kn -1
+ P nkn-1 = a 2 IIa - 1
a=1

Ia,b - 1

2
where the first sum vanishes. For an appropriate choice of ck > 0, kn = ck log(mn)na 2a+1 is equivalent to kn(knn)2a = C2 log(n/kn) for some C2 < C1-1. Since P nkn-1 = a = knn, we thus obtain

n/kn

EP0 L02,1 - 1 

P nkn-1 = a 2 eC1kn(knn)2a - 1

a=1

= (1 + O(1))knn eC1kn(knn)2a .

(74)

Using

knneC1kn(knn)2a = knn exp C1 C2 log n/kn = (knn)1-C1 C2 = O(1),

we conclude (72).

Case a  1/2: The only time we make use of the condition a > 1/2 above is in Step 3 to ob-

tain n/kn2 = O(1). The necessity of this relation is due to the large number of blocks n/kn, when operating with the entropy bounds. To establish the lower bound, this constraint can be removed by

granting the experimenter even more additional information what is briefly sketched in the follow-

ing. Indeed, suppose we know in addition that n  kn, 2kn, . . . , lnkn where ln = nl n/kn, l > 0 arbitrarily small but strictly positive and such that ln  N. Using the sufficiency argu-

ment of Step 2, we can gather all the information contained in (i)lnkn<in in one single average

(n - (ln + 1)kn)-1

n i=ln

kn

+1

i2

.

Then,

one

can

repeat

Steps

3

and

4,

subject

to

the

weaker

condition

ln/kn = O(1). Selecting l > 0 sufficiently small for each 0 < a  1, this is always possible. The

lower bound in Step 4 gives the same minimax detection boundary and hence the claim follows.

Let us now touch on the general case with some -2 > 0 and sequences Ln. Exactly the same arguments lead to (with ck as before) limn inf (a, bn) = 1 for

bn  Ln (knn)a , kn = ck

2

log(mn)-2 L-n 1na

= c n2a+1

2a
k 2a+1

1

-4 log(mn) Ln2

2a+1
, (75)

which gives the general result. Finally, we remark on the regularity alternatives H1R1/2. The strategy for the proof is exactly the
same for both cases and along the same lines as for jumps above. Instead of a jump of size Ln(knn)a

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

34

at unknown location, we observe a sudden, more regular increase in t2, where we exploit the regularity a . Hence, the jump gets replaced with a gradual regular increase. However, since a < a, this is always possible on an interval of size (knn)a/a < knn, and thus the arguments are almost identical. This also highlights the fact that at (or below) the boundary bn, all three alternatives H1J and H1R1/2 are not distinguishable.

Proof of Theorem 4.3. Using similar arguments as in the proof of Theorem 3.2 and in particular Proposition A.4 one derives for

V n,i =

n kn

i j=i-kn+1

(jnX)2 - E (nj X)2

n kn

i+kn j=i+1

(nj X)2 - E (nj X)2

that under the alternatives H1J and H1R1/2, it holds that

-1 ,

kn  i  n - kn ,

knV n,i = OP 1 , kn  i  n - kn.

(76)

Based on (76), a simple estimate yields

Vn  -V n, n

n +
kn

 -OP kn -1/2


s2 ds -
-knn

+knn
s2 ds


1 - OP(1) 2

n +
kn


s2 ds -
-knn

+knn s2 ds


1 - OP(1) sup0t1 t2

.

Observe that in order to prove  (a, bn)  0, it suffices to show that

(77)

P Vn  2C and P Vn < 2C

2 log(mn)/kn  1 under H1J or H1R1/2, 2 log(mn)/kn  1 under H0.

Case H1J: Using that (t2 - t2)t[0,1]  (a, Ln) and t  0, we get

(78) (79)

n sup
kn t


s2 ds -
-knn

+knn s2 ds  bn - 2Ln (knn)a .


Hence (78) follows for (34) with (77). Case H1R1/2: We consider H1R1 here, the proof for H1R2 follows the same strategy and is omitted.
For t2  SR1 a, a , bn, Ln, C , we have that

2+h  2 + Cha or 2+h  2 - Cha , for 0  h  (bn)1/a.

Since (bn)1/a  knn and (t2)t[0,1]  (a, Ln), it follows that

n kn


s2 ds -
-knn

+knn s2 ds


Cn 
kn

knn sa ds - Ln (knn)a
0



C 1+a

(knn)a

- Ln (knn)a .

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

35

Thus, using Ln = O (n/kn)a-a , for sufficiently large n the above is bounded from below by bn. Therefore (78) follows with (77).

Case H0: Under the hypothesis we employ the upper bound

Vn



max
knin-kn

V

n,i

+

Ln(knn)a

to prove (79). (33) implies

2C 2 log(mn)/kn  2 2 log(mn)/kn + Ln(knn)a,

and hence it suffices to show that P maxknin-kn V n,i  2 log(mn)/kn  1. This, however, follows from a very easy adaption of Theorem 3.2. Hence (79) follows, which completes the
proof.

Appendix D: Proofs of Section 5

Proof of Proposition 5.1. We use the following elementary lemma to prove Proposition 5.1.

Lemma D.1. Let f (t) and g(t) be functions on [0, ] such that f (t) is increasing. As long as f () - f ( - )  sup0t |g(t)| for some   [0, ], we have that
argmax0t f (t) + g(t)   - .
An analogous result holds if f (t) and g(t) are functions on [, 1] and f (t) is decreasing.
For   (0, 1) define i = n , the smallest integer such that in is larger or equal than . While (t2)t[0,1] is the squared volatility process containing one jump at time , denote by (~t2)t[0,1] the same path without jump, such that
i2n = ~i2n + 1(i  i)
with jump size . Without loss of generality, we assume  > 0. Define

f in



 0,





 =

(i + kn - i)kn-1/2

 



 

kn

if i + kn < i, for i = i - kn, . . . , i , if i > i,

(80)

and (f (t))t[0,1] the associated piecewise constant increasing step function. For i = kn, . . . , n - kn:

i i+kn

n(nj X)2 -

n(nj X)2

j=i-kn+1

j=i+1

i i+kn

=

n(nj X)2 - E[n(nj X)2] -

n(jnX)2 - E[n(jnX)2]

j=i-kn+1

j=i+1

i i+kn

+

E[n(jnX)2] - ~j2n -

E[n(nj X)2 - j2n ]

j=i-kn+1

j=i+1

i

i+kn

i+kn

i+kn

+

~j2n -

~j2n -

j2n- ~j2n =: Ain + Bin + Cin -

j2n - ~j2n ,

j=i-kn+1

j=i+1

j=i+1

j=i+1

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

36

with the obvious definition using the curly brackets. Thus, for the step function (g(t))t[0,1], with

g in = kn-1/2

i

i+kn

i+kn

n(nj X)2 -

n(jnX)2 +

i2n - ~i2n

j=i-kn+1

j=i+1

j=i+1

for i = kn, . . . , n - kn and g(in) = 0 else, we have that

kn g in = An,i + Bn,i + Cn,i + Dn,i ,

i+kn

- Dn,i =

j2n - ~j2n - i2n - ~i2n

j=i+1

i+kn
= j2n - i2n + ~i2n - ~j2n .
j=i+1

Exploiting the smoothness of (t)t[0,1] by Assumption 3.1, we obtain

i+kn

max Dn,i
i=1,...,n

=

max
i-knii

Dn,i



K

sup
0s1

|s|

max
i-knii

j=i+1

|jn

-

in |

 K sup |s|kn1+an-a = Oa.s. kn log(n) ,
0s1

with some constant K by (17). Proceeding similarly as in the proof of Theorem 3.2, it follows that

max An,i + Bn,i + Cn,i
i=1,...,kn

= OP

Altogether, we conclude that

kn log(n) .

(81)

sup g(t) = OP log(n) .
t[0,]

(82)

Finally, using (80), we see that f (in) > |g(in)| > 0 holds for each i = i - kn/2, . . . , i, with probability tending to 1. In particular,

Vn,i = f in + g in = f in + sign g(in) g in

(83)

for those i. Furthermore,

f (in) - f (in - n) = nn kn-1/2 for n  [0, kn/(2n)] .

Thus, we choose n such that

kn log(n) n

=O

n

.

(84)

Now the assumptions of Lemma D.1 are fulfilled, and we obtain, with probability tending to one,

in  argmaxi=kn,...,i Vn,i n  in - n,

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility
through an application of Lemma D.1 together with (83). A similar argument for i > i shows in  argmaxi=i,...,n-kn Vn,i n  in + n,
from which one obtains |n - in| = OP n , which completes the proof by definition of i.

37

Proof of Proposition 5.3. Suppose that

knn = O log(n)

(85)

and we have a consistent estimator  for . Define

n T = kn

n-1 j=n-kn

nj X

n+kn
2-
j=n+1

jnX 2

.

(86)

Using the statistic T, we can now test for jumps in the volatility t2. Notethat due to (85), it readily follows that this new test has a detection boundary bn = O log(n)/ kn . This, however, is a contradiction to Theorem 4.1, and hence such an estimator  cannot exist.

References
A®it-Sahalia, Y. and J. Jacod (2009). Testing for jumps in a discretely observed process. The Annals of Statistics 37(1), 184≠222.
A®it-Sahalia, Y. and J. Jacod (2010). Is Brownian motion necessary to model high-frequency data? The Annals of Statistics 38(5), 3093≠3128.
Alvarez, A., F. Panloup, M. Pontier, and N. Savy (2012). Estimation of the instantaneous volatility. Statistical Inference for Stochastic Processes 15(1), 27≠59.
Andersen, T. G. and T. Bollerslev (1998). Answering the skeptics: Yes, standard volatility models do provide accurate forecasts. International Economic Review 39, 885≠905.
Andrews, D. W. K. (1993). Tests for parameter instability and structural change with unknown change point. Econometrica 61(4), 821≠56.
Aue, A., S. Ho®rmann, L. Horva¥th, and M. Reimherr (2009). Break detection in the covariance structure of multivariate time series models. The Annals of Statistics 37(6B), 4046≠4087.
Bai, J. and P. Perron (1998). Estimating and testing linear models with multiple structural changes. Econometrica 66(1), 47≠78.
Barndorff-Nielsen, O. E. and N. Shephard (2002). Econometric analysis of realized volatility and its use in estimating stochastic volatility models. Journal of the Royal Statistical Society 64(2), 253≠280.
Bobkov, S. G., G. P. Chistyakov, and F. Go®tze (2013). Rate of convergence and Edgeworth-type expansion in the entropic central limit theorem. The Annals of Probability 41(4), 2479≠2512.
Brown, L. D. and M. G. Low (1996). Asymptotic equivalence of nonparametric regression and white noise. The Annals of Statistics 24(6), 2384≠2398.
Cso®rgo, M. and L. Horva¥th (1997). Limit theorems in change-point analysis. Wiley Series in Probability and Statistics. John Wiley & Sons, Ltd., Chichester. With a foreword by David Kendall.
Gatheral, J., T. Jaisson, and M. Rosenbaum (2014). Volatility is rough. Preprint, arXive: 1410.3394. Hinkley, D. V. (1971). Inference about the change-point from cumulative sum tests. Biometrika 58,
509≠523.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

38

Hoffmann, M. and R. Nickl (2011). On adaptive inference and confidence bands. The Annals of Statistics 39(5), 2383≠2409.
Iacus, S. M. and N. Yoshida (2012). Estimation for the change point of volatility in a stochastic differential equation. Stochastic Processes and their Applications 122(3), 1068≠1092.
Ingster, Y. I. (1993). Asymptotically minimax hypothesis testing for nonparametric alternatives i, ii, iii. Mathematical Methods of Statistics 2(4), 85≠114; 171≠189; 249≠268.
Ingster, Y. I. and I. A. Suslina (2003). Nonparametric goodness-of-fit testing under Gaussian models, Volume 169 of Lecture Notes in Statistics. Springer-Verlag, New York.
Jacod, J. (1997). On continuous conditional Gaussian martingales and stable convergence in law. Se¥minaire de Probabilitie¥s, Strasbourg, tome 31, 232≠246.
Jacod, J. (2008). Asymptotic properties of realized power variations and related functionals of semimartingales. Stochastic Processes and their Applications 118(4), 517≠559.
Jacod, J. and P. Protter (2012). Discretization of processes. Springer. Jacod, J. and M. Rosenbaum (2013). Quarticity and other functionals of volatility: efficient estimation.
The Annals of Statistics 41(3), 1462≠1484. Jacod, J. and V. Todorov (2010). Do price and volatility jump together? The Annals of Applied
Probability 20(4), 1425≠1469. Komlo¥s, J., P. Major, and G. Tusna¥dy (1975). An approximation of partial sums of independent RV's
and the sample DF. I. Z. Wahrscheinlichkeitstheorie und Verw. Gebiete 32, 111≠131. Komlo¥s, J., P. Major, and G. Tusna¥dy (1976). An approximation of partial sums of independent RV's,
and the sample DF. II. Z. Wahrscheinlichkeitstheorie und Verw. Gebiete 34(1), 33≠58. Loader, C. R. (1996). Change point estimation using nonparametric regression. The Annals of Statis-
tics 24(4), 1667≠1678. Mancini, C. (2009). Non-parametric threshold estimation for models with stochastic diffusion coeffi-
cient and jumps. Scandinavian Journal of Statistics 36(4), 270≠296. Marsaglia, G., W. W. Tsang, and J. Wang (2003). Evaluating Kolmogorov's distribution. Journal of
Statistical Software 8(18), 1≠4. Mu®ller, H.-G. (1992). Change-points in nonparametric regression analysis. The Annals of Statis-
tics 20(2), 737≠761. Mu®ller, H.-G. and U. Stadtmu®ller (1999). Discontinuous versus smooth regression. The Annals of
Statistics 27(1), 299≠337. Mykland, P. and L. Zhang (2009). Inference for continuous semimartingales observed at high fre-
quency. Econometrica 77(5), 1403≠1445. Mykland, P. A. (2012). A Gaussian calculus for inference from high frequency data. Annals of
Finance 8, 235≠258. Page, E. S. (1955). A test for a change in a parameter occurring at an unknown point. Biometrika 42,
523≠527. Pettitt, A. N. (1980). A simple cumulative sum type statistic for the change-point problem with zero-
one observations. Biometrika 67(1), 79≠84. Phillips, P. C. B. (1987). Time series regression with a unit root. Econometrica 55(2), 277≠301. Sakhanenko, A. I. (1996). Estimates for the accuracy of constructions on a probability space in the
central limit theorem. Rossiiskaya Akademiya Nauk. Sibirskoe Otdelenie. Institut Matematiki im. S. L. Soboleva. Sibirskii Matematicheskii Zhurnal 37(4), 919≠931, iv. Spokoiny, V. G. (1998). Estimation of a function with discontinuities via local polynomial fit with an adaptive window choice. The Annals of Statistics 26(4), 1356≠1378. Tauchen, G. and V. Todorov (2011). Volatility jumps. Journal of Business and Economic Statistics 29, 356≠371.

Bibinger, Jirak, Vetter/Nonparametric change-point analysis of volatility

39

Vetter, M. (2012). Estimation of correlation for continuous semimartingales. Scandinavian Journal of Statistics 39(4), 757≠771.
Wu, W. B. (2007). Strong invariance principles for dependent random variables. The Annals of Probability 35(6), 2294≠2320.
Wu, W. B. and Z. Zhao (2007). Inference of trends in time series. Journal of the Royal Statistical Society. Series B. Statistical Methodology 69(3), 391≠410.
Zaitsev, A. Y. (1987). On the Gaussian approximation of convolutions under multidimensional analogues of S. N. Bernstein's inequality conditions. Probability Theory and Related Fields 74(4), 535≠566.

SFB 649 Discussion Paper Series 2015

For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.

001 002
003
004 005
006 007 008

"Pricing Kernel Modeling" by Denis Belomestny, Shujie Ma and Wolfgang Karl H‰rdle, January 2015. "Estimating the Value of Urban Green Space: A hedonic Pricing Analysis of the Housing Market in Cologne, Germany" by Jens Kolbe and Henry W¸stemann, January 2015. "Identifying Berlin's land value map using Adaptive Weights Smoothing" by Jens Kolbe, Rainer Schulz, Martin Wersing and Axel Werwatz, January 2015. "Efficiency of Wind Power Production and its Determinants" by Simone Pieralli, Matthias Ritter and Martin Odening, January 2015. "Distillation of News Flow into Analysis of Stock Reactions" by Junni L. Zhang, Wolfgang K. H‰rdle, Cathy Y. Chen and Elisabeth Bommes, January 2015. "Cognitive Bubbles" by Ciril Bosch-Rosay, Thomas Meissnerz and Antoni Bosch-DomËnech, February 2015. "Stochastic Population Analysis: A Functional Data Approach" by Lei Fang and Wolfgang K. H‰rdle, February 2015. "Nonparametric change-point analysis of volatility" by Markus Bibinger, Moritz Jirak and Mathias Vetter, February 2015.

SFSBF6B4694, 9S,pSapnadnaduaeureSrtrSatﬂraeﬂ1e, 1D,-D10-1107187B8eBrleinrlin htthpt:t/p/:/s/fbs6fb4694.w9.iwwiiw.hiu.h-bue-brleinrl.idne.de
ThTishrisesreasrecahrcwhawsassupsuppoprtoerdtebdybtyhethDeeDuetsucthseche ForFsocrhsuchnugnsgesgmeeminesicnhsachftatfht rtohuroguhgthhethSeFSBF6B4694"9Ec"oEnconmoimc RicisRki"s.k".

