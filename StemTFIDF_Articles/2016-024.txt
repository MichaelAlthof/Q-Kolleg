BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2016-024
Simultaneous Inference for the Partially Linear Model
with a Multivariate Unknown Function when
the Covariates are Measured with Errors
Kun Ho Kim* Shih-Kang Chao*² Wolfgang K. Härdle*³
* Hanyang University, South Korea *² Purdue University, United States of America
*³ Humboldt-Universität zu Berlin, Germany This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Simultaneous Inference for the Partially Linear Model with a Multivariate Unknown Function when the Covariates are Measured
with Errors

Kun Ho Kim

Shih-Kang Chao July 25, 2016

Wolfgang K. Ha¨rdle§

Abstract
In this paper, we analyze the nonparametric part of a partially linear model when the covariates in parametric and non-parametric parts are subject to measurement errors. Based on a two-stage semi-parametric estimate, we construct a uniform confidence surface of the multivariate function for simultaneous inference. The developed methodology is applied to perform inference for the U.S. gasoline demand where the income and price variables are measured with errors. The empirical results strongly suggest that the linearity of the U.S. gasoline demand is rejected.
Key words: Measurement error, Partially linear model, Regression calibration, Non-parametric function, Semi-parametric regression, Uniform confidence surface, Simultaneous inference, U.S. Gasoline demand, Non-linearity JEL Classifications: C12, C13, C14

The authors gratefully acknowledge financial support from the Deutsche Forschungsgemeinschaft through the International Research Training Group IRTG 1792 "High Dimensional Non Stationary Time Series" and the Collaborative Research Center CRC 649 "Economic Risk".
Department of Economics and Finance, Hanyang University, Seoul, South Korea. E-mail: kunhokim8@gmail.com. Tel: +82-2-2220-1022.
Department of Statistics, Purdue University, West Lafayette, IN 47906, U.S.A. E-mail: skchao74@purdue.edu. Tel: +1 (765) 496-9544. Fax: +1 (765) 494-0558. Partially supported by Office of Naval Research (ONR N00014-151-2331).
§Ladislaus von Bortkiewicz Chair of Statistics, C.A.S.E. - Center for applied Statistics and Economics, HumboldtUniversita¨t zu Berlin, Unter den Linden 6, 10099 Berlin, Germany. Email: haerdle@wiwi.hu-berlin.de. Sim Kee Boon Institute for Financial Economics, Singapore Management University, 50 Stamford Road, Singapore 178899, Singapore.
1

1 Introduction

Partially linear models are welcome compromise between a pure nonparametric and a sometimes too restricted parametric specification. The semi-parametric structure makes it not only possible to include discrete predictors but also creates a chance of parts of the model to be estimated with high precision. These and other reasons have made this model class very successful, e.g. H¨ardle et al. (2000). In several applications though, one has a data structure that is not covered by the inferential analysis of the literature so far.
To be more specific, consider the semi-parametric model:

Yi = Si  + g(Ti) + i, Si = Zi + i, Ti = Xi + i

(1.1)

where Yi is a scalar random variable, Si is a ( ×1) random vector, and Ti is a (d×1) random vector for i = 1, · · · , n, respectively. In addition, i is a mean zero IID random error for each i. Here  and g(·) are a ( × 1) vector of unknown parameters and an unknown smooth function, respectively. Let S and T be unobserved due to measurement errors i and i. However, Zi, Xi and Yi are observed. The observed covariates Zi and Xi, error and measurement errors are mutually independent. Here i and i have zero means and finite variances, and i has zero mean and covariance matrix , which does not have to be known and is considered an improvement from the literature (Koul and Song, 2010). The distribution of i is assumed to be known. The measurement errors i and i are called the Berkson measurement error (Berkson (1950)) and are used typically in situations where true individual observations are not available but the average for the group where the individuals belong is available. See Section 1.1. for the justification of using Berkson errors in our model framework. The model (1.1) is widely used due to its flexibility to combine the parametric linear part Si  and the non-parametric non-linear component g(Ti). See Ha¨rdle et al. (2000) for more on the partially linear model framework.
The important aspect of (1.1) is that it allows the covariates to be measured with errors. It is well-known that economic variables, such as income and price variables, are often measured with some degree of inaccuracy. For example, (1.1) could represent a demand function for certain goods, where Ti is a (2 × 1) vector of income and price variables, respectively. The income and price variables in g(·, ·) are likely to be measured with errors because individuals are usually unwilling to reveal their true incomes and because the prices are often estimated rather than observed directly. The framework (1.1) can address this issue effectively. Section 1.1. discusses this in detail and also explains why the Berkson error assumption particularly fits the income and price variables used in our study. Given that economic theory usually provides little guidance for how to model the demand function (Blundell et al. (2012)), one could borrow a partially linear semi-parametric structure in the error-in-variable setting, such as (1.1). For these reasons, (1.1) could be a reasonable approximation for the true underlying demand function, among others.
Under the framework (1.1), our goal is to test the hypothesis on g(·), such that:

H10 : g(t) = g0(t), t  Rd

(1.2)

where g0(·) is some known real-valued function. For instance, g(t) could stand for a true demand function while g0(t) is a parametric log-linear demand function that is commonly used in the

1

economics literature. That is, the validity of the widely used log-linear demand structure can be checked by testing the hypothesis (1.2) under (1.1). If the null hypothesis is accepted, then the traditional log-linear demand function is justified. Otherwise, one needs to search for another framework that fits the demand structure better than the simple log-linear framework. The loglinear demand function for gasoline, subject to Berkson measurement errors, is discussed in detail in Section 3.1.
In the literature on measurement error models, regression calibration (Carroll et al. (1995)) is widely used to deal with the error-contaminated covariates. Under the assumptions,

E(Y |Zi = z, Xi = x) = z  + µ(x)
where µ(x) d=ef E[g(Ti)|Xi = x]. Thus, we are led to the following calibrated partially linear regression model:

Yi = Zi  + µ(Xi) + i

(1.3)

where i d=ef g(Ti) - µ(Xi) + i  + i. Note here that E( i|Zi = z, Xi = x) = 0 due to µ(x) = E[g(Ti)|Xi = x]. That is, i is uncorrelated with Zi and Xi. However, i is still dependent on Xi. The transformation of (1.1) to (1.3) is called the regression calibration, and is an effective way to
deal with measurement errors because the covariates in (1.3) are observed.
Since the distribution of i is known, a test of H10 can be carried out by testing the following hypothesis instead:

H20 : µ(x) = µ0(x), x  X

(1.4)

where µ0(x) d=ef E[g0(Ti)|Xi = x] and X is the compact range of Xi in (1.3). Under Berkson errors, Xi typically represents the observed average for a group of unobserved individual observations, such as individual incomes belonging to a certain income bracket. Hence the assumption of a compact range X makes sense. Clearly, H10 implies H20 although the converse is not true in general. However, if the family of densities f(·) for i is complete, then E[g(Ti) - g0(Ti)|Xi = x] = 0 for all x implies g = g0 almost surely. For more on the regression calibration under measurement errors, we refer to Koul and Song (2008), Koul and Song (2010), among others.
To perform inference for H20 in (1.4), we construct the uniform confidence surface (U CS) of µ(·) in (1.3) and observe whether the U CS contains the parametric specification under the null hypothesis. The construction of the U CS with confidence level 100(1 - )%,   (0, 1), requires us to find two functions fn(·) and gn(·) based on data, such that:

lim
n

P{fn(x)



µ(x)



gn(x)

for

all

x



X

}

=

1

-



(1.5)

Given the U CS of µ(·), one can test H20 by checking whether fn(x)  µ0(x)  gn(x) holds for all x  X . If the condition does not hold for some x  X , then we reject H20 at level , which leads to the rejection of H10 as well. That is, even if the condition holds for all x  X except for only one, the null hypothesis still gets rejected by the test.

2

1.1 Why Berkson measurement errors?
The innovation of this paper is to perform uniform inference of (1.1) under the presence of Berkson errors in the covariate terms. Hence it is essential to justify the use of Berkson errors in (1.1). To explain why such errors are used here, we consider the two different error structures:

Ti = Xi + i

(1.6)

Xi = Ti + i

(1.7)

where Ti is the "unobserved" true process and Xi is the "observed" proxy in (1.1). Here (1.6) is the framework with the Berkson measurement error used by the current study, while (1.7) is the classical measurement error structure. Typically, (1.6) fits better than (1.7) if the true individual observations are not available but the average value for the group where the individuals belong is available. We argue that the framework (1.6) is a good fit for the household income and gasoline price variables used in this study for the following reasons.
In our data set, the observations for the income variable are collected through household survey. Each surveyed individual is asked to choose the category where their true annual income belongs. For example, if the true income is 7,000 U SD per year for a household, then the respondent chooses the 5,000 U SD­ 9,999 U SD category, instead of reporting the true income. That is, we only get to observe such categorical data for the household income, not the true numerical values. In this situation, the "midpoint" of each category is typically taken as the value for the income variable, which certainly fits the framework (1.6) better than (1.7). In other words, the household-specific true but unavailable income T fluctuates randomly around the available group average X, resulting in Berkson-type errors. A similar example can be found in an epidemiological study in which an individual's true exposure to some contaminant is not observed, but instead, what is available is the average concentration of the contaminant in the region where the individual lives (Schennach (2013)).
Similarly, (1.6) is also a potentially better structure for the gasoline price variable than (1.7). The data set used in this study does not include the gasoline price data observed directly from gas stations. Instead, each household reports their "approximate" total annual expenditure on gasoline and the total gallons of gasoline purchased each year. Then, the gasoline price is obtained through dividing the total expenditure by the the total gallons purchased. As argued in Hyslop and Imbens (2001) and also emphasized in Schennach (2013), individuals reporting data on their own are typically aware of the uncertainty in their estimates and, as a result, tend to report an "average" over all possible estimates consistent with the information available to them. In our case, each respondent is unlikely to report the exact total expenditure on gasoline, and instead likely to report the midpoint of the plausible range of expenditure, thus leading to Berkson-type errors for the gasoline price variable as well. For these reasons, we believe that (1.6) is a reasonable representation of the error structure for the variables used in gasoline demand, such as the household income and the gasoline price variables.
The organization of the paper is the following: Section 2 introduces the methodology proposed to perform uniform inference of the partially linear model. We first employ a two-step procedure

3

to estimate the model and then carry out the construction of uniform confidence surface (U CS)

based on the estimates. Both the asymptotic-based and simulation-based constructions of U CS

are introduced. Section 3 handles an application of the proposed methodology. We estimate and

perform inference of a semi-parametric and partially linear gasoline demand function for the U.S.

economy. The data are explained and the empirical results are discussed in detail as well. Section

4 concludes the paper and discusses related future research. The mathematical proofs regarding

the uniform inference are relegated to Appendix.

Notations. For any vector v = (v1, v2, . . . , vp)  Rp, we let |v| =

p i=1

vi2

1/2.

For

any

random

vector V, we write V  Lq (q > 0) if V q = [E (|V|q)]1/q < . In particular, V = V 2. In

addition, we write an bn if |an/bn| is bounded away from 0 and  for all large n. For brevity,

we sometimes write supx U (x) for supxX U (x).

2 Methodology
Inference for (1.3) depends on the estimates of  and µ(·). Given the semi-parametric structure of (1.3), it is natural to employ a two-step method to estimate the unknowns. That is, the parametric part of the model is first estimated, and then the estimate is used for the estimation of the nonparametric component. For an application of the two-step methodology to economic issues, see Kim (2016) among others. The smoothness condition on µ(·) ensures that the simultaneous inference for the true underlying process is feasible in this study.

2.1 Estimation of  and µ(·)

To estimate the parameter vector  in (1.3), we employ the Robinson estimator (Robinson (1988)). The estimator is widely used in estimating the parameters in a semi-parametric framework, such as (1.3). To implement the estimation, we first define:

Yi# = Yi - E (Yi|Xi) Zi# = Zi - E (Zi|Xi)

where Yi# = Z#i  + i due to (1.3) and E ( i|Xi) = 0. Naturally, Yi# and Z#i can be estimated using the Nadaraya-Watson estimator (Nadaraya (1964); Watson (1964)):

Yi# = Yi - g (Xi) Z#i = Zi - f (Xi)

where

g(x) =

n i=1

Yi

K

x-Xi h

n i=1

K

x-Xi h

,

f (x) =

n i=1

ZiK

x-Xi h

n i=1

K

x-Xi h

.

Here K{(x - Xi)/h} = K((x1 - X1i)/h) × · · · × K((xd - Xdi)/h), where K(·) is a kernel function and h is a smoothing parameter, called the bandwidth. Then, the Robinson estimate R is defined

4

by:

R d=ef

n
Z#i Zi#

-1 n
· Z#i Yi# .

(2.1)

i=1 i=1

 Robinson (Robinson (1988)) shows that this estimate is n-consistent to the true parameter.

Given R, we are ready to estimate µ(x). By (1.3), Then, an estimate of µ(·) is obtained by the following optimization:

1n

µ(x)

=

argmin


nhd

i=1

K

x - Xi h

2
Yi - Zi R - 

(2.2)

which leads to

µ(x) d=ef

1

n
K

nhdfX (x) i=1

x - Xi h

(Yi - Zi R),

(2.3)

where fX (x)

d=ef

1 nhd

n i=1

K

x-Xi h

is a non-parametric estimate of fX , the joint density of

Xi = [X1i, · · · , Xdi]. A popular choice for the kernel function is the Epanechnikov kernel with a

compact support. The bandwidth is frequently selected by some data-driven method, such as the

generalized cross-validation (GCV ) (Craven and Wahba (1979)), which will be used in this study.

2.2 Uniform confidence surface (U CS) of µ(·)

To construct the U CS of µ(·), we adopt the methodology in Ha¨rdle (1989), Johnston (1982) and extend it to the multi-dimensional case. First, consider the optimization (2.2) when  is known:

1n

µ(x)

=

argmin


nhd

i=1

K

x - Xi h

2
Yi - Zi  -  .

(2.4)

We define

Hn(, x) d=ef

1 nhd

n

K

i=1

Hn(x) d=ef

1 nhd

n

K

i=1

x - Xi h
x - Xi h

Yi - Zi  -  Yi - Zi  - µ(x)

Then, by a Taylor expansion on Hn(x),

Hn(µ, x) = Hn(x) + {µ(x) - µ(x)} fX (x).

Since Hn(µ, x) = 0 by the first-order condition (F.O.C.) of (2.4), we have

µ(x) - µ(x) = Hn(x) fX (x)

which leads to

µ(x) - µ(x) = Hn(x) + Hn(x){fX (x) - fX (x)} .

fX (x)

fX (x)fX (x)

5

In sum,

µ(x)

-

µ(x)

=

Hn(x) - EHn(x) fX (x)

+

Rn(x)

where

Rn(x) d=ef

EHn(x) fX (x)

+

Hn(x){fX (x)-fX (x)} .
fX (x)fX (x)

Then,

by

(2.5),

nhdfX (x)

(x)

|µ(x)

-

µ(x)|



|Un(x)|

+

nhdfX (x)

(x)

|Rn(x)|

(2.5) (2.6)

where

2(x) d=ef {y - µ(x)}2 fY |X (y|x) dy

(2.7)

Un(x) d=ef

nhd 2(x)fX

(x)

(Hn(x)

-

EHn(x))

(2.8)

Here y d=ef y - z . Let  = (x) for simplicity. Then,

Un(x) =

nhd 2fX (x)

1 nhd

n
K

x - Xi h

i=1

Yi - Zi  - µ(x)

-

1 hd

E

K

x - Xi h

Yi - Zi  - µ(x)

nhd = 2fX (x)

1 hd K

x-t h

(y - µ(x)) dFn(t, y)

-

1 hd

K x - t (y - µ(x)) dF (t, y) h

1 =
hd2fX (x)

K

x-t h

(y - µ(x)) dZn(t, y)

where

Zn(x, y)

d=ef

 n

(Fn(x,

y)

-

F

(x,

y

)).

Here

Fn(·)

is

the

empirical

cumulative

distribution

function (c.d.f.) while F (·) is the true c.d.f. Moreover, we can define the following processes:

U1,n(x) =

1 hd2fX (x)

K

x-u h

(y - µ(x)) dBn {T (y, u)} ;

U2,n(x) =

1 hd2fX (x)

K

x-u h

(y - µ(x)) dWn {T (y, u)} ;

U3,n(x) =

1 hd2fX (x)

K

x-u h

(y - µ(u)) dWn {T (y, u)} ;

U4,n(x) =

1 hd2fX (x)

fX1/2(u)K

x-u h

dW (u);

U5,n(x) = h-d/2

x-u K dW (u),
h

6

where {Bn} are a sequence of Brownian bridges and {Wn} are a sequence of Wiener processes satisfying Bn T (y, u) = Wn T (y, u) - F (y, u)Wn(1, ..., 1). Here W (·) is the Wiener process and T (y, x) is the d dimensional Rosenblatt transformation (Rosenblatt, 1976):

T (y, u) = FX1|Y (u1|y), FX2|Y (u2|u1, y), ..., FXd|Xd-1,...,X1,Y (ud|ud-1, ..., u1, y), FY (y) . (2.9)

Then, from Theorem 2 of Rosenblatt (1976), suppose the volume of X is 1

P

2d log(h-1) K

sup |U5,n(x)| - dn
xX

<u

 exp (-2 exp(-u))

(2.10)

where K

=

( K2(u)du)1/2
R

and

dn

=

2d log (h-1) +  1
2d log(h-1)

1 2

(d

-

1)

log

log

h-1

+

log

2d d/2 det()
 4d

. This leads to the following proposition:

Proposition 2.1. By (2.10) and Assumption (A1)-(A6),

P

2d log(h-1) K

sup |Un(x)| - dn
xX

<u

 exp (-2 exp(-u))

Proof of Theorem 2.1. The proof follows directly by Lemma C.3­ Lemma C.8.

(2.11)

Moreover, by Lemma B.1 in the Appendix,

sup |Rn(x)| = oP
x

1 nhd log (h-1)

Then, by (2.6), (2.11) and (2.12), we obain the following theorem:

(2.12)

Theorem 2.2. Let b  0 and nb  . Then,

P

2d log(h-1) sup
K xX

nhdfX (x)

(x)

|µ(x)

-

µ(x)|

-

dn

<u

 exp (-2 exp(-u))(2.13)

where µ(x) is the infeasible estimate of µ(x) defined by (2.4).

Proof of Theorem 2.2. By (2.6),

2d log(h-1) sup
K x

nhdfX (x)

(x)

|µ(x)

-

µ(x)|

-

dn



2d log(h-1)

K

sup |Un(x)| - dn + sup
xx

2dfX

(x)nhd log(h-1) K (x)

|Rn(x)|

By (2.11) and (2.12), the theorem follows.

Since the asymptotic result (2.13) involves the infeasible estimate µ(x) that depends on the unknown , Theorem 2.2 cannot be directly applied to construct the U CS of the unknown µ(·). However, the result can be extended to derive the following theorem that can be utilized to construct the U CS of µ(·):

7

Theorem 2.3. Let b  0 and nb  . Then,

P

2d log(h-1) sup
K x

nhdfX (x)

(x)

|µ(x)

-

µ(x)|

-

dn

<u

 exp (-2 exp(-u)) (2.14)

where µ(x) is the feasible estimate of µ(x) defined by (2.3). 
Proof of Theorem 2.3. The proof follows by Theorem 2.2 and by the n-consistency of the Robinson estimator R (Robinson, 1988). We omit the detail.

By Theorem 2.3, the (1 - ) × 100% U CS of µ(x) is

 µ(x) ±

2(x)2K nhdfX (x)

dn +


q1- 2d log(h-1) 

(2.15)

where q1- = - log[-1/2 log(1 - )] is the (1 - ) × 100% quantile of the Gumbel distribution in (2.13). Here q0.95 = 3.66, det() = 25/16 and K = 0.6 for the Epanechnikov kernel. Since 2(x)
and fX (x) in (2.15) are unknown, the feasible U CS is

µ(x) ±

2(x)2K nhdfX (x)

dn +

q1- 2d log(h-1)

(2.16)

where the estimate of 2(x) is given by 2(x) d=ef 1
nhdfX (x)

n i=1

2i K

x-Xi h

and i is the residual

from the estimation of (1.3).

From Theorem 2.3, the convergence order to the asymptotic Gumbel distribution is 1/ log(n),

which means that the convergence is very slow. To that end, one can alternatively employ the

simulation-based method to construct the U CS of µ(x) by using the following property:

P sup |Zi| - dm 

u

1im

2 log(m)

 exp (-2 exp(-u))

(2.17)

where m d=ef inf{k  Z : k  h-1} and Zi are an IID standard normals and

11



dm =

2d log(m) -

log{d log(m)} + log 2  2d log(m) 2

The proof of (2.17) is given on page 98­99 of Ferguson (1996). The result is also used by Zhao and
Wu (2008). Note that (2.14) and (2.17) share the same asymptotic Gumbel distribution, which means that one can use the sampling distribution of sup1im |Zi| to replace the quantile from the Gumbel distribution. Thus, the (1 - ) × 100% U CS of (x) is approximated by:

µ(x) ±

2(x)K2 nhdfX (x)

dn +

q1-  2d log(h-1)

(2.18)

where q1-  = (q-dm) 2 log(m) and q is the (1-)×100% quantile of the sampling distribution of sup1im |Zi|. In the following application, we employ (2.18) to construct the U CS of µ(x) in (1.3).

8

3 Application

3.1 U.S. gasoline demand
As an application of the methodology developed in this work, we consider the U.S. gasoline demand. The rapid growth in the U.S. gasoline consumption has been of interest to many due to its environmental consequences and the role as an economic indicator. Several recent studies analyze demand for gasoline in the U.S./Canadian economy (Hausman and Newey (1995); Yatchew and No (2001); Blundell et al. (2012)). Schmalensee and Stoker (1999) employ the U.S. household level data and analyze the U.S. gasoline consumption. They estimate their partially linear model using 1988 and 1991 data of approximately 5, 000 observations and report a positive relationship between household income and gasoline consumption. Yatchew and No (2001) extends the earlier work to the case of Canadian gasoline consumption.
In contrast to Schmalensee and Stoker (1999) and Blundell et al. (2012), we focus on statistical inference of the non-parametric component in the model. Our model framework, which is a special case of (1.1) with d = 2, is the following:

log(T OT M ILESi) = 1 log(DRV Ri) + 2 log(V EHSi) + 3 log(HHSIZEi) + 4 CHILDi + 5 SEXi + 6 RU RALi + 7 Region + g (log(IN COM Ei), log(P RICEi)) + i

(3.1)

where TOTMILESi is total miles traveled by household i, INCOMEi is annual household income in U.S. dollars for household i and PRICEi is estimated gasoline price. Here DRVRi, VEHSi and HHSIZE are regressors that represent the number of drivers, vehicles and family members for household i, respectively. The other regressors are dummy variables such that CHILDi = 1 for a household with a child, SEXi = 1 for a female respondent, and RURALi = 1 for a household residing in a rural area. The region dummy Region is a vector of dummy variables that represents different regions of the U.S. In total, there are nine different region dummy variables. The dummy variables take either 1 or 0. The descriptions and the summary statistics for these variables are given by Table 1.
As discussed in detail in Section 1.1., the household income and gasoline price variables in g(·, ·) of (3.1) are likely to be contaminated by Berkson-type errors. When households are surveyed regarding their annual incomes, they are typically asked to choose the right "categories" for their incomes, rather than to report the exact amounts. When using the data in practice, the median values for each category are taken for estimation, which leads to the unobserved true income randomly fluctuating around the observed median. This clearly represents Berkson-type errors. Similarly, the gasoline price data are likely to be contaminated with Berkson errors as well, since they are based on "self-reported" household expenditure data. In this study, the gasoline price data are obtained through dividing a household's total annual expenditure on gasoline by the total gallons of gasoline purchased each year, because the directly observed data on price are not available from the original source. Since the self-reported expenditure is likely to be an average of all possible estimates over the plausible range (Hyslop and Imbens (2001)), we naturally introduce Berksontype errors into the gasoline price estimates here. For these reasons, the methodology developed

9

in this study can be readily used to perform simultaneous inference for the unknown g(·, ·) in the gasoline demand equation (3.1) where the covariates are possibly measured with Berkson errors.
3.2 Data
The household survey data for model (3.1) are from the Residential Transportation and Energy Consumption Surveys (RT ECS), which are a series of detailed household surveys on driving behavior and vehicle ownership collected by the U.S. Department of Energy, beginning 1979. The surveys are carried out every three years. The survey used in this paper was conducted in year 2001. That is, the data set used in our study is an updated version of the data used by Schmalensee and Stoker (1999). The total number of observations in our sample is 22, 178. In this study, we only consider the observations from the households with non-zero number of miles driven, drivers, and cars owned.
The response variable in the gasoline demand is either total miles traveled or consumption of gasoline each year. Observations on mileage driven in each year were collected directly from odometer readings. These observations were then combined with estimated miles-per-gallon figures for each vehicle owned to construct total gallons of gasoline demanded. For the income variable in (3.1), households report their annual income in one of 9 ranges (in thousands of dollars). We take the midpoint of each interval. The lowest income category is "less than $5,000". For the highest income category (income over $75, 000), we use the conditional median for national household income above $75, 000, which is approximately $100, 000. The gasoline price is obtained by dividing the total household expenditure on gasoline by the total gallons of gasoline demanded each year.
Number of drivers in each household is categorized into "1", "2", "3", and "4 or more drivers". Similarly, number of family members HHSIZE is categorized into "1", "2", "3", "4", "5", and "6 or more persons". Number of vehicles used by each household is categorized in a similar way. The region dummy variables cover the nine different partitions of the U.S. territory. The names for each region are provided by Table 1. For example, if a certain household belongs to the New England region, then the first region dummy variable for that household takes on one, while the other region dummies for the same household take on zero.
3.3 Empirical results
The summary statistics for the variables in (3.1) are provided by Table 1. They include the mean and standard deviation of each variable and the OLS estimate and its standard error for the corresponding coefficient. Except for the gender dummy and the gasoline price variable, the OLS estimates are positive. The negative coefficients for the gasoline price variable and the gender dummy indicate that the rising gasoline price makes consumers to switch to other energy sources and that male consumers tend to consume more gasoline than their female counterparts. The corresponding t-statistics are very high, which indicates that the variables in (3.1) are statistically very significant with small p-values.
The estimation and uniform inference results for the non-parametric portion of (3.1) are presented by Figs 1­3. In particular, Figs 2 and 3 show the estimated µ(x) (i.e. the solid curve) in (1.3) and its corresponding 95 percent uniform confidence surface (U CS) (i.e. the surrounding
10

dotted band). Here x1 refers to the household income, while x2 represents the gasoline price. Because the true income and price variables are not observed due to the measurement errors here, the estimation of gasoline demand is based on the calibrated model (1.3) instead of the true model (3.1).
Fig.2 represents the two-dimensional relationship between gasoline demand and gasoline price when the household income is fixed at a certain percentile, while Fig.3 represents the relationship between the gasoline demand and household income when the gasoline price is fixed instead. As the traditional demand theory in economics predicts it, Fig.2 shows that the gasoline demand decreases in its price for all three percentiles of income. In contrast, Fig.3 illustrates that the gasoline demand rises in household income regardless of the percentile of price. Interestingly, we can see that the slope of gasoline demand in household income is generally steeper than that in gasoline price. The slope in demand also depends on the percentile of income or that of price, as we observe it from Figs 2 and 3. However, the general trend appears to hold true regardless of the corresponding percentile.
In order to accept the null hypothesis of linearity for g(·, ·) in (3.1), which is a common assumption in demand analysis, one should be able to insert a straight line into the constructed U SC in "all" of the panels in Figs 2­3. That is, if one cannot insert a straight line into all of the constructed U SCs in Figs 2­3, then the linearity of µ(·, ·) is rejected at 5 percent level (and thus the linearity of g(·, ·) is rejected as well). Obviously, the U CSs presented in Fig.3 cannot contain any straight line in them because of the non-linearity of the estimates and of the corresponding U CSs. Hence the linearity hypothesis for g(·, ·) in (3.1) is clearly rejected at 5 percent level for the reasons discussed in the introduction of the paper.
4 Concluding Remarks
The paper illustrates how to conduct the uniform inference of a semi-parametric non-linear model when the covariate terms are contaminated by Berkson measurement errors. To that end, we employ the regression calibration (Carroll et al. (1995)) to transform the model into the one with observable covariate terms, and base the inference on the transformed one instead. The inference of the transformed model is conducted through the construction of uniform confidence surface, which is a multi-dimensional extension of the two-dimensional uniform confidence band (H¨ardle (1989), Johnston (1982); Kim (2016)). The relating asymptotic properties of the introduced methodology are investigated. The methodology is then applied to perform inference of the linearity of U.S. gasoline demand. The study shows that the linearity hypothesis is rejected at 5 percent level, mainly due to the non-linear relationship between the U.S. gasoline consumption and the household income.
Regarding future research, this project suggests a couple of interesting topics for consideration. One of them is to extend the current work to the case of time series. Unlike the cross section one considered in this study, time series data inherently possess temporal dependence among them. This would require a different framework to handle the issue of measurement error. Another potential extension is to consider the classical measurement error structure. Due to the nature of the available data in this study, we assume that the model covariates are contaminated by Berkson-type errors.
11

Instead, one can assume that the error structure is the classical one and perform uniform inference of the model, accordingly. Further insight can be gained by extending the current work in these and other possible directions.

Appendices
In the appendix, we provide the technical details for the theoretical results given in the main text. Section A presents the assumptions. Section B and C contain the proof for the theorems in the main text. Section D lists some useful results for proving our theory.

A Assumptions

Let n = {y : |y|  an}. n2(x) = E (Y  - µ(x))21(Y   n)|X = x and n2 = E (Y  - µ(x))21(Y   n)|X = x . Denote the vector of ones and zeros by l = (1, ..., 1) and 0 = (0, ..., 0).
The following assumptions are assumed to hold for Theorem 2.2.
(A1) K is of order s - 1 (see (A3)) has bounded support [-A, A]d, is continuously differentiable up to order d with bounded derivatives, i.e. K = 12...dK  L1(Rd) exists and is continuous for all multi-indices  = (1, ..., d)  {0, 1}d
(A2) Given an (h-3d log n)1/(b1-2)   for some b1 > 2, it holds that (i) 0 < supxX y - µ(x) b1 fY |X (y|x)dv < . (ii) There exists C > 0 such that

1/2

h-3d log n sup

y2fY |X (y|x)dy

xX {|y|>an}

 C,

(A.1)

(iii) n-1/6h-d/2an = O(n- ), for some constant  > 0. (A3) The function µ(x) is continuously differentiable and is in H¨older class with order s > d.

(A4) fX (x) is bounded, continuously differentiable and its gradient is uniformly bounded. More-

over, infxX fX (x) > 0 for domain X .

(A5) The joint probability density function f (y, x) is bounded and continuously differentiable up

to sth order (needed for Rosenblatt transform). The conditional density fY |X (y|x) exists

and is boudned and continuouly differentiable with respect to x.

(A6)

h

satisfies

 nhdhs

 log

n



0

(undersmoothing),

and

nh3d(log n)-2

 .

Assumption (A1) gives constraint on the kernel function, and is satisfied by popular kernels such as Epanechnikov and quartic. The moment condition of the model error (A2)(i), and the tail moment condition of the response variable (A2)(ii) are similar to those in the simultaneous confidence band literature such as Johnston (1982) and Ha¨rdle (1989). The condition (A2)(iii) is necessary for bounding the strong approximation error, which is given by Theorem 3.2 of Dedecker et al. (2014). (A3)-(A5) are similar to those required by Johnston (1982) and Ha¨rdle (1989). (A6) implies undersmoothing.

12

B Bound for Rn
Lemma B.1. Under assumptions (A1)-(A6), suppose i is bounded almost surely, then Rn(x) = oP nhd log(n) -1/2

(B.1)

Proof.

Recall

that

Rn(x) =

EHn(x) fX (x)

+

Hn(x)(fX (x)-f (x)) .
fX (x)f (x)

Then,

sup |Rn(x)|  sup
xx

EHn(x) fX (x)

+ sup
x

Hn(x) fX - fX (x) fX (x)fX (x)

By Theorem 1.4 in Li and Racine (2007) and (A4),

(B.2)

Then, by (B.3),

sup fX (x) - fX (x) = OP h2 +
x

log(n) nh2

(B.3)

sup
x

fX (x) - fX (x) fX (x)fX (x)

supx fX (x) - fX (x)

 infx fX (x)(fX (x) -

n) = OP

h2 +

log(n) nh2

(B.4)

where fX (x) - fX (x)  n and n  0 in probability from (B.3). This leads to fX (x) - n  fX (x), where fX (x) - n > C for some constant C > 0 for sufficiently large n. Moreover,

EHn(x) = h-dE K

x - Xi h

(µ (X) + i - µ(x))

= h-dE K

x - Xi h

(µ (X) - µ(x))

= h-d K x - t (µ (t) - µ(x)) f (t)dt h

h-d

x-t K
h

x-t

s 

f

(t)dt

h-d+s

x-t K f (t)dt

h

= hs K(u)f (x - u)du

= O(hs)

where the fourth inequality follows by assumption (A1) and (A3); the fifth inequality is from the bounded support of K(·) assumed in (A1); the sixth inequality is from change of variable, and the final rate is obtained by the summability condition of K(·) from (A1) and the bounded fX (x) from (A4). Thus,

sup |EHn(x)| = O(hs)
x

(B.5)

13

Furthermore,

sup |Hn(x)|  sup |Hn(x) - EHn(x)| + sup |EHn(x)| ,

xx

x

(B.6)

where supx |Hn(x) - EHn(x)| = OP((log n/nhd)1/2) from an application of Bernstein inequality, and a truncation argument to i as in the proof for Theorem 2 of Hansen (2008). Then in view of (B.2) and (B.4)­(B.6),

sup |Rn(x)| = OP hs +
x

log(n) nhd

h2 +

log(n) nh2

,

note that by (A6) we have hs nhd log n  0. Hence the lemma follows.

C Proof of Proposition 2.1

The steps of the proof mainly follow Chao et al. (2016).

Un(x) = U0,n(x) = U1,n(x) =

1 h22fX (x)
1 h2n2 (x)fX (x)
1 h2n2 (x)fX (x)

K

x-u h

(y - µ(x))dZn(u, y)

K
n
K
n

x-u h
x-u h

(y - µ(x))dZn(u, y) (y - µ(x))dBn(T (y, u))

(C.1) (C.2) (C.3)

where Bn T (y, u) = Wn T (y, u) - F (y, u)Wn(1, ..., 1) and T (y, u) is the d dimensional Rosenblatt transformation

T (y, u) = FX1|Y (u1|y), FX2|Y (u2|u1, y), ..., FXd|Xd-1,...,X1,Y (ud|ud-1, ..., u1, y), FY (y) .

1 U2,n(x) = h2n2 (x)fX (x)

K
n

x-u h

(y - µ(x))dWn(T (y, u))

1 U3,n(x) = h2n2 (x)fX (x)

K
n

x-u h

(y - µ(u))dWn(T (y, u))

1 U4,n(x) = h2n2 (x)fX (x)

n(u)2f (u)K

x-u h

dW (u)

1 x-u U5,n(x) = h K h dW (u)

(C.4) (C.5) (C.6) (C.7)

Theorem 2.2 follows from applying Theorem 2 of Rosenblatt (1976) on U5,n(x). Next we introduce some notations which are used repeatedly in the following proofs.

Definition C.1 (Neighboring Block in X  Rd, Bickel and Wichura (1971) p.1658). A block B  X is a subset of X of the form B = i(si, ti] with s and t in X ; the pth-face of B is i=p(si, ti]. Disjoint blocks B and C are p-neigbbors if they abut and have the same pth face; they are neighbors if they are p-neighbors for some p  1.

14

To illustrate the idea of neighboring block, take d = 3 for example, the blocks (s, t]×(a, b]×(c, d] and (t, u] × (a, b] × (c, d] are 1-neighbors for s  t  u.

Definition C.2 (Bickel and Wichura (1971) p.1658). Let X : Rd  R. The increment of X on the block B, denoted X(B), is defined by

X(B) =

(-1)d-||X s +  (t - s) ,

{0,1}d

(C.8)

where || = 1 + 2 + ... + d, " " denotes the componentwise product; that is, for any vectors u, v  Rd, u v = (u1v1, u2v2, ..., udvd).

Below we give some examples of the increment of a multivariate function X on a block: · d = 1: B = (s, t], X(B) = X(t) - X(s); · d = 2: B = (s1, t1] × (s2, t2]. X(B) = X(t1, t2) - X(t1, s2) + X(s1, s2) - X(s1, t2). Lemma C.3. Un - U0,n = Op (log n)-1/2 .

Proof of Lemma C.3. By the triangle inequality we have

Un - Un,0  Un - Un,0 + Un,0 - Un,0 d=ef E1 + E2,

where Un,0 = 2(x)/n(x)Un,0(x) and the terms E1 and E2 are defined in an obvious manner. We now show that Ej = Op (log n)-1/2 , j = 1, 2. Note that

|Un,0(x) - Un,0(x)| = (x)/n(x) - 1 Un,0(x) . 
It is shown later that Un,0 = Op log n , hence it remains to prove that

sup (x)/n(x) - 1 = O (log n)-1 .
xX

(C.9)

Under an (h-3d log n)1/(b1-2)   as n  , n2(x)  2(x) > 0 uniformly in x; moreover, by (A2)(ii), we have

h-3d log n sup |2(x)| = h-3d log n sup

(y - µ(x))2fY |X (y|x)dy = O(1),

xX

xX |y|>an

which implies supxX (log n)2n2(x)/n2(x)  (log n)h3dO(1) = O(1). Therefore,

(C.10)

(log n) sup
xX

2(x) n2 (x)

-

1

= (log n) sup
xX

n2 (x) + n2 (x) n2 (x)

-

1

 sup
xX

(log n)2n2(x) n2 (x)

 0,

as n  , hence E2 = Op (log n)-1/2 . We now show that E1 = op((log n)-1). To do this, it is enough to show the weak convergence
of log nE1, and it requires to show the finite dimensional convergence to 0 with rate (log n)-1 and

15

the tightness of the process inducing E1 in D(X ) in the sense of Chapter 3 of Billingsley (1968). First, we observe that

(log n)1/2E1 = (log n)1/2 sup |Un(x) - Un,0(x)|
xX

= (log n)1/2 sup
xX

1 hdfX (x)2(x)

= sup
xX

1 fX (x)2(x) Vn(x) ,

K
{|y|>an}

x-u h

(y - µ(x))dZn(y, u)

where and

n
Vn(x) = Wn,i(x),
i=1

Wn,i(x) = (log n)1/2(nhd)-1/2

(Yi - µ(x))1(|Yi| > an)K

x - Xi h

-E (Yi - µ(x))1(|Yi| > an)K

x - Xi h

.

Note that fX (x)2(x) > 0 for all x  X by Assumption (A2) and (A4). By (C.10),

E[Wn,i(x)2]  (log n)(nhd)-1E

Yi - µ(x) 21(|Yi| > an)K2

x - Xi h

 (log n)(nhd)-1CK n2(x)

= O(h2dn-1).

Thus,

n
E Wn,i(x) 2  nE Wn,i(x) 2 = O(h2d) = O(log n)-1),
i=1
as n  . From Markov's inequality, Vn(x) = op(1) for each fixed x  X . With this result, finite convergence follows by Cram´er-Wold theorem and the detail is omitted.
We now show the tightness of Vn(x) for x  X . To simplify the expression, define
g(x) d=ef {Y  - µ(x)}K x - X . h

Take arbitrary neighboring blocks B, C  X (see Definition C.1) and suppose B = di=1(si, ti],

E[Vn(B)2]1/2  (log n)1/2h-d/2 E 1(Yi > an)

(-1)d-||g s +  (t - s)

{0,1}d

+ E 1(Yi < -an)

(-1)d-||g s +  (t - s) 2 1/2

{0,1}d

d=ef (log n)1/2h-d/2(I1 + I2)1/2,

2

16

where I1 and I2 are defined in an obvious manner. Hence, I1 can be estimated as

I1  2 +2

1(y > an)y2

(-1)d-||K

s+

(t - s) - u /h

2
f

(y,

u)dydu.

{0,1}d

1(y > an)

(-1)d-||µ( s + 

(t - s))K s + 

(t - s) - u /h

2
f

(y

,

u)dydu

{0,1}d

Note that

(-1)d-||K s + 
{0,1}d

(t - s) - u /h

=

 (1,...,1) K
B

v-u h

dv  h-dCK (B),

(-1)d-||µ( s +  (t - s))K s +  (t - s) - u /h

{0,1}d

= (1,...,1) µ(v)K v - u Bh

dv  h-dCK ,µ (B),

where by (A1) and (A3) the constant CK , CK ,µ > 0 satisfies supuD |K(u)|  CK and supuD |{µ(u)K(u)}|  CK ,µ . (·) is the Lebesgue measure.
Taking C1 = max{CK , CK ,µ } > 0. Under the constraint that y > an > 1 for large enough n,
we have

I1  4



y2 C1h-d(B) 2f (y, u)dydu = 4h-2dC12(B)2

y2fY  (y)dy.

an {y>an}

By symmetry,

I2  4h-2dC12(B)2

y2fY  (y)dy.

{y<-an}

Hence, by (A.1) in (A2),

1/2

E[Vn(B)2]1/2  2C1(B) h-3d log n

y2fY  (y)dy

{|y|>an}

 2C1C(B).

Analogously we obtain the estimate for

E[Vn(C)2]1/2  2C1C(C),

which finally yields by H¨older's inequality,

E[|Vn(B)||Vn(C)|]  E[|Vn(B)|2]1/2E[|Vn(C)|2]1/2  4C12C2(B)(C).

Applying Lemma D.1 with 1 = 2 = 1 = 2 = 1 yields the tightness.
Lemma C.4. U0,n - U1,n = Op n-1/6h-d/2(log n) +(2d+4)/3an for any > 0.
Proof of Lemma C.4. In this proof, we adopt the notation that if   {0, 1}d+1, then we write  = (1, 2) where 1  {0, 1} and 2  {0, 1}d. In the computation below, we focus on Bx = jd=1 xj - Ah, xj + Ah instead of Rd since K has compact support. Recall definition C.1 of

17

an increment of a function X over a block B. Integration by parts for multivariate integral (see, for example, Theorem 3.4 on p.64 of Proksch (2012)) gives,

U0,n(x) = + +

1 hdfX (x)n2 (x)

Zn(y, u) d
Bx n

y - µ(x) K x - u h

Zn ·1, ·2

·1 -µ(x) K

x - ·2 h

n × Bx

{0,1}d+1-{0,l}

Zn(·1, ·2) d1
(n×Bx)

·1 -µ(x) 2 K

x - ·2 h

(C.11) n × Bx l-

where l = (1, ..., 1)  {0, 1}d+1 and 0 = (0, ..., 0)  {0, 1}d+1. n × Bx is a d + 1 dimensional cube. ·1 corresponds to the one-dimensional variable y and ·2 corresponds to the two-dimensional variable u. The second term in (C.11) can be evaluated with the formula (C.8). n × Bx l- can be viewed as the projection of n × Bx on to the space spanned by those axes whose numbers correspond to positions of ones of the multi-index l - . This leaves us with an ||-fold integral.
Moreover, d y-µ(x) K((x-u)/h) = y y-µ(x) ul2K (x-u)/h , where l2 = (1, ..., 1)  {0, 1}d and d y - µ(x) = 1.
By applying integration by parts for Brownian integral (Theorem 3.5 on p.70 of Proksch (2012))
to U1,n(x), and by Theorem 3.2 in Dedecker et al. (2014), we obtain for every > 0,

hd/2n1/6(log n)- -(2d+4)/3an-1|U0,n(x) - U1,n(x)|

 O(1)

a-n 1 fX (x)n2(x)

2an

dK((x - u)/h) + 2an K
Bx

x - ·2 h

Bx

+ 2an

2 K

1=1,2{0,1}d-{l2} (Bx)2

x - ·2 h

(Bx)l2-2

+ 2an

2 K

1=0,2{0,1}d-{02} (Bx)2

x - ·2 h

(Bx)l2-2

, a.s. (C.12)

By (A1), K is of bounded variation in the sense of Hardy and Krause (Owen (2005) definition 2), (C.12) is almost surely bounded.
Lemma C.5. U1,n - U2,n = Op hd/2 .
Proof of Lemma C.5. Since Bn T (y, u) = Wn T (y, u) - F (y, u)Wn(1, ..., 1), we obtain by a change of variables and a first order approximation to f (y, x - hv):

U1,n - U2,n

hd/2 K (v) dv

1 y - µ(x) f (y, x)dy + O(h) |W (1, ..., 1)| fX (x)n2 (x) n

Note that |W (1, ..., 1)| = Op(1), Yi - µ(x) has a finite second moment by (A2)(i) is uniformly bounded on X .

Lemma C.6. U2,n - U3,n = Op h1- , where 0 <  < 1.

18

Proof of Lemma C.6. Define

Vn(x) d=ef U2,n(x) - U3,n(x)
1 =
hdfX (x)n2 (x) 1
= hdfX (x)n2 (x)

y - µ(x) - (y - µ(u)) K x - u dW T (y, u) n h

µ(u) - µ(x) K x - u dW T (y, u) . n h

(C.13)

Via applying mean value theorem to µ and (A3), and the fact that FY |X (y|u)  1 for all y and u,

V (x) 2

1

Eh

= hd+2fX (x)n2 (x)

µ(u) - µ(x) 2K2 x - u f (y, u)dydu n h



Cµ hd+2fX (x)n2 (x)

FY |X (an|u) - FY |X (-an|u) |x - u|2K2

x-u h

fX (u)du



C2 h2fX (x)n2 (x)

K2(z)|hz|2fX (x)dz

+

O(h)



2C 2 dA2 n2 (x)

K

2 2

+

O(h),

where the last inequality follows from Assumption (A1) that K has bounded support. Therefore,

2 d=ef sup E
xX

Vn(x) 2  C + O(h), h

(C.14)

Now we compute d(s, t) defined in Lemma D.2.

E

V (t) - V (s) h

2



2 hd+2

µ(s) - µ(t) 2K2 s - u f (y, u)dydu+ n h

2 hd+2

µ(u) - µ(t) 2 K t - u - K s - u n h h

2
f (y, u)dydu d=ef I1 + I2.

We estimate I1 first,

I1



2Cµ hd+2

t - s 2K2



2Cµ hd+2

s-t

2 

K2

s-u h
s-u h

fX (u)du fX (u)du

s-t h2

2
,

where by (A3) there exists constant Cµ > 0 such that inequality uses (A1) that K is bounded.
For I2, by (A3), we obtain

d j=1

supxX

| j µ(x)|



Cµ

,

and

the

last

I2



2Cµ hd+2



4Cµ hd+2

t-u 2
s-t  h

K t-u -K h
hz 2 K (z) - K

s-u 2 h fX (u)du

s-t

z+ h

fX (x + hz)dz

 4Cµ

s-t  h

z 2 |K (z)| dz +

z2K

s-t z+

[-A,A]d

[-A,A]d

-

s-t
h

h

dz

s-t , h

19

where in the last inequality we again uses the bounded support property of K(·) in (A1). Thus, for the function  defined in Lemma D.2 we obtain the estimate ( )  C max{ /h, /h}  C /h

for < 1 and C > 0, and

   m2-y2

 m

Q(m)  C (2 + 2)

dy  C ,

1h

h

where C > 0 and m < 2. Observe that the graph of the inverse of a univariate, injective function
Q(m) is its reflection about the diagonal line, so the inverse of an upper bound for Q would be a lower bound for Q-1. Given the upper bound above, we can therefore bound Q-1 from below by

2 > Q-1(a)  (C )-2h2a2.

Let a = h- for 0 <  < 1 and arbitrary  > 0. Q-1(a-1) = Q-1 -1h  (C )-2-2h2+2.  > a-1 when n is large. Applying Lemma D.2 yields

P sup Vn(x) > h-

xX

h



22d+2(2r)d2dh-2d(1+)

2 h-

exp

-

2h-2 82

,

for large enough n and all  > 0, where r is a constant depending on X .

Lemma C.7. U3,n(x) =d U4,n(x) for all x  X .

Proof of Lemma C.7. The proof resembles the proof for Lemma A.5 in the supplement material of Chao et al. (2016) and is omitted for brevity.

Lemma C.8. U4,n - U5,n = Op h1- , where 0 <  < 1.

Proof of Lemma C.8. We will proceed as in Lemma C.6 and apply Lemma D.2. Set

Vn(x) d=ef U4,n(x) - U5,n(x) 1
= hdfX (x)n2 (x)

n2(u)fX (u) -

To apply Lemma D.2, we need to estimate

n2(x)fX (x) K

x-u dW (u).
h

E

Vn(t) h

2

1 = hd+2fX (t)n2 (t)

n2(u)fX (u) -

n2 (t)fX (t) 2 K2

t-u du
h

1 = hd+2fX (t)n2 (t)

n2(u) fX (u) - fX (t)

+ fX (x)

n2 (u) -

n2 (t)

2 K2

t-u h

du.

Note that 0 < infxX fX (x) < supxX fX (x) <  by (A4), n(x)2  (x)2 <  for all n and x  X by (A2)(i), and for sufficiently large n, n(x)2 > 0. Hence,

E

Vn(t) 2  2Ch-d-2 h

fX (u) -

fX (t) 2K2

t-u du
h

+

n2 (u) -

n2 (t) 2K2

t-u h

du ,

20

We have n2(x) = 2(x) - n2(x). By (C.10) in Lemma C.3, supxX n2(x) = O(h3d log-1 n). For large enough n such that n2(x) > 0,

2
n2 (u) - n2 (t) =

n2 (u) - n2 (t) n2 (u) + n2 (t)

2
 C n2 (t) - n2 (u) 2 = O(h6d log-2 n).

moreover, fX (x) is continuously differentiable on X by assumption (A4). Along with |z|2K(z) <  by (A1), we have

On the other hand,

sup E
tX

Vn(t) 2 = O(1). h

Vn(t) - Vn(s) 2 Eh

 Ch-d-2

n2(u)fX (u) -

n2(t)fX (t) K

t-u h

-

n2(u)fX (u) -

n2(s)fX (s) K

s-u h

2
du

= Ch-d-2

n2(u)fX (u) -

n2(t)fX (t) K

t-u h

-K

s-u h

+

n2(t)fX (t) -

n2(s)fX (s) K

s-u h

2
du

 2Ch-d-2

n2(u)fX (u) -

2
n2(t)fX (t) K

t-u h

-K

s-u h

2
du

+ 2Ch-d-2

n2(t)fX (t) -

n2 (s)fX (s) 2K2

s-u h

du d=ef I1 + I2.

From

2
n2(t)fX (t) - n2(s)fX (s) =

n2(t)fX (t) - n2(s)fX (s) n2(t)fX (t) + n2(s)fX (s)

2
C

t-s

2 

,

we obtain

I2 = C

t-s h2

2
.

By change of variables and a similar argument as to bound I2 in the proof of Lemma C.6, it follows

I1  C

s-t h

.

Computing ( ), Q(m), Q-1(a) as in Lemma C.6. Setting a = h- for 0 <  < 1 and arbitrary  > 0, and applying Lemma D.2 as in Lemma C.6 give the desired result.

21

D Auxiliary Results

Lemma D.1 (Bickel and Wichura (1971): Tightness of processes on a multidimensional cube). If
{Xn}n=1 is a sequence in D[0, 1]d, P(X  [0, 1]d) = 1. For neighboring blocks B, C in [0, 1]d (see Definition C.1) constants 1 + 2 > 1, 1 + 2 > 0, {Xn}n=1 is tight if

E[|Xn(B)|1 |Xn(C)|2 ]  (B)1 (C)2 ,

(D.1)

where µ(·) is a finite nonnegative measure on [0, 1]d (for example, Lebesgue measure), where the increment of Xn on the block B is defined by

Xn(B) =

(-1)d-||Xn s +  (t - s) .

{0,1}d

Lemma D.2 (Meerschaert, M. M., Wang, W. and Xiao, Y. (2013)). Suppose that Y = {Y (t), t  Rd} is a centered Gaussian random field with values in R, and denote

d(s, t) d=ef dY (s, t) = E|Y (t) - Y (s)|2 1/2, s, t  Rd.

Let X be a compact set contained in a cube with length r in Rd and let 2 = suptX E[Y (t)2]. For any m > 0, > 0, define
( ) = sup d(s, t)
s,tX , s-t 

and

 Q(m) = (2 + 2)


(m2-y2 )dy.

1

Then for all a > 0 which satisfy a  (1 + 4d log 2)1/2( + a-1),

P

sup |Y (t)| > a
tS

 22d+2

r d  + a-1

Q-1(1/a) + 1

exp a

-

2(

a2 + a-1)2

,

where Q-1(a) = sup{m : Q(m)  a}.

(D.2)

22

price

MU
income
Figure 1: U.S. gasoline demand in income and price. EIV UCS
References
Berkson, J. (1950). Are there two regressions? Journal of the American Statistical Association, 45:164­180.
Bickel, P. J. and Wichura, M. J. (1971). Convergence criteria for multivariate stochastic processes and some applications. The Annals of Mathematical Statistics, 42(5):1656­1670.
Billingsley, P. (1968). Convergence of Probability Measures. John Wiley & Sons. Blundell, R., Horowitz, J. L., and Parey, M. (2012). Measuring the price responsiveness of gaso-
line demand: Economic shape restrictions and nonparametric demand estimation. Quantitative Economics, 3:29­51. Carroll, R. J., Ruppert, D., and Stefanski, L. A. (1995). Measurement error in nonlinear models. Chapman and Hall, Boca Raton. Chao, S.-K., Proksch, K., Dette, H., and H¨ardle, W. K. (2016+). Confidence corridors for multivariate generalized quantile regression. Journal of Business & Economic Statistics.
23

Table 1: Variables in the RT ECS Surveys from Year 2001

Variable Description

Mean

Log of Total Miles Traveled (T OT M ILES) 4.214

Log of Income (IN COM E)

4.623

Log of Number of Drivers (DRV R)

0.236

Log of Number of Vehicles (V EHS)

0.248

Log of Household Size (HHSIZE)

0.344

Std. Dev. OLS estimate (std. error)

0.423

-

0.333

0.180
(0.007)

0.170

0.188
(0.024)

0.212 0.227

0.910
(0.013)
0.037
(0.028)

Child Dummy (CHILD) Gender Dummy (SEX) Urban Residence Dummy (RU RAL)

0.348 0.584 0.254

0.476 0.493 0.435

1.911
(0.037)
-0.035
(0.004)
0.097
(0.005)

Region Dummy Variables (Region) New England
Middle Atlantic East North Central West North Central
South Atlantic East South Central West South Central
Mountain Pacific

0.091 0.187 0.069 0.026 0.090 0.102 0.055 0.199 0.181

0.288 0.390 0.254 0.160 0.286 0.302 0.227 0.399 0.385

0.026
(0.011)
0.027
(0.010)
NA
(-)
1.983
(0.035)
1.884
(0.034)
1.699
(0.032)
1.926
(0.035)
1.883
(0.035)
1.795
(0.034)

24

4.00

3.95

3.95

3.90

gasoline

gasoline

3.90

3.85

3.85

3.80

0.1 0.2 0.3 0.4 0.5
price
(a) 25th-percentile income

0.6 0.1 0.2 0.3 0.4 0.5
price
(b) 50th-percentile income

0.6

gasoline
3.90 3.95 4.00

0.1 0.2 0.3 0.4 0.5
price
(c) 75th-percentile income

0.6

Figure 2: U.S. gasoline demand; The dashed band is 95% uniform confidence surface. EIV UCS

Craven, P. and Wahba, G. (1979). Smoothing noisy data with spline functions. Numerische Mathematik, 31:377­403.
Dedecker, J., Merlev´ede, F., and Rio, E. (2014). Strong approximation of the empirical distribution function for absolutely regular sequences in Rd. Electronic Journal of Probability, 19(9):1­56.
Ferguson, T. S. (1996). A Course in large sample theory. Chapman and Hall, CRC.
Hansen, B. E. (2008). Uniform convergence rates for kernel estimation with dependent data. Econometric Theory, 24(3):726­748.

25

gasoline
3.70 3.75 3.80 3.85 3.90 3.95 4.00

4.00

3.95

3.90

gasoline

3.85

3.80

3.75

3.70

0.2 0.4 0.6 0.8
income
(a) 25th-percentile price

0.2 0.4 0.6 0.8
income
(b) 50th-percentile price

4.00

3.95

3.90

3.85

gasoline

3.80

3.75

3.70

0.2 0.4 0.6
income
(c) 75th-percentile price

0.8

Figure 3: U.S. gasoline demand; The dashed band is 95% uniform confidence surface. EIV UCS

H¨ardle, W. (1989). Asymptotic maximal deviation of M -smoothers. Journal of Multivariate Analysis, 29(2):163­179.
H¨ardle, W., Liang, H., and Gao, J. (2000). Partially linear models. Heidelberg, Physica-Verlag.
Hausman, J. and Newey, W. (1995). Nonparametric estimation of exact consumer surplus and deadweight loss. Econometrica, 63:1445­1476.
Hyslop, D. R. and Imbens, G. W. (2001). Bias from classical and other forms of measurement error. Journal of Business & Economic Statistics, 19:475­481.

26

Johnston, G. J. (1982). Probabilities of maximal deviations for nonparametric regression function estimates. Journal of Multivariate Analysis, 12(3):402­414.
Kim, K. H. (2016). Inference of the trend in a partially linear model with locally stationary regressors. Econometric Reveiws, 35(7):1194­1220.
Koul, H. L. and Song, W. (2008). Model checking with berkson measurement errors. Journal of Statistical Planning and Inference, 138:1615­1628.
Koul, H. L. and Song, W. (2010). Model checking in partial linear regresion models with berkson measurement errors. Statistica Sinica, 20:1551­1579.
Li, Q. and Racine, J. S. (2007). Nonparametric Econometrics: Theory and Practice. Princeton university press, New Jersey.
Meerschaert, M. M., Wang, W. and Xiao, Y. (2013). Fernique-type inequalities and moduli of continuity for anisotropic Gaussian random fields. Transations of the American Mathematical Society, 365(2):1081­1107.
Nadaraya, E. A. (1964). On estimating regression. Theory of Probability and Its Applications, 9:141­142.
Owen, A. B. (2005). Multidimensional variation for quasi-Monte Carlo, volume 2 of Ser. Biostat., pages 49­74. World Sci. Publi., Hackensack, NJ.
Proksch, K. (2012). Gleichm¨aßige Konfidenzbereiche fu¨r multivariate inverse Regressionsmodelle mit Faltungsoperatoren. PhD thesis, Ruhr-Universit¨at Bochum.
Robinson, P. M. (1988). Root-n-consistent semiparametric regression. Econometrica, 56:931­954.
Rosenblatt, M. (1976). On the maximal deviation of k-dimensional density estimates. The Annals of Probability, 4(6):1009­1015.
Schennach, S. M. (2013). Regressions with berkson errors in covariates ­ a nonparametric approach. Annals of Statistics, 41:1642­1668.
Schmalensee, R. and Stoker, T. M. (1999). Household gasoline demand in the united states. Econometrica, 67:645­662.
Watson, G. S. (1964). Smooth regression analysis. Sankya, Series A., 26:359­372.
Yatchew, A. and No, J. A. (2001). Household gasoline demand in canada. Econometrica, 69:1697­ 1709.
Zhao, Z. and Wu, W. B. (2008). Confidence bands in nonparametric time series regression. Annals of Statistics, 36:1854­1878.
27

SFB 649 Discussion Paper Series 2016
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.

001
002 003
004 005 006
007 008 009 010
011 012
013 014
015 016 017
018 019 020

"Downside risk and stock returns: An empirical analysis of the long-run and short-run dynamics from the G-7 Countries" by Cathy Yi-Hsuan Chen, Thomas C. Chiang and Wolfgang Karl Härdle, January 2016. "Uncertainty and Employment Dynamics in the Euro Area and the US" by Aleksei Netsunajev and Katharina Glass, January 2016. "College Admissions with Entrance Exams: Centralized versus Decentralized" by Isa E. Hafalir, Rustamdjan Hakimov, Dorothea Kübler and Morimitsu Kurino, January 2016. "Leveraged ETF options implied volatility paradox: a statistical study" by Wolfgang Karl Härdle, Sergey Nasekin and Zhiwu Hong, February 2016. "The German Labor Market Miracle, 2003 -2015: An Assessment" by Michael C. Burda, February 2016. "What Derives the Bond Portfolio Value-at-Risk: Information Roles of Macroeconomic and Financial Stress Factors" by Anthony H. Tu and Cathy Yi-Hsuan Chen, February 2016. "Budget-neutral fiscal rules targeting inflation differentials" by Maren Brede, February 2016. "Measuring the benefit from reducing income inequality in terms of GDP" by Simon Voigts, February 2016. "Solving DSGE Portfolio Choice Models with Asymmetric Countries" by Grzegorz R. Dlugoszek, February 2016. "No Role for the Hartz Reforms? Demand and Supply Factors in the German Labor Market, 1993-2014" by Michael C. Burda and Stefanie Seele, February 2016. "Cognitive Load Increases Risk Aversion" by Holger Gerhardt, Guido P. Biele, Hauke R. Heekeren, and Harald Uhlig, March 2016. "Neighborhood Effects in Wind Farm Performance: An Econometric Approach" by Matthias Ritter, Simone Pieralli and Martin Odening, March 2016. "The importance of time-varying parameters in new Keynesian models with zero lower bound" by Julien Albertini and Hong Lan, March 2016. "Aggregate Employment, Job Polarization and Inequalities: A Transatlantic Perspective" by Julien Albertini and Jean Olivier Hairault, March 2016. "The Anchoring of Inflation Expectations in the Short and in the Long Run" by Dieter Nautz, Aleksei Netsunajev and Till Strohsal, March 2016. "Irrational Exuberance and Herding in Financial Markets" by Christopher Boortz, March 2016. "Calculating Joint Confidence Bands for Impulse Response Functions using Highest Density Regions" by Helmut Lütkepohl, Anna StaszewskaBystrova and Peter Winker, March 2016. "Factorisable Sparse Tail Event Curves with Expectiles" by Wolfgang K. Härdle, Chen Huang and Shih-Kang Chao, March 2016. "International dynamics of inflation expectations" by Aleksei Netsunajev and Lars Winkelmann, May 2016. "Academic Ranking Scales in Economics: Prediction and Imdputation" by Alona Zharova, Andrija Mihoci and Wolfgang Karl Härdle, May 2016.

SFSBF6B4694, 9S,pSapnadnaduaeureSrtrSatßraeß1e, 1D,-D10-1107187B8eBrleinrlin htthpt:t/p/:/s/fbs6fb4694.w9.iwwiiw.hiu.h-bue-brleinrl.idne.de
ThTishrisesreasercahrcwhawsassupsuppoprtoerdtebdybtyhethDeeDuetsucthseche ForFsocrhsuchnugnsgesgmeeminesicnhsachftatfht rtohuroguhgthhethSeFSBF6B4694"9Ec"oEnconmoimc RicisRki"s.k".

SFB 649 Discussion Paper Series 2016
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
021 "CRIX or evaluating blockchain based currencies" by Simon Trimborn and Wolfgang Karl Härdle, May 2016.
022 "Towards a national indicator for urban green space provision and environmental inequalities in Germany: Method and findings" by Henry Wüstemann, Dennis Kalisch, June 2016.
023 "A Mortality Model for Multi-populations: A Semi-Parametric Approach" by Lei Fang, Wolfgang K. Härdle and Juhyun Park, June 2016.
024 "Simultaneous Inference for the Partially Linear Model with a Multivariate Unknown Function when the Covariates are Measured with Errors" by Kun Ho Kim, Shih-Kang Chao and Wolfgang K. Härdle, August 2016.
SFSBF6B4694, 9S,pSapnadnaduaeureSrtrSatßraeß1e, 1D,-D10-1107187B8eBrleinrlin htthpt:t/p/:/s/fbs6fb4694.w9.iwwiiw.hiu.h-bue-brleinrl.idne.de
ThTishrisesreasercahrcwhawsassupsuppoprtoerdtebdybtyhethDeeDuetsucthseche ForFsocrhsuchnugnsgesgmeeminesicnhsachftatfht rtohuroguhgthhethSeFSBF6B4694"9Ec"oEnconmoimc RicisRki"s.k".

