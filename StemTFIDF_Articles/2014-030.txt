BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2014-030
Forecasting Generalized Quantiles of Electricity Demand: A Functional
Data Approach
Brenda López Cabrera* Franziska Schulz*
* Humboldt-Universität zu Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Forecasting Generalized Quantiles of Electricity

Demand: A Functional Data Approach.

Brenda López Cabrera, Franziska Schulz
May 30, 2014
Abstract
Electricity load forecasts are an integral part of many decision-making processes in the electricity market. However, most literature on electricity load forecasting concentrates on deterministic forecasts, neglecting possibly important information about uncertainty. A more complete picture of future demand can be obtained by using distributional forecasts, allowing for a more ecient decision-making. A predictive density can be fully characterized by tail measures such as quantiles and expectiles. Furthermore, interest often lies in the accurate estimation of tail events rather than in the mean or median. We propose a new methodology to obtain probabilistic forecasts of electricity load, that is based on functional data analysis of generalized quantile curves. The core of the methodology is dimension reduction based on functional principal components of tail curves with dependence structure. The approach has several advantages, such as exible inclusion of explanatory variables including meteorological forecasts and no distributional assumptions. The methodology is applied to load data from a transmission system operator (TSO) and a balancing unit in Germany. Our forecast method is evaluated against other models including the TSO forecast model. It outperforms them in terms of mean absolute percentage error (MAPE) and achieves a MAPE of 2.7% for the TSO.
Keywords: Electricity, Load forecasting, FPCA JEL classication: G19, G29, G22, Q14, Q49, Q59
1. INTRODUCTION
With the liberalization of energy markets, the amount of risk borne by operators and market participants has increased substantially. Statistical tools can be benecial to
The nancial support from the Deutsche Forschungsgemeinschaft via SFB 649  Ökonomisches Risiko, Humboldt-Universität zu Berlin is gratefully acknowledged.
Ladislaus von Bortkiewicz Chair of Statistics, Humboldt-Universität zu Berlin, Spandauer
Straÿe 1, 10178 Berlin, Germany. Email:lopezcab@wiwi.hu-berlin.de,sulzfran@hu-berlin.de
1

assess and manage their risk. Amongst energy, electricity stands out due to its limited storability. Supply and demand have to be balanced out at every point in time. Since electricity is mainly traded in a day-ahead market, short term adjustments in supply due to forecasting errors can lead to enormous nancial losses. Therefore, load forecasting is extremely important for energy suppliers, transmission system operators, nancial institutions and other participants in electricity market and a crucial process in the planning and operation of electric utilities.
There is a vast literature on how to forecast electricity load, most of them concentrating on deterministic forecasts. For an overview on common methods see Weron (2007) or Taylor and McSharry (2007). However, for a sustainable risk management of utility operators not only a forecast of expected demand, but also knowledge about the uncertainty and dispersion of future load plays an important role. This points towards the use of probabilistic forecasts. While in dierent areas of forecasting such as macro-economics and nance (Tay and Wallis 2000), meteorology (Leutbecher and Palmer 2008) or renewable energy production (Bremnes 2004; Pinson et al. 2007) probabilistic forecasts are already well established, there is a lack in literature on probabilistic forecasts for electricity demand. A notable exception is the work by Hyndman and Fan (2010) which uses a mixture of temperature simulation, economic scenarios, and residual bootstrapping to obtain long-term density forecasts of electricity demand. Others like Cottet and Smith (2003) use Bayesian modeling in a multi-equation regression model to forecast intraday electricity load and briey discuss model averaging for probabilistic forecasts.
Short-term probabilistic forecasts yield important information for utility operators for decisions e.g. on purchasing and generating electricity and load scheduling. They are crucial for risk management and can be used to derive risk measures such as probability of exceedance levels (Taylor 2008; Bellini et al. 2014). In this article we propose a methodology to obtain probabilistic forecasts by employing functional data analysis of generalized quantile curves.
With generalized quantiles we refer to quantiles (Koenker and Bassett Jr 1978) and expectiles (Newey and Powell 1987). Both are tail measures and uniquely characterize the conditional distribution of a random variable. Furthermore, for a large class of decision-making problems, optimal solutions correspond to quantiles of a conditional predictive distribution (Gneiting 2011). In fact, in a wide range of elds including weather events, extreme natural hazards, genomics, risk management, energy demand and portfolio allocation among others, tail indices provide useful information that goes beyond the mean and median. These tail indices constitute curves that can be treated in a functional principal component analysis (FPCA) context.
The idea of FPCA is to identify the main risk drivers by a small number of factors combined with random noise. The resulting factors are then to be (cor)related with exogenous variables, which will allow us to study phenomena contingent to extreme risks. Functional data analysis (see Ramsay and Silverman (2005)) is an extension of multivariate data analysis to functional data. There are few studies that apply methods from functional data analysis to load forecasting, amongst which are Shang (2013), Goia et al. (2010) and Antoch et al. (2008). Others like Cho et al. (2013) reduce dimension using a hybrid approach that combines a generalized additive
2

model for the weekly averages of the load and curve linear regression models for the dependence structure across consecutive daily loads.
Two recent studies on functional data analysis of tail events are Guo et al. (2013),
L Lwho do the dimension reduction with weighted 1 and 2 norm, where the weights
are sign sensitive, and Tran et al. (2014) who develop an analogue of PCA of tail curves in an asymmetric norm. However, both studies rely on independence between functional observations. In many elds however, such as energy demand modeling, the dependency between curves needs to be taken into account at the core of the modeling. In our study we allow for temporal dependence between functional observations and refer to results from Hörmann and Kokoszka (2010). The dependence between tail curves can be exploited for forecasting, which provides useful information to support modeling, pricing and trading. Our approach has several advantages: It allows for exible inclusion of explanatory variables and does not require distributional assumptions for the tails curves. Furthermore, treating load curves as functional data has the advantage that one step ahead forecasts yield forecasts for the whole next day and that forecasts are continuous functions and thus available for every point in time. We expect that exogenous variables like meteorological factors do not only eect the amount of electricity consumed, but also the distribution over the day and thus the shape of the load curves (Engel et al. 1986; Harvey and Koopman 1993; Taylor and McSharry 2007).
We illustrate our approach with data on quarter-hourly electricity consumption of a transmission system operator (TSO) and a balancing unit (BU) in western Germany. Variations in the intradaily pattern are explained using weather variables and meteorological forecasts. The proposed model is shown to perform better than well-known methods, such as a deterministic similar-day approach, the Holt-Winter Exponential smoothing and the forecast provided by TSO Amprion. It achieves on
average 2.7% mean absolute percentage error (MAPE) in the one-day forecasting
period for the TSO. Our article is structured as follows. Section 2 gives a brief introduction of the load
data. In Section 3 we dene FPCA of generalized quantiles that will be used to produce probabilistic load forecasts, together with its estimation algorithm. Section 4 discusses the modeling and estimation of the electricity demand data. Section 5 describes the forecast performance with respect to other methods. Section 6 concludes
Rthe paper. All computations in this paper were carried out in . The electricity load
data and forecast electricity load data was obtained from TSO Amprion and the balancing unit Stadtwerke Saarbrücken. The data source for the temperature data is Deutscher Wetterdienst (DWD); for the meteorological weather forecast data the data source is WeatherOnline. We thank Dr. Ulrich Römer and Herrad Werner for providing us the data. To simplify notation, in the following dates are denoted with yyyymmdd format. Supplementary materials for this article are available online.
2. ELECTRICITY DEMAND DATA
The German electricity market, which was liberalized in 1998, is Europe's largest, with annual power consumption of around 500 TWh and a generation capacity of
50125 GW (Eurostat 2014). The four German TSOs (Amprion, Tennet TSO, Hertz
3

Transmission and TransnetBW) are responsible for maintaining a stable and reliable system and to maintain balance between electricity generation and consumption. All market participants are organized in balancing units (BU). Each BU has a BU manager who is responsible for the balance within the unit. Electricity is traded mainly in the day-ahead market, which closes at 12pm. Before, each BU manager has to submit a load schedule to the corresponding TSO specifying the expected load for each quarter hour of the next day. Deviations from the specied load can still be adjusted in the intra-day market. The intra-day market is a continuous market where contracts can be traded until 45 minutes before delivery. However, the intra-day market is less liquid than the day-ahead market and therefore neglected in this study. The TSOs balance out dierences between the forecasted load of the BU and actual consumption in order to ensure a stable system. Precise forecasts of the area's consumption are essential in order to have sucient capacity available. For deviations between forecasted and actual load BUs have to pay a price which usually greatly exceeds the price at the spot market. Therefore, for BU managers improvements in their forecasting performance directly leads to enormous cost reductions.
For the empirical work of this article, we use electricity demand data of the TSO Amprion and the BU Stadtwerke Saarbrücken. Both datasets are freely accessible on their websites. The TSO Amprion operates in the west of Germany. The BU is located within the balancing area of Amprion. The analysis is based on quarter hourly data of electricity consumption from 20100101 to 20123112. Summary statistics are given in Table (1). The rst two years of the data are used for insample tting and the third year for an out-of-sample forecasting evaluation, given in Section 5. Figure (1) displays the two load data sets from 2010 to 2012. It is clearly visible that electricity consumption exhibits seasonal features over time and at dierent times of the day.

Median Mean

SD

Min Max

TSO BU

22020 22050 4054.35 11850 34870

402

401

95.71

152

630

Table 1: Summary Statistics of the load data (in MW)

It is a stylized fact that it contains yearly, weekly and intraday seasonal cycles

and is sensitive to temperature changes (Engel et al. 1986; Taylor and Buizza 2002).

During winter electricity consumption in Germany is higher than during the summer.

Additionally, at weekends electricity consumption is usually lower than during the

week. The typical intraday load prole shows a peak around noon, followed by valley

in the afternoon and another peak in the evening at around 7pm. These seasonal

patterns are quite predictable and therefore usually modeled deterministically. We
express the observed load Y~s as

Y~s = s + Ys, s = 1, . . . , S,

(1)

 Ywhere s is a deterministic seasonal component and s is a stochastic component.
We estimate the deterministic seasonal component separately for every quarter hour

4

Figure 1: Electricity load curves of TSO - Amprion (left) and BU - Stadtwerke Saarbrücken (right) from 20100101 to 20123112.

of a day. It is specied as

t,k = at + bt · k + c1,t sin

2k 365

+ c2,t cos

2k 365

7
+ di,t · Di,k,

i=1

(2)

where t = 1, . . . , 96 denotes the quarter hours of a day and k = 1, . . . , K the day, such that t · k = s. The parameters at,bt,c1,t,c2,t and di,t are estimated by ordinary Dleast square regression. i,k is a set of dummy variables consisting of six dummies
for the weekdays and one dummy for public holidays. They capture weekly seasonal behavior, while the sine and cosine functions capture yearly seasonalities. This approach is very close to the so called similar-day approach, which is a commonly used approach in industry to model and forecast electricity load.
As covariates for load modeling we include average daily temperature and hours
??of sunshine. The time series of both variables are displayed in Figure ( ). For
Saarbrücken temperature and hours of sunshine are measures from a weather station in Saarbrücken. For the TSO the average measures of three stations located in their area are taken. For forecasting we use meteorological day-ahead forecasts of the covariates, which are provided by WeatherOnline. For our analysis all covariates are deseasonalized.

3. METHODOLOGY
We propose a methodology that combines methods from generalized quantile regression and functional data analysis (FDA) in order to obtain probabilistic forecasts of electricity demand. FDA has gained importance with the advances in storing large sets of multivariate data. It has been applied in various elds of research ranging from bioscience to medicine and econometrics. For an overview on applications of FDA we refer to Ramsay and Silverman (2002) or Ferraty and Vieu (2006).

5

Figure 2: Average daily temperature and hours of sunshine for the area of the TSO Amprion (left) and Saarbrücken (right)

3.1 Generalized Quantiles

YThe distribution of a random variable can be characterized by its cdf FY (y). The Yquantile functions of are dened as

QY ( ) = FY-1( ) = inf {y : F (y)   },   (0, 1).

(3)

Like the cdf, the quantile function provides a full characterization of the random
variable Y . For each   (0, 1) the quantile function can be formulated as the
solution of a minimization problem:

QY ( ) = arg min E{ (Y - y)},
y
where  (·) is a loss function dened as
 (u) = u{ - I(u < 0)},

(4) (5)

which is in general asymmetric (Koenker 2005). A special case is the median, which
corresponds to  = 0.5. The quantile function conditional on a (one-dimensional) covariate X is given by

QY |X( ) = arg min E{ (Y - f (X)},
f F

(6)

6

where f (·) is a nonparametric function of the covariate X from a set of functions F ,

such that the expectation is well dened. Closely related to quantiles are expectiles

introduced by Newey and Powell (1987), which can be obtained by a generalization
of the loss function  (·):

l (X) = arg min E{ (Y - f (X)}, f F
(u) = |u|| - I(u < 0)|.

  {1, 2}

(7) (8)

We call the solution of (7) a generalized quantile function. For  = 1 we obtain

the loss function in (5) and the solution to (7) is a conditional quantile function.
For  = 2 the solution to (7) is a conditional expectile function. Note that the conditional expectile corresponding to  = 0.5 is the expected value E(Y |X ). Like

quantiles, expectiles characterize the distribution of a random variable. While they

are less intuitive to interpret than quantiles, they have the advantage of a better

computational eciency (Newey and Powell 1987) and are a coherent risk measure

(Bellini et al. 2014).

If one is not only interested in estimating a single generalized quantile, but in

estimating a collection of generalized quantiles, one faces the problem of crossing

quantiles/expectiles. This is unfavorable, since it is theoretically impossible. We use

an algorithm proposed by Schnabel (2011), that estimates the generalized quantile
functions l (X ) jointly as a surface on the domain of the independent variable X and the asymmetry parameter , called expectile sheet. The algorithm is based on

a least asymmetrically weighted squares (LAWS) criterion combined with P-splines.

The expectile sheet can be expressed as

KL

µ(X,  ) =

aklBk(X)B~l( ),

(9)

k=1 l=1

where B is a B-spline basis for the covariate X , B~ is a B-spline basis for the asym-

metry parameter  and A = [akl] is a matrix of coecients. It is estimated by

minimizing

nJ
wi(j){Yi - µ(Xi, j)}2 + P,
i=1 j=1

(10)

where wi( ) is a weight function and µ(X,  ) is the expectile sheet. P is a penalty term dened as P = x||DA||F +  ||AD~ ||F , where|| · ||F is the Frobenius norm D Dand and are second order dierence matrices. The penalty term controls the  smoothness of the estimates and x and p are smoothing parameters. The algorithm was originally developed for expectiles and the weight function wi( ) is given by

wi(j) =

j if Yi > µ(Xi, j) 1 - j if Yi  µ(Xi, j).

(11)

With a slight modication the algorithm can be adapted for quantiles as well. Fol-

lowing Schnabel and Eilers (2013) the modied weight function is given by



j

 wi(j) =

{Yi-µ(Xi,j )}2+2
 1-j

 {Yi-µ(Xi,j )}2+2

if Yt > µ(Xi, j) if Yt  µ(Xi, j),

(12)

7

where is a small constant which is used to avoid numerical problems. In the X tfollowing the covariate used is time of the day and will be denoted by .

3.2 Time series of functional data

Electricity demand is recorded in sequential form and shows a similar pattern each
day. Naturally, metered demand can be divided into time intervals of one day.
We are interested in generalized quantiles of metered intra-daily electricity demand.
The generalized quantile functions dened in the previous section can be treated
as realizations l,k(t) of a functional time series (l,k, k  Z) dened on a compact set T and for a xed   (0, 1). For notational convenience we supress in the following, i.e. l,k(t) := lk(t). Under stationarity lk(t) have a common mean function E{l(t)} = µ(t) and a common covariance function C(s, t) = Cov{l(s), l(t)} with s, t  T . Note that functional observations are intrinsically innite dimensional. A
common tool to reduce dimensionality is functional principal component analysis
(FPCA). For a survey on FPCA we refer the reader to Shang (2014).
FPCA yields the directions of largest variability in the data and expresses the data as
a weighted sum of the orthogonal principal component functions. If T C (t, t)dt < , the covariance function induces the Kernel operator K :   K  dened by (K )(s) = T C(s, t)(t)dt. Then, C has the representation


C(s, t) = ii(s)i(t),
i=0

(13)

where i for i = 1, 2, . . . are the orthogonal eigenfunctions and i the corresponding Knon-increasing and non-negative sequence of eigenvalues of the operator . The
eigenfunctions are also called principal component functions. The principal com-
ponent scores i, i = 1, 2, . . . are given by l(t), i , where ·, · denotes the inner product. That is, the principal component scores are the projection of l(t) in the direction of the corresponding principal component, with E(i) = 0 and Var(i) = i. Using the Karhuhen-Loève expansion we can express each function lk(t) as


lk(t) = µ(t) + iki(t).
i=1

(14)

The functions lk(t) can be approximated by a nite sum of the rst m principal
components, called truncated Karhuhen-Loève expansion:

m
lk(t)  µ(t) + iki(t)
i=1

(15)

Note that only the principal component scores are varying over time, whereas the mean and principal component functions are time invariant. This observation is exploited for forecasting.

8

3.3 Estimating FPCA for generalized quantiles

In practice the mean, eigenvalues and eigenfunctions are unknown and have to be estimated from the sample. The mean of the functions is estimated by

1n

µ(t) = n

lk(t),

k=1

(16)

nwhere is the sample size. We estimate the kernel operator by

(K)(s) = C(s, t)(t)dt,
T

(17)

where

1 C(s, t) =
n

n
{lk(s) - µ(s)}{lk(t) - µ(t)}.

k=1

(18)

Estimates of the eigenfunctions and scores are computed from (17) and denoted by i and ik, i = 1, . . . , m. Hörmann and Kokoszka (2010) show that these estimates are
n-consistent for a large group of stationary functional time series, which includes in
particular linear functional processes. To choose the number of principal component
mfunctions in Equation (3.2) there exist various rules. Here, the number is chosen
such that at least an a priori xed amount of variation in the data is explained by
the principal component functions.

3.4 Forecasting functional time series

As noted above, in Equation (14) only the principal component scores depend on µtime, while the common mean function and the principal component functions  are time-invariant. Hence, the dynamics over time of the load curves are fully
captured by the dynamics of the principal component scores. The time dynamics of
mthe rst estimated principal component scores can be modeled using time series
analysis (Aue et al. (2014)). The problem of modelling the innite dimensional functional data objects reduces thus to modeling a multivariate time series.
In our analysis a vector autoregressive model including exogeneous variables (VARX) turned out to be suitable to capture the dynamics of the principal component scores. The VARX model of order p is given by

p
k = ik-i + xk + k
i=1

(19)

 where k is the vector of estimated principal component scores, i is a coecient x matrix, k are exogenous variables and k is a white noise process (Lütkepohl 2005).
A forecast of the principal component scores directly yields a forecast of the load

curve:

m
lK+h(t) = µ(t) + i,K+hi(t),
i=1

(20)

9

 hwhere i,K+h denotes the -step ahead forecast of the principal component scores at time K and lK+h(t) is the h-step ahead forecast of the load curve. Although
suitable here, in a more general setting forecast models for the principal component scores are not retricted to VAR models and can be replaced by many other time series models. The next algorithm summarizes the aforementioned steps:
Algorithm
1. For xed   (0, 1) and each k = 1, . . . , K, use the data Yt,k, t = 1, . . . , 96 to estimate the k - th generalized quantile curve l,k(t) by LAWS
2. Fix m and apply FPCA to l,1, . . . , l,K :
(a) Compute the empirical mean µ, FPCs i and FPC scores k = (1,k, . . . , m,k) , k = 1, . . . , K, i = 1, . . . , m
3. For xed h, use the m-variate time series of empirical FPC scores  = (1 . . . m) to obtain h-step ahead forecast K+h = (K+h,1 . . . K+h,m)
(a) Use a multivariate time series model, e.g. VAR model
(b) Include information from exogenous variables
4. Use K+h to compute h-step ahead forecast of lK+h as
m
lK+h(t) = µ(t) + i,K+hj(t)
i=1

3.5 Simulation Study

In this section simualtions are used for illustrating the performance of the proposed method for FPCA with generalized quantiles. We run the simulation for independent as well as autocorrelated functional observations to demonstrate robustness to temporal dependence. For comparison, we follow the simulation setup of Guo et al. (2013) and Tran et al. (2014), who both suggest alternative approaches for modeling
functional tail event curves. The data Yt,k, k = 1, . . . , K, j = 1, . . . , T is simulated
from the model

Yj,k = µ(tj) + 1,kf1(tj) + 2,kf2(tj) + k,j

(21)

where tj are equidistant sampling points in [0, 1] with tj = j/T , µ(t) = 1 + t + exp{-(t - 0.6)2/0.05} is the mean function, f1(t) = 2 sin(2t) and f2(t) =
2 cos(2t) are the principal component functions and 1,k and 2,k are principal
component scores. The principal component scores are generated either (1) indepen-
dently from a N(0, 36) and N(0, 9) distribution, respectively or (2) from a VAR(1)

process with

1 =

-0.5 -0.2 0.2 0.5

.

10

The error k,t is generated from three dierent distributions as specied in Table
(2), where the rst one is a light-tailed distribution, the second one is heavy-tailed
and the third one exhibits heteroscedasticity. The simulation is run 200 times with two dierent setups: (1) T = 100 grid points per curve and K = 20 curves and (2) T = 150 data points per curve and K = 50 curves. Summary statistics of the
mean squared errors (MSE) and the average run time in seconds of the simulations are given in Table (2). The magnitude of the average MSE does not dier substantially between the independent and the autocorrelated case. This conrms that the quality of the proposed methodology is not sensitive to temporal dependence between functional observations. The methodology performs worst for the fat tailed distribution, but well handles heteroscedasticity. Overall, the results are at least as good in terms of average MSE than those reported by Guo et al. (2013) and Tran et al. (2014).

  N(0, 0.5)   t(5)   N(0, µ(t)0.5)

Mean SD AT
Mean SD AT
Mean SD AT

  N(0, 0.5)   t(5)   N(0, µ(t)0.5)

Mean SD AT
Mean SD AT
Mean SD AT

N = 20, T = 100
(1) (2)

N = 50, T = 150
(1) (2)

0.0448 0.0295 3.4400 0.2444 0.2565 3.7500 0.0564 0.0381 3.5100
0.0433 0.0285 3.3900 0.2447 0.2508 3.7100 0.0521 0.0379 3.2600

 = 0.95

0.0400

0.0254

0.0271

0.0174

3.7200 10.1300

0.2290

0.1465

0.2396

0.1590

4.2300 10.3700

0.0518

0.0416

0.0340

0.0286

3.8200 10.2100

 = 0.05

0.0407

0.0259

0.0281

0.0177

3.7200

9.8000

0.2242

0.1480

0.2407

0.1644

4.6600 11.6200

0.0518

0.0499

0.0354

0.0385

3.7700

9.8700

0.0233 0.0170 11.0100 0.1428 0.1729 12.2500 0.0500 0.0389 11.8000
0.0234 0.0168 10.3200 0.1401 0.1571 12.0700 0.0501 0.0393 12.2000

Table 2: Mean and standard deviation (SD) of MSE and average run time in seconds
(AT) based on K = 200 simulation runs

11

4. MODELING DYNAMICS OF ELECTRICITY DEMAND
As noted above the generalized quantile functions fully characterize the distribution of electricity demand and they are an alternative to modeling the distribution
function directly. We model the dynamics of the 1%, 5%, 25%, 50%, 75%, 95% and 99% expectile functions using the described functional data approach for the two
year insample period from 20100101 to 20113112. The expectile functions are ob-
 tained based on the LAWS algorithm with penalty terms x and  estimated by
asymmetric cross validation.
The number of principal components is chosen such that at least 95% of the
variation in the data is explained. Tables (3) and (4) show the explained variation of
each principal component for all considered expectile levels for the BU Saarbrücken
and the TSO Amprion, respectively. With four principal components slightly more
than 95% of the variation is captured. For all expectile levels the rst PC is the
dominant factor, explaining roughly three quarter of the variation in the curves.
Expectile level  PC 1% 5% 25% 50% 75% 95% 99%
1 0.7221 0.7223 0.7232 0.7195 0.7247 0.7129 0.7233 2 0.1209 0.1213 0.1215 0.1220 0.1199 0.1241 0.1227 3 0.0695 0.0690 0.0687 0.0687 0.0698 0.0691 0.0722 4 0.0394 0.0409 0.0404 0.0420 0.0416 0.0410 0.0409
Total 0.9521 0.9536 0.9540 0.9524 0.9562 0.9572 0.9593
Table 3: Explained variance of the rst four principal components for the BU Saarbrücken
Expectile level  PC 1% 5% 25% 50% 75% 95% 99%
1 0.7985 0.7942 0.8007 0.7946 0.7952 0.7956 0.7892 2 0.0878 0.0893 0.0864 0.0883 0.0892 0.0887 0.0920 3 0.0583 0.0586 0.0553 0.0559 0.0547 0.0553 0.0541 4 0.0222 0.0237 0.0240 0.0255 0.0253 0.0252 0.0261
Total 0.9670 0.9659 0.9667 0.9644 0.9645 0.9650 0.9615
Table 4: Explained variance of the rst four principal components for the TSO Amprion
Figure (3) shows the rst four principal components for TSO and the BU. For both data sets the extracted PCs exhibit similar shapes. The rst principal component reects variations in the level of electricity load. A positive score on the rst
12

principal component implies above average consumption, a negative score below average consumption (see Figure (4) for the scores). The second and third principal component capture variations in the height and location of peak load. The steepness of the load curves is modeled by the fourth principal component.

PC 2 -2 -1 0 1 2

PC 1 -2 -1 0 1 2

00:00 06:00 12:00 18:00 24:00 Time

00:00 06:00 12:00 18:00 24:00 Time

PC 4 -2 -1 0 1 2

PC 3 -2 -1 0 1 2

00:00 06:00 12:00 18:00 24:00 Time

00:00 06:00 12:00 18:00 24:00 Time

Figure 3: First four principal components corresponding to = 50% of the TSO
Amprion (dashed) and the BU (solid)

The load of the TSO is the aggregated load of all BUs located in their area of responsibility. We compare the dynamics of the principal component scores for
 = 0.5 of the TSO and of the BU Saarbrücken in order to investigate to which
degree the quantity risk in the BU is driven by the same factors as the overall market. The scores of the rst factor of the TSO and the BU have a correlation
of only 0.3 indicating that the level of electricity load of both is only moderately correlated. The correlation of the other scores and dierent levels of is of similar
magnitude. The dynamics of the principal component scores are modeled by a VARX(p)
pmodel. The lag order is chosen by the Akaike information criterion and equals p = 7 for all expectile levels. Table (5) shows the estimation results of the exogenous
variables for the TSO. Note that the values refer to deseasonalized data. Both, daily average temperature and hours of sunshine have a strong negative
eect on all four principal component scores, implying that they do not only aect the amount of electricity used, but also the allocation over the day. As expected, an increase in temperature results in lower electricity consumption, since in the area of
13

1 -100 50

1 -3000 2000

0 100 200 300 400 500 600 700 Time

0 100 200 300 400 500 600 700 Time

2 -20 10

2 -1000 500

0 100 200 300 400 500 600 700 Time

0 100 200 300 400 500 600 700 Time

3 -20 0 20

3 -1000 1000

0 100 200 300 400 500 600 700 Time

0 100 200 300 400 500 600 700 Time

4 -10 5

4 -400 400

0 100 200 300 400 500 600 700 Time

0 100 200 300 400 500 600 700 Time

 =Figure 4: The scores corresponding to the rst four principal components ant 50% of the TSO Amprion (left) and the BU Saarbrücken (right)

the TSO Amprion there is a high commonness of electric heating in form of nightstorage heaters. Similary, more hours of sunshine decrease electricity demand, for instance due to less demand for lighting and in-house consumption of solar energy. Peak demand is aected dierently by temperature and hours of sunshine as reected in the sign of the coecients. While higher temperature causes more pronounced peaks, more hours of sunshine atten the load curve.
For the BU (Table (6)) temperature does not have any eect on electricity load. This may be explained by the fact, that the share of electric heating is much lower in Saarbrücken than in the total area of the TSO. Therefore, demand is less sensitive to temperature.
In order to test the validity of our model, a multivariate portmanteau test (Hosking 1980) is performed, which suggests to reject the overall signicance of residual
autocorrelation for lag orders up to 50.
5. FORECAST EVALUATION
In this section we conduct an out-of sample forecast evaluation for the third year of electricity consumption data (2012) for the BU and the TSO.

14

Temperature Sunshine
Temperature Sunshine
Temperature Sunshine Note:

1
-22.314 (7.175)
-24.912 (8.895)
-22.156 (7.141)
-24.563 (8.834)
-21.892 (7.187)
-25.244 (8.877)

2 3

 = 5%

-14.805

-11.665

(2.903)

(2.620)

38.058

20.184

(3.599)

(3.248)

 = 50%

-14.708

-11.276

(2.896)

(2.591)

38.198

20.208

(3.582)

(3.205)

 = 95%

-13.771

-11.587

(2.930)

(2.593)

37.850

21.095

(3.619)

(3.202)

4
-3.629 (1.564) -6.308 (1.939)
-3.940 (1.576) -6.059 (1.949)
-3.790 (1.557) -5.633 (1.923)

p<0.1; p<0.05; p<0.01

Table 5: Estimation Results TSO Amprion. Standard deviation in parenthesis.

Temperature Sunshine
Temperature Sunshine
Temperature Sunshine Note:

1
-0.038 (0.154) -0.950 (0.191)
-0.039 (0.154) -0.958 (0.190)
-0.048 (0.154) -0.978 (0.190)

2 3

 = 5%

-0.039

-0.016

(0.058)

(0.054)

0.633

0.194

(0.072)

(0.067)

 = 50%

-0.037

-0.017

(0.058) 0.631

(0.054) 0.210

(0.072)

(0.067)

 = 95%

-0.036

-0.022

(0.058)

(0.055)

0.627

0.228

(0.072)

(0.068)

4
-0.039 (0.041) -0.204 (0.051)
-0.041 (0.041) -0.200 (0.051)
-0.043 (0.041) -0.171 (0.050)

p<0.1; p<0.05; p<0.01

Table 6: Estimation Results BU Saarbrücken. Standard deviation in parenthesis ().

15

5.1 Prediction comparison methods

In order to assess the performance of our forecasting approach we compare it to the results of three dierent benchmark models. As a rst benchmark we choose the simple Deterministic Seasonal Component (DSC) (Eq. 2). The deterministic seasonal component is straightforward to estimate and in modied forms frequently used in industry. As a further benchmark we use forecasts that are provided by the TSO Amprion for their area of responsibility. Additionally, we compare our model to the triple seasonal Holt-Winter exponential smoothing (TSHW) model, which was proposed and applied to short-term load forecasting by Taylor (2010). The latter model accomodates yearly, weekly and daily seasonal cycles and has the advantage that no specication of the functional form is required. Furthermore, Taylor (2010) shows in an application to data from the UK that the TSHW model outperforms simpler exponential smoothing models and performs at least as well as seasonal ARMA models. The formulation of the TSHW model is given by

lt = (yt - dt-s1 - wt-s2 - at-s3 ) + (1 - )lt-1

(22)

dt = (yt - lt - wt-s2 - at-s3) + (1 - )dt-s1

(23)

wt = (yt - lt - dt-s1 - at-s3) + (1 - )wt-s2

(24)

at = (yt - lt - dt-s1 - wt-s2) + (1 - )at-s2

(25)

yt+h = lt + dt-s1+h + wt-s2+h + at-s3+h + k(yt - lt-1 - dt-s1 - wt-s2 - at-s3 ) (26)

where lt is the smoothed load, dt, wt and at are seasonal indices for daily, weekly and annual cycles and , , ,  are smoothing parameters. yt+h denotes the h-step t ahead forecast at time and the term including is an adjustment for rst-order
autocorrelation.

5.2 Forecast Results
We evaluate the performance of the proposed forecasting methodology based on the root mean squared error (RMSE) dened as

RM SEh =

1 96

96
{lh(t) - lh(t)}2

t=1

and the mean absolute percentage error (MAPE) given by

M AP Eh

=

1 96

96 t=1

| lh(t) - lh(t) |, lh(t)

where h = 1, . . . , H denotes the day-ahead forecasts. Table (7) reports the mean of the RMSE and MAPE based on H = 351 out-of-sample day-ahead forecasts over
the year 2012. Meteorological forecasts of the explanatory variables are used as covariates. The proposed methodology clearly outperforms the benchmark models in terms of the given measures. Surprisingly, also the simple DSC performs relatively good and yields results similar to those of the TSHW exponential smoothing model.

16

FDA

DSC TSHW TSO

RMSE MAPE
RMSE MAPE

711.72 0.027
23.16 0.043

TSO

1021.16 932.81

0.045

0.043

Balancing Unit

30.30

34.71

0.062

0.066

3064.97 0.13
 

Table 7: Mean of RMSE and MAPE for the TSO and the BU of functional data
approach (FDA) with  = 0.5, deterministic seasonal component (DSC), triple
seasonal Holt-Winter exponential smoothing (TSHW) and forecast provided by the transmision system operator (TSO).

This underlines the very regular structure in intra-daily electricity consumption. Figure (5) shows boxplots of the MAPE. The distribution of MAPE of the FDA is most narrow, however it contains several extreme values at the right tail. Overall, the gures indicate that our model performs quite well in point forecasting and
results in forecasts with an average absolute deviation of only 2.7% for the TSO and 4.3% for the BU.
In order to evaluate the performance of the distributional forecasts, we look at
the accuracy of the expectile estimates for = 0.01, 0.05, 0.25, 0.75, 0.95, 0.99. As
pointed out by Guler et al. (2014) a performance measure should be used that reects the asymmetric loss function of expectiles. We choose the root mean weighted squared error (RMWSE) dened as

RM W SEh =

1 96

96

|

-

I {lh(t)<l,h(t)}

|{lh(t)

-

l,h(t)}2,

t=1

(27)

l where  denotes the forecasted -expectile curve. Summary statistics of the RMWSE for the dierent expectile levels based on H = 351 day-ahead forecasts are given in
Table (8). The results indicate high precision of the estimated tail curves. Figure (6) shows a plot of the forecasted mean together with forecast intervals corresponding to various expectile levels and the observed load for the TSO Amprion. The intervals spanned by the expectile curves provide information about the dispersion and asymmetry of next day's load. Furthermore, as pointed out above, quantiles and expectiles can be optimal point forecasts if the forecasters loss function is asymmetric. In energy demand forecasting, asymmetric loss functions occur if the cost for positive and negative imbalance is asymmetric, as it is the case in Scandinavian countries (Linnet 2005). In that case trading strategies based on quantiles and expectiles can be benecial.

17

Expectile level  1% 5% 25% 50% 75% 95% 99%

Mean 566.83 SD 440.98
Mean 13.93 SD 6.57

685.42 494.81
16.82 6.71

700.51 420.20
20.90 6.49

TSO
711.72 416.40
BU
23.16 7.61

673.97 391.32
24.47 9.31

611.88 432.82
24.20 10.93

496.68 373.50
23.36 11.41

Table 8: Summary Statistics of RMWSE and MAWPE

0.30

0.30

MAPE 0.10 0.20

MAPE 0.10 0.20

0.00

0.00

FDA

DSC

TSHW

TSO

FDA

DSC

TSHW

Figure 5: Boxplot of the mean absolute percentage forecasting error for the TSO (left) and the BU (right) of the functional data approach (FDA), the deterministic seasonal component (DSC), the triple seasonal Holt-Winter exponential smoothing model (TSHW) and the forecast provided by the transmission system operator (TSO).

6. CONCLUSION
In this article we show how to get powerful probabilistic short-term forecasts of intradaily electricity load employing functional data analysis methods with generalized quantile regression. Probabilistic forecasts yield important information about the uncertainty of future demand and are crucial for sustainable operation of electric utilities and for traders in the electricity market. This novel approach has several advantages: It allows for exible inclusion of explanatory variables and does not require distributional assumptions for neither the tails nor the functional form of the tail time varying curves. The empirical analysis is based on quarter-hourly data from a TSO and a BU in western Germany. The proposed methodology identies the main risk drivers of the electricity load by a number of factors: variations in the level of electricity load, variation in the height and location of peak load and the steepness of the load curves. We show how these factors are then to be (cor)related with climate eects.
18

Load in MW 22000 24000 26000 28000

00:00

06:00

12:00 Time of day

18:00

24:00

Figure 6: Forecasted expected load (black solid line) together with forecasts of
 = 0.01, 0.05, 0.25, 0.75, 0.95, 0.99 expectiles (gray shades) and observed load (red
dashed line) for TSO Amprion on 20120125.

In a forecast comparison study we nd that our methodology outperforms forecasts (a MAPE of 2.7%) provided by the TSO as well as those of the benchmark models.
References
Antoch, J., Prchal, L., De Rosa, M. R., and Sarda, P. (2008), Functional linear regression with functional response: application to prediction of electricity consumption, in Functional and Operatorial Statistics, Springer, pp. 2329.
Aue, A., Norinho, D. D., and Hörmann, S. (2014), On the prediction of stationary functional time series, Journal of the American Statistical Association.
Bellini, F., Klar, B., Müller, A., and Rosazza-Gianin, E. (2014), Generalized quantiles as risk measures, Insurance: Mathematics and Economics, 54, 4148.
Bremnes, J. B. (2004), Probabilistic wind power forecasts using local quantile regression, Wind Energy, 7, 4754.
Cho, H., Goude, Y., Brossat, X., and Yao, Q. (2013), Modeling and Forecasting Daily Electricity Load Curves: A Hybrid Approach, Journal of the American Statistical Association, 108, 721.
Cottet, R. and Smith, M. (2003), Bayesian Modeling and Forecasting of Intraday Electricity Load, Journal of the American Statistical Association, 98, 839849.
Engel, R. F., Granger, C. W. J., Rice, J., and Weiss, A. (1986), Semiparametric Estimated of the Relation Between Weather and Electricity sales, Journal of the American Statistical Association, 81, 310320.
Eurostat (2014), Supply, transformation, consumption - electricity - annual data,
http://epp.eurostat.ec.europa.eu, accessed: 2014-03-17.
19

Ferraty, F. and Vieu, P. (2006), Nonparametric functional data analysis: theory and practice, Springer.
Gneiting, T. (2011), Quantiles as optimal point forecasts, International Journal of Forecasting, 27, 197207.
Goia, A., May, C., and Fusai, G. (2010), Functional clustering and linear regression for peak load forecasting, International Journal of Forecasting, 26, 700711.
Guler, K., Ng, P. T., and Xiao, Z. (2014), Mincer-Zarnovitz Quantile and Expectile Regressions for Forecast Evaluations under Asymmetric Loss Functions, Northern Arizona University, Working Paper Series.
Guo, M., Zhou, L., Härdle, W. K., and Huang, J. Z. (2013), Functional Data Analysis of Generalized Regression Quantiles, Statistics and Computing.
Harvey, A. and Koopman, Siem, J. (1993), Forecasting Hourly Electricity Demand Using Time-Varying Splines, Journal of the American Statistical Association, 12281236.
Hörmann, S. and Kokoszka, P. (2010), Weakly dependent functional data, The Annals of Statistics, 38, 18451884.
Hosking, J. R. (1980), The multivariate portmanteau statistic, Journal of the American Statistical Association, 75, 602608.
Hyndman, R. J. and Fan, S. (2010), Density forecasting for long-term peak electricity demand, Power Systems, IEEE Transactions on, 25, 11421153.
Koenker, R. (2005), Quantile regression, Cambridge University Press.
Koenker, R. and Bassett Jr, G. (1978), Regression quantiles, Econometrica: Journal of the Econometric Society, 46, 3350.
Leutbecher, M. and Palmer, T. (2008), Ensemble forecasting, Journal of Computational Physics, 227, 35153539.
Linnet, U. (2005), Tools supporting wind energy trade in deregulated markets, Ph.D. thesis, Technical University of Denmark, DTU, DK-2800 Kgs. Lyngby, Denmark.
Lütkepohl, H. (2005), New introduction to multiple time series analysis, Springer.
Newey, W. K. and Powell, J. L. (1987), Asymmetric least squares estimation and testing, Econometrica: Journal of the Econometric Society, 55, 819847.
Pinson, P., Chevallier, C., and Kariniotakis, G. N. (2007), Trading wind generation from short-term probabilistic forecasts of wind power, Power Systems, IEEE Transactions on, 22, 11481156.
Ramsay, J. O. and Silverman, B. W. (2002), Applied functional data analysis: methods and case studies, Springer.
20

 (2005), Functional data analysis, Springer. Schnabel, S. (2011), Expectile smoothing: new perspectives on asymmetric least
squares. An application to life expectancy, Ph.D. thesis, Utrecht University. Schnabel, S. K. and Eilers, P. H. C. (2013), Simultaneous estimation of quantile
curves using quantile sheets, AStA Advances in Statistical Analysis, 97, 7787. Shang, H. L. (2013), Functional time series approach for forecasting very short-term
electricity demand, Journal of Applied Statistics, 40, 152168.  (2014), A survey of functional principal component analysis, AStA Advances in
Statistical Analysis, 98, 121142. Tay, A. S. and Wallis, K. F. (2000), Density Forecasting: A Survey, Journal of
Forecasting, 19, 235254. Taylor, J. W. (2008), Estimating Value at Risk and Expected Shortfall Using Ex-
pectiles, Journal of Financial Econometrics, 6, 231252.  (2010), Triple seasonal methods for short-term electricity demand forecasting,
European Journal of Operational Research, 204, 139152. Taylor, J. W. and Buizza, R. (2002), Neural Network Load Forecasting with
Weather Ensemble Predictions, Power Systems, IEEE Transactions on, 17, 626 632. Taylor, J. W. and McSharry, P. E. (2007), Short-term load forecasting methods: An evaluation based on European data, Power Systems, IEEE Transactions on, 22, 22132219. Tran, N. M., Osipenko, M., and Härdle, W. K. (2014), Principal Component Analysis in an Asymmetric Norm, Humboldt University Berlin, CRC 649 Discussion Paper. Weron, R. (2007), Modeling and forecasting electricity loads and prices: A statistical approach, Wiley.
21

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Principal Component Analysis in an Asymmetric Norm" by Ngoc Mai Tran, Maria Osipenko and Wolfgang Karl Härdle, January 2014.
002 "A Simultaneous Confidence Corridor for Varying Coefficient Regression with Sparse Functional Data" by Lijie Gu, Li Wang, Wolfgang Karl Härdle and Lijian Yang, January 2014.
003 "An Extended Single Index Model with Missing Response at Random" by Qihua Wang, Tao Zhang, Wolfgang Karl Härdle, January 2014.
004 "Structural Vector Autoregressive Analysis in a Data Rich Environment: A Survey" by Helmut Lütkepohl, January 2014.
005 "Functional stable limit theorems for efficient spectral covolatility estimators" by Randolf Altmeyer and Markus Bibinger, January 2014.
006 "A consistent two-factor model for pricing temperature derivatives" by Andreas Groll, Brenda López-Cabrera and Thilo Meyer-Brandis, January 2014.
007 "Confidence Bands for Impulse Responses: Bonferroni versus Wald" by Helmut Lütkepohl, Anna Staszewska-Bystrova and Peter Winker, January 2014.
008 "Simultaneous Confidence Corridors and Variable Selection for Generalized Additive Models" by Shuzhuan Zheng, Rong Liu, Lijian Yang and Wolfgang Karl Härdle, January 2014.
009 "Structural Vector Autoregressions: Checking Identifying Long-run Restrictions via Heteroskedasticity" by Helmut Lütkepohl and Anton Velinov, January 2014.
010 "Efficient Iterative Maximum Likelihood Estimation of HighParameterized Time Series Models" by Nikolaus Hautsch, Ostap Okhrin and Alexander Ristig, January 2014.
011 "Fiscal Devaluation in a Monetary Union" by Philipp Engler, Giovanni Ganelli, Juha Tervala and Simon Voigts, January 2014.
012 "Nonparametric Estimates for Conditional Quantiles of Time Series" by Jürgen Franke, Peter Mwita and Weining Wang, January 2014.
013 "Product Market Deregulation and Employment Outcomes: Evidence from the German Retail Sector" by Charlotte Senftleben-König, January 2014.
014 "Estimation procedures for exchangeable Marshall copulas with hydrological application" by Fabrizio Durante and Ostap Okhrin, January 2014.
015 "Ladislaus von Bortkiewicz - statistician, economist, and a European intellectual" by Wolfgang Karl Härdle and Annette B. Vogt, February 2014.
016 "An Application of Principal Component Analysis on Multivariate TimeStationary Spatio-Temporal Data" by Stephan Stahlschmidt, Wolfgang Karl Härdle and Helmut Thome, February 2014.
017 "The composition of government spending and the multiplier at the Zero Lower Bound" by Julien Albertini, Arthur Poirier and Jordan RoulleauPasdeloup, February 2014.
018 "Interacting Product and Labor Market Regulation and the Impact of Immigration on Native Wages" by Susanne Prantl and Alexandra SpitzOener, February 2014.
SFSBF6B4694, 9S,pSapnadnaduaeureSrtrSatßraeß1e, 1D,-D10-1107187B8eBrleinrlin htthpt:t/p/:/s/fbs6fb4694.w9.iwwiiw.hiu.h-bue-brleinrl.idne.de
ThTishrisesreasrecahrcwhaws assupsuppoprtoerdtebdybtyhethDeeDuetsucthseche ForFsocrhsuchnugnsgesgmeeminesicnhsachftatfht rtohuroguhgthhethSeFSBF6B4694"9Ec"oEnconmoimc RicisRki"s.k".

SFB 649 Discussion Paper Series 2014
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
019 "Unemployment benefits extensions at the zero lower bound on nominal interest rate" by Julien Albertini and Arthur Poirier, February 2014.
020 "Modelling spatio-temporal variability of temperature" by Xiaofeng Cao, Ostap Okhrin, Martin Odening and Matthias Ritter, February 2014.
021 "Do Maternal Health Problems Influence Child's Worrying Status? Evidence from British Cohort Study" by Xianhua Dai, Wolfgang Karl Härdle and Keming Yu, February 2014.
022 "Nonparametric Test for a Constant Beta over a Fixed Time Interval" by Markus Reiß, Viktor Todorov and George Tauchen, February 2014.
023 "Inflation Expectations Spillovers between the United States and Euro Area" by Aleksei Netsunajev and Lars Winkelmann, March 2014.
024 "Peer Effects and Students' Self-Control" by Berno Buechel, Lydia Mechtenberg and Julia Petersen, April 2014.
025 "Is there a demand for multi-year crop insurance?" by Maria Osipenko, Zhiwei Shen and Martin Odening, April 2014.
026 "Credit Risk Calibration based on CDS Spreads" by Shih-Kang Chao, Wolfgang Karl Härdle and Hien Pham-Thu, May 2014.
027 "Stale Forward Guidance" by Gunda-Alexandra Detmers and Dieter Nautz, May 2014.
028 "Confidence Corridors for Multivariate Generalized Quantile Regression" by Shih-Kang Chao, Katharina Proksch, Holger Dette and Wolfgang Härdle, May 2014.
029 "Information Risk, Market Stress and Institutional Herding in Financial Markets: New Evidence Through the Lens of a Simulated Model" by Christopher Boortz, Stephanie Kremer, Simon Jurkatis and Dieter Nautz, May 2014.
030 "Forecasting Generalized Quantiles of Electricity Demand: A Functional Data Approach" by Brenda López Cabrera and Franziska Schulz, May 2014.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

