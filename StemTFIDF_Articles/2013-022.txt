BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2013-022
Decomposing Risk in Dynamic Stochastic General Equilibrium
Hong Lan* Alexander Meyer-Gohde*
* Humboldt-Universit‰t zu Berlin, Germany This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universit‰t zu Berlin Spandauer Straﬂe 1, D-10178 Berlin

Decomposing Risk in Dynamic Stochastic General Equilibrium

Hong Lan

Alexander Meyer-Gohdeß

This Version: April 16, 2013

We analyze the theoretical moments of a nonlinear approximation to a model of business cycles and asset pricing with stochastic volatility and recursive preferences. We find that heteroskedastic volatility operationalizes a time-varying risk adjustment channel that induces variability in conditional asset pricing measures and assigns a substantial portion of the variance of macroeconomic variables to variations in precautionary behavior, both while leaving its ability to match key macroeconomic and asset pricing facts untouched. Our method decomposes moments into contributions from realized shocks and differing orders of approximation and from shifts in the distribution of future shocks, enabling us to identify the common channel through which stochastic volatility in isolation operates and through which conditional asset pricing measures vary.

JEL classification: C63, E32, G12

Keywords: Recursive preferences; stochastic volatility; asset pricing; DSGE; moment calculation

We are grateful to Michael Burda, Monique Ebell and Lutz Weinke as well as participants of the CFE 2012 and of
research seminars and workshops at HU Berlin for useful comments, suggestions, and discussions. This research was supported by the DFG through the SFB 649 "Economic Risk". Any and all errors are entirely our own.
Humboldt-Universita®t zu Berlin, Institut fu®r Wirtschaftstheorie II, Spandauer Straﬂe 1, 10178 Berlin, Germany; Email: lanhong@cms.hu-berlin.de
ßHumboldt-Universita®t zu Berlin, Institut fu®r Wirtschaftstheorie II, Spandauer Straﬂe 1, 10178 Berlin, Germany;
Tel.: +49-30-2093 5720; Fax: +49-30-2093 5696; E-Mail: alexander.meyer-gohde@wiwi.hu-berlin.de

1 Introduction
Assessing the statistical and structural implications of nonlinear DSGE models with recursive pref-
erences and stochastic volatility for asset pricing and business cycle dynamics is an unfinished task
in macroeconomics. We derive the theoretical moments of nonlinear moving average approxima-
tions to the model and decompose these moments into contributions from the individual orders of
nonlinearity in realized shocks (amplification effects) and from the moments of future shocks (risk
adjustment effects). With this decomposition, we find that stochastic volatility activates a time-
varying risk adjustment channel in macroeconomic variables accounting for a substantial amount
of total variation. We identify this conditional heteroskedastic mechanism as the sole driving force
of the conditional asset pricing measures under study. This enables us to tell the story of a varying
pattern of risk in the economy eliciting changes in households' precautionary responses as priced by
measures such as the conditional market price of risk.
While there is growing interest in stochastic volatility and Epstein and Zin's (1989) recursive preferences1 in recent literature, there is little work that studies the joint effect of these two elements for both asset pricing and business cycle dynamics.2 Andreasen (2012), focusing on the different
specifications of the conditional heteroskedasticity and the consequential difference in the quanti-
tative performance of a New Keynesian model, takes a brief look at the implications of the model
on both sides. Bidder and Smith (2012), taking a model uncertainty perspective a` la Hansen and
Sargent (2007), study fluctuations in the worst-case distribution as sources for business cycles in
a model with stochastic volatility and recursive preferences. We differ from both their work in our
1See also Kreps and Porteus (1978) and Weil (1990). Backus, Routledge, and Zin (2005) offers a recent review of these and related preferences.
2Bloom (2009) notes the impact of stochastic volatility on macroeconomic variables. Justiniano and Primiceri (2008) add stochastic volatility to DSGE models to study the documented reduction in volatility of U.S. economy since the early 1980's (See also Blanchard and Simon (2001), Stock and Watson (2003) and Sims and Zha (2006) for a review.). Tallarini (2000) among many others, note recursive preferences can contribute to resolving the longstanding asset pricing puzzles (equity premium and risk free rate) documented in Mehra and Prescott (1985) and Weil (1989) without compromising the model's ability of replicating macroeconomic dynamics; and Rudebusch and Swanson (2012) and van Binsbergen, Ferna¥ndez-Villaverde, Koijen, and Rubio-Ram¥irez (2012) use a model with recursive preferences to study the dynamics of the yield curve.
1

aim to analyze the propagation mechanism of stochastic volatility implemented as a volatility shock, and we examine the role of stochastic volatility in attaining the Hansen-Jagannathan bounds (See Hansen and Jagannathan (1991)) to complement the empirical evaluation of the model regarding replicating asset pricing regularities.
We solve the model using the nonlinear moving average perturbation derived in Lan and MeyerGohde (2012), following the documentation of Caldara, Ferna¥ndez-Villaverde, Rubio-Ram¥irez, and Yao (2012) regarding the accuracy of perturbation for a business cycle model with recursive preferences and stochastic volatility and Bidder and Smith's (2012) perturbation study using the same specific functional form for continuation utility (the exponential certainty equivalent of Tallarini (2000)). We approximate the policy function to third order since it is the minimum order needed to capture the time-varying shifts in risk premium as noted in Andreasen (2012, p. 300) and van Binsbergen, Ferna¥ndez-Villaverde, Koijen, and Rubio-Ram¥irez (2012, p. 638). The nonlinear moving average policy function takes the infinite sequence of realized shocks, past to present, as its state variable basis and adjusts the deterministic policy function for the effect of future shocks by scaling their distribution with the perturbation parameter. This policy function and its third order approximation can be decomposed straightforwardly into the order of the amplification effects (the impact of the realized shocks) and risk adjustment (the anticipation effect of future shocks). We find, in the analysis of the impulse responses of both macroeconomic and asset pricing variables, a volatility shock by itself propagates solely through the time-varying risk adjustment channel. For conditional asset pricing measures such as the expected risk premium, volatility shocks and productivity growth shocks propagate individually through the time-varying risk adjustment channel only. Moreover, the effect of stochastic volatility shocks on the expected risk premium is several orders of magnitude larger than that of productivity growth shocks, highlighting again the importance of this time variation in the dispersion of probability measures used to form expectations for conditional asset pricing.
2

Using our third order nonlinear moving approximation, we are able to derive theoretical moments that are in general not available in the nonlinear DSGE models. We further derive a decomposition of the theoretical variance that neatly dissects the individual contributions of amplification and risk adjustment effects to the total variance of the model. With this variance decomposition, we find that adding stochastic volatility changes the composition of the variance of the macroeconomic variables. In the presence of stochastic volatility, more variation is generated in the time-varying risk adjustment channel. As for macroeconomic variables, movements in the risk adjustment channel can be explained by the household's precautionary motive. This finding implies households aware of shifts in the distributions of future shocks will adjust their precautionary behavior commensurately.
The nonlinear moving average approximation, as its policy function directly maps exogenous shocks into the endogenous variables, only needs the moments of the exogenous shocks when computing the theoretical moments. We implement our approach numerically by providing an add-on for the popular Dynare package.3 A state space perturbation policy function, by contrast, maps the endogenous variables into themselves and resulting in an infinite regression in theoretical moments requiring higher moments than moments being computed. In a similar vein to our nonlinear moving average, Andreasen, Ferna¥ndez-Villaverde, and Rubio-Ram¥irez (2012) compute theoretical moments using a pruned state space perturbation,4 since after pruning, the unknown higher moments are nonlinear functions of the known moments of lower order approximations.
The paper is organized as follows. The competitive real business cycle model with recursive preferences and stochastic volatility is derived in section 2. In section 3, we present the nonlinear moving average perturbation solution to the model. The calibrations are introduced in section 4. We then derive the theoretical moments in section 5 and apply our method to analyze the model in section 6. Section 7 concludes.
3See Adjemian, Bastani, Juillard, Mihoubi, Perendia, Ratto, and Villemot (2011) for Dynare. 4See Lan and Meyer-Gohde (2013) for an overview of pruning and its relation to our nonlinear moving average.
3

2 The Model

In this section, we lay out the stochastic neoclassical growth model with the recursive preferences

and stochastic volatility. We parameterize the model close to the production model described in

Tallarini (2000). The economy is populated by an infinitely lived household seeking to maximize its

expected discounted lifetime utility given by the recursive preferences

(1)

Ut

= lnCt

+  ln(1

- Nt)

+



2 

ln

Et

exp

 2Ut+1

where Ct is consumption, Nt labor,   (0, 1) the discount factor and

(2)





2

(1

- )(1 - 1+

)

indexes the deviation with respect to the expected utility.  denotes the coefficient of relative risk

aversion (CRRA) and  > 0 controls labor supply. With  equal to the elasticity of intertemporal

substitution (EIS) which is equal to one here, (1) collapses to the expected utility. The household

optimizes over consumption and labor supply subject to

(3) Ct + Kt = Wt Nt + rtKKt-1 + (1 - )Kt-1 where Kt is capital stock accumulated today for productive purpose tomorrow, Wt real wage, rtK the capital rental rate and   [0, 1] the depreciation rate. Investment is the difference between the

current capital stock and the capital stock in the previous period after depreciation

(4) It = Kt - (1 - )Kt-1

We assume a perfectly competitive production side of the economy, where output is produced using the labor augmented Cobb-Douglas technology Yt = Kt-1 eZt Nt 1-. Zt is a stochastic pro-
ductivity process and   [0, 1] the capital share. Productivity is assumed to be a random walk with
drift, incorporating long-run risk into the model5
(5) at  Zt - Zt-1 = a + zez,t z,t, z,t  N (0, 1)
5As noted by Bansal and Yaron (2004, p. 1502), in an endowment economy with recursive preferences and stochastic volatility, better long-run growth prospects leads to a rise in the wealth-consumption and the price-dividend ratios. Rudebusch and Swanson (2012, p. 108) incorporate both real and nominal long-run risk in a production economy with recursive preference, and find long-run nominal risk improves the model's ability to fit the data.

4

with z,t the innovation to Zt. zez,t can be interpreted as the standard deviation of the productivity growth with z the homoskedastic component. Following, e.g., Ferna¥ndez-Villaverde, Guerro¥nQuintana, Rubio-Ram¥irez, and Uribe (2011) and Caldara, Ferna¥ndez-Villaverde, Rubio-Ram¥irez,

and Yao (2012), we specify the heteroskedastic component, z,t, as

(6) z,t = z,t-1 + z,t , z,t  N (0, 1)
where || < 1 and  is the standard deviation of z,t . The model is closed by the market clearing condition

(7) Yt = Ct + It

that prevents consumption and investment from exceeding output in each period.

The solution is characterized by the intratemporal labor supply/productivity condition equalizing

the utility cost of marginally increasing labor supply to the utility value of the additional consump-

tion

(8)

 1 - Nt

=

1 Ct

(1

-

)Kt-1eZt

(1-)

Nt-

The stochastic discount factor, or pricing kernel, from the household's intertemporal maximiza-

tion of utility is given by

(9)

mt+1



Vt /Ct+1 Vt /Ct

=

 Ct Ct+1

exp 2Vt+1

Et

exp

 2

Vt+1

where Vt is the maximum attainable utility, i.e., the value function of the household

(10)

Vt

= lnCt

+  ln(1

- Nt)

+



2 

ln

Et

exp

 2Vt+1

Combining firms' profit and households' utility maximization yields the real risky rate rt

(11) 1 + rt = Kt--11 (ezt Nt )1- + 1 -  = rtK + 1 - 

The fundamental asset pricing equation takes the form

(12) Et [mt+1 (1 + rt+1)] = 1

As the economy is nonstationary, growing at the rate at, we detrend output, consumption, investment, capital stock and value function to stationarize the model. This is achieved by dividing all

5

nonstationary variables but the value function, which must detrended differently, by the contemporaneous level of productivity eZt .6 Labor supply Nt and leisure 1 - Nt as well as the returns rt and rtK are stationary and therefore do not need to be transformed. Stationary variables will be denoted by lower case letters.

Reexpressing the pricing kernel in terms of stationary variables, the effect of incorporating long-

run risk can be seen directly in the pricing kernel

(13)

mt+1

=

 ct e-(a+zez,t+1 z,t+1) ct+1

Et

exp exp

 2

 2

vt+1

+

1 1-

(a

+

zez,t+1

z,t+1)

vt+1

+

1 1-

(a

+

zez,t+1

z,t+1)

with the stochastic trend, zez,t+1, entering the kernel directly.

To analyze asset prices, we append the model with the following variables: the real risk-free rate (14) 1 + rtf  Et (mt+1)-1

the conditional market price of risk--the ratio of the conditional standard deviation of the pricing

kernel to its conditional mean (15)

cmprt 

Et

(mt+1 - Et mt+1)2 Et mt+1

1 2

that measures the excess return the household demands for bearing an additional unit of risk, the

expected (ex ante) risk premium

(16) er pt  Et rt+1 - rtf

and the (ex post) risk premium (17)

r pt = rt - rtf-1

as the difference between the risky and risk-free rate.

3 Perturbation Solution and Risk Adjustment Channel

As stated by Caldara, Ferna¥ndez-Villaverde, Rubio-Ram¥irez, and Yao (2012), local approximations via perturbation methods can solve models such as ours quickly with a degree of accuracy com-
6See the appendix for details.

6

parable to global methods. Moreover, as at least a third order approximation is necessary for the

analysis of time-varying shifts in risk premia and related measures at the heart of our analysis, we

solve the model to third order. We choose the nonlinear moving average perturbation derived in

Lan and Meyer-Gohde (2012) as it delivers stable impulse responses and simulations at all orders,

hence including our third order approximation of interest, and, as we shall show, enables the direct

calculation and decomposition of moments.

For the implementation of the nonlinear moving average perturbation, we collect the (stationar-

ized) equilibrium conditions into a vector of functions

(18) 0 = Et [ f (yt+1, yt , yt-1, t )]

where yt = kt

ct

Nt

at - a

z,t

vt

mt

rt

rtf

cm prt

er pt


rpt is the vector of the en-

dogenous variables, and t = z,t z,t  the vector of the exogenous shocks, assuming the function

f in (18) is sufficiently smooth and all the moments of t exist and finite7.

The solution to (18) is a time-invariant function y, taking as its state variable basis the infinite

sequence of realized shocks, past and present, and indexed by the perturbation parameter   [0, 1]

scaling the distribution of future shocks

(19) yt = y(, t, t-1, . . .) Assuming normality of all the shocks and setting  = 1 as we are interested in the stochastic

model, the third order approximation--a Volterra expansion, see Lan and Meyer-Gohde (2012)--of

(19), takes the form

  (20)

yt(3)

=y +

1 2 y2

+

1 2

 i=0

yi + y2,i

t-i

+

1 2


y j,i(t- j
j=0 i=0

 t-i)

  +

1 6

 k=0

 j=0

 i=0

yk,

j,i(t-k



t-

j



t-i)

where y denotes the deterministic steady state of the model, at which all the partial derivatives

7See for example, Judd (1998, ch. 13) and Jin and Judd (2002) for a complete characterization of these assumptions. While the normal distribution for shocks we choose is at odds with Jin and Judd's (2002) assumption of bounded support, Kim, Kim, Schaumburg, and Sims (2008) dispute the essentiality of this assumption, lending support to our distribution choice

7

y2, y2,i, yi, y j,i and yk, j,i are evaluated. (20) is naturally decomposed into order of nonlinearity and risk adjustment--yi, y j,i and yk, j,i capture the amplification effects of the realized shocks (t, t-1, . . .) in the policy function (19) at first, second and third order respectively. The two partial derivatives with respect to , y2 and y2,i adjust the approximation for future risk.8 While y2 is a constant adjustment for risk and a linear function of the variance of future shocks9, y2,i varies over time, interacting the linear response to realized shocks with the variance of future shocks essentially adjusting the model for time variation in the conditional volatility of future risk.
4 Calibration
We select three calibrations for the numerical analysis of the model. For the baseline calibration, most of the parameter values are taken from Tallarini (2000) and are listed below. For the parameters of the volatility shock, the literature varies in the range of the persistence--, from 0.9, Caldara, Ferna¥ndez-Villaverde, Rubio-Ram¥irez, and Yao (2012) and Bidder and Smith (2012), to 0.95, Ferna¥ndez-Villaverde and Rubio-Ram¥irez (2010a), and to 0.99 or 1, Andreasen (2012) and Justiniano and Primiceri (2008)--and in the range of its instantaneous standard deviation--, from 0.01, Andreasen (2012) and Justiniano and Primiceri (2008), to 0.1, Ferna¥ndez-Villaverde and RubioRam¥irez (2010b), and to 0.15, Bidder and Smith (2012). We follow the parameterization of Bidder and Smith (2012), implying a cumulative variance comparable to the value in Ferna¥ndez-Villaverde and Rubio-Ram¥irez (2010a, p. 20), described as "generat[ing] changes in volatility similar to the ones observed in the [post-war] U.S." Following Tallarini (2000), we adjust the homoskedastic component of the standard deviation of productivity growth to match the standard deviation of (log) consumption growth.
[Table 1 about here.]
8More generally, a constant term, y3, at third order adjusts (20) for the skewness of the shocks. See Andreasen (2012). As we assume all the shocks are normally distributed, y3 is zero and not included in (20) and the rest of our analysis.
9See, Lan and Meyer-Gohde (2012, p. 13) for the derivation of this term.
8

The discount factor  = 0.9926 generates an annual interest rate of about 3 percent. The capital share  = 0.331 matches the ratio of labor share to national income. The depreciation rate  = 0.021 matches the ratio of investment to output. The risk aversion parameter  and labor supply parameter  are chosen such that labor in the deterministic steady state, N, is 0.2305 to align with the mean level of hours in data and such that  = -0.3676 in line with Tallarini (2000).
While still allowing preferences to be recursive, the constant volatility calibration shuts down stochastic volatility by setting  = 0, this enables direct comparison with Tallarini's (2000) results. In addition, by comparing with the results from the baseline calibration, this exercise helps identify the contribution of the stochastic volatility, by itself and/or in interaction with recursive preferences, to the model.
[Table 2 about here.]
The expected utility calibration shuts stochastic volatility down and is implemented by setting  = 1 (equivalently,  = 0). We will be using all the three calibrations to analyze the contributions of recursive preferences and stochastic volatility to the model's performance evaluated by the HansenJagnannathan bounds.
5 Theoretical Moments
In this section, we derive the theoretical moments of the third order approximation (20). The nonlinear moving average policy function (19) and its third order approximation (20) both map exogenous shocks directly into endogenous variables. The moments of endogenous variables can therefore be computed directly as they are functions of the known moments of exogenous shocks. We further decompose the theoretical variance, disentangling the individual contributions of the risk adjustment and amplification channels to the total variance. Note that throughout the derivation of theoretical moments, we assume normality of the exogenous shocks10 and all processes involved are, as proved
10While removing normality does not disable the calculation of theoretical moments, the derivation will be more complicated as additional terms involving skewness and higher (up to fifth) moments of the shocks emerge.
9

in Lan and Meyer-Gohde (2012), covariance stationary. By contrast, the state space perturbation policy function and its nonlinear approximations map
the endogenous variables into themselves. Computing the m-th theoretical moment of such a nonlinear approximations of n-th order, for example, requires the knowledge of higher (than m-th) moments of endogenous variables that are in general nonlinear functions of the approximations up to and including n-th order. To this end, the calculation results in an infinite regression in the moments of endogenous variables. While theoretical moments of nonlinear state space perturbation approximations are in general not available, there are attempts in recent literature. Andreasen, Ferna¥ndezVillaverde, and Rubio-Ram¥irez (2012) calculate theoretical moments by pruning the nonlinear approximations, such that the higher (than m-th) moments are functions of approximations lower than the current order of approximation, and therefore computable given the results from all lower orders.

5.1 Mean

The mean (first moment) of the third order approximation (20) is straightforward to calculate. Ap-

plying the expectations operator to (20) yields

(21)

E

yt(3)

=

y+

1 2 y2

+

1 2


y j, jE
j=0

[t

 t]

The last term in (20) vanishes as the triple Kronecker product in expectation is the columnwise

vectorization of the third moment of the exogenous shocks, equal to zero under normality. Likewise,

the Kronecker product in expectation is the columnwise vectorization of the second moment of

the exogenous shocks. Only the contemporaneous variance appears because the shock vector is

assumed serially uncorrelated. The other two terms containing t-i in (20) also disappear as the shock is mean zero. From a different perspective, the deterministic steady state is the mean of

the zeroth order approximation where all shocks, past, present and future are zero. It remains the

mean in a first order approximation, as the exogenous shocks are mean zero (first moment is zero).

At second order, the second moments of the shocks are included--both past and present (in the

10

term j=0 y j, jE [t  t]) as well as future shocks (in the term y2)--which are assumed nonzero, generating an adjustment from the deterministic steady state. When the approximation moves to the third order, the calculation of the mean of (20) would be accordingly adjusted for the first three moments of all the realized and future shocks, but the mean zero and normality assumptions render the first and third moments of the shocks zero, thus leaving the first moment at third order identical to its value from a second order approximation.

5.2 Variance and Autocovariances

While we could conceivably compute the second moments (variance and autocovariances) of (20)

using the Volterra expansion directly, it would be a rather complicated operation on the products of

multi-layered infinite summation of coefficients. As an alternative, we use the recursive expression

of (20) derived in Lan and Meyer-Gohde (2013) to compute the second moments.

Computing the second moments using the recursive expression of (20), we need to proceed se-

quentially through the orders of approximation and exploit the linearly recursive (in order) structure

of the solution.11 That is, the second moments of the approximation at any order can always be

expressed as the sum of the second moments of the approximation of the previous order and the

second moments of all the previous order increments (the difference between two approximations

of adjacent order, subtracting the constant risk adjustment of the higher order). In other words, the

embedded decomposition into order of approximation in the nonlinear approximations of the policy

function (19) is preserved its second moments.

The first order approximation of (19) takes the form of a linear moving average, yt(1) = y +

i=0 yit-i, and can be expressed recursively as12

(22)

yt(1) - y =  yt(1)state - ystate + 0t

11The terminology if Lombardo's (2010). In Lan and Meyer-Gohde (2013), we compare Lombardo's (2010), others, and our recursive representation.
12See Lan and Meyer-Gohde (2013). This is, of course, an standard result for linear models. Compare, e.g., the state
space representations of Uhlig (1999) with the infinite moving average representations of Taylor (1986).

11

where the difference yt(1) - y is the deviation of the first order approximation with respect to the deterministic steady state, and identical to the first order increment (23) dyt(1)  yt(1) - y

which captures the addition to the approximation contributed by the time varying terms of the current, here first, order of approximation, as y is the zeroth order approximation13 and the constant

risk adjustment of first order, y, is zero. In addition (24) E dyt(-1)1t = 0

as the current shock is not correlated with the endogenous variables in the past. Under the orthog-

onality condition (24), the sequence of autocovariances of endogenous variables or, at this order equivalently, of the first order increment yj(1) = (j1) = E dyt(1)dyt(-1)j , solves the following Lya-

punov equation

(25)

yj(1) = yj(1)  + 0E[t t- j]0

The second order approximation of the policy function (19) captures the amplification effects of

the realized shocks up to second order, and the constant risk adjustment for future shocks

  (26)

yt(2)

=

y+

1 2 y2


+ yit-i
i=0

+

1 2


y j,i(t- j
j=0 i=0

 t-i)

Defining the second order increment

(27)

dyt(2)



yt(2)

- yt(1)

-

1 2 y2

which more clearly illustrates the notion of increment we use here; the addition the approximation

contributed by time varying components of current order (or the difference between the current

and previous order of approximation, here yt(2) - yt(1), less the additional constant contributed by

the

current

order,

here

1 2

y2

).

The

second

moments

of

the

second

order

approximation

(26)

can

be

expressed as the sum of the second moments of the first order approximation and those of the order

increment. We summarize the results for a second order approximation in the following proposition

13This is the terminology in Anderson, Levin, and Swanson (2006, p. 17) and Borovicka and Hansen (2012, p. 22).

12

Proposition 5.1. Assuming the exogenous shocks are normally distributed, the j'th autocovariance

of the second order approximation (26) is of the form

(28)

yj(2) = yj(1) + (j2)

where (29) (30) (31)

yj(2) = E yt(2) - Eyt(2) yt(-2)j - Eyt(2)  yj(1) = (j1) = E dyt(1)dyt(-1)j (j2) = E dyt(2) - Edyt(2) dyt(-2)j - Edyt(2) 

Proof. See the appendices.

The second order increment dyt(2) can likewise be expressed recursively.14 With that recursive expression in hand, the unknown (j2) in (28) can be computed by formulating an appropriate Lyapunov equation. We regelate all details to the appendices.
Likewise, to compute the second moments of endogenous variables using the third order approximation (20), we define the third order increment (32) dyt(3)  yt(3) - yt(2) which is merely the difference between the third and second order approximations, as the third order approximation adds no additional constant terms under normality. We summarize the resulting second moment calculations at third order in the following proposition

Proposition 5.2. Assuming the exogenous shocks are normally distributed, the j'th autocovariance

of the third order approximation (20) takes the form

(33)

yj(3) = yj(2) + (j3) + (j1),(3) + (j1),(3) 

14See, again, Lan and Meyer-Gohde (2013).

13

where

(34)

yj(3) = E yt(3) - Eyt(3)

(35) (j3) = E dyt(3)dyt(-3)j

(36)

(j1),(3) = E dyt(1)dyt(-3)j

and yj(2) is as defined in Proposition 5.1.

yt(-3)j - Eyt(3) 

Proof. See the appendices.
yj(3) is the j'th autocovariance of endogenous variables computed using the third order approximation (20), (j3) the j'th autocovariance of the third order increment dyt(3), and (j1),(3) the j'th autocovariance between the first and the third order increments dyt(1) and dyt(3). Analogous to (28)
in Proposition 5.1, (33) decomposes the second moments into order of approximation: When the
approximation moves to the third order, the second moments of endogenous variables are those computed using second order approximation (26), adjusted by the second moments of dyt(3) itself and the interaction with the first order increment dyt(1).
With the recursive form of the third order increment dyt(3),15 the two unknown quantities, (j3) and (j1),(3), in (33) for calculating the covariance matrices of the third order approximation can be computed by formulating appropriate Lyapunov equations. The details are in the appendices.

5.3 A Variance Decomposition

The third order approximation, (20), decomposes naturally into orders of nonlinearity and risk ad-

justment. This dissects the individual contributions of the sequence of realized shocks and future

shocks and a variance decomposition can be accordingly derived to analyze the composition of the

volatility of endogenous variables.

Let

yt(3)risk



1 2

y2

+

1 2

i=0

y2,it-i

denote

risk

adjustment

channel,

with

a

constant

risk

adjust-

ment

at

second

order

(

1 2

y2

)

and

a

time-varying

risk

adjustment

channel

at

third

order

(

1 2

i=0

y2

,i

t

-i)

15See, again, Lan and Meyer-Gohde (2013).

14

and yt(3)amp collect all the other terms in the third order approximation (20) capturing the amplifica-

tion effects, we can rewrite (20) as

(37)

yt(3)  yt(3)risk + yt(3)amp

Centering the previous equation around its mean,16 multiplying the resulting expression with its

transposition and applying the expectations operator yields the following variance decomposition

(38)

0y(3)

=

y(3)risk
0

+ y(3)risk,amp
0

+ y0(3)amp

where

0y(3)

is

the

variance

of

the

endogenous

variables.

y(3)risk
0

=

E

yt(3)risk - Eyt(3)risk

yt(3)risk - Eyt(3)risk 

stores the variations in the endogenous variables come from the time-varying risk adjustment chan-

nel alone.

y(3)amp
0

=

E

yt(3)amp - Eyt(3)amp

yt(3)amp - Eyt(3)amp  stores the variations come

from

the

amplification

channels

of

all

three

orders.

y(3)risk,amp
0

is

the

sum

of

E

yt(3)amp - Eyt(3)amp yt(3)risk

and its transposition, storing the variations come from the interaction between the two types of chan-

nels.

Both

yt(3)risk

and

yt(3)am p

can

be

expressed

recursively.

With

those

recursive

expressions,

y(3)risk
0

and

y(3)amp
0

can

be

computed

by

formulating

appropriate

Lyapunov

equations

(See

the

appendices

for

details).

As

0y(3)

is

already

known

from

Proposition

5.2,

y(3)risk,amp
0

can

be

computed

by

subtracting

y(3)risk
0

and

y(3)amp
0

from

y0(3) .

5.4 Simulated Moments

Apart from the theoretical moments, we can simulate the third order approximation (20) and com-

pute the moments of the simulated series to analyze the statistical implications of the model. Lan

and Meyer-Gohde (2012) show that nonlinear approximation of the policy function (19) preserve

the stability of the linear approximation or first order approximation and, hence, does not generate

explosive time paths in simulations.

Simulation methods for moment calculations are, however, not always feasible for state space

16Note

E yt(3)risk

=

1 2

y2

and

E yt(3)am p

=

y+

1 2

j=0

y j, jE

[t

 t ].

15

perturbations. Aruoba, Ferna¥ndez-Villaverde, and Rubio-Ram¥irez (2006), Ferna¥ndez-Villaverde and Rubio-Ram¥irez (2006) and Kim, Kim, Schaumburg, and Sims (2008) note that higher order Taylor approximations to state space perturbation policy function can be potentially explosive in simulations. Truncation of the distribution from which exogenous shocks are drawn or the application of pruning schemes, like proposed by Kim, Kim, Schaumburg, and Sims (2008) for a second order approximation,17 can prevent such behavior. While this imposes stability on simulations of higher order approximations, pruning is an ad hoc procedure as noted by Lombardo (2010) and potentially distortive even when the simulation is not on an explosive path (See, Den Haan and De Wind (2012)). Though this might give rise to reasonable doubts regarding the accuracy and validity of moments calculated using perturbations, we will show that this is not the case with our nonlinear moving average.
As (20) generates stable time paths, moments computed by simulating (20) should asymptotically converge to their theoretical counterparts.
[Figure 1 about here.]
Figure 1 is an example of this check. It depicts the evolution path of the density of the simulated variance of the pricing kernel in the model described in Section 2 under the benchmark calibration. Densities of the simulated variance of the pricing kernel are calculated using a kernel density estimation and 100 simulations at the indicated length. The theoretical variance, denoted by the red dashed line, is 0.0666 and all densities are in general centered around this value. The distributions of simulated variance are more dispersed in short-run simulations, tightening up to the theoretical value as the length increases consistent with asymptotic convergence of the simulated moments to their theoretical couterparts we calculated above.
17See Lan and Meyer-Gohde (2013) for an overview and comparison of pruning algorithms at second and third order and their relation to our nonlinear moving average.
16

6 Analysis
In this section, we report the performance of the model under the different calibrations. We present impulse responses of shocks in productivity growth and its volatility for both macroeconomic and asset pricing variables, to analyze the role of the amplification and risk adjustment channel in shock propagation. We then proceed to the moments and the results of the variance decomposition introduced in Section 5.3 to identify and quantify the individual contribution of the time-varying risk adjustment channel to the total variation. In addition, we analyze effect of adding stochastic volatility on model's ability of attaining the Hansen-Jagnanthan bounds.
6.1 Impulse Responses and Simulations
We analyze the impulse responses to shocks in productivity growth and shock in its volatility for macroeconomic and asset pricing variables. We also simulate the conditional market price of risk under stochastic volatility and with growth shocks of constant variance to observe the change in the variations of this variable under conditional heteroskedasticity.
[Figure 2 about here.]
Figure 2 depicts the impulse response and its contributing components for capital to a positive, one standard deviation shock in a,t. The upper panel displays the impulse responses at first, second and third order as deviations from their respective (non)stochastic steady states (themselves in the middle right panel). In the the middle left panel and the middle column of panels in the lower half of the figure, the contributions to the total impulse responses from the first, second and third order amplification channels, that is, yi, yi,i and yi,i,i in the third order approximation (20), are displayed. Notice that there is no response in these amplification channels. All responses to this volatility shock come from the lower left panel of the figure where the time-varying risk adjustment channel y2,i is displayed. In other words, for capital, a volatility shock by itself propagates solely through the time-varying risk adjustment channel.
17

Capital responds positively to a positive volatility shock. This captures the household's precautionary reaction to the widening of the distribution of future shocks. Our risk-averse household accumulates a buffer stock in capital to ensure itself against the increased future risk of productivity growth shocks from a more dispersed distribution.
[Figure 3 about here.]
Figure 3 depicts the systematic responses at the third order of macroeconomic variables as deviations from their nonstochastic steady states to a positive, one standard deviation volatility shock. The household accumulates a buffer stock of capital by increasing current investment on impact of the shock. As the allocation has not changed, the household finances this investment through a decrease in current consumption, resulting in an increase in the marginal utility of consumption. The intratemporal labor supply equation (8) implies this increased marginal utility of consumption leads to an increase in the marginal utility of leisure, and therefore a decrease in time spend on leisure. The increased labor effort, with the capital stock being fixed on impact as it is a state variable and with the productivity having not changed,18 translates into an increase in current output partially offsetting the costs borne by consumption of the increased investment for the buffer stock of capital. Thus, this model predicts a boom in economic activity following an increase in risk, as firms produce and households work to accumulate the necessary buffer stock. A richer model of investment that, for example, includes variable capacity utilization can overturn this result, see Bidder and Smith (2012). While the impulse responses for the macroeconomic variables are not pictured with their contributing components, responses of these variables to a volatility shock come solely from the time-varying risk adjustment channel. The volatility shock is persistent but not permanent. As the shock dies out and productivity shocks fail to materialize from their widened distribution, the household winds down its buffer stock of capital by increasing consumption and leisure, leading to a fall in output and investment.
18Remember, it is the distribution governing future productivity shocks that is being shocked here, not the level of productivity itself.
18

[Figure 4 about here.]
Figure 4 depicts the impulse responses and their contributing components for the expected risk premium to positive, one standard deviation shocks in a,t and z,t (Figure 4a and 4b respectively). Note that both the volatility shock and productivity growth shock propagate solely through y2,i the time-varying risk adjustment channel for this variable and there are no responses in the amplification channels of any of the three orders. Moreover, the responses to the volatility shock are almost two orders magnitude larger than the responses to the growth shock. Hence, figure 4 implies that almost all the variations in this variable are driven solely by volatility shocks with the contribution of the growth shock to the total variation negligible.
[Figure 5 about here.]
Figure 5 depicts the simulated time paths of the squared conditional market price of risk19 under the second and the baseline calibration of the model (Figure 5a and 5b respectively). When there is no volatility shock, the conditional market price exhibits minimal fluctuations along the simulation path. Adding stochastic volatility, however, induces a substantial amount of variations in this variable. This is consistent with the interpretation that volatility shocks are a source of conditional heteroskedasticity. The displayed time variation in the conditional market price of risk is roughly consistent with the empirical variations in the (lower bound of) market price of risk as measured over different periods of time the past 130 odd years (See, Cogley and Sargent (2008, p. 466)).
6.2 Moments Comparison
We compare the mean and standard deviations of the third order approximation (20) to those reported in Tallarini (2000) for his model and post-war U.S. data. The results of the variance decomposition in Section 5.3 are reported, allowing us to pin down the contribution from the time-varying risk adjustment channel to the total variance of the endogenous variables.
19We square this variable to eliminate the kink at the deterministic steady state, so that perturbation methods can be applied.
19

[Table 3 about here.]

The third column of Table 3 reports the theoretical means under the baseline calibration of the

model. The fourth column reports means of Tallarini's (2000) model under the same calibration but

without the volatility shock. For both macroeconomic and asset pricing variables, our theoretical means are in line with those of Tallarini (2000)20. As (21) implies, the theoretical means will

generally differ from the deterministic steady states reported in the second column of the table since

the mean at second and third order is adjusted for the infinite sum of variance over realized shocks

1 2

j=0 y j, jE

(t

 t)

and

the

variance

of

future

shocks

1 2

y2

.

[Table 4 about here.]

The second column of Table 4 reports the theoretical standard deviations of the third order approximation (20) under the baseline calibration of the model. Comparing to the standard deviations reported in the third and fourth column, the theoretical standard deviations are in line with those reported in Tallarini (2000), both model based and empirical.

[Table 5 about here.]

Table 5 reports the results of the variance decomposition under the baseline and the second
calibration without stochastic volatility. For each calibration, the table reports the percentage contributions of the first order amplification channel yt(1) and the time-varying risk adjustment channel yt(3)risk to the total variance of the endogenous variables as the overall majority of variations come from these two channels. The second and third column report the decomposition results in absence
of volatility shock and the last two columns in presence of volatility shock. For the conditional
market price of risk and the expected risk premium, all variation comes from the time-varying risk
20The fact that Tallarini chooses an iterative implementation of a modified LQ approximation method proposed by Hansen and Sargent (1995) to solve his model may account for the remaining difference.

20

adjustment channel regardless of whether there is volatility shock. This is consistent with the impulse responses for the expected risk premium (Figure 4), where we observed that both the growth and volatility shock propagate solely through the time-varying risk adjustment channel.
For the risk premium and macroeconomic variables, adding the volatility shock alters the composition of variance. In the absence of the volatility shock, the contribution of the time-varying risk adjustment channel is negligible and almost all variation comes from the first order amplification channel. Adding stochastic volatility, however, operationalizes the time-varying risk channel, as a large portion of variance now comes through this channel. Since, for macroeconomic variables, actions in the time-varying risk adjustment channel can be explained by the risk-averse household's precautionary motives, this variance decomposition result implies that such motives account for a larger portion of variance in the presence of stochastic volatility than in the absence thereof.
From a methodological point of view, in the absence of stochastic volatility shock, a first order linear approximation would thus appear sufficient for computing the theoretical variance of macroeconomic variables. However, theoretical variances need to be computed using a third order approximation in the presence of stochastic volatility and for conditional asset pricing measures, as otherwise a large portion or all of the variance will be missed through the neglect of time varying risk adjustment and higher order amplification effects.
6.3 Stochastic Volatility and Hansen-Jagannathan Bounds
We evaluate the model's ability of attaining the Hansen-Jagannathan bounds under the three different calibrations, as they are an important empirical measure for a model's ability to replicate asset pricing facts that depend on the first two moments of the pricing kernel.
[Figure 6 about here.]
Figure 6 depicts the unconditional mean standard deviation pairs of the pricing kernel generated by the model under the three different calibrations. Under the baseline (stochastic volatility) and
21

second (constant variance) calibrations, the preferences are in recursive form, and therefore when the volatility of the kernel increases with risk aversion (here from one to five, ten, twenty, thirty, forty, fifty, and one hundred), the unconditional mean of the kernel is left (essentially) unchanged and the model approaches the Hansen-Jagannathan Bounds from below. The expected utility calibration generates a volatile pricing kernel at the cost of reducing its unconditional mean, as the EIS and risk aversion are inversely correlated in the expected utility, generating Weil's (1989) risk free rate puzzle. Figure 6a shows that given the same value of risk aversion, the calibration with stochastic volatility (baseline calibration) generates a more volatile pricing kernel than the constant volatility calibration. In other words, to generate certain amount of volatility in the pricing kernel, the model with volatility shock appears to need less risk aversion than the model without volatility shock. This is achieved, however, at the cost of increasing the variance of the log consumption growth. As figure 6b shows, if we hold that variance constant at its empirical counterpart by reducing the homoskedastic component of the productivity growth shock, the effect of volatility shock in terms of further increasing the volatility in the pricing kernel vanishes, reiterating the conditional heteroskedastic interpretation of volatility shocks.
7 Conclusion
We have solved a business cycle model with recursive preferences and stochastic volatility with a third order perturbation approximation to the nonlinear moving average policy function. We use the impulse responses generated by this third order approximation to analyze the propagation mechanism of a volatility shock, and find that for macroeconomic variables, a volatility shock by itself propagates solely through a time-varying risk adjustment channel. For conditional asset pricing variables, this time-varying risk adjustment channel is the only working channel for the transmission of shocks, both to productivity growth and its volatility.
We have derived a closed-form calculation of the theoretical moments of the endogenous vari-
22

ables using a third order approximation. Our calculation of moments lends itself to a decomposition that disentangles the individual contributions of time-varying risk adjustment and amplification channels to the total variance. In our model, we find that adding stochastic volatility alters the composition of variance, making a time-varying risk channel a substantial contributor of variance. For macroeconomic variables, variations that come from the time-varying risk adjustment channel can be explained by the household's precautionary savings desires and, in the presence of stochastic volatility, we find a large portion of variations in macroeconomic variables is driven by precautionary behavior.
In linear approximations, variance decompositions can be applied to study the individual contribution of each shock to the total variance. The channels of risk adjustment and amplification we have derived here are perhaps a step towards extending this shock-specific decomposition to nonlinear perturbation approximations.
23

References
ADJEMIAN, S., H. BASTANI, M. JUILLARD, F. MIHOUBI, G. PERENDIA, M. RATTO, AND S. VILLEMOT (2011): "Dynare: Reference Manual, Version 4," Dynare Working Papers 1, CEPREMAP.
ANDERSON, G. S., A. LEVIN, AND E. SWANSON (2006): "Higher-Order Pertubation Solutions to Dynamic Discrete-Time Rational Expectations Models," Federal Reserve Bank of San Francisco Working Paper Series 2006-01.
ANDREASEN, M. M. (2012): "On the Effects of Rare Disasters and Uncertainty Shocks for Risk Premia in Non-Linear DSGE Models," Review of Economic Dynamics, 15(3), 295C316.
ANDREASEN, M. M., J. FERNA¥ NDEZ-VILLAVERDE, AND J. RUBIO-RAM¥IREZ (2012): "The Pruned State-Space System for Non-Linear DSGE Models: Theory and Empirical Applications," Mimeo December.
ARUOBA, S. B., J. FERNA¥ NDEZ-VILLAVERDE, AND J. F. RUBIO-RAM¥IREZ (2006): "Comparing Solution Methods for Dynamic Equilibrium Economies," Journal of Economic Dynamics and Control, 30(12), 2477≠2508.
BACKUS, D. K., B. R. ROUTLEDGE, AND S. E. ZIN (2005): "Exotic Preferences for Macroeconomists," in NBER Macroeconomics Annual 2004, Volume 19, NBER Chapters, pp. 319≠414. National Bureau of Economic Research, Inc.
BANSAL, R., AND A. YARON (2004): "Risks for the Long Run: A Potential Resolution of Asset Pricing Puzzles," The Journal of Finance, 59(4), 1481C1509.
BIDDER, R. M., AND M. E. SMITH (2012): "Robust Animal Spirits," Journal of Monetary Economics, 59(8), 738≠750.
BLANCHARD, O., AND J. SIMON (2001): "The Long and Large Decline in U.S. Output Volatility," Brookings Papers on Economic Activity, 32(1), 135≠174.
BLOOM, N. (2009): "The Impact of Uncertainty Shocks," Econometrica, 77(3), 623≠685.
BOROVICKA, J., AND L. P. HANSEN (2012): "Examining Macroeconomic Models through the Lens of Asset Pricing," Working Paper Series WP-2012-01, Federal Reserve Bank of Chicago.
CALDARA, D., J. FERNA¥ NDEZ-VILLAVERDE, J. RUBIO-RAM¥IREZ, AND W. YAO (2012): "Computing DSGE Models with Recursive Preferences and Stochastic Volatility," Review of Economic Dynamics, 15(2), 188≠206.
COGLEY, T., AND T. J. SARGENT (2008): "The Market Price of Risk and the Equity Premium: A Legacy of the Great Depression?," Journal of Monetary Economics, 55(3), 454≠476.
DEN HAAN, W. J., AND J. DE WIND (2012): "Nonlinear and Stable Perturbation-Based Approximations," Journal of Economic Dynamics and Control, 36(10), 1477≠1497.
24

EPSTEIN, L. G., AND S. E. ZIN (1989): "Substitution, Risk Aversion, and the Temporal Behavior of Consumption and Asset Returns: A Theoretical Framework," Econometrica, 57(4), 937≠69.
FERNA¥ NDEZ-VILLAVERDE, J., P. A. GUERRO¥ N-QUINTANA, J. RUBIO-RAM¥IREZ, AND M. URIBE (2011): "Risk Matters: The Real Effects of Volatility Shocks," American Economic Review, 101(6), 2530 ≠ 61.
FERNA¥ NDEZ-VILLAVERDE, J., AND J. RUBIO-RAM¥IREZ (2010a): "Macroeconomics and Volatility: Data, Models, and Estimation," NBER Working Papers 16618, National Bureau of Economic Research, Inc.
(2010b): "Macroeconomics and Volatility: Data, Models, and Estimation," Mimeo December.
FERNA¥ NDEZ-VILLAVERDE, J., AND J. F. RUBIO-RAM¥IREZ (2006): "Solving DSGE Models with Perturbation Methods and a Change of Variables," Journal of Economic Dynamics and Control, 30(12), 2509≠2531.
HANSEN, L. P., AND R. JAGANNATHAN (1991): "Implications of Security Market Data for Models of Dynamic Economies," Journal of Political Economy, 99(2), 225≠62.
HANSEN, L. P., AND T. J. SARGENT (1995): "Discounted Linear Exponential Quadratic Gaussian Control," Automatic Control, IEEE Transactions on, 40(5), 968 ≠971.
(2007): Robustness. Princeton University Press.
JIN, H.-H., AND K. L. JUDD (2002): "Pertubation Methods for General Dynamic Stochastic Models," Mimeo April.
JINADASA, K. G., AND D. S. TRACY (1986): "Higher Order Moments of Random Vectors Using Matrix Derivatives," Stochastic Analysis and Applications, 4(4), 399 ≠ 407.
JUDD, K. L. (1998): Numerical Methods in Economics. MIT Press, Cambridge, MA.
JUSTINIANO, A., AND G. E. PRIMICERI (2008): "The Time-Varying Volatility of Macroeconomic Fluctuations," American Economic Review, 98(3), 604≠41.
KIM, J., S. KIM, E. SCHAUMBURG, AND C. A. SIMS (2008): "Calculating and Using SecondOrder Accurate Solutions of Discrete Time Dynamic Equilibrium Models," Journal of Economic Dynamics and Control, 32(11), 3397≠3414.
KREPS, D. M., AND E. L. PORTEUS (1978): "Temporal Resolution of Uncertainty and Dynamic Choice Theory," Econometrica, 46(1), 185≠200.
LAN, H., AND A. MEYER-GOHDE (2012): "Solving DSGE Models with a Nonlinear Moving Average," Mimeo July.
(2013): "Pruning in Perturbation DSGE Models: Guidance from Nonlinear Moving Average Approximations," Mimeo.
25

LOMBARDO, G. (2010): "On Approximating DSGE Models by Series Expansions," Working Paper Series 1264, European Central Bank.
MAGNUS, J. R., AND H. NEUDECKER (1979): "The Commutation Matrix: Some Properties and Applications," The Annals of Statistics, 7(9), 383≠394.
MEHRA, R., AND E. C. PRESCOTT (1985): "The Equity Premium: A Puzzle," Journal of Monetary Economics, 15(2), 145≠161.
RUDEBUSCH, G. D., AND E. T. SWANSON (2012): "The Bond Premium in a DSGE Model with Long-Run Real and Nominal Risks," AEJ: Macroeconomics, 4(1), 105 ≠ 143.
SCHMITT-GROHE¥ , S., AND M. URIBE (2004): "Solving Dynamic General Equilibrium Models Using a Second-Order Approximation to the Policy Function," Journal of Economic Dynamics and Control, 28(4), 755≠775.
SIMS, C. A., AND T. ZHA (2006): "Were There Regime Switches in U.S. Monetary Policy?," American Economic Review, 96(1), 54≠81.
STOCK, J. H., AND M. W. WATSON (2003): "Has the Business Cycle Changed and Why?," in NBER Macroeconomics Annual 2002, ed. by M. Gertler, and K. Rogoff, vol. 17, pp. 159≠230. MIT Press.
TALLARINI, JR., T. D. (2000): "Risk-Sensitive Real Business Cycles," Journal of Monetary Economics, 45(3), 507≠532.
TAYLOR, J. B. (1986): "Econometric Approaches to Stabilization Policy in Stochastic Models of Macroeconomic Fluctuations," in Handbook of Econometrics, ed. by Z. Griliches, and M. D. Intriligator, vol. 3 of Handbook of Econometrics, chap. 34, pp. 1997≠2055. Elsevier.
TRACY, D. S., AND S. A. SULTAN (1993): "Higher Order Moments of Multivariate Normal Distribution Using Matrix Derivatives," Stochastic Analysis and Applications, 11(3), 337 ≠ 348.
UHLIG, H. (1999): "A Toolkit for Analysing Nonlinear Dynamic Stochastic Models Easily," in Computational Methods for the Study of Dynamic Economies, ed. by R. Marimon, and A. Scott, chap. 3, pp. 30≠61. Oxford University Press.
VAN BINSBERGEN, J. H., J. FERNA¥ NDEZ-VILLAVERDE, R. S. KOIJEN, AND J. RUBIO-RAM¥IREZ (2012): "The term structure of interest rates in a DSGE model with recursive preferences," Journal of Monetary Economics, 59(7), 634≠648.
WEIL, P. (1989): "The Equity Premium Puzzle and the Risk-Free Rate Puzzle," Journal of Monetary Economics, 24(3), 401≠421.
(1990): "Nonexpected Utility in Macroeconomics," The Quarterly Journal of Economics, 105(1), 29≠42.
26

A Appendices
A.1 Detrending the Model

Stationary consumption, investment, capital stock and output, denoted by the lower case letters, are

defined as follows

(39)

ct



Ct eZt

,

It



It eZt

,

kt



Kt eZt

,

yt



Yt eZt

,

For notational ease in detrending the model, we define a combined shock a,t, containing both

the homoskedastic and heteroskedastic components of the productivity growth shock

(40)

a,t  zez,t z,t

The productivity growth process can therefore be written as

(41) at  Zt - Zt-1 = a + a,t

While detrending, the exponential form of the foregoing will be frequently used

(42)

eat

=

eZt eZt-1

= ea+a,t

The goal is essentially to substitute Ct, It, Kt and Yt for their stationary counterparts in the relevant

model equations. We start with the production function

(43) (44) (45)

yt eZt = kt-1eZt-1  eZt Nt 1-

yt =

eZt eZt-1

-
kt-1Nt1-

yt = e-(a+a,t)kt-1Nt1-

Detrending the capital accumulation law

(46) kt eZt = (1 - ) kt-1eZt-1 + it eZt

(47)

kt

=

(1

-

)

eZt-1 eZt

kt-1

+

it

(48) kt = (1 - )e-a-a,t kt-1 + it

Detrending the market clearing condition is straightforward as it is a contemporaneous relation-

27

ship

(49) yt eZt = ct eZt + it eZt

(50) yt = ct + it

Combing (45), (48) and (50) yields the detrended resource constraint

(51)

ct + kt = e-(a+a,t)kt-1Nt1- + (1 - )e-a-a,t kt-1

Detrending the labor supply equation

(52)

 1 - Nt

=

1 ct eZt

(1

-

)

kt-1eZt-1

 eZt (1-)Nt-

(53)



1

 - Nt

=

(1

-

)e-(a+a,t

)

1 ct

kt-1Nt-

The risky rate rt is stationary and we reexpress it in terms of the stationary variables

(54) 1 + rt = (1 - ) +  kt-1eZt-1 -1 eZt Nt 1-

(55) 1 + rt = (1 - ) + kt--11e(a+a,t)(1-)Nt1-

We now move to the value function. As the felicity function is logarithmic in nonstationary

consumption, removing the trend in consumption will leave a term linear in the level of productivity

that when subtracted from Vt gives the stationary value function vt (56) vt = Vt - b ln eZt = Vt - bZt

Substituting the relevant variables for their stationary counterparts yields

(57)

vt + bZt = ln ct eZt

+



ln(1

-

Nt

)

+



2 

ln

Et

exp

 2

[vt

+1

+

bZt+1]

(58)

vt

=

ln ct

+

 ln(1

-

Nt) +



2 

ln

Et exp

 2

vt+1 + b

Zt

+1

-

b-1 b

Zt

It follows that the remaining nonstationarities can be offset if

(59)

b-1 b

=

1

which pins down b as

(60)

b

=

1 1-

28

Inserting (60) in (58) yields the stationary value function

(61)

vt

=

ln

ct

+



ln(1

-

Nt

)

+



2 

ln

Et

exp

 2

vt+1

+

1

1 -



(a

+

a,t+1)

While stationary, the foregoing value function does not fit in the problem statement (18) in the

text, thus can not be implemented directly in perturbation software packages like Dynare. This

problem is caused by nonlinear twisting of the expected continuation value, and can be fixed by

redefining this conditional expectation as a new variable known in period t. Besides, the twisted

expected continuation value is numerically unstable, due to the logarithmic transformation, when 

approaches zero or becomes very large. To counteract this, we define21

(62)

vt  Et exp

 2

vt+1

+

1

1 -



t+1

-

v

where v denotes the deterministic steady state value of the stationary value function (61) and can be

computed as follows

(63)

v

=

1 1-

ln

c

+



ln(1

-

N)

+

1

 -



a

Substituting vt+1 in (61) for vt yields the normalized, stationary value function

(64)

vt

=

ln ct

+  ln(1

- Nt)

+



2 

ln

vt

+

 2

1

1 -



a

+

v

With the stationary value function in hand, we reexpress the pricing kernel in terms of stationary

variables (65)

mt+1

=



ct

ct eZt +1eZt

+1

Et

exp exp

 2
 2

vt+1

+

1 1-

Zt+1

vt

+1

+

1 1-

Zt

+1

Multiplying both the denominator and numerator of the foregoing with exp

-

 2

1 1-

Zt

, and

rearranging yields

(66)

mt+1

=

 ct e-(a+a,t+1)

ct+1

Et

exp exp

 2
 2

vt

+1

+

1 1-

(a

+

a,t+1)

vt+1

+

1 1-

(a

+

a,t+1)

Writing out the definition of a,t+1 yields (13) in the text. Recognizing the expectational term in

the previous equation can be replaced by the product vt exp

 2

v

+

1 1-

a

, we substitute it for this

21Rudebusch and Swanson (2012) adopt, in their companion Mathematica codes, a very similar procedure to improve numerical stability.

29

product and collect terms

(67)

mt+1

=



ct ct+1

e-(a+a,t+1)

exp

 2

vt+1

+

1 1-

a,t

+1

-

v

vt

The period t counterpart of the foregoing follows

(68)

mt

=

 ct-1 ct

e-(a+a,t )

exp

 2

vt

+

1 1-

a,t

-

v

vt-1

A.2 Proof of Proposition 5.1

Rearrange the definition of the second order increment to express the second order approximation as

the sum of the first order approximation, the second order increment, and the second order constant

risk adjustment

(69)

yt(2)

=

yt(1)

+ dyt(2)

+

1 2 y2

Applying the expectations operator to the foregoing yields the mean of the second order approxima-

tion

(70)

E yt(2)

=

E yt(1)

+

E d yt(2)

+

1 2 y2

Centering the second order approximation (69) around its mean by subtracting (70) from (69) yields

(71) yt(2) - Eyt(2) = yt(1) - Eyt(1) + dyt(2) - Edyt(2)

Noting that the mean of the first order approximation is the deterministic steady state of yt, i.e.,

Eyt(1) = y, the foregoing can be rewritten as

(72) yt(2) - Eyt(2) = yt(1) - y + dyt(2) - Edyt(2)

Using the definition of the first order increment dyt(1)  yt(1) - y, the foregoing is

(73) yt(2) - Eyt(2) = dyt(1) + dyt(2) - Edyt(2)

Multiplying the foregoing with its transposition at t - j and noting that Eyt(2) = Eyt(-2)j and Edyt(2) =

Edyt(-2)j yields

(74)

yt(2) - Eyt(2) yt(-2)j - Eyt(2) 

= dyt(1) + dyt(2) - Edyt(2)

dyt(-1)j + dyt(-2)j - Edyt(2) 

30

=dyt(1)dyt(-1)j + dyt(2)dyt(-1)j - Edyt(2)dyt(-1)j + dyt(1)dyt(-2)j - dyt(1)Edyt(2) + dyt(2) - Edyt(2)

dyt(-2)j - Edyt(2) 

Applying the expectations operator to the foregoing delivers

(75)

E yt(2) - Eyt(2) yt(-2)j - Eyt(2) 

=E dyt(1)dyt(-1)j + E dyt(2)dyt(-1)j - Edyt(2)Edyt(-1)j

+ E dyt(1)dyt(-2)j - Edyt(1)Edyt(2) + E dyt(2) - Edyt(2)

dyt(-2)j - Edyt(2) 

To simplify the foregoing, apply the expectations operator to the definition of the first order incre-

ment, yielding its mean

(76) Edyt(1) = Eyt(1) - y

As Eyt(1) = y, the foregoing implies that the mean of the first order increment is zero

(77) Edyt(1) = 0

Using the this result and noting that Edyt(1) = Edyt(-1)j, (75) reduces to

(78)

E yt(2) - Eyt(2) yt(-2)j - Eyt(2) 

=E dyt(1)dyt(-1)j + E dyt(2)dyt(-1)j + E dyt(1)dyt(-2)j + E dyt(2) - Edyt(2) dyt(-2)j - Edyt(2) 

It then remains to show that (79) E dyt(2)dyt(-1)j = 0, E dyt(1)dyt(-2)j = 0

One way is to use the moving average representation of the order increments. I.e., inserting the

moving average representation of the first and second order approximations in the definition of the

order increments yields

(80) dyt(1) =  yit-i

i=0

 (81)

dyt(2)

=

1 2


y j,i(t- j
j=0 i=0

 t-i)

Therefore the product of the two order increments, when set in expectation, takes the form of the

31

third moments of the shocks, which is equal to zero under normality.

A.3 Proof of Proposition 5.2

First note that Eyt(3) = Eyt(2) under normality22. Given this result, applyingthe expectations operator to the definition of the third order increment dyt(3)  yt(3) - yt(2) immediately implies Edyt(3) = 0.

Next, rearranging the definition of the third order increment delivers

(82) yt(3) = yt(2) + dyt(3)

Applying the expectations operator to the foregoing yields (83) Eyt(3) = Eyt(2)

Centering (82) around its mean by subtracting (83) from (82) gives

(84)

yt(3) - Eyt(3) = yt(2) - Eyt(2) + dyt(3)

Multiplying the foregoing with its transposition at t - j and noting Eyt(3) = Eyt(-3)j and Eyt(2) = Eyt(-2)j

delivers

yt(3) - Eyt(3) yt(-3)j - Eyt(3)  =dyt(3)dyt(-3)j + yt(2) - Eyt(2) yt(-2)j - Eyt(2) 

+ dyt(3)yt(-2)j - dyt(3)Eyt(2) + yt(2)dyt(-3)j - Eyt(2)dyt(-3)j

Applying the expectations operator to the foregoing, noting Edyt(3) = 0, gives (85) E yt(3) - Eyt(3) yt(-3)j - Eyt(3)  =Et dyt(3)dyt(-3)j + E yt(2) - Eyt(2)

yt(-2)j - Eyt(2) 

+ E dyt(3)yt(-2)j + E yt(2)dyt(-3)j

Rewrite

the

definition

of

the

second

order

increment

dyt(2)



yt(2)

- yt(1)

-

1 2

y2

as

(86)

yt(2)

=

dyt(2)

+ yt(1)

+

1 2 y2

=

dyt(2)

+

dyt(1)

+

yØ +

1 2 y2

Given the foregoing expression and noting Edyt(3) = 0, E yt(2)dyt(-3)j on the right hand side of (85)

can be rewritten as (87) E yt(2)dyt(-3)j = E

dyt(2)

+

d

yt(1)

+

yØ

+

1 2

y2

dyt(-3)j

=E

dyt(1)dyt(-3)j

22To see this, applying the expectations operator to the second order approximation (26) and comparing the resulting expression with the mean of the third order approximation (21)

32

Noting that E dyt(2)dyt(-3)j is zero under normality23. Analogously, E dyt(3)yt(-2)j on the right hand

side of (85) can be written as (89)

E dyt(3)yt(-2)j = E dyt(3)dyt(-1)j

Inserting the last two equations in (85) yields E yt(3) - Eyt(3) yt(-3)j - Eyt(3)  =Et dyt(3)dyt(-3)j + E yt(2) - Eyt(2)
+ E dyt(1)dyt(-3)j + E dyt(3)dyt(-1)j

yt(-2)j - Eyt(2) 

A.4 Second Moments of dyt(2)

The second order increment dyt(2) can be expressed recursively as

(90)

dyt(2)

=

dyt(-2)1state

+

1 2

22dyts-ta1te[2] + 220

dyt(-1)1state  t

+ 00t[2]

If the previous equation can be cast as a linear recursion, then standard linear methods can be

applied to the computation of the second moments. Note dyt(2), besides being linearly autoregressive in the state variable block of itself dyt(-2)1state, is a linear function of all the second order permutations of products of the first order increment dyt(-1)1state and the shocks. This relationship guides the calculations, and we therefore compute the second moments of dyt(2)state first, then recover the second

moments of variables of interest24.

The state variable block of (90) takes the form

(91)

dyt(2)state

=

statedyt(-2)1state

+

1 2

s2t2at

edyt(-1)1st

at

e[2]

+

2st0ate

dyt(-1)1state  t

+

1 2

0st0atet[2]

To cast the foregoing in a linear recursion, we take the state variable block of the first order

increment dyt(1)state and raise it to the second Kronecker power, noting throughout we use (ns) to
23Again consider the moving average representation of the third order increment

   (88)

dyt(3)

=

1 2


y2,it-i
i=0

+

1 6

 k=0


yk, j,i(t-k
j=0 i=0

 t- j

 t-i)

When multiplying with the moving average representation of the second order increment, the result, in expectation, is a
sum of the third and fifth moments of shocks, and equal to zero under normality. 24This procedure is widely adopted to minimize the dimension and improve the speed of the computation. See, e.g.,
Uhlig's (1999) toolkit, Schmitt-Grohe¥ and Uribe's (2004) software package and Dynare.

33

denote the number of state variables

(92)

dyt(1)state[2] =state[2]dyt(-1)1state[2] + (Kns,ns + Ins2 ) state  0state + 0state[2]t[2]

dyt(-1)1state  t

where Kns,ns is a ns2 ◊ ns2 commutation matrix (See Magnus and Neudecker (1979)). Combing (91)

and (92) yields the following linear recursion containing the linear recursion of dyt(2)state

(93)

Xt(2) = (2)X Xt(-2)1 +

1 2

s0t0at

e

s0tate[2]

E

t[2]

+ (2)X t(2)

where

(94)

Xt(2) =

dyt(2)state dyt(1)state[2]

(95)

(2)X =

state 0

1 2

s2t2ate

state[2]

(96)

(2)X =

1 2

s0t0at

e

0state[2]

s2t0ate (Kns,ns + Ins2) state  0state

(97)

t(2) =

t[2] - Et[2] dyt(-1)1state  t

While the second term on the right hand side of (93) vanishes after centering (93) around its

mean, it ensures, by compensating the subtraction of E t[2] in t(2), that t(2) is orthogonal25 to Xt(-2)1 (98) E Xt(-2)1t(2) = 0
With the linear recursion of Xt(2), the second order increment (90) can be recast as the following

linear recursion

(99)

dyt(2) = (2)Xt(-2)1 +

1 2

00

0 [2]

E

t[2]

+ (2)t(2)

where (2) = 

1 2

22

,

(2) =

1 2

00

0 [2]

Noting E t(2) = 0 by construction, and the mean of the foregoing writes

(100)

Edyt(2) = (2)EXt(2) +

1 2

00

0 [2]

E

t[2]

25This orthogonality condition significantly simplifies the calculation of the autocovariances that followed.

34

A.4.1 Contemporaneous Covariance

Centering (99) around its mean--by subtracting (100) from (99)--yields the following centered

linear recursion of the second order increment

(101)

dyt(2) - Edyt(2) = (2) Xt(-2)1 - EXt(2) + (2)t(2)

Multiplying the foregoing with its transposition and applying the expectations operator to the

resulting expression yields the contemporaneous variance of the second order increment

(102)

(02) = (2)(02)X (2) + (2)

where

(103)

0(2)X = E Xt(2) - EXt(2) Xt(2) - EXt(2) 

(104)

0(2) = E dyt(2) - Edyt(2) dyt(2) - Edyt(2) 

(105)

(2) = (2)E t(2)t(2) (2)

This requires the contemporaneous variance of Xt(2), i.e., 0(2)X , as well as E t(2)t(2) . Starting

with (02)X , we can proceed by applying the expectations operator to (93) to yield

(106)

EXt(2) = (2)X EXt(2) +

1 2

0st0ate

0state[2]

E

t[2]

Centering the foregoing around its mean yields

(107)

Xt(2) - EXt(2) = (2)X Xt(-2)1 - EXt(2) + (2)X t(2)

Multiplying the foregoing with its transposition and applying the expectations operator, it follows

the unknown contemporaneous variance of Xt(2) solves the following Lyapunov equation26

(108)

(02)X = (2)X (02)X (2)X + (2)X

where (109)

(2)X = (2)X E t(2)t(2) (2)X

26Note 0(2)X is of dimension (ns + ns2) ◊ (ns + ns2). For models with a large number of state variables, splitting (108) into four Sylvester equations of smaller size by exploiting the triangularity of (2)X and solving them one by one
is computationally a lot less expensive than solving (108) as a whole. This division also enables exploitation of the symmetry of 0(2)X and therefore can avoid redundant computations.

35

(110)

Thus, (02)X can be calculated given E t(2)t(2) and, therefore, 0(2)X in (102) too. We requires

this variance, which is given by

(111)

E

t(2)t(2)

=

(Ine2 + Kne,ne) [E (t t)  E (t t)] 0

0 0(1)X  E (t t)

In the right hand side of (111), 0(1)X is the state variable block of the contemporaneous variance

of the first order approximation (or of the first order increment), and therefore already known from

calculations at the first order.

The upper left entry of the right hand side of (111) contains the fourth moment of the shocks

and can be computed using Tracy and Sultan's (1993, p. 344) formula. The two zero entries in (111) are due to the fact that the third moments of the shocks are zero under normality, and dyt(-1)1state is uncorrelated with current shocks.

A.4.2 Autocovariances

Now we turn to the autocovariances of dyt(2). To start, note that under normality, t(2) is serially

uncorrelated

(112)

E t(2)t(-2)j = 0  j > 0

Given the contemporaneous variance (02)X , multiplying (107) with the transposition of (101)

and taking expectation yields the contemporaneous variance between the Xt(2) and dyt(2)

(113)

(02)X,dy = (2)X 0(2)X (2) + (2)X,dy

where (114) (115)

(02)X,dy = E Xt(2) - EXt(2) dyt(2) - Edyt(2)  (2)X,dy = (2)X E t(2)t(2) (2)

With all the three contemporaneous variances in hand, the orthogonality (98) and (112) ensures

the autocovariance of dyt(2) can be computed with the following recursive formulae

(116)

(j2) = (2)(j2-)1X,dy

36

(117) where (118) (119)

(j2)X,dy = (2)X (j2-)1X,dy
(j2) = E dyt(2) - Edyt(2) dyt(-2)j - Edyt(2)  (j2)X,dy = E Xt(2) - EXt(2) dyt(-2)j - Edyt(2) 

A.5 Second Moments of dyt(3)

The third order increment can be expressed recursively as

(120)

dyt(3)

=dyt(-3)1state

+

1 6

333,1dyt(-1)1state[3] + 000t[3]

+ 22 dyt(-2)1state  dyt(-1)1state + 20 dyt(-2)1state  t

+1 2

300

dyt(-1)1state  t[2]

+ 330,1

dyt(-1)1state[2]  t

+ 20t + 21dyt(-1)1state

Its state variable block takes the form

(121)

dyt(3)state

=statedyt(-3)1state

+

1 6

s3t3a3t,e1dyt(-1)1state[3] + s0t0a0tet[3]

+ s2t2ate dyt(-2)1state  dyt(-1)1state + 2st0ate dyt(-2)1state  t

+1 2

s3t0a0te

dyt(-1)1state  t[2]

+ s3t3a0t,e1

dyt(-1)1state[2]  t

+ st2a0tet + st2a1tedyt(-1)1state

From the terms on the left hand side of the foregoing, we need to build up two additional recur-

sions, the first in the Kronecker product of the first and second order increments and the second in

the triple Kronecker product of the first order increment, to construct the linear recursion containing

dyt(3)state that can be used for calculating moments (122)

dyt(2)state  dyt(1)state =state[2] dyt(-2)1state  dyt(-1)1state +

1 2

2st2ate

 state dyt(-1)1state[3]

+ state  0state dyt(-2)1state  t +

1 2

s0t0at

e

 s0tate tstate[3]

+

2st0ate  state Knsne,ns +

1 2

s2t2at

e

 0state

dyt(-1)1state[2]  t

37

(123)

+

1 2

s0t0ate

 state Kne2,ns + 2st0ate  0state

dyt(1)state[3] =state[3]dyt(-1)1state[3] + s0tate[3]t[3]

dyt(-1)1state  t[2]

+ [(Kns,ns  Ins + Ins3 )Kns2,ns + Ins3 ] state[2]  s0tate dyt(-1)1state[2]  t

+ [Kns2,ns + (Kns,ns  Ins + Ins3 )] state  s0tate[2] dyt(-1)1state  t[2]

Given the foregoing two equations, along with the state variable block of the first order increment

(124)

dyt(1)state = statedyt(-1)1state + 0statet

we construct the following linear recursion

(125)

Xt(3) = (3)X Xt(-3)1 + (3)X t(3)

where27 (126)

 Xt(3) = dyt(2d)sytdat(yt1e)t(s3t)asttdeaytet([31])state ,
dyt(1)state

t(3) = dyt(-1)1stdaytdet(-y1)t(1-s2t)a1sttteat[t3e[][22]]-tEtt[2]

 

t

Note there is no need to center Xt(3) before computing its contemporaneous variance as its mean is

zero under normality, i.e., EXt(3) = 0. In the third entry of t(3), t[2] is adjusted using its mean, such

that t(3) is orthogonal to Xt(-3)1

(127)

E Xt(-3)1t(3) = 0

and it is can be shown that t(3) is serially uncorrelated

(128)

E t(3)t(-3)j = 0  j > 0

A.5.1 Contemporaneous Covariance

With linear recursion (125), the third order increment (120) can be cast in a linear recursion28

(129)

dyt(3) = (3)Xt(-3)1 + (3)t(3)

Multiplying the foregoing with its transposition and applying the expectations operator to the
27(3)X and (3)X are specified in section A.8. 28(3) and (3) are specified in section A.8.

38

resulting expression yields the contemporaneous variance of the third order increment

(130)

(03) = (3)0(3)X (3) + (3)

where

(131) (132)

(03) = E dyt(3)dyt(3) (3) = (3)E t(3)t(3) (3)

To compute the yet known contemporaneous variance of Xt(3), i.e., 0(3)X , we multiply (125) with its transposition and apply the expectations operator to the resulting expression. It follows that 0(3)X

solves the following Lyapunov equation29

(133)

(03)X = (3)X 0(3)X (3)X + (3)X

where

(134)

(03)X = E Xt(3)Xt(3)

(135)

(3)X = (3)X E t(3)t(3) (3)X

with E t(3)t(3) as specified in section A.8.

Given 0(3)X , multiplying (125) with the transposition of (129) and applying the expectations

operator yields the contemporaneous variance between Xt(3) and dyt(3)

(136)

0(3)X,dy = (3)X 0(3)X (3) + (3)X,dy

where (137) (138)

0(3)X,dy = E Xt(3)dyt(3) (3)X,dy = (3)X E t(3)t(3) (3)

29Note that (133) is a Lyapunov equation of dimension ns + ns2 + ns3 + ns ◊ ns + ns2 + ns3 + ns . By exploiting the triangularity of (3)X and the symmetry of (03)X , that large Lyapunov equation can be split and reduced to 10 Sylvester equations of dimension up to ns3 ◊ ns3.

39

A.5.2 Autocovariances

For the autocovariance of the third order increment, the orthogonality (127) and t(3) being serially

uncorrelated, i.e., (128), ensure that it can be computed with the following recursive formulae

(139) (140)

(j3) = (3)(j3-)1X,dy (j3)X,dy = (3)X (j3-)1X,dy

where (141) (142)

(j3) = E dyt(3)dyt(-3)j (j3)X,dy = E Xt(3)dyt(-3)j

A.6 Second Moments between dyt(1) and dyt(3)

First rewrite the linear recursion of the first order increment (22) using Xt(3)

(143)

dyt(1) = 0 0 0  Xt(-3)1 + 0 0 0 0 0 t(3)

Multiplying the foregoing with the transposition of the linear recursion of the third order incre-

ment (129), and applying the expectations operator to the resulting expression yields the contempo-

raneous covariance between dyt(1) and dyt(3)

(144)

(01),(3) = 0 0 0  0(3)X (3) + 0 0 0 0 0 E t(3)t(3) (3)

where

(145)

0(1),(3) = E dyt(1)dyt(3)

The autocovariance, (j1),(3), can be computed using the following recursive formula

(146)

(j1),(3) = 0 0 0  (j3-)1X,dy

40

A.7 Variance Decomposition

The decomposition the variance of the third order approximation follows directly from the decom-

position of the third order increment. Defining

(147)

dyt(3)  dyt(3)amp + dyt(3)risk

Multiplying the foregoing with its transposition and applying the expectations operator, a vari-

ance decomposition immediately follows

(148)

0(3) = 0(3)amp + (03)risk + (03)amp,risk + 0(3)amp,risk 

where (149) (150) (151)

0(3)amp = E dyt(3)ampdyt(3)amp 0(3)risk = E dyt(3)riskdyt(3)risk 0(3)amp,risk = E dyt(3)ampdyt(3)risk

Proposition (5.2) in the text implies the contemporaneous variance of the variables of interest

takes the form

(152)

0y(3) = 0y(2) + (03) + 0(1),(3) + 0(1),(3) 

Inserting the decomposed 0(3), i.e., (148), in the previous equation yields the decomposition of

the contemporaneous variance of the variables of interest

(153)

y0(3) =0y(2) + 0(3)amp + (03)risk + 0(3)amp,risk + (03)amp,risk  + 0(1),(3) + (01),(3) 

Note the decomposition (153) is not yet complete as the cross-contemporaneous variance (01),(3)

can be further broken down into two parts30

(154)

(01),(3) =E dyt(1)dyt(3) =E dyt(1) dyt(3)amp + dyt(3)risk 

30In (154), (01)amp,(3)amp is used to denote E dyt(1)dyt(3)amp as there is only amplification effects in the first order increment dyt(1).

41

=E dyt(1)dyt(3)amp + E dyt(1)dyt(3)risk =(01)amp,(3)amp + 0(1)amp,(3)risk

Inserting the foregoing in (153) yields the complete variance decomposition

(155)

0y(3) =0y(2) + 0(3)amp + 0(3)risk + 0(3)amp,risk + (03)amp,risk 

+ 0(1)amp,(3)amp + (01)amp,(3)risk + (01)amp,(3)amp + (01)amp,(3)risk 

Letting

y(3)amp
0

collect

the

contribution

from

all

amplification

channels

of

all

three

orders,

y(3)risk,amp
0

collects

all

interaction

between

amplification

and

time-varying

risk

adjustment

channels

and

y(3)risk
0

collects the contribution from the time-varying risk adjustment channel

(156) (157)

y(3)amp
0

=

0y(2)

+ (03)amp

+ (01)amp,(3)amp

+

0(1)am p,(3)am p



y(3)risk,amp
0

=

(03)am p,risk

+

0(3)am p,risk

 + (01)amp,(3)risk +

0(1)am p,(3)risk



(158)

y(3)risk
0

=

0(3)risk

Inserting the foregoing in (155) yields (38) in the text. Note the first order amplification effect reported in Table 5 is included in (156). In particular, it is included in y0(2). As implied by proposition

5.1, the contemporaneous variance of the second order approximation takes the form

(159)

y0(2) = y0(1) + 0(2)

where y0(1) captures the first order amplification effect.

To compute the individual terms in (155), first note dyt(3)amp collects all amplification effects and

dyt(3)risk collects the time-varying risk adjustment effect in the third order increment

(160)

d yt(3)am p

=d yt(-3)1am p,st at e

+

1 6

333,1dyt(-1)1state[3] + 000t[3]

+ 22 dyt(-2)1state  dyt(-1)1state + 20 dyt(-2)1state  t

(161)

+1 2

300

dyt(-1)1state  t[2]

+ 330,1

dyt(-1)1state[2]  t

dyt(3)risk

=

dyt(-3)1risk,state

+

1 2

2

0t

+

1 2

2

1

d

yt(-1)1st

at

e

42

We (162)

start

with

constructing

an

aXut(x3Dil)ia=ryvdeyct(to2ddd)rsyyytXta(tt((3t13t(e)-))3asrD1tmias)ktpde,,fssytotata([rt31tee])tshtaistedecomposition

dyt(1)state

With the foregoing auxiliary vector, dyt(3)amp and dyt(3)risk can be cast as linear recursions

(163)

dyt(3)amp = (3)ampXt(-3D1 ) + (3)ampt(3)

(164)

dyt(3)risk = (3)riskXt(-3D1 ) + (3)riskt(3)

where

(165) (166) (167) (168)

(3)amp = 

0 22

1 6

333,1

1 2

s3t0a0te

Ins  Et[2]

(3)risk = 0



0

0

1 2

2

1

(3)amp =

1 6

000

1 2

330,1

1 2

300

20

0

(3)risk = 0

0

0

0

1 2

20

Multiplying (163) with its transposition and applying the expectations operator yields the con-

temporaneous variance 0(3)amp, which collects the contribution of amplification channels to the total

variance of the third order increment

(169)

(03)amp = (3)ampE Xt(-3D1 )Xt(-3D1 ) (3)amp + (3)ampE t(3)t(3) (3)amp

where E t(3)t(3) is as calculated in section A.4. E Xt(-3D1 )Xt(-3D1 ) can be computed using the

following relationship

(170)

Xt(3) = ADXt(3D)

where (171) therefore (172)



I I 000

AD = 00

0 0

I 0

0 I

00

0000 I

E Xt(-3D1 )Xt(-3D1 ) = AD+E Xt(-3)1Xt(-3)1 AD+ = AD+0(3)X AD+

43

where AD+ denotes the Moore-Penrose inverse of AD and (03)X is already known. Then (03)amp can

be computed using

(173)

0(3)amp = (3)ampAD+ (03)X (3)ampAD+  + (3)ampE t(3)t(3) (3)amp

Likewise, the contemporaneous variance 0(3)risk collects the contribution of the time-varying

risk adjustment channel to the total variance of the third order increment, and can be computed

using

(174)

(03)risk = (3)riskAD+ 0(3)X (3)riskAD+  + (3)riskE t(3)t(3) (3)risk

0(3)amp,risk and its transposition collects the contribution of the interaction between the amplifi-

cation and time-vary risk adjustment channels to the total variance of the third order increment, and

can be computed using

(175)

(03)amp,risk + 0(3)amp,risk  = 0(3) - (03)amp - (03)risk

To compute 0(1)amp,(3)amp, multiply (143) with the transposition of (163) and apply the expecta-

tions operator to the resulting expression to yield

(176)

(01)amp,(3)amp = 0

0

0

 0(3)X

(3)am p AD+


+

0

0

0

0

0 E

t(3)t(3)

(3)am p

As (01),(3) was already computed in section A.6, 0(1)amp,(3)risk can be obtained by subtracting

the foregoing from 0(1),(3).

A.8 Coefficient Matrices

This section contains explicit expressions for several coefficient matrices left implicit above.

(3) = 

22

1 6

333,1

1 2

300

Ins  Et[2]

+

1 2

21

(3) =

1 6

000

1 2

330,1

1 2

300

20

1 2

2

0

44

 (3)X = s00tate
0

2st2ate state[2]
0 0

1 6

3st3a3t,e1

1 2

2st2at

e

 state

state[3]

0



1 2

3st0a0te

Ins  Et[2]

+ st2a1te

1 2

s0t0at

e

 state

Kne2,ns + 2st0ate  0state

Ins  Et[2]

Kns2,ns + (Kns,ns  Ins + Ins3) state  s0tate[2] Ins  Et[2]



state

45

 (3)X =  2st0ate  state

1 6

0st0a0te

Knsne,ns +

0state[3]

1 2

2st2ate

 0state

1 2

3st3a0t,e1

1 2

s0t0ate

 state

Kne2,ns + 2st0ate  0state

[(Kns,ns  Ins + Ins3 )Kns2,ns + Ins3] state[2]  s0tate

00

... ... ... ...

...

1 2

3st0a0te

. . . state  s0tate

. . . [Kns2,ns + (Kns,ns  Ins + Ins3 )] state  s0tate[2]

... 0

s2t0ate 0 0 0

1 2

00st2a0te

0state

E t(3)t(3) =



E E

E t[3]t[3]
dyt(-1)1state[2]  t t[3] 0
dyt(-2)1state  t t[3] E t t[3]

E t[3] dyt(-1)1state[2]  t  E dyt(-1)1state[2]  t dyt(-1)1state[2]  t 
0 E dyt(-2)1state  t dyt(-1)1state[2]  t 
E t dyt(-1)1state[2]  t 

...
... ... ...
...

... ...
... E
... ...

0 0

dyt(-1)1state  t[2] - Et[2]

dyt(-1)1state  t[2] - Et[2]

0 0



... ...
...
... ...

. . . E t[3] dyt(-2)1state  t  . . . E dyt(-1)1state[2]  t dyt(-2)1state  t 
... 0 . . . E dyt(-2)1state  t dyt(-2)1state  t  . . . E t dyt(-2)1state  t 



E E

E t[3]t
dyt(-1)1state[2]  t t 0
dyt(-2)1state  t t
E (t t)



46

A.9 Computing Elements in E t(3)t(3)

For every nonzero entry of E t(3)t(3) in section A.8, the terms inside the expectations operator

are either i) second, fourth, or sixth moments of the shocks, or ii) the product of these moments with the state variable block of the order increments, i.e., dyt(-2)1state and dyt(-1)1state. The fourth and sixth

moments of the shocks can be computed using Tracy and Sultan's (1993, p. 344-345) formulae. E.g.,

for sixth moments in the form E t[3]t[3] , applying the mixed Kronecker product rule yields

(177)

E t[3]t[3] = E tt  t t  t t

then Tracy and Sultan's (1993) Theorem 3 (repeated here) can be applied directly (178)
E tt  t t  t t = E tt [3] K + (Kne  Kne,ne) + (Kne,ne  Kne) + Kne,ne2 (Kne,ne  Kne)
+ K vec E tt vec E tt  E t t K

where

(179)

K = Kne3 + Kne,ne2 + Kne2,ne

is a sum of commutation matrices (See Magnus and Neudecker (1979)).
For the fourth moment in the form E t[3]t , Jinadasa and Tracy's (1986, p. 404) formula
(repeated here) can likewise be applied directly (180) E t[3]t = E(t t)  vec E(t t) + vec E(t t)  E(t t) + (Ine  Kne,ne) vec E(t t)  E(t t)

For the entries in the form of a product between the moments and the state variable block of order

increments, use the property of the Kronecker product of column vectors and the mixed Kronecker

product rule to rearrange until they are in the form of a (Kronecker) product of two clusters: one

cluster contains the state variable block of the order increments only, and the other contains (the

product of) shocks only. As all the order increments of the last period are uncorrelated with the

current shocks, the expected value of the two clusters can be computed separately. E.g.
(181) E dyt(-1)1state[2]  t t[3] =E dyt(-1)1state[2]  t  t[3] = E dyt(-1)1state[2]  t  t[3]

47

where E

dyt(-1)1state[2]

=E dyt(-1)1state[2]  t t[3] = E dyt(-1)1state[2]  E t t[3] was computed in section A.4 and E tt[3] can be computed using the

transposed version of (180).

In fact, many nonzero entries in E t(3)t(3) can be recycled from the calculations in section

A.4 and therefore need not to be computed again. E.g., the block entry in the second row and second

column of E t(3)t(3) can be written as (182) E dyt(-1)1state[2]  t dyt(-1)1state[2]  t  = E dyt(-1)1state[2]dyt(-1)1state[2]  E t t

The first term on the right hand side of the foregoing can be recycled from (02)X as the lower

right entry (the block entry in the second row and second column) of (02)X takes the form

(183)

0(2,2)X2 =E dyt(-1)1state[2] - Edyt(-1)1state[2] dyt(-1)1state[2] - Edyt(-1)1state[2] 

(184)

=E dyt(-1)1state[2]dyt(-1)1state[2] - E dyt(-1)1state[2] E dyt(-1)1state[2] 

therefore

(185)

E dyt(-1)1state[2]dyt(-1)1state[2] = (02,2)X2 + E dyt(-1)1state[2] E dyt(-1)1state[2] 

Some entries of E t(3)t(3) are zero as they contain one or some of terms equal to zero un-

der normality: the odd moments of the exogenous shocks, E dyt(1)state , E dyt(1)state[3] and

E dyt(1)state[5] .

48

Table 1: Parameter Values: Common to All Three Calibrations

Parameter      a  

Value

0.9926 2.9869 25.8 0.331 0.021 0.004 0.9 0.15

See Tallarini (2000) and the main text.

Table 2: Parameter Values: Calibrating Homoskedastic Volatility

Calibration Baseline

Constant Volatility Expected Utility

a

0.009824769 0.011588754

0.0115

a calibrated to keep the standard deviation of  ln(c) = 0.0055

Table 3: Mean Comparison

Variable log(k)
i log(c) log(y) log(N) Rf
R

Det .S.S. 2.084 0.200 -0.567 -0.265 -1.467 1.149 1.149

Baseline Calibration 2.137 0.211 -0.554 -0.242 -1.460 1.047 1.053

Tallarini (2000) 2.158 0.216 -0.549 -0.232 -1.456 1.011 1.022

* The deterministic steady state value See Table 5, Tallarini (2000).

Table 4: Standard Deviation Comparison

Variable
 log(c)  log(y)  log(i) log(c) - log(y) log(i) - log(y)

Baseline Calibration 0.0055 0.0096 0.0240 0.0154 0.0425

Tallarini (2000) 0.0055 0.0095 0.0224 0.0147 0.0403

Data 0.0055 0.0104 0.0279 0.0377 0.0649

See Table 7, Tallarini (2000).

49

Table 5: Variance Decomposition in Percentage

MPRt E RP
RP log(k) i log(c) log(y) log(N)

Constant Volatility Calibration

1st order amp. time-varying risk adj.

0 100

0 100

106.50

0.30

97.34

0.01

96.63

0.01

97.58

0.01

96.31

0.02

98.46

0.01

Baseline (Stochastic Volatility) Calibration

1st order amp. time-varying risk adj.

0 100

0 100

80.76

8.52

75.07

1.37

57.21

30.26

75.88

2.62

44.52

36.97

66.26

18.62

For each calibration, the columns may not add up to 100 due to the omission of 2nd and 3rd order amplification and cross effects.

50

3rd Order NLMA: Density of Simulated Variance

150

100

50

0
0.14 0.12

0.1 0.08 0.06 0.04
Var(m)

2000

4000

6000

8000

10000

Length of Simulation

Figure 1: Monte Carlo Consistency

51

Deviations

x 10-3 1.4 1.2

Impulse Response of k to a 1 Std. Dev. Shock in esigmaa

Third-Order Accurate Second-Order Accurate First-Order Accurate

1

0.8

0.6

0.4

0.2

0 0 5 10
First-Order Component 1

0.5

0

-0.5

-1 0 10 20 30 Periods x 10-3 Risk Correction to First-Order
1.5

40

1

0.5

0 0 10 20 30 40 Periods

Deviations

Deviations

15 1

20 Periods since Shock Realization
Second-Order Component

25

0.5

0

-0.5

-1 0 10 20 30 40 Periods Third-Order Component
1

0.5

0

-0.5

-1 0 10 20 30 40 Periods

30 35 40

Steady-State and Constant

2.2

Steady-State

2.15

plus Risk Adjustment

2.1

2.05 0

10 20 30 40

Figure 2: Capital IRF: Volatility shock

Deviations

Deviations

52

Deviations

x 10-3 2.5
Labor
2
Investment
1.5
Output
1

Impulse Response of Macros to a 1 Std. Dev. Shock in Vol.

0.5
Capital
0

-0.5

-1

-1.5 Consumption
-2 0 5 10 15 20 25 30 35 40 Periods since Shock Realization

Figure 3: Macro IRFs: Volatility Shock and Precautionary Reaction

53

Deviations

x 10-3 1.8 1.6 1.4

Impulse Response of ERP to a 1 Std. Dev. Shock in esigmaa

Third-Order Accurate Second-Order Accurate First-Order Accurate

1.2

1

0.8

0.6

0.4

0.2

0 0 5 10
First-Order Component 1

0.5

0

-0.5

-1 0 10 20 30 Periods x 10-3 Risk Correction to First-Order
2

40

1.5

1

0.5

0 0 10 20 30 40 Periods

Deviations

Deviations

15 1

20 Periods since Shock Realization
Second-Order Component

25

0.5

0

-0.5

-1 0 10 20 30 40 Periods Third-Order Component
1

0.5

0

-0.5

-1 0 10 20 30 40 Periods

30 35 40

0.015 0.01

Steady-State and Constant
Steady-State plus Risk Adjustment

0.005

0 0 10 20 30 40

(a) Volatility Shock

Deviations

Deviations

Deviations

x 10-5 5 4

Impulse Response of ERP to a 1 Std. Dev. Shock in ea

Third-Order Accurate Second-Order Accurate First-Order Accurate

3

2

1

0

-1 0 5 10
First-Order Component 1

0.5

0

-0.5

-1 0 10 20 30 Periods x 10-5 Risk Correction to First-Order
6

40

Deviations

4

2

0 0 10 20 30 40 Periods

Deviations

Deviations

15 1

20 Periods since Shock Realization
Second-Order Component

25

0.5

0

-0.5

-1 0 10 20 30 40 Periods Third-Order Component
1

0.5

0

-0.5

-1 0 10 20 30 40 Periods

30 35 40

0.015 0.01

Steady-State and Constant
Steady-State plus Risk Adjustment

0.005

0 0 10 20 30 40

Deviations

(b) Growth Shock
Figure 4: Expected Risk Premium IRF: Volatility and Growth Shock

54

Value

0.14 0.12
0.1 0.08 0.06 0.04 0.02
0 -0.02
0

Simulation of MPR2

Third-Order Accurate Second-Order Accurate First-Order Accurate

50 100 150 200 250 300 350 400 Periods

0.14 0.12
0.1 0.08 0.06 0.04 0.02
0 -0.02
0

(a) Constant Volatility Calibration
Simulation of MPR2

Second-Order Accurate First-Order Accurate Third-Order Accurate

50 100 150 200 250 300 350 400 Periods

Value

(b) Baseline (Stochastic Volatility) Calibration
Figure 5: Stochastic Volatility and Squared Conditional Market Price of Risk

55

Standard Deviation (m)

0.35 0.3
0.25 0.2
0.15 0.1
0.05 0 0.8

0.85 0.9 0.95
E[m]
(a) a = 0.0115 for All Three Calibrations

1

Standard Deviation (m)

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0 0.8

0.85 0.9 0.95
E[m]

1

(b) a Calibrated to Match  log(c)0.0055

Figure 6: Stochastic Volatility and the Hansen-Jagannathan Bounds ◊: Expected Utility; +: Constant Volatility; : Baseline (Stochastic Volatility)

56

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.

001
002 003 004 005 006
007
008 009
010 011 012
013 014
015 016
017
018 019

"Functional Data Analysis of Generalized Quantile Regressions" by
Mengmeng Guo, Lhan Zhou, Jianhua Z. Huang and Wolfgang Karl H‰rdle, January 2013. "Statistical properties and stability of ratings in a subset of US firms" by
Alexander B. Matthies, January 2013. "Empirical Research on Corporate Credit-Ratings: A Literature Review" by Alexander B. Matthies, January 2013. "Preference for Randomization: Empirical and Experimental Evidence" by
Nadja Dwenger, Dorothea K¸bler and Georg Weizs‰cker, January 2013. "Pricing Rainfall Derivatives at the CME" by Brenda LÛpez Cabrera, Martin Odening and Matthias Ritter, January 2013. "Inference for Multi-Dimensional High-Frequency Data: Equivalence of
Methods, Central Limit Theorems, and an Application to Conditional Independence Testing" by Markus Bibinger and Per A. Mykland, January 2013.
"Crossing Network versus Dealer Market: Unique Equilibrium in the Allocation of Order Flow" by Jutta Dˆnges, Frank Heinemann and Tijmen R. DaniÎls, January 2013. "Forecasting systemic impact in financial networks" by Nikolaus Hautsch,
Julia Schaumburg and Melanie Schienle, January 2013. "`I'll do it by myself as I knew it all along': On the failure of hindsightbiased principals to delegate optimally" by David Danz, Frank H¸ber,
Dorothea K¸bler, Lydia Mechtenberg and Julia Schmid, January 2013. "Composite Quantile Regression for the Single-Index Model" by Yan Fan, Wolfgang Karl H‰rdle, Weining Wang and Lixing Zhu, February 2013. "The Real Consequences of Financial Stress" by Stefan Mittnik and Willi
Semmler, February 2013. "Are There Bubbles in the Sterling-dollar Exchange Rate? New Evidence from Sequential ADF Tests" by Timo Bettendorf and Wenjuan Chen, February 2013.
"A Transfer Mechanism for a Monetary Union" by Philipp Engler and Simon Voigts, March 2013. "Do High-Frequency Data Improve High-Dimensional Portfolio
Allocations?" by Nikolaus Hautsch, Lada M. Kyj and Peter Malec, March 2013. "Cyclical Variation in Labor Hours and Productivity Using the ATUS" by Michael C. Burda, Daniel S. Hamermesh and Jay Stewart, March 2013.
"Quantitative forward guidance and the predictability of monetary policy ≠ A wavelet based jump detection approach ≠" by Lars Winkelmann, April 2013.
"Estimating the Quadratic Covariation Matrix from Noisy Observations: Local Method of Moments and Efficiency" by Markus Bibinger, Nikolaus Hautsch, Peter Malec and Markus Reiss, April 2013. "Fair re-valuation of wine as an investment" by Fabian Y.R.P. Bocart
and Christian M. Hafner, April 2013. "The European Debt Crisis: How did we get into this mess? How can we get out of it?" by Michael C. Burda, April 2013.

SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
020 "Disaster Risk in a New Keynesian Model" by Maren Brede, April 2013. 021 "Econometrics of co-jumps in high-frequency data with noise" by Markus
Bibinger and Lars Winkelmann, May 2013. 022 "Decomposing Risk in Dynamic Stochastic General Equilibrium" by Hong
Lan and Alexander Meyer-Gohde, May 2013.
SFB 649, Spandauer Straﬂe 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

