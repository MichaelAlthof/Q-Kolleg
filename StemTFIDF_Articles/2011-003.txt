BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2011-003
Mean Volatility Regressions
Lu Lin* Feng Li§ Lixing Zhu# Wolfgang Karl Härdle 
* - Shandong University Jinan, China
§ - Zhengzhou Institute of Aeronautical Industry Management, China # - Hong Kong Baptist University, China
 - Humboldt-Universität zu Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Noname manuscript No. (will be inserted by the editor)
Mean Volatility Regressions
Lu Lin · Feng Li · Lixing Zhu · Wolfgang Karl H¨ardle
Received: date / Accepted: date
Abstract Motivated by increment process modeling for two correlated random and non-random systems from a discrete-time asset pricing with both risk free asset and risky security, we propose a class of semiparametric regressions for a combination of a non-random and a random system. Unlike classical regressions, mean regression functions in the new model contain variance components and the model variables are related to latent variables, for which certain economic interpretation can be made. The motivating example explains why the GARCH-M of which the mean function contains a variance component cannot cover the newly proposed models. Further, we show that statistical inference for the increment process cannot be simply dealt with by a two-step procedure working separately on the two involved systems although the increment process is a weighted sum of the two systems. We further investigate the asymptotic behaviors of estimation by using sophisticated nonparametric smoothing. Monte Carlo simulations are conducted to examine finite-sample performance, and a real dataset published in Almanac of
The research described here was supported by NBRP (973 Program 2007CB814901) of China, NNSF project (10771123) of China, RFDP (20070422034) of China and NSF project (ZR2010AZ001) of Shandong Province of China, and a grant from Research Grants Council of Hong Kong, Hong Kong, China. Support by CRC649 "Economic Risk", Deutsche Forschungsgemeinschaft is gratefully acknowledged L. Lin School of Mathematics, Shandong University, Jinan, China E-mail: linlu@sdu.edu.cn F. Li Zhengzhou Institute of Aeronautical Industry Management, Zhengzhou, China E-mail: lifengsta@gmail.com L. Zhu Department of Mathematics, Hong Kong Baptist University, Hong Kong, China E-mail: lzhu@hkbu.edu.hk W. K. H¨ardle CASE-Center for Applied Statistics & Economics, Humboldt-Universit¨at zu Berlin, Germany and CDA - Centre Complex Data Analysis. National Central University, Taiwan. E-mail: haerdle@wiwi.hu-berlin.de

2 Lu Lin et al.
China's Finance and Banking (2004 and 2005) is analyzed for illustration about the increment process of wealth in financial market of China from 2003 to 2004.
Keywords Non-random systems · Random systems · Semiparametric regression · Variance built-in Mean
JEL classification: C00; C14; J01; J31

1 Introduction

The standard regression paradigm separates mean and variance effects in the sense that the scale of the stochastic error does not enter the conditional mean effect given the explanatory variable X. This is also true for most of the time series models of autoregressive type with a few exceptions like e.g. the GARCH - M model, see Tsay(2002). Discrete versions of many continuous time dynamics though naturally give motivation for considering dependence of the mean function on the conditional variance (or standard deviation) given X. Stochastic differential equations, as studied by Karoui and Peng (1997) in their discretized form may be seen as special cases of

E{Y¯ (t)|X(t)} = f [(t), Y {X(t)}, Z{X(t)}]t1/2,

(1.1)

where f is a given regression function and t is the time period. In (1.1), the parameter vector (t) is time-dependent, Y {X(t)}, Y¯ (t) and Z{X(t)} depend on an observable variable function X(t). Further, Y {X(t)} and Y¯ (t) are observable,
while Z{X(t)} is an unobservable random variable satisfying

Z2{X(t)} = Var{Y¯ (t)|X(t)}.

(1.2)

Here the basic difference to classical regressions (including the classical time series models) is that the mean E{Y¯ (t)|X(t)} of (1.1) contains a standard deviation Z(x) (or variance Z2(x)) and depends on the latent variable X(t). The main difference between diffusion processes (or forward stochastic differential equations) and forward-backward stochastic differential equations will be discussed in the next section.
Briefly speaking, the dynamics of Y¯ (t) is determined by two systems, one is non-random (e.g. a money market instrument or bond) and the other has a random disturbance (e.g. a stock). Allocating randomly the asset to the two systems results in our new model. The new model can describe an increment process (e.g. wealth increment) and may be applied to different scientific fields such as mathematical finance. We adopt a two-step procedure with estimating parameters in the two systems separately and then working on the model about increment process of interest. This technique leads us to investigating statistical properties such as the distribution of the increment process and confidence interval construction for parameters; for details see the next section. The proposed model contains well known models, such as linear, nonlinear and varying coefficient models, as its special cases.
The GARCH-M is also of a structure in which the mean function contains the variance function. We will give a brief explanation about the differences between our modeling and the GARCH-M in Section 2.1 below.

Mean Volatility Regressions

3

The paper is organized in the following way. In Section 2 we first briefly describe the motivation from a problem arising in asset pricing with one risk-free asset and one risky security.Consequently, a new model and its extensions are proposed in Section 2. For the model with varying coefficients, some estimation methods are introduced and the asymptotic properties are investigated in Section 3. Section 4 contains the estimation for nonlinear models. We separate these two cases, although the estimation in Section 3 can be a special case of that in Section 4, because of its importance of the model under linear structure. Monte Carlo studies are given in Section 5 for illustration and an empirical application is investigated in Section 6. The proofs of the theorems are presented in the Appendix.

2 Modeling
In this section, we start with two examples to motivate the modeling with varying coefficients under linear structure, and then extend them to the ones with nonlinear structure.

2.1 Models under linear structure

Consider the varying coefficient regression:

Y¯ (ti) = [a(ti) + b(ti)Y (X(ti)) + c(ti)Z{X(ti)}]1i /2 + Z{X(ti)}(ti)

(2.1)

for i = 1, · · · , n - 1, where i = ti+1 - ti is the time period, a(t), b(t) and c(t) are time-dependent parameters, X(ti) and Y {X(ti)} are random variables observed at ti, and Y¯ (ti) = [Y (X(ti+1)) - Y {X(ti)}]/1i /2, Z{X(ti)} is an unobservable random variable valued at ti, and {(ti)} is a sequence of unobservable independent standard normal random variables independent of X(ti). A special case is that all the parameters a(·), b(·), and c(·) are constants.
A very simple example is geometric Brownian motion where the stock dynamics
X(t) is:
dX(t)/X(t) = µdt + dW (t)

Discretising at ti with steps i as defined above yields:

X(ti+1) - X(ti) = µX(ti)i + X(ti)i(1/2)(ti).

A further motivating example for (2.1) is as follows. For discrete-time asset pricing, one may think of two basic securities: the risk free asset (e.g., money market instrument or bond) and the risky asset (e.g., stock). The risk free asset is with price per unit P0(t) governed by

P0(ti+1) - P0(ti) = r(ti)P0(ti)(ti+1 - ti),

(2.2)

where r(t) is the short rate. The risky asset is traded and the price process X(t) of the stock is modeled (similar to the example above) by a linear equation as:

X(ti+1) - X(ti) = µ(ti)X(ti)(ti+1 - ti) + (ti)X(ti)(ti+1 - ti)1/2(ti), (2.3)

4 Lu Lin et al.

where µ(t) and (t) > 0 are unknown functions. Let 0(ti) and 1(ti) be the amounts of wealth invested respectively in bond and stock at time ti, and n0(ti) and n1(ti) be the numbers respectively of bond and stock. Further, denote the portfolio of bond and stock as Y {X(ti)} = n0(ti)P0(ti) + n1(ti)X(ti). Let Z{X(ti)} = (ti)1(ti) = (ti)n1(ti)X(ti). Assume that the wealth process Y {X(ti)} is selffinancing (Karatzas and Shreve 1998). Then the average wealth process Y¯ (t) sat-

isfies

Y¯ (ti)

=

[ r(ti)Y

{X (ti )}

+

µ(ti) - (ti

r(ti) )

Z

{X

] (ti)} 1i /2

+

Z {X (ti )}(ti ).

(2.4)

The proof for (2.4) is given in the Appendix. Note that Z{X(t)} is in general unobservable in the financial market because (t) is an unknown function and 1(t) is unobservable. However Z{X(t)} is certainly a function of interest because it is related to the amount 1(t) of risky investment.
Model (2.4) is of course a special case of the dynamics described in (2.1). When

the data X(ti) and Y (ti) are available, we can infer the parameter functions a(t), b(t) and c(t), and the variable Z2{X(t)}, and then we can predict future increments
Y¯ (t) and risky investments Z{X(t)}.

A very natural concern is that, to fully use the information provided by ob-

served data, we would first separately estimate the parameters in (2.2) and (2.3),

and then define the estimators of the associated parameters in model (2.1) or (2.4),

and investigate the statistical inference. We still use the first example to explain

its disadvantages. For point estimation, it is possible because the point estimation

does not involve a random relationship between the asset allocation of n0(ti) and of n1(ti). However, this relation does have impact on statistical inference so that such a two-step estimation does not very much help for inferring model (2.1) or

(2.4). First, note that in our case, the model of interest is total asset or increment,

but in asset pricing, the numbers n0(ti) and n1(ti) respectively of risk free and risky assets are highly related. By model (2.2) and (2.3) only, one has difficulty

to study some statistical properties, such as the distribution of average increment Y¯ (ti) of wealth. It also causes the difficulty for, say, confidence region construction
for the parameters in (2.1) or (2.4), when we do it only through the confidence

regions for the parameters in models (2.2) and (2.3). This is because, firstly, cor-

relation between the data in models (2.2) and (2.3) can influence the confidence

regions (including the coverage probability and shape of the confidence regions)

for the parameters in model (2.1) or (2.4); Secondly, the confidence regions for

the parameters in models (2.2) and (2.3) can not be directly transformed into the

confidence regions for the associated parameters in model (2.1) or (2.4). Therefore,

an indirect investigation in terms of model (2.1) or (2.4) is necessary.

When the normality condition on (t) is not supposed to hold, (2.1) becomes

linear semiparametric regression model

{ E(Y¯ (t)|X(t)) = [a(t) + b(t)Y {X(t)} + c(t)Z{X(t)}]1t /2, Var(Y¯ (t)|X(t)) = Z2{X(t)} for t  [0, T ].

(2.5)

From (2.1) and (2.5), we can see the main difference from the standard semi-
parametric regression is as follows. In (2.5), the regression function contains an unknown deviation function Z(x), and the observations Y¯ (t) and Y {X(t)} depend on an observable variable X(t). In this case, these models are different from the

Mean Volatility Regressions

5

GARCH-M, a time series model. In the GARCH-M, although the mean term also contains the variance, the variance is a squared sum of white noises and then is independent of model variables (Tsay 2002). In our approach, however, Z{X(t)} is dependent on X(t) where both Z{X(t)} and X(t) have special meanings such as price process and investment process, respectively. Further our models are different from the classical diffusion processes because (2.4) is determined by two systems (2.2) and (2.3), and then Y¯ (t) and Y {X(t)} depend on yet another variable X(t). Note that the standard diffusion process does not have this property although drift functions in some diffusion processes also contain variance functions; see for example Barndorff-Nielsen and Shephard (2002), and Fan (2005).

2.2 Extension

Note that the above semiparametric models are of linear structure in the sense that the conditional expectation of Y¯ (t) is linearly related to the time-dependent parameters a(t), b(t) and c(t). Such a linearity would need a check for it. However, this is beyond the scope of this paper, we leave it to a further study. By contrast, some diffusion processes are nonlinear in parameters (Ait-Sahalia (1996), Chan et al. (1992), Fan et al. (2003), and Fan 2005). We can verify that if models (2.2) and (2.3) are nonlinear in parameters, the resulting model (2.1) or (2.4) will be nonlinear accordingly. Then nonlinear extension of model (2.1) or (2.4) is of interest. For flexibility of modeling the above process, a nonlinear semiparametric regression with a built-in standard deviation can be defined as

{ E{Y¯ (t)|X(t)} = f [(t), Y {X(t)}, Z{X(t)}]t1/2, Var{Y¯ (t)|X(t)} = Z2{X(t)} for t  [0, T ],

(2.6)

where f is a given function and (t) is an unknown p-dimensional parameter vector depending on time t.

3 Estimation for linear semiparametric regression
We now consider estimation for model (2.5). First, for studying the asymptotic properties of the estimators defined below, we need the (locally) strict stationarity of the sequence of X(ti) in (2.5). However, it is usually not the case because X(ti) are generated from (2.3) and this equation produces unstationary X(ti). To satisfy the stationarity condition, a common way is to make a transform on X(ti) . For example a familiar transformation is S(ti) = log X(ti). The process S(ti) is then often a (locally) stationary process. Correspondingly, P0(ti) in (2.2) should be transformed as P (ti) = log P0(ti). S(ti) and P (ti) can then satisfy an equation similar to (2.1) or (2.5). Therefore, without loss of generality, we assume that X(ti) are (locally) stationary. This is a main condition assumed in the following theorems.
As is stated in Subsection 2.1, Z2(x) is in general unobservable. But the second equation of (2.5) shows that Z2(x) is a conditional expectation of Y¯ (t) given X(t) = x. Then we can use nonparametric method to estimate Z2(x) by historical observations (X(ti), Y¯ (ti)) (i = 1, · · · , n) of (X(t), Y¯ (t)) (see for example

6 Lu Lin et al.

Fan (2005), Fan et al (2003), Cai (2007) and Wand and Jones (1995), Simonoff

(1996)). Note that, compared with the deviation term Z(x), the expectation term
[a(t) + b(t)Y (t) + c(t)Z{X(t)}]1t /2 is negligible if t is small enough. Then, a simple estimator of the variance is defined as

Z^2(x0) =

in=-12nY-¯ 22
i=1

(ti)Kh{X(ti) - x0} Kh{X(ti) - x0}

,

(3.1)

where Kh(x) = K(x/h)/h, K(x) is a kernel function satisfying the regularity conditions given below and h is the bandwidth depending on n. We use this estimation

mainly for ease of exposition, other smoothing methods, such as local polyno-

mial(Fan and Gijbels 1996), may also be used. Let X = {X(t1), · · · , X(tn)} and Y¯ = {Y¯ (t1), · · · , Y¯ (tn)}. Without loss of

generality, suppose that 0  t1  t2  · · ·  tn  T . We need the following

conditions: ti = ti+1 - ti = O(T /n) for i = 1, · · · , n - 2, the kernel function K(u) and the sequence {X(t1), · · · , X(tn)} respectively satisfy the following conditions:

C1) K(u) is symmetric with respect to u = 0, has a bounded derivative and support

(-1, 1), and

1 -11
-1

K(u)du = 1, |u|j Kk(u)du

K2

=

1
-1

<  for j

u2K k

(u)du = = 1, 2.

0,

(3.2)

C2) X(t1), · · · , X(tn) are -mixing dependent; the -mixing coefficients (l) satisfy (l)  0 as l  , where

(l) = sup | E(Xi+lXi) - E(Xi+l) E(Xi)| Xi,Xi+lX (Var(Xi+l) Var(Xi))1/2

(3.3)

with Xi = X(ti). Condition C1) is standard and condition C2) is commonly used for weakly

dependent process; see for example Rosenblatt (1956, 1970), Kolmogorov and

R-1o1zaunj Kov2 ((u1)9d6u0)f,orBrjad=ley0,

and 1, 2.

Bryc (1985), Furthermore,

Lu and Lin (1997). Denote JKj = some common stochastic processes

satisfy condition C2) as shown by Bradley (2005). We have the following theorem.

Theorem 1 In addition to conditions C1) and C2), assume that in model (2.5), X(ti)  (x0 - h, x0 + h) have a common probability density p(x); both the functions p(x) and Z(x) have two continuous derivatives; {X(ti) : X(ti)  (x0 -h, x0 +h)} is a stationary Markov process; the -mixing coefficients satisfy (l) = l for 0 <  < 1; and a(t), b(t) and c(t) are bounded on [0, T ]. Then as nh  , nh5  0 and nh t2  0,
nh{Z^2(x0) - Z2(x0)} -L N (0, JK0 Z4(x0)/p(x0)).

The proof of Theorem 1 is presented in the Appendix. The asymptotic normal-
ity given in this theorem is similar to that of classical nonparametric estimation.
Here we only need the conditions locally in the neighbor x0 (x0 -h, x0 +h) because
the kernel estimation only utilizes the data around x0. Also, from the proof we can see the -mixing condition can be replaced by pl(u, v) - p(u)p(v) = O(l), where pl(u, v) is the joint probability density of {X(ti), X(ti+l))}in=-12 and 0 <  < 1.
Furthermore, the proof of this theorem indicates that when the expectation term [a(t)+b(t)Y (t)+c(t)Z{X(t)}]1t /2 is large (when t is large), the conventional

Mean Volatility Regressions

7

estimator defined in (3.1) may be no longer consistent. Thus, we define a bias corrected estimator for Z2(x0) in terms of the difference between Y¯ (ti+1) and Y¯ (ti) for successive time points ti and ti+1 as

Z~2(x0) = ni=-12{Y¯2(ti+in1=-)12-KY¯h({tXi)(}t2iK) -h{xX0}(ti) - x0} .

(3.4)

The above estimator is a new one designed for the model that has an unspecified mean function. The following theorem states the asymptotical normality.

Theorem 2 In addition to the conditions of Theorem 1, the conditional probability density pl(v|u) of X(ti+l) given X(ti) is free of i for X(ti+l), X(ti)  (x0 - h, x0 + h), and has two continuous derivatives. Then as nh  , nh5  0 and nh t4  0,
nh{Z~2(x0) - Z2(x0)} -L N (0, JK0 Z4(x0)/p(x0)).

The proof is also postponed to the Appendix. As is shown in the above two theorems, we can estimate the nonparametric function Z(x). Furthermore, according to (2.2) and the commonly used estimation for forward stochastic differential equations, we can also estimate (t) whose estimator is denoted by ^(t). From the relation between Z{X(t)}, n1(t) and 1(t), we can see that both n1(t) and 1(t) can be estimated respectively with

n^1(t)

=

Z^{X (t)} X (t)^ (t)

or

n~1(t)

=

Z~{X (t)} X (t)^ (t)

,

(3.5)

^1(t)

=

Z^{X (t)} ^(t)

or

~1(t)

=

Z~{X (t)} ^(t)

.

(3.6)

These estimators show that although in some situations, such as in a natural

environment, n1(t) (the number of groups of a species defined in Section 2) cannot
be directly observed, it can be estimated. We now turn to estimating (t) = (a(t), b(t), c(t)) . In the remainder of this

section, for the convenience of representation, we assume that i =  for all i. First, we plug the estimator Z^ or Z~ into the first equation of (2.5). Then by the

local polynomial smoothing (Fan and Gijbels 1996), we can obtain an estimator

of (t) as

^(t) = -1/2(D^  W D^ )-1D^  W Y¯ ,

(3.7)

where W = diag{Kh(t1 - t), · · · , Kh(tn - t)}, Y¯ = (Y¯1, · · · , Y¯n) and

 1

Y1 Z^1 

D^ =  · · · · · · · · · 

1 Yn Z^n

with Yi = Y {X(ti)}, Y¯i = Y¯ (ti) and Z^i = Z^{X(ti)} or Z^i = Z~{X(ti)}. Different from the case for estimating Z{X(t)}, in which we use state variable
X(t) to construct kernel estimators (3.1) and (3.4), we consider time t as a covari-
ate to construct nonparametric estimator of (t) given in (3.7). In the following theorem the local condition on X(ti) is determined by time t rather than by state variable x.

8 Lu Lin et al.

Theorem 3 In addition to the conditions of Theorems 1 and 2, assume that (t) has
two continuous derivatives and the matrix (t) defined below is positive definite. Then, as nh  , nh5  0 and nh   , we have
nh{^(t) - (t)} -L N (0, JK0 Zt2-1(t)), 
1 E(Yt) E(Zt) where (t) =  E(Yt) E(Yt2) E(YtZt)  with X(t) = Xt, Y {X(t)} = Yt and Z{X(t)} =
E(Zt) E(YtZt) E(Zt2) Zt.

Note that unlike the estimator of Z(x) and nonparametric estimator in classical

nonparametric regression, which can achieve the standard convergence rate, the convergence rate of ^(t) depends on . Usually,   0 and then the estimator ^(t)

has a slow convergence rate. The reason why this happens is that the mean term

is higher order infinitesimal than the variance term. This argument will be further

verified by the simulations in Section 6. On the other hand, since X(t1), · · · , X(tn)

are supposed to be locally and identically distributed, the matrix (t) given in

the above theorem is dependent on t.

Particularly, when  is time-independent, similar to (3.7), the estimator is

simplified to be

^ = -1/2(D^  D^ )-1D^  Y¯ .

(3.8)

By a similar argument used in Su and Lin (2009), we can prove that, under some

regularity conditions,

n(^ - ) L N (0, JK0 E(Z2)-1), 
1 E(Y ) E(Z) where  =  E(Y ) E(Y 2) E(Y Z)  .
E(Z) E(Y Z) E(Z2)

(3.9)

4 Estimation for nonlinear semiparametric regression

We now consider the estimation for model (2.6). Because the estimator of Z(x0) is free of the first equation of (2.6), it can be estimated by the same method as that

given in (3.1) or (3.4), and then the resulting estimator has the same asymptotic

properties as those in Theorems 1 and 2. Thus, we only focus on the estimation

for the parameter vector (t) in this section.

We can plug the estimator of Z(x0) into the first equation of (2.6) and then
use the local polynomial smoother (Fan and Gijbels 1996) to obtain an estimator of (t). For example, an estimator of (t), denoted by ^(t), can be obtained by

minimizing

Q^()

=

1 n

n-2 {Y¯i

- f^i()1i /2}2Kh(ti

-

t)

i=1

(4.1)

over , where f^i() = f (ti, , Xi, Yi, Z^i). Under some regularity conditions, ^ can also be obtained by solving the following equation

L^()

=

Q^()

=

-

1 n

n-2 {Y¯i

-

f^i()1i /2}f^i()1i /2Kh(ti

-

t)

=

0,

i=1

Mean Volatility Regressions

9

where Q() denotes the derivative of Q(). In the remainder of this section, for convenience of representation, we also assume that i =  for all i. The following lemma is a preliminary for the asymptotic result of ^.

Lemma 1 For nonlinear model (2.6), when the functions (t) and f () respectively have two and three continuous derivatives, E{f ((t))f ((t)) } is positive definite, the conditions on X(ti) in Theorem 3 hold, we have
sup |^(t) - (t)| = Op(n- ),
t[0,1]

where the positive number  satisfies n [h2 + (log(nh)/nh)1/2]  0.

The proof of the lemma is delayed to the Appendix. The following theorem follows.

Theorem 4 Under the conditions of Lemma 1, if nh5  0 and nh  , then

nh{^(t)

-

(t)}

-L

N

( 0,

JK0

Zt2{E[f

{(t)}f

{(t)}

) )]}-1 .

The proof of the theorem is also in the Appendix. When the regression function

f {(t)} is linear in (t), the above theorem is reduced to Theorem 3. As is shown

above, X(ti), i = 1, · · · , n, are supposed to be locally and identically distributed, we then write the matrix E[f {(t)}f {(t)} )] as a function of t.
When  is time-independent, the estimator ^ can be defined as the minimizer

of

Q^()

=

1 n

n-2 {Y¯i

- f^i()i1/2}2

i=1

over . Similar to (3.9), we have that, under some regularity conditions,

n(^

-

)

-L

N

( 0,

JK0

E(Z 2 ){E[f

()f

()

) ]}-1 .

5 Monte Carlo studies

In this subsection, the models for simulations are chosen to satisfy the stationary condition. The simulations are based on 500 repetitions with the size n = 300. We use the mean and mean squared error (MSE) of estimators to evaluate their performance.
Example 1. The main goal of this example is to examine the behavior of estimators of the diffusion term and the drift term in linear semiparametric models. Consider the common riskless asset model

P0(ti+1) - P0(ti) = rP0(ti)(ti+1 - ti)

(5.1)

with the Cox-Ingersoll-Ross (CIR) model

X(ti+1) - X(ti) = { - X(ti)}(ti+1 - ti) + X1/2(ti)(ti+1 - ti)1/2(ti), (5.2)

where ,  and  are the time-independent parameters. Note that model (5.1) is the same as (2.2) but model (5.2) differs from (2.3). Here model (5.2) does not

10 Lu Lin et al.

describe the stock price but an interest rate term structure, in which the spot rate X(t) moves around its long-run equilibrium level  at speed . When 2  2,

this process is shown to be positive and stationary. By the same notations as used

in Section 2, we have

[]

Y¯ (ti) =

n1 + rY (ti) -

+r n1  2

Z

2

{X

(ti

)}

1/2 + Z{X(ti)}(ti)

[a + bY (ti) + cZ2{X(ti)}]1/2 + Z{X(ti)}(ti)

(5.3)

and Z{X(ti)} = n1X1/2(ti).

Let  = 0.214,  = 0.086,  = 0.078, r = 0.05, n0 = 10, n1 = 10,  = 1/4, X(t0) =

0.08, P (t0)

=

0.1.

In

the

estimation,

we

use

the

Gaussian

kernel

K(t)

=

1 2

exp(-

t2 2

).

Table 1 reports the simulation results for the estimators of the coefficients

a

=

n1,

b

=

r

and

c

=

-

+r n1 2

.

The

results

show

that

the

estimator

of

b

works

well,

but those for a and c have large bias, and especially for c, the MSE is pretty large.

The curves however are fitted well. To be precise, the estimated curves of drift and

diffusion are close to the true ones. Figure 1 presents the estimated curves by one

simulation.

(Table 1 is about here) (Figure 1 is about here)

Example 2. As is shown in the previous sections, the asymptotic normality depends on the condition about , but the rates required for estimating the drift and the diffusion are different. Now we examine the behavior of the estimator with different choices of . The model is identical to that in Example 1 except choosing  = 4/10, which is larger than that in Example 1. Table 2 reports the simulation results. We see that when  is large, the resulting estimators work better than those obtained with small . By contrast, comparing Figure 1 with Figure 2, we see that Z{X(t)} is estimated more accurately when  is small. On the other hand, the drift term is estimated more accurately when  is large. These findings coincide with our theoretical results of course.

(Table 2 is about here) (Figure 2 is about here)

Example

3.

In

this

example



is

time-dependent

as

(t)

=

0.086

+

1 4

(

t n

-

0.5)2,

the other parameters are fixed at the values as in Example 1. Therefore, a = a(t) =

0.184

+

0.535(

t n

-

0.5)2.

The

simulations

show

that

the

estimator

^a(t)

works

very

well. Figure 3 reports the simulation results about estimated curves and confidence

bands respectively with bandwidth h = 10 and h = 20 by one simulation. We

may conclude that the estimation of a(t) is not very sensitive to the bandwidth

selection.

(Figure 3 is about here)

6 An empirical application
We now illustrate the proposed technology in a real data situation. To investigate the increment process of wealth in the financial market of China, we fit data

Mean Volatility Regressions

11

published in the Almanac of China's Finance and Banking (2004 and 2005). The dataset consists of the total amount of deposit and the total amount of market capitalization of stock reported daily from 2003 to 2004. To get daily data of

deposit, we approximate them by interpolation. Two models are used to fit the data, one is with constant coefficients and the other has varying-coefficients.
We first consider the following linear model

{ E{Y¯ (ti)|X(ti)} = [bY {X(ti)} + cZ{X(ti)}]t1/2, Var{Y¯ (ti)|X(ti)} = Z2{X(ti)} for ti = 1, 2, · · · , 483,

(6.1)

where parameters b and c are time-independent, X(ti), Y (ti), Y¯ (ti) and Z{X(ti)} are defined as those in Section 2. To estimate Z{X(ti)}, the bandwidth is chosen to be Std{X(t)}n-1/5 and the length of interval is chosen as ti = 1. After estimating Z{X(ti)}, b and c by the methods proposed in the previous sections, we get the fitted values of wealth increment; that is Y^¯ (ti) = [^bY (ti)+c^Z^{X(ti)}]1ti/2 (hundred million). Figure 4 reports the fitted values Y^¯ (ti) and real values Y¯ (ti). It shows
that the fitted values are in the centric curve of data cloud. Then our model and method work well in this case. Note that Z^{X(ti)} changes from time to time largely and the estimation value c^ = 1.471 is also large relative to ^b = -0.004. It
implies that the built-in variance (or deviation) in the regression function is not
negligible.

(Figure 4 is about here)

We now turn to considering the varying-coefficient linear model as { E{Y¯ (ti)|X(ti)} = [b(ti)Y {X(ti)} + c(ti)Z{X(ti)}]1t /2, Var{Y¯ (ti)|X(ti)} = Z2{X(ti)} for ti = 1, 2, · · · , 483.

(6.2)

For comparison, the bandwidth h for estimating Z{X(t)} and length of interval are chosen to be the same as those for model (6.1). Figure 5 reports the fitted values of wealth increment for different h and Table 3 lists the corresponding expectation values of squared residuals (MSR). From these figures and Table 3 we can see that, when h is large, the fitted values are smooth but the mean of squared residuals is large. Thus we should choose a suitable h to balance the smoothness and fitting. On the other hand, the means of squared residuals obtained by time-dependent model (6.2) are uniformly smaller than those obtained by the time-independent model (6.1). Then for this dataset, a time-dependent model seems more suitable than a time-independent model.

(Table 3 is about here) (Figure 5 is about here)

Appendix:Proofs Proof of (2.4) The wealth process Y {X(ti)} satisfies Y {X(ti)} = n0(ti)P0(ti) + n1(ti)X(ti).

12 Lu Lin et al.

By the existing literature, see for example Karatzas and Shreve (1998), the selffinancing implies
n0(ti)P0(ti+1) + n1(ti)X(ti+1) = 0,
where n0(ti) = n0(ti+1) - n0(ti) and n1(ti) = n1(ti+1) - n1(ti). By the representation of Z{X(ti)} = (ti)n1(ti)X(ti) and the self-financing equation, we see that if P0(ti) and X(ti) in the above wealth equation are replaced by those in (2.2) and (2.3), respectively, then the equation (2.4) follows.
Proof of Theorem 1 Without loss of generality, we assume ti =  for all i. Denote
Y¯ {X(ti)} = Y¯i, Z{X(ti)} = Zi, Kh = Kh{X(t) - x0}, Kh,i = Kh{X(ti) - x0}, Ki = K{X(ti) - x0}.

Because Xi, i = 1, · · · , n, are identically distributed, and Z(x) and p(x) have two continuous derivatives, we have

E(

1 n

n-2
i=1

Y¯i2Kh,i)

=

E[Y¯ 2{X(t)}Kh]

= = =

Eh1[E (ZY¯22({uX)K(t{)}(uK-h |Xx0

)] )/h}p(u)du

Z 2 (x0 )p(x0 )

+

1 2

h2

{Z

2(x0)p(x0

+ Op() )}K2 + Op

()

+

Op(h2).

Similarly,

E(

1 n

n-2
i=1

Kh,i

)

=

1 h



K{(u - x0)/h}p(u)du

=

p(x0)

+

1 2

h2

p(x0)K2

+

Op(h2).

Furthermore,

1 n

n-2
i=1

Kh,i

is

a

kernel

estimator

of

the

density

p(x0).

By

the

uniform weak consistency of kernel estimator with mixing dependent variables

(Peligrad 1992; Kim and Cox 1996), we have

supx

|

1 n

n-2
i=1

Kh,i

-

p(x)|

=

Op[h2

+

{log(nh)/nh}1/2].

Then

22

^ ( ) ( )Z x - Z xn0-2 Ei=1
= +n-2 Ei=1

Y¯i2 Y¯i2

KKhh,,iini-0-=-12 Knini==--h11,22i

= 1 + (1){np(x0)

(Y¯i2 Kh,i ) (Y¯i2 Kh,i )

En-2 i=1

(Y¯i2 Kh,ini=)--12ZK2h(,xi0 )

n-2
i=1

Kh,i

Op }

+

1 2

h2(Z2(x0)p(x0)-p(x0))K2 +Op(h2)+Op() p(x0 )

{1

+

Op(1)}.

(A.1)

(Ani.=1-)12sEh(oY¯wi2sKthh,ai)t.,

Z^2(x0) - Z2(x0) From Lemma 1

is of

asymptotically

equivalent

to

n-2
i=1

Y¯i2Kh,i

-

Politis and Romano (1992) and the relation

between the -mixing condition and the -mixing condition (see, e.g. Theorem

1.1.1 of Lu and Lin 1997), we can see that {Y¯12, · · · , Y¯n2} is a -mixing dependent

process and the mixing coefficient, denoted by Y (l), satisfies

 Y

(2k )



C

 (2k )

=



2k

<

,

k=1

k=1

k=1

Mean Volatility Regressions

13

where C is a positive constant. By this and Central Limit Theorems for -mixing dependent process (see Ibragimov 1975; or Theorem 6.3 of Fan and Yao 2005; or Theorem 4.0.1 of Lu and Lin 1997), we can obtain that

{ nh

1

n

n-2

Y¯i2Kh,i

-

1 n

n-2

} E(Y¯i2Kh,i)

-L

N (0,

D),

i=1

i=1

(A.2)

where

D

is

the

limiting

variance

of

 nh n

n-2
i=1

Y¯i2Kh,i.

The

work

remaining

is

to

calculate D. By the properties of Markov process and the -mixing coefficients, we

have

| E(Y¯i2Y¯i2+l{Kh,i - E(Kh,i)}{Kh,(i+l) - E(Kh,(i+l))}| = | E[Zi2Zi2+l{Kh,i - E(Kh,i)}{Kh,(i+l) - E(Kh,(i+l))}]| + O()  E(Zi2Zi2+l){Var(Ki) Var(Ki+l)}1/2 l + O() = Cl + O().

We

can

easily

verify

that,

as

n



,

1 n

n-2
i=1

n-i
l=1

l



 1-

.

Thus

D

=



Var(

nh n

n-2
i=1

Y¯

2Kh,i)

= =

+hh EE2n[[h(ZZ42{ni{X=-X1(2(t)t)}}(lnK(=-K1hihE--[Y¯EiE(2(KY¯Kih2+h)l)){)2K)]2+h],i2n-h OE((Khin,=i-)12}{Knlh=-,(1ii+ll))

- +

E(Kh,(i+l))}] O(h)

= Z4(x0)p(x0)JK0 + O(1).

(A.3)

Therefore the result of the theorem follows from (A.1)-(A.3).

Proof of Theorem 2 The proof is similar to that of Theorem 1 and thus is omitted here.

As Theorem 3 is a special case of Theorem 4, we omit the proof details. Proof of Lemma 1 Let 0(t) be the true value of the parameter in model (2.6)
and  be p-dimensional vector satisfying  = 1. It is sufficient to show that, for any given  > 0, the following holds:

{} P inf inf Q^{0(t) + n- } > Q^{0(t)}  1 - ,
t[0,T ] =1

(A.4)

where Q^ is defined in (4.1). This is because it implies that with probability at least 1 -  that supt[0,T ] ^(t) - 0(t)  n- . Hence there exists a minimizer such that supt[0,T ] ^(t) - 0(t) = Op(n- ).
Again by the uniform weak consistency of kernel estimator for mixing depen-
dent variables, we have

supx |Z^2(x) - Z2(x)| = Op{h2 + (log(nh)/nh)1/2}, supx |Z~2(x) - Z2(x)| = Op{h2 + (log(nh)/nh)1/2}.

Let fi() = f (ti, , Xi, Yi, Zi) and

L()

=

-

1 n

n-2 {Y¯i

-

fi()1/2}fi()1/2Kh(ti

-

t).

i=1

14 Lu Lin et al.
By similar methods and Taylor expansion, there exists a point  between 0(t) + n-  and 0(t), such that, uniformly for all x and t, noting that fi contains Z(x),

Q^{0(t) + n- } - Q^(0(t))

=

-n- L^(0(t))

+

Op(n-2 ) 2n

n-2 f^i()f^i() Kh(ti

-

t)

i=1

-

Op

(n-2 2n

)

n-2(Y¯i

-

f^i()1/2)f^i()1/2Kh(ti

-

t)

i=1

=

-n- L(0(t))

+

Op(n-2 ) 2n

n-2 fi()fi() Kh(ti

-

t)(1

+

Op(1))

i=1

-

Op

(n-2 2n

)

n-2(Y¯i

-

fi()1/2)fi()1/2Kh(ti

-

t)(1

+

Op(1))

i=1

=

-n- L(0(t))

+

Op(n-2 ) 2n

n-2 fi(0(t))fi(0(t)) Kh(ti

-

t)(1

+

Op(1))

i=1

-

Op

(n-2 2n

)

n-2(Y¯i

-

fi(0(t))1/2)fi(0(t))1/2Kh(ti

-

t)(1

+

Op(1)).

i=1

(A.5)

We now compare the convergence rates of the three terms. Again by the uniform consistency of kernel estimator, we have that, uniformly for all t,

() n- L{0(t)} = Op n- {h2 + (log(nh)/nh)1/2} ,

n-2 2n

n-2 fi{0(t)}fi{0(t)} Kh(ti

- t)

=

Op(n-2 ),

i=1

n-2 2n

n-2 [Y¯i

- fi{0(t)}1/2]fi{0(t)}1/2Kh(ti

- t)

[i=1 ]

= Op n-2 {h2 + (log(nh)/nh)1/2} .

These three rates indicate that the second term is slower convergent to zero than
the other two terms do. Thus, the first and third terms can be asymptotically negligible, and then Q^(0(t) + n- ) - Q^(0(t)) is asymptotically equivalent to

Op(n-2 ) 2n

n-2

fi{0(t)}fi{0(t)}

Kh(ti

-

t).

i=1

Note that the above is positive uniformly for t  [0, T ]. We then get that for any  > 0 with probability 1 - , for large n, Q^(0(t) + n- ) > Q^(0(t)) uniformly for
t  [0, T ]. This completes the proof of (A.6).
Proof of Theorem 4 Note that L^(^(t)) = 0 and L^((t)) = L((t))(1 + Op(1)). Then by Lemma 1 and Taylor expansion, we have that there exists a point 

Mean Volatility Regressions

15

between ^ and  such that, uniformly for all x and t,

0 = L(^){1 + Op(1))}

=

L()(1

+

Op(1))

+

1 n

n-2 fi()fi() Kh(ti

-

t){^(t)

-

(t)}{1

+

Op(1))}

i=1

-

1 n

n-2 {Y¯i

-

fi ( )1- }fi ( )1/2 Kh (ti

-

t){^(t)

-

(t)}{1

+

Op(1))}

i=1

=

L()(1

+

Op(1))

+

1 n

n-2 fi()fi() Kh(ti

-

t){^(t)

-

(t)}{1

+

Op(1))}

i=1

-

1 n

n-2 {Y¯i

-

fi()1/2}fi()1/2Kh(ti

-

t){^(t)

-

(t)}{1

+

Op(1))}.

i=1

(A.6)

As is shown in the proof of Lemma 1, the first and third terms on the right hand side of (A.6) can be asymptotically negligible uniformly for all x and t. By the uniform weak consistency of kernel estimator,

supt[0,1]

1 n

n-2

fi()fi()

Kh(ti

-

t)

-

E[f

((t))f

((t))

)]

i=1

= Op(h2 + (log(nh)/nh)1/2).

(A.7)

Fu-r1t/h2ermnhorLe(, b) yis tahseymsapmtoetiacraglluymneonrtmianl.

the proof of Hence (A.6)

Theorem and (A.7)

1, we result

have that in that

1/2nh(^(t) - (t))

=

{

1 n

n-2

fi()fi()

Kh(ti

-

}-1 t)

-1/2

 nh

L()

+

Op(1)

(i=1 )

-L N 0, JK0 Zt2{E[f ((t))f ((t)) )]}-1 ,

as desired.

References
1. A¨ it-Sahalia, Y. (1996). Testing continuous-time models of the spot interest rate. Review of Financial Studies, 9, 385-426.
2. Bardorff-Nielsen, O. E. and Shephard, N. (2002). Econometric analysis of realized volatility and its use in estimating stochastic volatility models. J. Royal Statistical Society Series B, 64, 253-280.
3. Bismut, J. M. (1973). Conjugate convex functions in optimal stochastic control. J. Math. Ann. Appl., 44, 384-404.
4. Bradley, R. C. (2005). Basic properties of strong mixing conditions. A survey and some open questions. Prob. Surveys, 2, 107-144.
5. Bradley, R. C. and Bryc, W. (1985). Multilinear forms and measures of dependence between random variables. J. Multivariate Anal., 16, 335-367.
6. Cai, Z. (2007). Trending Time-varying coefficient time series model with serially correlated errors. Journal of Econometrics, 136, 163-188.
7. Chan, K. C., Karolyi, A. G, Longstaff, F. A. and Sanders, A. B. (1992). An empirical comparison of alternative models of the short-time interest rate. Journal of Finance, 47, 1209-1227.

16 Lu Lin et al.
8. Fan, J. (2005). A selective overview of nonparametric methods in financial econometrics (with discussion). Statist. Sci., 20, 317-357.
9. Fan, J., Jiang, J., Zhang, C. and Zhou, Z. (2003). Time-dependent diffusion models for term structure dynamics. Statistica Sinica, 12, 965-992.
10. Hart, J. D. (1997). Nonparametric Smoothing and Lack-of-fit Tests. Springer-Verlag New York, Inc.
11. Ibragimov, I. A. (1975). A note on the central limit theorem for dependent random variables. Probab. Theory Appl. 20, 134-139.
12. Karatzas, L. and Shreve, S. (1998). Methods of Mathematical Finance. Springer, New York.
13. Karoui, N. E. and Peng, S. (1997). Backward stochastic differential equation in finance. Mathematical Finance, 7, 1-71.
14. Kim, T. T. and Cox, D. D. (1996). Uniform strong consistency of kernel estimator under dependence. Statist. and Prob. Letter, 26, 179-185.
15. Kolmogorov, A. N. and Rozanov, U. A. (1960). On the strong mixing conditions of a stationary Gaussian process. Probab. Theory Appl., 2, 222-227.
16. Lu, C. R. and Lin, Z. Y. (1997). Limit theories for mixing dependent variables. Science Press, Beijing.
17. Pardoux, E. and Peng, S. (1990). Adapted solution of backward stochastic differential equation. Systems control Lett., 14, 55-61.
18. Peligrad, M (1992). Properties of uniform consistency of the kernel estimators of density and regression functions under dependence assumptions. Stochastics, 40, 147 - 168.
19. Politis N. and Romano P. (1992) A general resampling scheme for triangular arrays of -mixing random variables with application to the problem of spectral density estimation. Ann. statist, 20, 1985-2007.
20. Rosenblatt, M. (1956). A central limit theorem and a strong mixing condition. Proc. Nat. Acad. Sci., 42, 43-47.
21. Rosenblatt, M. (1970). Density estimates and Markov sequences, in Nonparametric Techniques in Statistical Inference, ed. M. Puri, London: Cambridge University Press, pp. 199210.
22. Simonoff, J. S. (1996). Smoothing Methods in Statistics. Springer, New York. 23. Su, Y. X. and Lin, L. (2009). Semi-parametric estimation for Forward-Backward Stochastic
Differential Equations. Communication in Statistics-Theory and Methods, 38, 1759-1775. 24. Tsay, R. S. (2002). Analysis of Financial Time Series. John Wiley & Sons, inc. 25. Wand, M. P. and Jones, M. C. (1995). Kernel Smoothing. Chapman and Hall, London.

Table 1: The Parameter Estimators For Example 1

Parameter a b c

True value 0.1840 0.0500 -4.3393

Mean 0.2542 0.0499 -5.6493

MSE 0.0341 0.0000 14.0454

Table 2: The Parameter Estimators For Example 2

Parameter a b c

True value 0.1840 0.0500 -4.3393

Mean 0.1999 0.0500 -4.2135

MSE 0.0210 0.0000 6.6967

Mean Volatility Regressions

17

Model MSR
Model MSR

Table 3: Means Of Squared Residuals For Demonstration Study

(5.4) 2.164 × 105
(5.5) with h = 20 1.997 × 105

(5.5) with h = 10 1.887 × 105
(5.5) with h = 25 2.021 × 105

(5.5) with h = 15 1.957 × 105
(5.5) with h = 40 2.074 × 105

0.45 2 curve of Z(X(t)) estimated curve of Z(X(t))
0.4 1.5
0.35
1 0.3

drift curve estimated curve of drift

0.25

0.5

0.2
0 0.15

0.1 0 10 20 30 40 50 60 70 80

-0.5 0

10 20 30 40 50 60 70 80

Figure 1. The estimation curves with  = 1/4 for model in example 1. The figure on the left presents the true curve of Z{X(t)} and estimation curve of Z{X(t)}, and the figure on the right presents the true curve of drift term and its estimation curve.

0.35 20 curve of Z(X(t)) estimated curve of Z(X(t))
0.3 15

drift curve estimated curve of drift

0.25 10

0.2 5

0.15 0

0.1 0 20 40 60 80 100 120

-5 0 20 40 60 80 100 120

Figure 2. The estimation curves with  = 4/10 for model in example 2. The figure on the left presents the true curve of Z{X(t)} and estimation curve of Z{X(t)}, and the figure on the right presents the true curve of drift term and its estimation curve.

18 Lu Lin et al.

0.45 curve of a(t) estimated median curve of a(t)
0.4 estimated 25th sample percentiles curve of a(t) estimated 75th sample percentiles curve of a(t)
0.35

0.45
curve of a(t) 0.4 estimated median curve of a(t)
estimated 25th sample percentiles curve of a(t) estimated 75th sample percentiles curve of a(t) 0.35

0.3 0.3

0.25 0.25

0.2 0.2

0.15 0.15

0.1 0 10 20 30 40 50 60

0.1 0 10 20 30 40 50 60

Figure 3. The estimated curve and confidence band of a(t) in Example 3. The figures on the left and right present the results with h = 10 and h = 20, respectively.

2500 2000 1500 1000
500 0
-500 -1000 -1500
0

increment of wealth fitted increment of wealth
100 200 300 400 500

Figure 4. The fitted increment of wealth for model (5.4).

Mean Volatility Regressions

19

2500 2000 1500 1000
500 0
-500 -1000 -1500
0

increment of wealth fitted increment of wealth
100 200 300 400 500

2500 2000 1500 1000
500 0
-500 -1000 -1500
0

increment of wealth fitted increment of wealth
100 200 300 400 500

2500 2000 1500 1000
500 0
-500 -1000 -1500
0

increment of wealth fitted increment of wealth
100 200 300 400 500

2500 2000

increment of wealth fitted increment of wealth

1500

1000

500

0

-500

-1000

-1500 0

100 200 300 400 500

Figure 5. The fitted increment of wealth for model (5.5). The figures on the upper left and right respectively present the results h = 10 and h = 15. The figures on the middle left and right respectively present the results with h = 20 and h = 25.

SFB 649 Discussion Paper Series 2011
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Localising temperature risk" by Wolfgang Karl Härdle, Brenda López Cabrera, Ostap Okhrin and Weining Wang, January 2011.
002 "A Confidence Corridor for Sparse Longitudinal Data Curves" by Shuzhuan Zheng, Lijian Yang and Wolfgang Karl Härdle, January 2011.
003 "Mean Volatility Regressions" by Lu Lin, Feng Li, Lixing Zhu and Wolfgang Karl Härdle, January 2011.
SFB 649, Ziegelstraße 13a, D-10117 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

