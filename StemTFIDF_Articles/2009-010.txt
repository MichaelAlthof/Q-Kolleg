BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2009-010
A Microeconomic Explanation of the EPK
Paradox
Wolfgang Härdle* Volker Krätschmer**
Rouslan Moro***
*Humboldt-Universität zu Berlin, Germany **Technische Universität Berlin, Germany
***DIW Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

A Microeconomic Explanation of the EPK Paradox
Wolfgang K. Ha¨rdle, Volker Kr¨atschmer, Rouslan A. Moro.§
Abstract Supported by several recent investigations the empirical pricing kernel paradox might be considered as a stylized fact. In Chabi-Yo et al. (2008) simulation studies have been presented which suggest that this paradox might be caused by regime switching of stock prices in financial markets. Alternatively, we want to emphasize a microeconomic view. Based on an economic model with state dependent utilities for the financial investors we succeed in explaining the paradox by changes of the risk attitudes. Theoretically, the change behaviour is compressed by the pricing kernels. As a starting point for empirical insights we shall develop and investigate inverse problems in terms of data fits for estimated basic values of the pricing kernel.
Keywords: Pricing kernel, representative agent, empirical pricing kernel, epk paradox, state dependent utilities, switching points. JEL Classification: D01, D58, C02, G13 AMS Classification: 15A29, 62G07, 62G35
This research was supported by Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk". Center for Applied Statistics and Economics, Humboldt-Universit¨at zu Berlin, Spandauer Str. 1, 10178 Berlin; e-mail: haerdle@wiwi.hu-berlin.de. Center for Applied Statistics and Economics, Humboldt-Universit¨at zu Berlin, Spandauer Str. 1, 10178 Berlin and Institute of Mathematics, Berlin University of Technology, 10623 Berlin; e-mail: kraetsch@math.tu-berlin.de. §Center for Applied Statistics and Economics, Humboldt-Universit¨at zu Berlin, Spandauer Str. 1, 10178 Berlin and German Institute for Economic Research (DIW Berlin), Mohrenstr. 58, 10117 Berlin; e-mail: moro@diw.de.
1

1 Introduction
The empirical pricing kernel paradox refers to the empirical phenomenon that the observable behaviour of investors in financial markets conflicts with the traditional expected utility framework. Several recent studies support the conjecture that this deviation evolves into a stylized fact. All the investigations are settled within similar economic models assuming representative agents in financial markets whose indirect preferences have classical expected utility representation. Additionally, the risk neutral valuation principle is supposed to be valid for the financial markets by means of pricing kernels. If the pricing kernels represent state contingent equilibrium prices they might be identified with the v. Neumann-Morgenstern indices of the representative agents. As a consequence the pricing kernels should be nonincreasing. In the studies of Ait-Sahalia and Lo (2000), Jackwerth (2000), Detlefsen et al. (2007), Constantinidis et al. (2009) different econometric methods have been applied to estimate pricing kernels with varying underlying models for the financial markets. It turned out as a common result, that the estimates, the so called empirical pricing kernels, have non-monotonic shape regardless of the used data sets. This difference between the theoretical property of the pricing kernel and the observed failure of it is what we shall call the empirical pricing kernel paradox. A further confirmation of it is provided by Golubev et al. (2008). In this paper a test for monotonicity of pricing kernels has been introduced, and applied to DAX data over several periods. Typically, the nullhypothesis that the pricing kernel is nonincreasing was rejected. More recently, simulation studies in Chabi-Yo et al. (2008) suggest to explain by regime switches of the prices for the underlyings of the financial markets. Since it is plausible to view regime switches as consequences of changes in the investor' risk attitude, we want to emphasize a microeconomic perspective. The aim is to provide an extended economic model, which allows non-monotone pricing kernels. The crucial idea is to propose financial investors whose risk attidudes might be sensible to the prices in the financial markets. More technically, we shall assume state dependent utilities to represent the preferences of the financial investors. The paper is organized as follows. In section2 we shall introduce our model for the financial market. Also the classical relationship between the utilities of representative agent and the pricing kernel will be reviewed. Afterwards, the problem to estimate pricing kernel will be considered. Afterwards we shall point out the empirical pricing kernel paradox. A simple consumption model based on state dependent utilities
2

for the investors will be introduced in section 3. Within this framework we shall retain the relationship between preferences of investors and pricing in the market by an analogous result. It will turn out that dependent on the stock prices the v. Neumann-Morgenstern utility index for the representative agent might switch between different types of utilities, meaning possible changes of the risk attitudes. In particular pricing kernels might be non-monotone. The switching points and the types of utilities describe local risk attitudes of the investors. So in order to get some insight on the changing of the risk attitudes it might be useful to analyze the switching behaviour of the pricing kernel. The idea is to find a good fit of estimated basic values by given base functions expressing the possible types utilities. Essentially, there are inverse problems behind which will be developed and investigated throughout section 4. Several mathematical results and proofs of quite technical nature have been delegated to appendices A, B, C respectively.

2 Financial Investors' within the Expected Utility Framework and the Empirical Pricing Kernel Paradox

Let [0, T ] be the time interval of investment in the financial market, where t = 0 denotes the present time

and t = T ]0, [ the time of maturity.

Furthermore it is assumed that a riskless bond and a risky asset are traded in the financial market as basic

underlyings. The price process (Bt)t[0,T ] of the riskless bond is defined by

dBt Bt

=

rt

dt,

via a deterministic Riemannian-integrable interest process (rt)t[0,T ]. The price process (St)t[0,T ] of the risky asset is assumed to be a nonnegative semimartingale with constant S0 and continuously distributed marginals St (t ]0, T ]). Outstanding examples for such financial markets are the Black-Scholes model,

non-parametric diffusion models as in Ait-Sahalia and Lo (2000) and GARCH models. Notice that time

discrete models may be subsumed under this setting.

Furthermore let us suppose that the financial market is arbitrage free in the sense that there exists at least

one equivalent martingale measure.

We further assume that the risk neutral valuation principle is valid for nonnegative pay offs (ST ). That means that there is some unknown Radon-Nikodym density  of a martingale measure such that the price

3

of any (ST ) is characterized by

E

e-

RT
0

rx

dx(ST )

=E

e-

RT
0

rx

dx(ST )E[|ST ]

.

(1)

By factorization we find some Borel-measurable K with E[|ST ] = K(ST ), so that

E

e-

RT
0

rx

dx(ST )

=



e-

RT
0

rx

dx  (x)K (x)

pST (x)

dx,

0

(2)

where pST denotes a density function of the distribution of ST . Equation (2) gives reason to call K the pricing kernel (w.r.t. ).

Let us now embed the financial market into an economic model where the investors of the financial

market are consumers whose consumptions rely on the price ST of the stock at maturity only. Within

the classical framework, where the investor preferences may be represented by expected utilities, there

exists a link between the risk attitude of the investors and the pricing rule of the financial markets. It

is built upon the assumption of a representative agent whose indirect utility U ({e¯(ST )}), depending on

the aggregated market endowment e¯(ST ), has expected utility representation U (e¯[ST ]) = E[u(ST )] with

concave v. Neumann-Morgenstern utility index u. Under some further technical conditions on the investor

preferences,

and

the

additional

specification

e¯(ST )

=

ST S0

,

then

there

is

some

positive



such

that

du

dx

x=

sT S0

=

K

sT S0

for almost every realization sT of ST . This relationship might be obtained by using methods as in the

sections 6.1, 6.2 of Karatzas and Shreve (1998). For a rigorous formulation and derivation see Corollary

A.2 in Appendix A. It should be emphasized that within the classical expected utility framework the

pricing kernel has to be nonincreasing due to concavity of the utility index u.

Several recent econometric studies are concerned with the problem to estimate the pricing kernel, calling

the estimators empirical pricing kernels (EPK) (cf. Ait-Sahalia and Lo (2000), Jackwerth (2000), Detlefsen

et al. (2007), Constantinidis et al. (2009)). Typically, we may find a shape of the empirical pricing kernel

as visualized in the following graphic which is borrowed from Detlefsen et al. (2007).

The figure shows empirical pricing kernels resulting from different estimation methods. Here estimations of Garch-, Garch-M and discrete Heston models for stock prices had been done. The underlying data are the from the DAX index in March 2000. Significantly, all three kernels are quite similar: They have the

4

epk

7 returns GARCH
6 GARCH in mean 5 4 3 2 1 0 0.5 1 1.5 2
return
Figure 1: EPK on 24 March 2000. Across data sets, methods, models and markets
same form, the same characteristic features like e.g. the hump, and they differ in absolute terms slightly. In particular the empirical kernels fail to be monotone, contrasting the classical theory within the expected utility framework. This is what we shall call the empirical pricing kernel paradox. A further investigation in Detlefsen et al. (2007) based on DAX data in July 2002 and June 2004 confirmed the paradox. Moreover, in the above mentioned studies Ait-Sahalia and Lo (2000), Jackwerth (2000) one may find similar pictures of the empirical pricing kernels. So summarizing, the empirical pricing kernel paradox has been observed across different times independently of the data sets, the markets, the models of stock prices and the employed estimation methods. It is further supported by Golubev et al. (2008), where a statistical test for the monotonicity of pricing kernel has been developed. The application to DAX data over different periods lead to the rejection of the null hypothesis that the pricing kernel is nondecreasing, in almost every case.
3 A Microeconomic View on the EPK Paradox
A first explanation for the empirical pricing kernel paradox has been offered by Chabi-Yo et al. (2008). The crucial idea of the authors is to suppose that regime switches are inherent of the price process of the stock market. More specifially, within a discrete time period {0, 1, ..., T }, there are two types of price processes (St0)t{0,...,T }, (St1)t{0,...,T } for the risky asset which have joint continuous distributions, and constitute separately together with the riskless bond arbitrage free financial markets in the sense of section 2. Furthermore, Chabi-Yo et al. (2008) assume a latent regime switching variables in terms of an
5

unobservable Markov-chain (Ut)t{0,1,...,T } of Bernoulli-distributed random variables. The observable price process (St)t{0,1,...,T } is then modelled by St = UtSt1 + (1 - Ut)St0 for t  {0, ..., T }. Assuming the risk neutral valuation principle for the latent two basic financial markets and for the observable one, the authors

drew a comparison of the associated pricing kernels via a simulation study. Indeed it turned out that the

empirical pricing kernels in the separated financial market were nondecreasing whereas the empirical

pricing kernel in the integrated financial market failed to have the property of monotonicity. Therefore

the empirical pricing kernel might be explained by a switch of the price processes of the underlyings in

the financial market.

Referring to Chabi-Yo et al. (2008), we want to stress a microeconomic viewpoint. Based on the initializing

thought that regime switching is caused by changes of the investors' preferences our aim is to make the

influence of these changes on the shape of the pricing kernels more explicit. In the following we shall

provide a simple economic model underlying the financial market where the pricing kernel need not to be

nonincreasing. The key idea is to consider the investors as consumers whose preferences are representable

by utilities dependent on the prices of the stock. This refers to the concept of state dependent preferences.

An axiomatic justification is provided by Karni et al. (1983).

Let us assume that we have m consumers who choose among nonnegative random variables c(ST ). They have exogeneous endowments by initial capitals w01, ..., w0m > 0 and state dependent endowement in form of nonnegative random variables e1(ST ), ..., em(ST ). Their individual budget constraints for c(ST ) is therefore:

T

T

exp(- ry dy)c(x)K(x)pST (x) dx  w0i + exp(- ry dy)ei(x)K(x)pST (x) dx, i = 1, . . . , m.

00

00

(3)

The consumers are assumed to have state dependent utilities in terms of extended expected utility pref-

erences within the terminology of Mas-Colell et al. (1995). That means in particular that consumer i has

numerical representation of her/his preferences as:

T
U i{c(ST )} = E exp(- rx dx)ui{ST , c(ST )} ,
0
where ui : R+ × R+  R  {-} denotes a state dependent v. Neumann-Morgenstern utility index

6

satisfying:

ui(x, y)  R for x  0, y > 0, ui(x, ·) is strictly increasing and strictly concave for any x  0,

(4) (5)

ui(·, y) is Borel-measurable for every y  0.

(6)

At time of maturity T

the market has an aggregated endowment e¯(ST ) d=ef

m
{w0i + ei(ST )}.

It is assumed

i=1

that simultaneous consumption is allowed for consumption vectors (c1(ST ), ..., cm(ST )) which satisfy the

m

individual budget constraints and obey the aggregated endowment in the sense of ci(ST )  e¯(ST ). Such

i=1

vectors are called admissible, and they are gathered by a set say A (see Mas-Colell et al. (1995)).

Next it is supposed that the consumers have chosen their consumptions (c¯1(ST ), ..., c¯m(ST )) such that the following properties are fulfilled.

(ii) individual optimization: For each consumer i the consumption c¯i(ST ) solves the optimization problem

max U i{c(ST )}, s.t. c(ST ) satisfies individual budget constraint (3).

(7)

(i) market clearing:

m
c¯i(ST ) = e¯(ST ).
i=1

(8)

The conditions (8) and (8) describe a weak version of a so called contingent Arrow Debreu equilibrium

(see Dana and Jeanblanc (2003), sect. 7.1). As a by product (c¯1(ST ), ..., c¯m(ST )) is a Pareto optimum too, i.e. there is no (c1(ST ), ..., cm(ST ))  A with U i{ci(ST )}  U i{c¯i(ST )} for every i and such that U i0{ci0(ST )} > U i0{c¯i0(ST )} for at least one i0. Therefore, by the so called Negeishi method (cf. Dana and Jeanblanc (2003)) we may find nonnegative weights 1, ..., m summing to 1 such that

m mm

iU i{c¯i(ST )} = U{e¯(ST )} d=ef max

iU i{ci(ST )} | ci(ST )  e¯(ST )

i=1 i=1 i=1

(9)

Let u : R+2  R  {-, } be defined by

Tm

m

u(x, y) = sup exp(- rx dx) iui1(x, yi) | y1, ..., ym  0, yi  y .

0 i=1

i=1

7

Obviously, u(x, ·) is strictly increasing as well as strictly concave for x  0, and u(·, y) is Borel-measurable
for every y  0.
U{e¯(ST )} has extended expected utility representation
T
U{e¯(ST )} = E exp(- rx dx)u(e¯(ST )) ,
0

which might be concluded from Lemmata B.1, B.2 (cf. Appendix B). In the next step we want to establish the relationship between the indirect utility u of the representative agent and the pricing kernel K. As customary, we shall impose the so called Inada conditions (cf. Dana and Jeanblanc (2003)) on the state dependent utility indices u1(ST , ·), ..., um(ST , ·), i.e. u1(x, ·)|]0, [, ..., um(x, ·)|]0, [ are assumed to be continuously differentiable satisfying

dui(x, ·)

dui(x, ·)

lim e0 dy

y=e = ,

lim
e

dy

y=e = 0 (i = 1, ..., m)

(10)

for x  0.

The Inada conditions together with condition (5) imply that for any i  {1, ..., m} and every x  0 the

dui(x, ·) mapping

]0, [ is injective onto ]0, [ with continuously differentiable, strictly decreasing inverse

dy

say Ii(x, ·). Furthermore, in accordance with the investigations of consumption optimization within the

setting of expected utility maximizing financial investors the following condition of regularity should be

fulfilled:

E [I1 {(ST , yK(ST )}] , . . . , E [Im {(ST , yK(ST )}] <  for any y > 0.

(11)

See Dana and Jeanblanc (2003), Duffie (1996), Karatzas and Shreve (1998) for more details.

Theorem 3.1 In addition to (4) ­ (11) let u1(x, ·)|]0, [, ..., um(x, ·)|]0, [ be twice continuously differ-

entiable for x  0.

Then u(sT , ·)|]0, [ is continuously differentiable for every realization sT of ST . Furthermore for any

i > 0 there exists some i > 0 such that

du(sT , ·) dy

y=e¯(sT )

=

i

dui(sT dy

,

·)

y=c¯i(sT ) = iiK(sT )

for every realization sT .

8

The proof of Theorem 3.1 is delegated to the end of Appendix A.

Remark:

The relationship between pricing kernels and the marginal utilities of the individual investors as stated in

Theorem 3.1 occurs as a motif in the literature of financial mathematics to characterize solutions of different

optimization problems. Concerning the optimal utility based investment Kramkov and Schachermayer

(1999) introduced a new condition on the asymptotic elasticity of the utilities which replaced the analogue

of condition (11). Within our framework it reads as follows

dui(x, ·)

lim sup y dy

y< 1 for any x  0 and every i  {1, . . . , m}.

(12)

Kramkov and Schachermayer restrict themselves to individual investors with classical state independent

expected utility preferences. They achieved to show that the new introduced condition is a minimal

requirement to describe the optimal investment in terms of the marginal utilities and a pricing kernel.

Their methods had been adapted by Karatzas and Zitkovic (2003) to characterize the optimal consumption

in incomplete financial market similar to Theorem 3.1. The difference, and the mathematically more

challeging point is, that in Karatzas and Zitkovic (2003) the martingale measure is not fixed in advance.

Within our setting the guidelines of Kramkov and Schachermayer (1999) might be followed more directly

to establish Theorem 3.1 with condition (12) instead of (11). However, a rigorous derivation would lie

beyond the scope of this paper, and we use condition (12) which simplifies the argumentation in the proof

of Theorem 3.1.

Let RT

= ST S0

be the return at maturity.

It has a continuous distribution, say PRT .

If the market

endowment specializes to e¯(ST ) = ST /S0, Theorem 3.1 reads as follows.

Corollary 3.2 Let e¯(ST ) = ST /S0 and let u1(x, ·)|]0, [, ..., um(x, ·)|]0, [ be twice continuously differen-

tiable for x  0. Then under (4) ­ (11), u(st, ·)|]0, [ is continuously differentiable for every realization

rT , and for any i > 0 there exists some i > 0 such that

du(rT , ·) dy

y=rT

=

i

dui(rT dy

,

·)

y=c¯i(sT ) = iiK(S0rT ) d=ef K(rT ).

Corollary 3.2 is the corner stone for our microeconomic explanation of the empirical pricing kernel paradox. The framework of state dependent utilities of the investors allows us to describe a switching behaviour of

9

them when facing a threshold for the price of the stock at maturity. In more detail, let us assume that each consumer i is disposed of two basic continuous, strictly increasing and strictly concave utility indices ui0, u1i : [0, [ R  {-} with u0i (y), u1i (y)  R for y > 0. He or she is changing between these indices dependent on a threshold xi > 0 for the return RT , i.e.

ui(rT , ·) = 1[0,xi](rT )ui0 + 1]xi,[(rT )ui1

for every realization rT of RT . Here 1A denotes the indicator function of subset A. The reader might think of u0i , u1i as utility indices representing bearish and bullish risk attitudes of consumer i, and that her or his revealed attitudes are adapted to the prices of the financial market. In order to simplify notations, let us assume that the thresholds are ordered by x1  ...  xm. There exist different competing potential representative agent groups in the market with respective representations U1{e¯(ST )), . . . , Um+1(e¯(ST )} of indirect utilities defined by

Ui {e¯(ST )}

i-1 m+1

= sup

E

e-

RR
0

rx

dxu0k{ck(ST )}

+

E

e-

RR
0

rx

dxuk1{ck(ST )}

k=1 k=i

m+1
ck(ST )  e¯(ST ) .
k=1

In view of Lemmata B.1, B.2 (cf. Appendix B) they have expected utility representations

Ui {e¯(ST )} = E

e-

RT
0

rx

dxui {e¯(sT )}

,

where

ui (y) = sup

e-

RR
0

rx

dx

i-1 m
kuk0(yk) + kuk1(yk)
k=1 k=i

m
y1, ..., yk  0, yk  y
k=1

for y  0, i  {1, ..., m + 1}. It is now a routine excercise to verify that

m-1

u(x, y) = 1[0,x1](x)u1 (y) +

1]xi,xi+1](x)ui+1(y) + 1]xm,[(x)um+1(y) for x, y  0.

i=1

As a consequence the indirect utility U{e¯(ST )} might be interpreted as expressing the hegemony of the

different potential representative agents. Moreover, under the assumptions of Corollary 3.2 we obtain

immediately some  > 0 such that

1[0,x1

](rT

)

du1 (rT dy

,

·)

y=rT

m-1
+

1]xi,xi+1](rT

)

dui+1(rT dy

,

·)

y=rT

+1]xm

,[

(rT

)

dum +1(rT dy

,

·)

y=rT = K(rT )

i=1

10

Pricing Kernel

Switching points

Returns

Figure 2: EPK with the switching points.

holds for any realization rT of RT . From this observation it becomes clear that the pricing kernel is nonincreasing separately on the intervals [0, x1[, ]x1, x2[, ..., ]xm[, but it might fail to be monotone just

at the switching points x1, ..., xm (see figure 2). For illustration let us assume that the distribution of RT has [0, [ as support, and that the investors

have an identical switching point say x0. That means

1[0,x0]

(rT

)

du1(rT dy

,

·)

y=rT

+

1]x0

,[

(rT

)

dum +1(rT dy

,

·)

y=rT = zK(rT )

for every realization rT of RT .

Furthermore, let us suppose that each investor i switches between CRRA utilities uji (y) = yij /ij (j = 0, 1)

with

0

<

i1

<

i0

<

1,

inducing

the

Arrow-Pratt

coefficients

of

absolute

risk

aversion

ij (y)

=

1-ij y

(j = 0, 1; y > 0). It follows i1(y) > 10(y) for i  {1, ..., m} and y > 0, which means that u11, ..., um1

represent a more risk averse attitude than u01, ..., um0 (cf. Mas-Colell et al. (1995), p. 191). In particular

for stock prices lower or equal x0 we have a bullish market, whereas we obtain a bearish market when

stock prices exceed x0.

The application of Lemma B.1 and Proposition B.3 in Appendix B yields

rT = F 0

du1(rT , ·) dy y=rT

= F1

dum(rT , ·) dy y=rT

11

for any positive realization rT , where

1
F j :]0, []0, [, z  m (z) ij-1 i=1 i
i >0

(j = 0, 1)

are decreasing bijective mappings. If x0 > max{F 0(1), F 1(1)}, then

du1(rT , ·) dy

y=rT

,

dum (rT dy

,

·)

y=rT < 1,

and

F0

du1 (rT , ·) dy y=rT

= rT = F 1

dum (rT , ·) dy y=rT

> F0

dum(rT , ·) dy y=rT

for any realization rT  x0. Therefore

dum+1(rT , ·) dy

y=rT

>

du1(rT , ·) dy

y=rT for rT  x0.

That means that K is not monotone at x0.

4 The Inverse Problems for the Switching Points

In section 3 we developed an economic environment, where in equilibrium the pricing kernel K(RT ) may

be expressed by a mixture of different marginal utilities. That means

K(RT ) =

m

1]xi-1

,xi]

(RT

)

dui dy

y=RT

+1]xm

,[

(RT

)

dum+1 dy

y=RT

i=1

for some m  N, 0 = x0 < ... < xm <  and mappings u1, ..., um+1 : [0, ]  R  {-} whose restrictions to ]0, [ are strictly increasing, strictly convex twice continuously differentiable real-valued

functions satisfying the Inada conditions. Such a representation will be the starting point for the following

investigations. The values x1, ..., xm will be called the switching points of the pricing kernel K(RT ).

They are the amounts of returns where the investors are feeling themselves compelled to change their risk

attitudes. Usually as a local measure of the risk aversion one might use the Arrow-Pratt coefficient of

absolute risk aversion. Hence the change of the risk attitudes might be expressed by drawing a comparison

of the left- and right-sided versions the Arrow-Pratt coefficients of absolute risk aversions at the switching

12

points. They read as follows

K(xi - ) - K(xi)

K(xi + ) - K(xi)

lim
0+

 K (xi )

, lim
0+

 K (xi )

for i  {1, ..., m}.

Unfortunately, neither the number and the location of the switching points nor the marginal utilities of the

u1, ..., um+1 are known. In order to get an idea of them we suggest to fit basic values of the pricing kernel.
For that purpose we fix a set V of strictly decreasing continuously differentiable mappings v :]0, [ R
satisfying lim v(x) = 0. As a prominent example we mention the parameterized set of functions v, defined
x
by v(x) d=ef (x + a)b-1 for some a  0 and b ]0, 1[. These are the marginals of the generalized HARA
N
(CRRA) utilities. As test functions for the data fitting we shall use mixtures vi1]xi-1,xi] of functions
i=1
from V. Here the basic points represent approximately the unknown switching points. The quality of the
approximation will be expressed by quadratic mean error w.r.t. a fixed continuous distribution F^ with
density function say p^ and compact support enclosed in [0, [. The mapping p^ might be a kernel estimation

of a density function for the distribution of RT . Henceforth we shall denote the minimum and maximum of the support by z and z¯ respectively.

We shall focus on the choice of appropriate basic points. The two approaches we want to propose differ

in the way to discretize the pricing kernel.

4.1 The Monte Carlo Approach

For any distribution F on R satisfying F ([z, [) = 1, we shall consider i.i.d. sequences (XNF )N of

random variables with common distribution F. Fixing N, they are associated with the order statistics

X1:N , ..., XN:N according to z d=ef X0:N  X1:N  ...  XN:N .

The

idea

is

to

discretize

randomly

K

by

KN (F )

d=ef

N
i=1 K (XiF:N )1]X(Fi-1):N ,XiF:N ].

The

suggestion

is

statis-

tically motivated by the following observation.

Proposition 4.1 Let F be a continuous distribution on R with F ([z, [) = 1, and let C(K) denote the set of continuity points of K. Then for any x  C(K) which belongs to the topological interior int(supp(F ))
of the support of F we obtain
N
K(XiF:N )1]X(Fi-1):N ,XiF:N ](x)  K(x) a.s..
i=1
13

In particular, setting i(F ) d=ef inf{x | F (] - , x]) > 0} and s(F ) d=ef sup{x | F (] - , x]) < 1}, we may even achieve this convergence for any x  C(K)]i(F ), s(F )[ if supp(F ) is konvex.

Proposition 4.1 is an immediate application of Proposition C.1 in appendix C.

The choice of proper basic points for the discretization changes into the problem to find a proper a priori

distribution for the Monte Carlo sampling. The sample size N will be assumed to be given exogeneously.

Simulating the jumping behaviour of K in finite many points, we shall restrict ourselves to all continuous distributions with bounded support enclosed in [0, [, and which have density functions being constant

on each interval ]xi-1, xi[ (i = 1, ..., N ) for some x0  x1  ...  xN , where x0 and xN denote a lower and an upper bound of the support respectively. In particular we consider the set PN of all continuous

distributions with bounded support enclosed in [z, z¯], and which have density functions being constant on each interval ]xi-1, xi[ (i = 1, ..., N ) for some z d=ef x0  x1  ...  xN d=ef z¯. Furthermore for F  PN we shall denote the joint distribution of X1F:N , ..., XNF :N by F(N). Then the inverse problem reads as follows. Inverse problem: Find F   PN such that

inf
v1,...,vN V

EF(N )

N2

KN (F )(x) -

vi(x)1]X(Fi- 1):N ,XiF:N ](x)

i=1

p^(x) dx

N2

= min inf
F PN (z) v1,...,vN V

EF(N) KN (F )(x) -

vi(x)1]X(Fi-1):N ,XiF:N ](x)

i=1

p^(x) dx

We shall discuss the solvability of the inverse problem after we shall have introduced the second inverse

problem to be considered.

4.2 The pure numerical approach

The restriction K|[z, z¯] should be discretized by by some basic values. More precisely, we choose a partition z d=ef x0  x1 < ... < xN d=ef z¯ of [z, z¯], and use KN (x1, ..., xN ) d=ef N K(xi)1]xi-1,xi] as an approximation
i=1
of K|[z, z¯]. This idea suggests itself by the following observation.

N

Proposition

4.2

The

mapping

i=1

K (a+

i N

(b-a))1
]a+

(i-1) N

(b-a),a+

i N

(b-a)]

converges

to

K |[a,

b]

uniformly

on compacta of continuity points of K|[a, b] for any nondegenerated interval [a, b] ]0, [.

14

Proposition 4.2 may be derived immediately from the well known Korovkin like approximation result for

mappings on [0, 1] (cf. e.g. Witting and Mu¨ller-Funk (1995), Satz B5.2).

As for the Monte Carlo approach we shall not care about the choice of N, it will be assumed to be exogeneously given. Denoting by ZN the set of all (x1, ..., xN )  RN satisfying x0 d=ef z  x1  ...  xN = z¯, the choice of the basic points might be described in terms of the following inverse problem.

Inverse problem: Find (x1, ..., xN )  ZN such that

inf
v1,...,vN V

N

K(xi ) - vi(x)

2
1]x(i-1),xi ](x)

p^(x)

dx

i=1

= inf

inf

(x0,...,xN )ZN v1,...,vN V

N2
K(xi) - vi(x) 1]x(i-1),xi](x) p^(x) dx
i=1

As a convention we tacitly set K(0) d=ef  and  · 0 d=ef 0.

4.3 Solvability of the inverse problems

Throughout this section we shall assume

sup v(x)2+p^(x) dx <  for some  > 0.
vV

Remark 4.3 In the following situations the family V fulfills the assumed integrability condition:

1.

1 p^(x) 0 x2+

dx <  for some  > 0, and V d=ef

v :]0, [ R, x  (x + a)b-1 | a  0, b ]0, 1[

.

2. z > 0, and sup v(z) < , e.g. if V d=ef v :]0, [ R, x  (x + a)b-1 | a  0, b ]0, 1[ .
vV

The integrability condition means that V is L2-norm bounded. In particular V as well as {v2 | v  V} are uniformly F^-integrable, and the weak closure clw(V) of V is weakly compact because L2(F^), equipped with the L2-norm, is a reflexive Banach space. Moreover, since the standard Borel -algebra on R is countably generated, the L2-norm topology on L2(F^) is separable. Hence the relative topology of the weak topology to clw(V) is metrizable (cf. Dunford and Schwarz (1958), Theorem V.6.3), and thus as a

compact topology also separable. So we obtain the following result.

15

Lemma 4.4 Under the integrability condition on V the weak closure clw(V) of V is weakly compact, and the relative weak topology to clw(V) is separably metrizable.

For abbreviation let us define g : ZN × L2(F^)N  R  {} by


  g(x1, ..., xN , v1, ..., vN ) =
 

N
(K(xi) - vi(x))2 1]xi-1,xi](x)p^(x) dx : (v1, ..., vN )  VN
i=1
 : otherwise

Let us gather some basic properties of g.

Lemma 4.5 Let 1 be the relative topology of the standard topology on RN to ZN , let 2 denote the product weak topology on L2(F^)N , and let 1 × 2 stand for the product topology of 1 and 2. Furthermore let us denote the set of continuity points of K by C(K). Then under the integrability condition on V the mapping g satisfies the following properties:

1. g(x1, ..., xN , ·) | VN is lower continuous w.r.t. 2 for every (x1, ..., xN )  ZN ;
2. g(·, v1, ..., vN ) is measurable w.r.t. the Borel -algebra generated by 1 for any (v1, ..., vN )  VN , and the restrictions of these mappings to ZN  C(K)N are even continuous w.r.t. 1;
3. The family g(·, v)|ZN  C(K)N v  VN is equicontinuous w.r.t. 1, in particular the restriction of g to ZN  C(K)N × VN is lower semicontinuous w.r.t. 1 × 2.

Proof: The statement 1. may be verified by routine procedures. For that purpose it should be observed that we may restrict ourselves to sequential weak lower semicontinuity by Lemma 4.4 and that the squared L2-norm is weakly lower semicontinuous as a convex L2-norm continuous mapping. Statement 2. follows easily from measurability of K and the following observation

(*) For every 1 > 0, there is some 2 > 0 such that

sup |w(x)| 1]y1,y2](x) - 1]z1,z2](x) p^(x) dx < 1
wW
whenever (y1, y2), (z1, z2)  [0, [2 with y1  y2, z1  z2 and (y1 - z1)2 + (y2 - z2)2 < 2. Here W denotes an arbitrary familiy of uniformly F^-integrable real-valued mappings on ]0, [.

16

In order to see (*) observe 1]y1,y2] - 1]z1,z2] p^(x) dx = 1]y1,y2[ - 1]z1,z2[ p^(x) dx  0 as (z1, z2)  (y1, y2), and that 1]y1,y2] - 1]z1,z2] is just indicator function of the symmetric difference of the involved intervals. For the proof of statement 3. it suffices to show 1-equicontinuity of g(·, v)|ZN  C(K)N v  VN because the second part of statement 3. follows then in view of statement 1.. So let us fix some (x1, ..., xn)  ZN  C(K)N . Since ZN  C(K)N  1, we may find a bounded neighbourhood U  1 of (x1, ..., xn) such that U  C(K)N [, z¯]N for some  > 0. Then we obtain for any (x~1, ..., x~N )  U and any (v1, ..., vN )  VN

|g(x1, ..., xN , v1, ..., vN ) - g(x~1, ..., x~N , v1, ..., vN )|

N2
 K(xi) - vi(x) 1]xi-1,xi] - 1]x~i-1,x~i] p^(x) dx
i=1

N
+
i=1

22
K(xi) - vi(x) - K(x~i) - vi(x) 1]x~i-1,x~i] p^(x) dx

N2
 sup K(xi) - v(x) 1]xi-1,xi] - 1]x~i-1,x~i] p^(x) dx
i=1 vV

N
+ sup
i=1 vV

22
K(xi) - v(x) - K(x~i) - v(x) 1]x~i-1,x~i] p^(x) dx

N2
 sup K(xi) - v(x) 1]xi-1,xi] - 1]x~i-1,x~i] p^(x) dx
i=1 vV

N

+ K(xi) - K(x~i) sup
i=1 vV

K(xi) + K(x~i) + 2v(x) p^(x) dx

Since we have assumed K to be a piecewise decreasing positive function, K|[, z¯] is bounded from above
by some positive . Additionally, sup v(x) p^(x) dx <  by weak compactness of clw(V), and v2 | v  V
vV
is uniformly F^-integrable due the integrability condition on V. Therefore, on one hand

N

K(xi) - K(x~i) sup
i=1 vV

K(xi) + K(x~i) + 2v(x) p^(x) dx

N

 2 + 2 sup v(x) p^(x) dx

K(xi) - K(x~i) .

vV i=1

17

On the other hand [K(x) - v]2 | x  [, z¯], v  V is uniformly F^-integrable (cf. Bauer (1992), Korollar 21.3), and we may apply (*). Putting all together, the equicontinuity of g(·, v)|ZN  C(K)N v  VN at (x1, ..., xN ) follows immediately, completing proof.
Next let us introduce the lower semicontinuous envelope lsc(g) of g, defined to be the largest 1 × 2-lower semicontinuous R  {}-valued mapping dominated by g. Notice that g and lsc(g) coincide on the set
ZN  C(K)N × VN by Proposition 3.6 in DalMaso (1993). The lower semicontinuous envelope will turn out to be a useful tool concerning the solvability of the inverse problems posed in the subsections before. Let us begin with the one coming out of the pure numerical approach. In terms of g it reads as follows.

minimize inf g(x1, ..., xN , v)
vV N
among all (x1, ..., xN )  ZN .
Fortunately, we may apply directly Theorem 3.8 in DalMaso (1993), observing that ZN × clw(V)N is compact and sequentially compact w.r.t. 1 × 2, and by Lemma 4.5

lim
m

inf
vV N

g(xm,

v)

-

inf
vV N

g(x0,

v)



lim
m

sup
vV N

|g(xm,

v)

-

g(x0,

v)|

=

0

for any sequence (xm)mN0 in ZN  C(K)N  1 with xm  x0.

Theorem 4.6 Let

(xm, vm)

m

be

a

sequence

in

ZN

× VN

such

that

lim
m

g(xm,

vm

)

= inf inf g(x, v).
xZN vVN

Then this sequence has at least one cluster point in ZN × clw(V)N , and every such cluster point (x, v)

satisfies

lsc(g)(x, v) = min lsc(g)((x, v) = inf g(x, v),

(x,v)ZN ×clw(V)N

(x,v)ZN ×VN

with inf g(x) = inf inf g(x, v) if the components of x are continuity points of K.

vV N

xZN vVN

In view of Tonelli's theorem the inverse problem we have formulated after introducing the Monte-Carlo

approach may be described in terms of g by

minimize

inf
vV N

EF(N )

g(X1F:N , ..., XNF :N , v)

among all F  PN .

Concerning the solvability of this problem we may observe the following result.

18

Theorem 4.7 Let w be the topology of weak convergence on the set of distributions on R, and let w × 2 denote the product topology of w and the product weak topology 2 on L2(F^)N . Furthermore let us consider a sequence ((Fm, vm))m in PN × VN fulfilling

lim
m

EFm(N

)

g(X1F:mN , ..., XNFm:N , vm)

=

inf
F PN

inf
vV N

EF(N )

g(X1F:N , ..., XNF :N , v)

.

Then this sequence has a cluster point w.r.t. to w × 2. Every such cluster point (F , v) satisfies

min

lim inf
m

EFm(N )

g(X1F:mN , ..., XNFm:N , v~m)

| v~m  v

=

min min
vL2(F^)N

lim inf
m

EFm(N )

g(X1F:mN , ..., XNFm:N , v~m)

| v~m  v

=

inf
F PN

inf
vV N

EF(N )

g(X1F:N , ..., XNF :N , v)

,

where even inf EF 
vV N

g(X1F:N , ..., XNF :N , v)

=

inf
F PN

inf
vV N

EF(N )

g(X1F:N , ..., XNF :N , v)

holds if z > 0, and

the set of discontinuity points of K is a F -null set (e.g. if F  is a continuous distribution).

Proof:

First of all, since the topology of weak convergence for distributions on R is completely as well as separably

metrizable, and since the supports of the distributions Fm are uniformly enclosed in a compact subset of

R, the sequence (Fm)m is uniformly tight, and therefore has a cluster point by Prokhorov's theorem.

Furthermore clw(V)N has been observed as sequentially 2-compact by Lemma 4.4, so that we may

conclude that ((Fm, vm))m has a cluster point w.r.t. w × 2. Now, let (F , v) be a cluster point of ((Fm, vm))m . Without loss of generality we may assume that it

is even a limit point. Then the induced sequence (Fm(N))m of the respective joint distributions of the

order

statistics

X1F:mN , ..., XNFm:N

has

the

joint

distribution

F(N )

of

X1F:N

,

...,

XNF


:N

as

a

limit

point

w.r.t.

the

topology of weak convergence on the set of distributions on RN . Indeed, denoting the joint distribution

of the order statistics U1:N , ..., UN:N obtained from an i.i.d sample of size N according to the uniform

NN

distribution on ]0, 1[ by FU,(N), we have Fm(N)

] - , xi]
i=1

= FU,(N)

] - , Fm(] - , xi])]
i=1

for any (x1, ..., xN )  RN , and an analogous expression for FN . Then the claim follows immediately from

the Helly Bray theorem.

19

Now we may apply directly Theorem 7.8 from DalMaso (1993) to the sequence (Gm)m of functions Gm : L2(F^)N  R  {}, defined by

 Gm(v) d=ef  EFm(N)

g(X1F:mN , ..., XNFm:N , v)

:

v  VN

.

  : otherwise

This proves the first part of the Theorem 4.7.
In the case of z > 0, the mapping K|[z, z¯] is bounded, because as a result of section 3 we may describe K
k
by K = 1]yi-1,yi]wi, where 0 = y0 < y1 < ... < yk = , and w1, ..., wk denote decreasing real-valued
i=1
mappings on ]0, [. This implies that g(·, v) is bounded too for every v  V.
Moreover, [XiF:N = x] is a null set for any distribution F whose distribution function is continuous at x. Hence, denoting the set of continuity points of K by C(K)N , we have F(N)(ZN × C(K)N ) = 1 for every F  {Fm, F  | m  N} because by assumption K is not continuous at finitely many points only. Therefore
in view of Lemma 4.5 we might draw on a well known result concerning uniform convergence w.r.t. the
topologies of weak convergence (cf. Billingsley and Topsoe (1967), Theorem 1) to conclude

inf
vV N

EFm(N )

g(X1F:mN , ..., XNFm:N , v)

-

inf
vV N

EF(N )

g(X1F:N

,

...,

XNF


:N

,

v)



sup
vV N

EFm(N )

g(X1F:mN , ..., XNFm:N , v

- EF(N)

g

(X1F:N

,

...,

XNF


:N

,

v

 0.

The proof is complete.

A Appendix
We continue with the consumption model of section 3, retaking all assumptions and notations. The aim of this section is to provide a proof for Theorem 3.1. For this purpose let us firstly characterize the optimal consumptions c¯1(ST ), ..., c¯m(ST ) of the individual consumer. Assumption (3.5) enables us to apply the dominated convergence theorem to show
(A1) continuity of the mappings gsit :]0, [ R, y  Ii{sT , yK(sT )}K(sT ) (sT  0, i  {1, ..., m}).
20

Furthermore the Inada conditions together with monotone and dominated convergence imply

(A2)

lim
y0

gsi T

(y)

=



and

lim
y

gsi T

(y)

=

0.

We are now ready to extend the classical characterization of the optimal consumption to the case of

extended expected utility preferences.

Theorem A.1 Assuming (4) ­ (11), there exist y1, ..., ym > 0 such that

c¯i(ST ) = Ii{ST , yiK(ST )} for i = 1, . . . , m

Proof: Let us fix i  {1, ..., m} and denote xi d=ef w0i + E[ei(ST )K(ST )]. Since xi > 0 we may find in view of (A1), (A2) some yi > 0 with g(yi) = xi. Let c(ST ) be a nonnegative random variable with E[c(ST )K(ST )]  xi. Then

E[u{ST , c(St)}] + yi(xi - E[c(ST )K(ST )] = yixi + E[u{ST , c(St)} - yic(ST )K(ST )] 
yixi + sup E[u(ST , x) - yixK(ST )] =
x0
yixi + E[u[ST , Ii{ST , yiK(ST )}] - yiIi{ST , yiK(ST )}K(ST )] = E[u{ST , Ii(ST , yiK(ST ))}].

Therefore Ii(ST , yiK(ST )) solves the optimization problem of consumer i. Moreover, the numerical representation Ui of consumer's i preferences is strictly concave in view of strict concavity of ui(x, ·) for every x  0. In particular Ii(ST , yiK(ST )) is the unique solution, hence being identical with c¯i(ST ).
Before starting with the proof of Theorem 3.1 let us consider for purposes of reference the classical case of the consumer being expected utility maximizer. Indeed as an additional corollary of Theorem 3.1, we may retain the folk result concerning the risk neutral price valuation and the v. Neumann-Morgenstern utility index of the representative agent. More precisely, let us assume that there exist mappings u1, ..., ur from R+ into R  {-} satisfying u1(x, ·) = u1, ..., um(x, ·) = um for x  0, and
(A3) u1(y), ..., um(y)  R for y > 0,
(A4) u1, ..., um are continuous, strictly increasing as well as strictly concave.

21

Then

mm

u(y) d=ef sup

iui(yi) | y1, ..., ym  0, yi  y = u(x, y) for x, y  0.

i=1 i=1

The adaptions of (10), (11) read as follows. We shall impose the so called Inada conditions on the state

independent utility indices u1, ..., um, i.e.

(A5) u1|]0, [, ..., um|]0, [ are assumed to be continuously differentiable satisfying

lim dui e0 dy

y=e = ,

lim dui e dy

y=e = 0 (i = 1, ..., m).

(A6) E[I1(yK(ST ))], . . . , E[Im(yK(ST ))] <  for any y > 0, where I1, ..., Ir denote the inverses of du1 , ..., dum respectively. dy dy

We may conclude immediately from Theorem 3.1 the announced result.

Corollary

A.2

Let e¯(ST ) =

ST S0

,

and

let

u1|]0,

[,

...,

um|]0,

[

be

twice

continuously differentiable.

Then

under (A3) - (A6), u|]0, [ is continuously differentiable, and for any i > 0 there exists some i > 0

such that

du dy

y=

sT S0

=

i

dui dy

Proof of Theorem 3.1:

y=c¯i(sT ) = iiK(sT ) for any realization sT of ST .

Without loss of generality let us set {1, ..., r} d=ef i  {1, ..., m} | i > 0}. Then, defining gi d=ef iui, we
r
have u = gi, and we may apply Lemmata B.1, B.2 and Proposition B.3 (cf. Appendix B). Then, in
i=1
view of Lemmata B.1, B.2 and (3B), we obtain
r
u (sT , e¯[sT ]) = iui sT , c¯i[sT ]
i=1
for every realization sT of ST .

On one hand by Theorem A.1, there exist y1, ..., ym > 0 such that

c¯i(ST ) = Ii(ST , yiK(ST )) > 0 for i = 1, ..., r.

On the other hand, due to Proposition B.3, u(sT , ·)|]0, [ is differentiable for every realization sT ,

satisfying

i

ui(sT , ·) dy

y=c¯i(sT )=

u(sT , ·) dy

y=e¯(sT )

for i  {1, ..., r} and any realization sT . Notice that by construction the random variable e¯(ST ) has strictly

positive outcomes only. Now, the statement of Theorem 3.1 is clear.

22

B Appendix

Throughout this section let the mappings g1, ...gr : R2+  R  {-} satisfy the following conditions: (B0) g1(x, y), ..., gr(x, y)  R for x  0, y > 0;

(B1) g1(x, ·), ..., gr(x, ·) are continuous, strictly increasing and strictly concave for x  0;

(B2) g1(·, y), ..., gr(·, y) are Borel-measurable for y  0.

Furthermore let g : R+2  R  {-, } be defined by

rr

g(x, y) = sup

gi(x, yi) | y1, ..., yr  0, yi  y

i=1 i=1

r
Indeed g(x, 0) = gi(x, 0)  R  {-inf ty} for x  0, and
i=1

- <

r

gi(x,

y r

)



g(x,

y)



r

gi(x, y) < 

i=1 i=1

for x  0, y > 0 due to (B0), (B1).

.

Lemma B.1 For any x, y  0 there is some unique (x, y) = (1(x, y), ..., (x, y))  Rm+ such that
m
i(x, y)  y and
i=1 r
gi(x, i(x, y)) = g(x, y).
i=1
m
Furthermore i(x, y) = y.
i=1
Proof:

Let x, y  0. For y = 0 the statement of Lemma B.1 is obvious. So let y > 0, which means g(x, y)  R.

Due to (B1), the mapping

rr

r

f : (y1, ..., yr)  Rr+

yi  y, gi(x, yi)  g(x, y) - 1  R, (y1, ..., yr)  gi(x, yi)

i=1 i=1

i=1

is continuous, strictly concave, and defined on a nonvoid convex compact set. Therefore f attains it
r
maximum at a unique (x, y). Obviously, i(x, y) = y because f is strictly increasing too by (B1).
i=1
The proof is complete.

Lemma B.1 defines a mapping  = (1, ..., r) : R+2  Rr+. It is Borel-measurable as will be shown now.

23

Lemma B.2  is Borel-measurable.

Proof:
r
It suffices to show that -1 i=1 [0, ai] is a Borel-subset of R2+. For this purpose define for any (a1, ..., ar) from Rr+ the mapping ga1...ar : R+ × R+  R  {-} by

r rr

ga1...ar (x, y) = sup

gi(x, yi) | (y1, ..., yr)  [0, ai],
i=1

yi  y .

i=1 i=1

Notice that ga1...ar (x, y)  R for x  0, y > 0, analogously to g(x, y)  R for x  0, y > 0. Furthermore

r

g1(x, ·), ..., gr(x, ·) are continuous for any x  0. Hence, setting Ra1...ar =

[0, ai] × Qm,
i=1

ga-11...ar (]z, [) =
(y1 ,...,yr )Ra1 ...ar

r -1

r

igi(·, yi)

]z, [ ×

yi, 

i=1 i=1

(z  R).

Thus ga-11...ar (]z, [) is a Borel-subset of R+2 for every z  R by assumption (B2). Then we may conclude

that

-1

-1

r

[0, ai]
i=1

=

sup gb1...br - ga1...ar
(b1 ,...,br )Qr+

({0})

is a Borel subset of R+2 for any (a1, ..., ar)  Rr+, which completes the proof.

In order to characterize the mapping  in terms of derivatives of the functions g1(x, ·), ..., gr(x, ·), it is customary to impose the Inada conditions, i.e.

(B3) for any x  0 the mappings g1(x, ·)|]0, [, ..., gr(x, ·)|]0, [ are assumed to be continuously differen-

tiable satisfying

gi(x, ·) lim 0 y

y=

= ,

lim gi(x, ·)  y

y=e = 0, i = 1, . . . , r.

The Inada conditions together with condition (B1) imply that for any i  {1, ..., r} and every x  0 the mapping gi(x, ·) ]0, [ is injective onto ]0, [ with continuously differentiable, strictly decreasing
y inverse say Ii(x, ·).

Proposition B.3 Let the assumptions (B0) - (B3) be fulfilled, and let g1(x, ·)|]0, [, ..., gr(x, ·)|]0, [ be

twice continuously differentiable.

Then for any x  0 the mapping g(x, ·) ]0, [ is differentiable satisfying

g(x, ·)

g(x, ·)

(x, y) = I1 x, y y , . . . , Ir x, y y

for y > 0.

24

Proof:
r
Let for x  0 the mapping Fx : ]0, [×]0, [ R be defined by Fx(y, z) = Ii(x, z) - y.
i=1
Since the mappings g1(x, ·)|]0, [, ..., gr(x, ·)|]0, [ are assumed to be strictly concave and twice contin-

uously differentiable, their second derivatives are strictly negative. Then by local inverse theorem the

mappings I1(x, ·), ..., Ir(x, ·) are continuously differentiable, having strictly negative derivatives. In partic-

ular Fx is continuously differentiable, satisfying

Fx z

(y,z)= 0 for y, z > 0.

Furthermore, since I1(x, ·), ..., Ir(x, ·) are continuous and strictly decreasing mappings onto ]0, [, we may

find for any y > 0 a unique (y) > 0 with F (y, (y)) = 0. Drawing on the implicit function theorem,

y  (y) defines a differentiable mapping  :]0, []0, [.
r
Moreover, for y > 0 and y1, ..., yr  0 with yi  y, we may conclude
i=1

r rr

gi(x, yi) + (y)(y - yi) = (y)y + (gi(x, yi) + (y)yi) 

i=1 i=1 i=1 r

(y)y + sup(gi(x, z) + (y)z) =
i=1 z0
r

(y)y + [gi{x, Ii(x, (y))} + (y)Ii{x, (y)}] =

i=1 r

r

gi[x, Ii{x, (y)}] - Fx{y, (y)} = gi[x, Ii{x, (y)}].

i=1 i=1

This means

r

g(x, y) = gi[x, Ii{x, (y)}],

i=1

and hence by Lemma B.1

(*) (x, y) = (I1[x, (y)], ..., Ir[x, (y)]).

As a further consequence g(x, ·)|]0, [ is differentiable satisfying

dg(x, ·) dy

y=

r

(y) dIi(x, ·)   dy

i=1

d y= (y)

r
Ii(x, ·)  
i=1
dy

y= (y).

r
For the last equation notice that Ii(x, ·)   is just the identity on ]0, [. In view of (*) the proof is
i=1
complete.

25

C Appendix

Proposition C.1 Let g :]0, [ R be a mapping whose set of continuity points C(g) is an open subset of

R. Furthermore, let F be an atomless distribution with satisfying F ([z, [) = 1 for some z  0. Addition-

ally, let (XN )N denote an i.i.d. sequence of random variables over some probability space (, F, P) with common distribution F, inducing for any N the order statistics X1:N , ..., XN:N with z d=ef X0:N  X1:N 

...  XN:N . Then for any continuity point x of g which belongs to the topological interior int(supp(F )) of

the support of F we obtain

N
g(Xi:N )1]X(i-1):N ,Xi:N ]  g(x) a.s..
i=1

In particular, setting i(F ) d=ef inf{x | F (] - , x]) > 0} and s(F ) d=ef sup{x | F (] - , x]) < 1}, we may

even achieve this convergence for any x  C(g)]i(F ), s(F )[ if supp(F ) is konvex.

Proof: Let x  C(g)  int(supp(F )), let qF-, qF+ denote the lower and upper quantile functions of F respectively, and let us define 0 d=ef F (] - , x]). Since F is atomless, and since x  int(supp(F )) we have 0 ]0, 1[ and qF-(0) = qF+(0) = x. Let  > 0 be fixed. By assumption C(g) is open so that there is some  > 0 such that g|]x - , x + [ is
continuous, and |g(y) - g(x)| <  for any y ]x - , x + [. Furthermore, the lower and upper quantile
functions of F differ on at most countable points only, and the distribution function of F is continuous. Hence we may find an antitone sequence (n)nN in ]0, 1[ which converges to 0 such that qF-(n) = qF+(n) d=ef qF (n) for every n  N. We may draw on the asympotic theory of order statistics to find some A  F, P(A) = 1, such that

lim
N 

X1:N ()

=

i(F

)

for





A,

and

lim
N 

X[N j +1]:N

()

=

qF

(j )

holds for every   A and any j  N, where [N j + 1] denotes the largest l  N with l  N j + 1 (cf. Witting and Mu¨ller-Funk (1995), Satz 7.108, Satz 7.120). Now let us fix   A. Putting things together, we have qF (j) ]x, x + [, and thus

X1:N () < x < X[Nj+1]:N () < x + 

26

for sufficiently large j and N. Hence, setting iN d=ef min{i  {1, ..., N } | x  Xi:N ()}, we obtain the inequalities XiN :N ()  X[Nj+]:N () < x + , implying
N
g(Xi:N )1]X(i-1):N ,Xi:N ]() - g(x) = |g(XiN :N ()) - g(x)| < .
i=1
The remaining part of follows immediately from the observation that int(supp(F )) =]i(F ), s(F )[ is valid for convex supp(F ).
References
Ait-Sahalia, Y. and Lo, A. (2000). Nonparametric risk-management and implied risk aversion. Journal of Econometrics, 94(9):9­51.
Bauer, H. (1992). Mass- und Integrationstheorie. de Gruyter, Berlin, 2nd edition.
Billingsley, P. and Topsoe, F. (1967). Uniformity in weak convergence. Z. Wahrscheinlichkeitstheorie verw. Geb., 7:1­16.
Chabi-Yo, Y., Garcia, R., and Renault, E. (2008). State dependence can explain the risk aversion puzzle. Review of Financial Studies, 21:973­1011.
Constantinidis, G. M., Jackwerth, J. C., and Perrakis, S. (2009). Mispricing of S&P 500 Index Options. Forthcoming in Review of Financial Studies.
DalMaso, G. (1993). An Introduction to -Convergence. Birkh¨auser, Boston et al.
Dana, R.-A. and Jeanblanc, M. (2003). Financial Markets in Continuous Time. Springer, Berlin.
Detlefsen, K., H¨ardle, W. K., and Moro, R. A. (2007). Empirical pricing kernels and investor preferences. SFB 649 Discussion Paper 017, Humboldt-Universita¨t zu Berlin.
Duffie, D. (1996). Dynamic Asset Pricing Theory, 2nd ed. Princeton University Press.
Dunford, N. and Schwarz, J. (1958). Linear Operators. Part I. Interpublisher Sciences, New York.
27

Golubev, Y., H¨ardle, W. K., and Timofeev, R. (2008). Testing monotonicity of pricing kernels. SFB 649 Discussion Paper 001, Humboldt-Universita¨t zu Berlin.
Jackwerth, J. (2000). Recovering risk aversion from option prices and realized returns. Review of Financial Studies, 13(2):433­451.
Karatzas, I. and Shreve, S. E. (1998). Methods of Mathematical Finance. Springer, New York. Karatzas, I. and Zitkovic, G. (2003). Optimal consumption from investment and random endowment in
incomplete semimartingale markets. The Annals of Probability, 31:1821­1858. Karni, E., Schmeidler, D., and Vind, K. (1983). On state dependent preferences and subjective probabili-
ties. Econometrica, 51(4):1021­1031. Kramkov, D. and Schachermayer, W. (1999). The asymptotic elasticity of utility functions and optimal
investment in incomplete markets. The Annals of Applied Probability, 9(3):904­950. Mas-Colell, A., Whinston, M. D., and Greene, J. R. (1995). Microeconomic Theory. Oxford University
Press. Witting, H. and Mu¨ller-Funk, U. (1995). Mathematische Statistik II. Teubner, Stuttgart.
28

SFB 649 Discussion Paper Series 2009
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Implied Market Price of Weather Risk" by Wolfgang Härdle and Brenda López Cabrera, January 2009.
002 "On the Systemic Nature of Weather Risk" by Guenther Filler, Martin Odening, Ostap Okhrin and Wei Xu, January 2009.
003 "Localized Realized Volatility Modelling" by Ying Chen, Wolfgang Karl Härdle and Uta Pigorsch, January 2009.
004 "New recipes for estimating default intensities" by Alexander Baranovski, Carsten von Lieres and André Wilch, January 2009.
005 "Panel Cointegration Testing in the Presence of a Time Trend" by Bernd Droge and Deniz Dilan Karaman Örsal, January 2009.
006 "Regulatory Risk under Optimal Incentive Regulation" by Roland Strausz, January 2009.
007 "Combination of multivariate volatility forecasts" by Alessandra Amendola and Giuseppe Storti, January 2009.
008 "Mortality modeling: Lee-Carter and the macroeconomy" by Katja Hanewald, January 2009.
009 "Stochastic Population Forecast for Germany and its Consequence for the German Pension System" by Wolfgang Härdle and Alena Mysickova, February 2009.
010 "A Microeconomic Explanation of the EPK Paradox" by Wolfgang Härdle, Volker Krätschmer and Rouslan Moro, February 2009.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

