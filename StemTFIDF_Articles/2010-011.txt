BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2010-011
Illiquidity and Derivative Valuation
Ulrich Horst* Felix Naujokat*
* Humboldt-Universität zu Berlin, Germany
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Illiquidity and Derivative Valuation

Ulrich Horst, Felix Naujokat
Institut für Mathematik Humboldt-Universität Berlin horst@mathematik.hu-berlin.de naujokat@mathematik.hu-berlin.de
February 1, 2010
Abstract
In illiquid markets, option traders may have an incentive to increase their portfolio value by using their impact on the dynamics of the underlying. We provide a mathematical framework within which to value derivatives under market impact in a multi-player framework by introducing strategic interactions into the model of Almgren and Chriss (2001). Specically, we consider a nancial market model with several strategically interacting players that hold European contingent claims and whose trading decisions have an impact on the price evolution of the underlying. We establish existence and uniqueness of equilibrium results for risk neutral and CARA investors and show that the equilibrium dynamics can be characterized in terms of a coupled system of possibly non-linear PDEs. For the linear cost function used in Almgren and Chriss (2001), we obtain a (semi) closed form solution. Analyzing this solution, we show how market manipulation can be reduced.
AMS classication: 91B28, 91B70, 60K10 JEL classication: C73, G12, G13 Keywords: Stochastic dierential games, illiquidity, market impact, derivative valuation.
1 Introduction
Standard nancial market models assume that asset prices follow an exogenous stochastic process and that all transactions can be settled at the prevailing price without any impact on market dynamics. The assumption that all trades can be carried out at exogenously given prices is
We thank Torsten Schöneborn, Mikhail Urusov, seminar participants at various institutions and two anonymous referees for valuable comments and suggestions. Financial Support through the SFB 649 Economic Risk is gratefully acknowledged.
1

appropriate for small investors that trade only a negligible proportion of the overall daily trading volume; it is not appropriate for institutional investors trading large blocks of shares over a short time span. Trading large amounts of shares is likely to move stock prices in an unfavorable direction and often carries signicant trading costs. This is a particular challenge for traders that need to liquidate or acquire large portfolios. In derivative markets the situation is more ambiguous. A trader that is endowed with a large number of options may have an incentive to utilize her impact
on the price dynamics of the underlying in order to move the option value in a favorable direction1.
Pirrong (2001) write that a trader with a large long position in a cash-settled contract can drive up its settlement value by buying excessive quantities [of the underlying]. Kumar and Seppi (1992) call such trading behavior punching the close. This paper addresses the problem of derivative valuation in nancial markets with strategically interacting investors that have an incentive to punch the close. We model the interaction between the investors as a stochastic dierential game and establish existence and uniqueness of Markov equilibria for risk neutral and CARA investors. This allows us to discuss some ideas how manipulation in the sense of punching the close can possibly be avoided.
Our work builds on previous research in at least three dierent elds. The rst is the mathematical modeling of illiquid nancial markets. The last few years the role of liquidity as a source of nancial risk has been extensively investigated in both the mathematical nance and nancial economics literature. Much of the literature focusses on either optimal hedging and portfolio liquidation strategies for a single large investor under market impact (Çetin, Jarrow, and Protter (2004), Alfonsi, Fruth, and Schied (2010), Rogers and Singh (2008)), predatory trading (Brunnermeier and Pedersen (2005), Carlin, Lobo, and Viswanathan (2007), Schied and Schöneborn (2007)) or the role of derivative securities including the problem of market manipulation using options (Jarrow (1994), Kumar and Seppi (1992)). It has been shown by Jarrow (1994), for instance, that by introducing derivatives into an otherwise complete and arbitrage-free market, certain manipulation strategies for a large trader may appear, such as market corners and front runs. Schönbucher and Wilmott (2000) discuss an illiquid market model where a large trader can inuence the stock price with vanishing costs and risk. They argue that the risk of manipulation on the part of the large trader makes the small traders unwilling to trade derivatives any more. In particular, they predict that the option market breaks down. Our analysis indicates that markets do not necessarily break down when stock price manipulation is costly as it is in our model. Kraft and Kühn (2009) analyze the behaviour of an investor in a Black Scholes type market, where trading has a linear permanent impact on the stock's drift. They construct the hedging strategy and the indierence price of a European payo for a CARA investor, and show that the optimal strategy is a combination of hedging and manipulation. In order to exploit her market impact, the investor over- or underhedges the option, depending on her endowment and the sign of the impact term.
The second line of research our paper is connected to is the strategic interaction between large investors and its implications for market microstructure, as discussed in Kyle (1985), Foster
1Gallmeyer and Seppi (2000) provide some evidence that in illiquid markets option traders are in fact able to
increase a derivative's value by moving the price of the underlying.
2

and Viswanathan (1996), Back, Cao, and Willard (2000), and Chau and Vayanos (2008), for instance. Brunnermeier and Pedersen (2005), Carlin, Lobo, and Viswanathan (2007) and Schied and Schöneborn (2007) consider predatory trading, where liquidity providers try to benet from the liquidity demand that comes from some large investor. Vanden (2005) considers a pricing game in continuous time where the option issuer controls the volatility of the underlying but does not incur liquidity or spread crossing costs. He derives a Nash equilibrium in the two player, risk neutral case and shows that seemingly harmless derivatives, such as ordinary bull spreads, oer incentives for manipulation that are identical to those oered by digital options (p. 1892, l. 36). Closest to our setup is the paper by Gallmeyer and Seppi (2000). They consider a binomial model with three periods and nitely many risk neutral agents holding call options on an illiquid underlying. Assuming a linear permanent price impact and linear transaction costs, and assuming that all agents are initially endowed with the same derivative they prove the existence of a Nash equilibrium trading strategy and indicate how market manipulation can be reduced.
A third line of research we build on is market manipulation. Dierent notions of market manipulations have been discussed in the literature including short squeezes, the use of private information or false rumours, cf. Kyle (1985), Back (1992), Jarrow (1994), Allen and Gale (1992), Pirrong (2001), Dutt and Harris (2005), Kyle and Viswanathan (2008). However, it seems to us that no generally accepted denition of market manipulation has yet been established. Kyle and Viswanathan (2008, p. 1) classify a trading strategy as illegal price manipulation if it undermines economic eciency both by making prices less accurate as signals for ecient resource allocation and by making markets less liquid for risk transfer. Our notion of manipulation refers to the practice of punching the close, i.e. moving the stock price in order to increase the payo of a given option. Kyle and Viswanathan (2008) call strategies such as punching the close benign, to emphasize that they are not necessarily illegal. Punching the close nonetheless reduces the accuracy of prices as signals about a stock's fundamental value; we thus argue that it fullls at least the rst part of Kyle and Viswanathan's denition of illegal manipulation.
Most of the aforementioned articles on manipulation are set up in discrete time. We suggest a general mathematical framework in continuous time within which to value derivative securities in illiquid markets under strategic interactions. Specically, we consider a pricing game between a nite number of large investors (players) holding European claims written on an illiquid stock. Their goal is to maximize expected utility at maturity from trading the stock where their portfolio value at maturity depends on the trading strategies of all the other players through their impact on the dynamics of the underlying. Following Almgren and Chriss (2001) we assume that the players have a permanent impact on stock prices and that all trades are settled at the prevailing market price plus a liquidity premium. The liquidity premium can be viewed as an instantaneous price impact that aects transaction prices but not the value of the players' inventory. This form of market impact modeling is analytically more tractable than that of Obizhaeva and Wang (2005) which also allows for temporary price impacts and resilience eects. It has also been adopted by, e.g. Carlin, Lobo, and Viswanathan (2007) and Schied and Schöneborn (2007) and some practitioners from the nancial industry, as pointed out by Schied and Schöneborn (2008).
Our framework is exible enough to allow for rather general liquidity costs including the linear
3

cost function of Almgren and Chriss (2001) and some form of spread crossing costs, cf. Example 2.4. We show that when the market participants are risk neutral or have CARA utility functions the pricing game has a unique Nash equilibrium in the class of absolutely continuous Markovian trading strategies; existence results for more general utility functions are given for the single player case. We solve the problem of equilibrium pricing using techniques from the theory of stochastic optimal control and stochastic dierential games. Assuming that players' action sets are given by a class of absolutely continuous Markovian trading strategies we show that the family of the players' value functions can be characterized as the solution to a coupled system of non-linear PDEs. Coupled systems of non-linear PDEs arise naturally in dierential stochastic games. Since general existence and uniqueness of solution results for systems of non-linear PDEs on unbounded state spaces are unavailable much of the literature on stochastic dierential games is conned to bounded state spaces; see. e.g., the seminal paper of Friedman (1972). Without a priori estimates it is usually hard to prove the existence of a global solution to a non-linear PDE system. We prove an a priori estimate Nash equilibria. More precisely we prove that under rather mild conditions any equilibrium trading strategy is uniformly bounded. This allows us to prove that the PDE system that describes the equilibrium dynamics has a unique classical solution. The equilibrium problem can be solved in closed form for a specic market environment, namely the linear cost structure used in Almgren and Chriss (2001) and risk neutral agents.
It is important to know which measures may reduce market manipulation. For instance, Dutt and Harris (2005) propose position limits; Pirrong (2001) suggests ecient contract designs. We use the explicit solution for risk neutral investors to show when punching the close is not benecial. For instance, no manipulation occurs in zero sum games, i.e., in a game between an option writer and an option issuer. In our model manipulation decreases with the number of informed liquidity providers and with the number of competitors, if the product is split between them. Furthermore, we nd that the bid ask spread is important determinant of market manipulation. It turns out that the higher the spread, the less benecial market manipulation: high spread crossing costs make trading more costly and hence discourage frequent re-balancing of portfolio positions.
This paper is organized as follows: We present the market model in section 2. In section 3, we formulate the optimization problem, derive a priori estimates for Nash equilibria and prove the existence of a solution for one player with general utility function. We solve the multi-player case in section 4 for risk neutral and CARA agents. We use these solutions in section 5 to show how market manipulation can be reduced. Section 6 concludes.
2 The Model
We adopt the market impact model of Schied and Schöneborn (2007) with a nite set of agents, or players, trading a single stock whose price process depends on the agents' trading strategies.
Following Almgren and Chriss (2001) we shall assume that the players have a permanent impact on asset prices and that all trades are settled at prevailing market prices plus a liquidity premium
which depends on the change in the players' portfolios. In order to be able to capture changes
in portfolio positions in an analytically tractable way, we follow Almgren and Chriss (2001) and
4

Schied and Schöneborn (2007) and restrict ourselves to absolutely continuous Markov trading

strategies. A Markov trading strategy for player j  J

{1, ..., N } is a family of mappings

Xtj : R  R for any time t  [0, T ] where Xtj (p) denotes the number of stock shares the player

holds at time t, given the stock current price is p. We assume that the strategy X j belongs to the

class

X {X : [0, T ]×R  R|X absolutely continuous adapted and X0 = 0} ,

write dXtj = X tj dt and call X j the trading speed of player j.

Remark 2.1. We appreciate that it may be considered undesirable to allow for absolutely contin-
uous strategies only. Jumps are naturally captured in discrete time models, such as Kumar and

Seppi (1992) or Gallmeyer and Seppi (2000). However, strategies with absolutely continuous and jump parts in continuous time would call for methods of singular or impulse control, viscosity solutions, and (systems of ) quasi variational inequalities. This is beyond the scope of this article; we refer the interested reader to Ly Vath, Mnif, and Pham (2007) and Guo and Pham (2005) for

a discussion of investment problems with more general trading strategies.

2.1 Price dynamics and the liquidity premium

Our focus is on valuation schemes for derivatives with short maturities under strategic market
interactions. For short trading periods it is appropriate to model the fundamental stock price, i.e.,

the value of the stock in the absence of any market impact, as a Brownian Motion with volatility

(Bt). Market impact is accounted for by assuming that the investors' accumulated stock holdings

N i=1

X

i

have

a

linear

impact

on

the

stock

process

(Pt)

so

that

N
Pt = P0 + Bt +  Xti
i=1

(2.1)

with a permanent impact parameter  > 0. The linear permanent impact is consistent with the
work of Huberman and Stanzl (2004) who argue that linearity of the permanent price impact is
important to exclude quasi-arbitrage.
A trade at time t  [0, T ] is settled at a transaction price P~t that includes an additional instantaneous price impact, or liquidity premium. Specically,

P~t = Pt + g

N
X ti
i=1

(2.2)

with a cost function g that depends on the instantaneous change

N i=1

X i

in

the

agents'

position

in a possibly non-linear manner. The liquidity premium accounts for limited available liquidity,

transaction costs, fees or spread crossing costs, cf. Example 2.4. Spread-crossing costs are of

particular importance and have not been considered in the previous literature on market impact.

5

Remark 2.2. In our model the liquidity costs are the same for all traders and depend only on the

aggregate demand throughout the entire set of agents. This captures situations where the agents

trade through a market maker or clearing house that reduces the trading costs by collecting all orders

and matching incoming demand and supply prior to settling the outstanding balance

N i=1

X ti

at

market prices.

We assume with no loss of generality that g is normalized, g(0) = 0, and that g is smooth. The following additional mild assumptions on g will guarantee that the equilibrium pricing problem
has a solution for risk neutral and CARA investors.
Assumption 2.3. · The derivative g is bounded away from zero, that is g >  > 0.

· The mapping z  g(z) + zg (z) is strictly increasing.

The rst assumption is a technical condition needed in the proof of Proposition 3.2. It appears

not too restrictive for a cost function. Since the liquidity costs associated with a net change in the
overall position z is given by zg(z), the second assumption states that the agents face increasing marginal costs of trading. Our assumptions on g are satised for the following important examples:

Example 2.4. Among the cost functions which satisfy Assumption 2.3 are the linear cost function
g(z) = z with  > 0, used in Almgren and Chriss (2001) and cost functions of the form

2

g(z) = z + s arctan(Cz) 

with

s, C > 0.

The former is the cost function associated with a block-shaped limit order book. The latter can
be viewed as a smooth approximation of the map z  z + s · sign(z) which is the cost function associated with a block-shaped limit order book and bid ask spread s > 0.

2.2 Preferences and endowments
Each agent is initially endowed with a contingent claim H j = H j (PT ), whose payo depends on the stock price PT at maturity. Our focus is on optimal trading strategies in the stock, given an
initial endowment. As in Gallmeyer and Seppi (2000) and Kraft and Kühn (2009), we assume
that the agents do not trade the option in [0, T ]. A consistent model for trading an illiquid option
with illiquid underlying in a multiplayer framework in continuous time is not available, to the
best of our knowledge. Our work might be considered a rst step in this direction. Although it
is not always necessary, we assume that the functions H j are smooth and bounded with bounded derivatives Hpj .
Remark 2.5. We only consider options with cash settlement. This assumption is key. While cash
settlement is susceptible to market manipulation, we show in Corollary 5.4 below that when deals are settled physically, i.e., when the option issuer delivers the underlying, market manipulation is not benecial: Any price increase is outweighed by the liquidity costs of subsequent liquidation. We notice that this only applies to punching the close. There are other types of market manipulation, such as corners and short squeezes, which might be benecial when deals are settled physically, but which are not captured by our model, cf. Jarrow (1994) or Kyle and Viswanathan (2008).

6

If the agent j follows an absolutely continuous trading strategy X j , then the value of her

portfolio at maturity is given by the option payo H j (PT ) less the costs of trading -

T 0

X tjP~tdt

plus the liquidation value LV j (XTj ) of the stock position XTj at maturity.

Remark 2.6. Dening and computing the liquidation value of an asset position in an illiquid

market is currently an active eld of research, cf. Almgren and Chriss (2001), Obizhaeva and

Wang (2005), Alfonsi, Fruth, and Schied (2010) and Schied and Schöneborn (2008), to mention

only a few. For the special case of a single risk neutral investor the expected liquidation value

under innitely slow liquidation equals the expected trading costs in the absence of market impact

so the optimization problem is given by

T

sup E - X tjg X tj dt + Hj(PT ) .

Xj X

0

In particular, in optimizing her expected portfolio value the investor can focus entirely on the tradeo between increased trading costs (market impact) and increased option payos.

Rigorously dening a form of liquidation value in a game-theoretic setting is challenging, even under risk neutrality. One reason is that all the agents optimize their trading rules against their beliefs about the other players' assessments of all the portfolio values at maturity. In order to simplify the analysis, and in order to focus on the interplay between the gain from manipulating option payos and the increase in trading costs that accompanies it, we shall assume that all agents value their portfolios according to its acquisition costs in the absence of market impact. Of course, this is just a rst benchmark, but it nonetheless yields some insight into the structure of optimal trading under strategic interactions. Without Assumption 2.7, the equilibrium analysis becomes rather intractable as we illustrate in Appendix C.

Assumption 2.7. All agents optimize their utility assuming that for all j = 1, ..., N

T

LV j(XTj ) =

X tjPtdt.

0

(2.3)

Under the preceding assumption the optimization problems of the individual market partici-

pants reduce to

sup E uj
Xj X

T
- X tjg
0

N
X ti
i=1

dt + Hj(PT )

.

(2.4)

This optimization problem reects each investor's tradeo between high liquidity costs and an
increased option payo.2 If there is no market impact, agents do not trade, as we shall see in

Remark 3.1.

Denition 2.8. We say that a vector of strategies X 1, ..., X N is a Nash equilibrium if for each

agent j  J her trading strategy X j is a best response against the behavior of all the other players,

i.e., if X j solves (2.4), given the other players' aggregate trading X -j

i=j X i.

2The only purpose of trading is an increased option payo and not, for instance, hedging. For a study on the
interplay of hedging and manipulation we refer the reader to Kraft and Kühn (2009).

7

In the following section we derive a priori estimates for equilibrium trading strategies and use standard results from the theory of stochastic optimization to show that Nash equilibria can be characterized in terms of a coupled system of partial dierential equations (PDEs). For the special case of risk neutral and CARA investors we show that the system of PDEs has a solution so that a unique (in a certain class) equilibrium exists.

3 Equilibrium Dynamics and A-Priori Estimates

In this section we formulate the optimization problem (2.4) as a stochastic control problem, derive

the associated Hamilton-Jacobi-Bellman-equations, HJB for short, and transform it into a system
of coupled PDEs. To this end, we choose the stock price P and the trading costs Rj of the agent j  J as state variables. They evolve according to:

N



  

dPt

=

dBt

+



X tidt,



 i=1

N

    

dRtj

=

X tjg

X ti dt,



i=1

P0 = p0 R0j = 0.

For a given time t < T , spot price p and a vector of trading costs r = function of the player j, dened by

r1, ..., rN

the value

V j(t, p, r)

TN

sup Et uj -rj - X sjg

X si ds + Hj(PT ) | Pt = p ,

Xj X

t i=1

(3.1)

denotes the maximal expected portfolio value at maturity that the player can achieve by trading

the underlying. The associated HJB-equation is (cf. Fleming and Soner (1993)):



   

0

=

vtj

+

1 2

2vpjp

+

sup
cj R





  

vj (T ,

p,

r)

=

uj

-rj + Hj(p)

cj + X -j

vpj + g

cj + X -j

 

cj vrjj +

X ivrji 

i=j

(3.2)
The HJB-equation is formulated in terms of the candidate value functions v1, ..., vN instead of the actual value functions V 1, ..., V N . We rst need to show existence and uniqueness of a smooth solution to (3.2) before we can identify vi with V i. Given the aggregate trading strategy X -j of all the other agents, a candidate for the maximizer cj = X j in (3.2) should satisfy

0 = vpj + g cj + X -j vrjj + g


cj + X -j cj vrjj + X ivrji  .
i=j

(3.3)

Under some mild technical assumption which will all be satised for the case of risk neutral and CARA investors studied in Section 4 we are now going to turn the individual HJB equations into a coupled system of non-linear PDE. In terms of this PDE system we shall then characterize a class of equilibrium trading strategies.

8

3.1 The equilibrium PDE system

Let us assume that the matrix vrij (t, p, r) i,jJ is invertible for any xed argument (t, p, r). We

will show in Section 4 that this is true for risk neutral and CARA investors. In these cases,

vrij (t, p, r) i,jJ is a diagonal matrix. If vrij (t, p, r) i,jJ is invertible, there exist 1, ..., N  R

such that

N i=1

 i vri j

=1

for

each

j

 J.

Thus,

multiplying

equation

(3.3) with

j

and

summing

up the equations for j  J yields the following characterization of the aggregate trading speed

N i=1

X ti:

N NN
0 =  jvpj + g X ti jvrjj + g
j=1 i=1 j=1

N
X ti
i=1

NN
j X ivrji
j=1 i=1

N NN
=  j vpj + g X ti j vrjj + g
j=1 i=1 j=1

N
X ti
i=1

N
X i.
i=1

(3.4)

We further assume that K

N j=1

j

vrjj



1.

Again, this is true for risk neutral and CARA

investors, where j vrjj = 1. Due to Assumption 2.3, z  K · g(z) + z · g (z) is strictly increasing.

Hence, equation (3.4) admits a unique solution

N
X  X i

i=1

which depends on

N j=1

j

vpj

and

N j=1

j

vrjj

.

Plugging

the

solution X 

back

into

(3.3)

allows to

compute the expression

N i=1

X

ivrji

in

terms

of

X 

as

N
X ivrji = - i=1 g

1 X 

vpj + g(X )vrjj .

(3.5)

This expression is well dened since g > 0. To conclude, we have turned the family of individual

HJB-equations (3.2) into the following system of coupled PDEs for j = 1, ..., N :



  

0

=

vtj

+

1 2

2

vpjp

+



  

vj (T ,

p,

r)

=

uj

-rj + Hj(p)

X 

-

g(X ) g (X )

vpj

-

g(X )2 g (X )

vrjj

(3.6)

where the coupling stems from X , which is uniquely dened via (3.4). It will become clear in Section 4 that the state variable r is redundant for risk neutral and CARA investors. In these

cases, the value function is translation invariant (after a suitable transformation), which allows to
drop the variable r.

Remark 3.1. In a market without price impact ( = 0), manipulation is not benecial. To

see this, rst note that X  =

N i=1

X

i

=

0

is

the

unique

solution

to

(3.4).

From (3.5), we get

N i=1

X

ivrji

= 0.

On

the

other

hand,

we

have

from (3.1)

and

(3.2)

that vj(t, p, r) = V j(t, p, r) =

Etuj -rj + H j (PT ) , and in particular vrjj = 0 and vrji = 0 for i = j. This implies that 0 =

N i=1

X

ivrji

= X j vrjj

and

nal ly

X j

=0

for

each

j.

9

3.2 A priori equilibrium estimate

Solving the system (3.6) is delicate, to say the least. The problem is the non-linearity coming from

the expressions

g(X ) g (X )

and

g(X )2 g (X )

along with the implicit dependence of X 

on the derivatives vpi

and vri i , i  J . In Section 4, we show that a unique classical solution to the system (3.6) exists

for risk neutral and CARA investors. The proof uses the following a priori estimates for the

optimal trading strategies. It states that, if an equilibrium exists, then each player's trading speed

is bounded. In particular, there is no equilibrium with unbounded strategies. As a result, the

agents' utilities from trading and the value function associated with their respective HJB equations

along with (as we shall see) their derivatives are bounded.

Proposition 3.2. Let
X j satises

X 1, ..., X N be a Nash equilibrium for problem (2.4). Then each strategy

X tj

N 

max
i

Hpi

+1

,

where  is taken from Assumption 2.3.

Proof. Let j  J , h maxi Hpi  and A

(t, ) :

N i=1

X ti(t,

)



0

be the set where the

aggregate trading speed is nonnegative. Let us x the sum of the competitors' strategies X -j . On

the set A the best response X tj is bounded from above by K

 

(h

+

1).

Otherwise the truncated

strategy Ytj X tj  K 1A + X tj 1Ac would outperform X tj . To see this, let us compare the payos

associated with X j and Y j . We denote by PTY j and PTX j the stock price under the strategies Y j

and X j , respectively. The payo associated with Y j minus the payo associated with X j can be

estimated from below as

T
- Ytj g Ytj + X t-j dt + Hj(PTY j )
0 T
+ X tjg X tj + X t-j dt - Hj (PTX j )
0 T
 Ytj g X tj + X t-j - g Ytj + X t-j dt
0 T
+ X tj - Ytj g X tj + X t-j dt - (XTj - YTj) Hp  .
0

Note that X tj + X t-j  0 on A and thus g X tj + X t-j  0 due to Assumption 2.3. Furthermore, g X tj + X t-j - g Ytj + X t-j   X tj - Ytj , again by Assumption 2.3. The dierence in the
payos is therefore larger than

TT

Ytj X tj - Ytj dt - h

X tj - Ytj dt

00

= X tj>Ytj Ytj - h X tj - Ytj dt

10

On the set

X tj > Ytj

we

have

Ytj

=

K

=

 

(h

+

1)

and

the

above

expression

is

strictly

positive,

a contradiction. This shows that X tj is bounded above by K on the set A for each j  J . Still on

the set A, we get the following lower bound:

N
X tj = X ti +

-X ti  0 - (N - 1)K.

i=1 i=j

(3.7)

A symmetric argument on the set B

(t, ) :

N i=1

X ti(t,

)



0

completes the proof.

In the one player framework we can use a standard result from the theory of stochastic control
to show that (3.6) admits a unique solution. We say that a function  satises a polynomial growth condition if there are constants p, C > 0 such that |(x)|  C(1 + |x|p).
Proposition 3.3. Let N = 1. Let u  C 3 be such that u and u satisfy a polynomial growth
condition. Then the HJB-equation (3.2) admits a unique classical solution in C 1,2, which coincides with the value function V .
Proof. Due to the a priori estimates in Proposition 3.2, it is enough to choose the control X from a compact set. Thus, we can apply Theorem I V.4.3 in Fleming and Soner (1993), which yields that (3.2) admits a unique solution in C 1,2, which is of polynomial growth. It remains to apply the Verication Theorem I V.3.1 from Fleming and Soner (1993) to see that this solution coincides with the agent's value function V .

Under suitable smoothness conditions on the cost function the PDE system (3.6) always has
a bounded solution with bounded derivatives for small time steps; see Taylor (1997), Proposition
15.1.1. The challenge is to establish a global solution, i.e., a solution on the whole time interval
[0, T ]. The main diculty stems from the dependence of the players' optimal trading strategies on the derivative of the value function with respect to the trading costs. If the derivatives vrji are
constant, then our a priori estimate together with the boundedness assumptions on the payos
H j and the characterization (3.5) of the equilibrium aggregate trading speed guarantees that the
value function are bounded with bounded derivatives and hence that an equilibrium exists. This
argument will be made more precise in the following section.

4 Solution for Risk Neutral and CARA Investors
In this section we establish existence and uniqueness of equilibrium results for risk neutral and CARA investors. For risk neutral investors and linear cost functions the equilibrium strategies can be given in closed form; if spread crossing costs are involved a closed form solution is not available and we report numerical results instead.

11

4.1 Risk Neutral Agents
Let us assume that all players are risk neutral, i.e. uj (z) = z. In a rst step we prove existence of a unique solution to the system (3.6) for general cost functions g. Subsequently we construct an
explicit solution to (3.6) for the linear cost structure used in Almgren and Chriss (2001).

4.1.1 General Cost Structure

Let g be a general cost function which satises Assumption 2.3. In the risk neutral case the value function of player j turns into

TN

V j(t, p, r) = -rj + sup Et - X sjg

X si ds + Hj(PT )|Pt = p .

Xj X

t

i=1

In particular, Vrji = -1i=j and the optimal strategies do not depend on the trading costs. In other words, the state variable r is redundant and we omit it in this section. We write

V j(t, p) V j(t, p, 0),

and call this function value function, if there is no danger of confusion. The HJB-equation (3.2)

turns into

0

=

vtj

+

1 2

2vpjp

+

sup
cj R



cj + X -j

vpj - cjg

cj + X -j

where we have used Vrji = -1i=j . The optimal trading speed from (3.5) is given by

(4.1)

cj = X j = - 1 g X 

-vpj + g(X )

(4.2)

where the aggregate trading speed X  =

N i=1

X

j

is

the

unique

solution

to

N NN

0 =  vpi - N g

X ti -

X ti g

i=1 i=1 i=1

N
X ti
i=1

.

This is (3.4) with j = -1. The system of PDEs (3.6) therefore takes the form

(4.3)

0

=

vtj

+

1 2

2

vpjp

+



X 

-

g(X ) g (X )

vpj

+

g(X )2 g (X )

(4.4)

with terminal condition vj (T , p) = H j (p) for j  J . Systems of the form (4.4) appear naturally in
the theory of dierential games, but we did not nd a reference which covers this particular case. Theorem 1 of Friedman (1972) for instance is valid only on a bounded state space. However, in view of our a-priori estimates of Proposition 3.2 the proof follows from a general existence result for nonlinear systems of PDEs stated in Appendix A. The following theorem shows that a unique
solution exists if H j  Cb2, i.e. H j and its derivatives up to order 2 are bounded for each j.

12

Theorem 4.1. Let H  Cb2. Then the Cauchy problem (4.4) admits a unique classical solution
in C 1,2, which coincides with the vector of value functions.

An alternative way of solving the system (4.4) is the following: If we sum up the N equations,

we get a Cauchy problem for the aggregate value function v

N i=1

vi,

namely

0

=

vt

+

1 2

2vpp

+

X 

vp - g

X 

(4.5)

with terminal condition v(T , p) =

N i=1

H

i

(p).

Existence and uniqueness of a solution to this

one-dimensional problem can be shown using Theorem IV.8.1 in Ladyzenskaja, Solonnikov, and

Ural'ceva (1968). Once the solution is known, we can plug it back into (4.4) and get N decoupled

equations. This technique is applied in the following section where we construct an explicit solution

for linear cost functions.

4.1.2 Linear Cost Structure

For the particular choice g(z) = z ( > 0) used in Almgren and Chriss (2001) and Schied and
Schöneborn (2007), the solution to (4.4) can be given explicitly.
Corollary 4.2. Let g(z) = z. Then the solution of (4.4) can be given in closed form as the
solution to a nonhomogeneous heat equation.

Proof. The optimal trading speed from (4.2) and the aggregate trading speed from (4.3) are

X j

=

 

vpj

-

N

1 +

1

N

vpi

i=1

X  =

N

X i =



(N + 1)

N

vpi

=

 (N +

1) vp.

i=1 i=1

(4.6) (4.7)

Let us sum up the N equations from (4.4). This yields the following PDE for the aggregate value

function v =

N i=1

vi:

0

=

vt

+

1 2

2

vpp

+

2N (N + 1)2

vp2

(4.8)

with terminal condition v(T , p) =

N i=1

H

i(p).

This PDE is a variant of Burgers' equation, cf.

Rosencrans (1972). It allows for an explicit solution, which we cite in Lemma 4.3. With this

solution at hand, we can solve for each single investor's value function. We plug the solution v

back into the equations (4.6) and (4.7) for the trading speeds, and those into the PDE (4.4). This

yields

0

=

vtj

+

1 2

2vpjp

+

2 (N +

1)2 vp2

with terminal condition vj (T , p) = H j (p). This nonhomogeneous heat equation is solved by

vj(T - t, p) =

R

H j dN

(p,

t)

+

2 (N +

1)2

t 0

vp2(s, ·)dN (p, (t - s))
R

where v is given in Lemma 4.3 and N denotes the heat kernel.

13

In the preceding proof and in Corollary 4.5 we need the solution to a variant of Burgers' equation. We cite it in the following Lemma.
Lemma 4.3. Let A > 0, B = 0 and G : R  R be smooth and bounded. The PDE
0 = 2vt + Avpp + Bvp2

with terminal value

v(T, p) = G(p)

is solved by

A v(t, p) = log

B exp G Az

dN p , T - t

.

B RA

A

Proof. By means of a linear transformation we can reduce the problem to A = B = 1. This

particular case is solved in Rosencrans (1972).

4.1.3 Numerical Illustrations
In the risk neutral setting, we were able to reduce the system of PDEs from the multi-player setting to the one-dimensional PDE (4.8) for the aggregate value function. This can be interpreted as the value function of the representative agent. Such reduction to a representative agent is not always possible for more general utility functions. In the sequel we illustrate the optimal trading speed
X (t, p) and surplus of a representative agent as functions of time and spot prices for a European call option H (PT ) = (PT - K)+ and digital option H (PT ) = 1{PT K}, respectively.3 By surplus, we mean the dierence between the representative agent's optimal expected utility v(t, p) and the conditional expected payo Et[H (PT )|Pt = p] in the absence of any market impact. It represents
the expected net benet due to price manipulation.
We choose a linear cost function, strike K = 100, maturity T = 1, volatility  = 1 and liquidity parameters  =  = 0.01. We see from Figure 1 that for the case of a call option both the optimal
trading speed and the surplus increases with the spot; the latter also increases with the time to maturity. Furthermore, the increase in the trading speed is maximal when the option is at the money. For digital options the trading speed is highest for at the money options close to maturity as the trader tries to push the spot above the strike. If the spot is far away from the strike, the trading speed is very small as it is unlikely that the trader can push the spot above the strike before expiry.
3Note that the cost function in (4.9) is not smooth, and the Call and Digital options are not smooth and
bounded, so Theorem 4.1 does not apply directly. There are two ways to overcome this diculty: We could either
approximate g and H by smooth and bounded functions. Or we could interpret v not as a classical, but only as a
viscosity solution of (4.1), cf. Fleming and Soner (1993).

14

Trading Speed

Surplus

0.4
0.2
0.0 0.0

TIME 0.5.

110 105 100 SPOT 95
1.0 90

0.002
0.001
0.000 0.0

TIME 0.5.

110 105 100 SPOT 95
1.0 90

Figure 1: Trading speed and surplus for one risk neutral investor holding a European Call option.

Trading Speed

Surplus

0.4
0.2
0.0 0.0

TIME 0.5.

110 105 100 SPOT 95
1.0 90

0.0010
0.0005
0.0000 0.0

TIME 0.5.

110 105 100 SPOT 95
1.0 90

Figure 2: Trading speed and surplus for one risk neutral investor holding a Digital option.

15

Trading Speed at t 0
0.5
0.4
0.3
0.2
0.1
SPOT 98 100 102 104

0.0025 0.0020 0.0015 0.0010 0.0005

Surplus at t 0
SPOT 98 100 102 104

Figure 3: Trading speed and surplus for a risk neutral investor holding a European Call option for dierent spread sizes s = 0 (black), 0.001 (blue), 0.002 (red), 0.003 (green), 0.004 (brown). The higher the spread, the smaller the trading speed and the surplus.

Trading Speed at t 0
0.08
0.06
0.04
0.02
SPOT 98 100 102 104

0.0010 0.0008 0.0006 0.0004 0.0002

Surplus at t 0
SPOT 98 100 102 104

Figure 4: Trading speed and surplus for a risk neutral investor holding a Digital option for dierent spread sizes s = 0 (black), 0.001 (blue), 0.002 (red), 0.003 (green), 0.004 (brown). The higher the spread, the smaller the trading speed and the surplus.

16

Figures 3 and 4 illustrate that a high spread makes manipulation unattractive. It shows the
optimal trading speed and the surplus at time t = 0 for the Call and Digital option in the one
player framework. We used the cost function
g(z) = z + s · sign(z) for dierent spreads s  {0, 0.001, 0.002, 0.003, 0.004} (4.9)
with the remaining parameters as above. We see that the higher the spread, the smaller the trading speed and the surplus. This is intuitive as frequent trading, in particular, when the option is at the money, incurs high spread crossing costs. The same is true for xed transaction costs which also discourage frequent trading.

4.2 Risk Averse Agents

A second class which yields explicit results is those of exponential utility functions uj (z) = - exp -j z for j = 1, ..., N , where j > 0 is the risk aversion coecient. In this case the

value functions satisfy

V j(t, p, r) = exp jrj · V j(t, p, 0)

and thus Vrji = j V j 1i=j . We suppress the state variable r and write V j (t, p) V j (t, p, 0). As
above, we rst show existence and uniqueness of a solution for a general cost structure. In a second
step, we derive the closed form solution for the linear cost function in the single player framework.

4.2.1 General Cost Structure

The HJB-equation (3.2) turns into

0

=

vtj

+

1 2

2

vpjp

+

sup
cj R



cj + X -j

vpj + cjg

cj + X -j

j vj

(4.10)

with terminal condition vj (T , p) = - exp -j H j (p) . We apply the logarithmic transformation

v~j

-

1 j

log(-vj )

to

turn

the

HJB

equation

into

0

=

v~tj

+

1 2

2v~pjp

-

1 2j 2

v~pj 2 + sup 
cj R

cj + X -j

v~pj - cjg

cj + X -j

(4.11)

with terminal condition v~j (T , p) = H j (p). Note that this equation equals the HJB-equation (4.1)

in

the

risk

neutral

setting,

up

to

the

quadratic

term

-

1 2

2

j

v~pj

2 .

As in (4.2), the optimal

trading speeds are

cj = X j = - 1 g X 

-v~pj + g(X )

where the aggregate trading speed X  is the unique solution to

N NN

0 =  v~pi - N g

X ti -

X ti g

i=1 i=1 i=1

N
X ti
i=1

.

(4.12)

17

If we plug X  and X j back into (4.11), we get

0

=

v~tj

+

1 2

2v~pjp

-

1 2j 2

v~pj 2 + 

X 

-

g(X ) g (X )

v~pj

+

g(X )2 g (X )

.

(4.13)

We can show existence and uniqueness of a solution.
Theorem 4.4. Let Hj  Cb2 for each j  J . The Cauchy problem (4.11) admits a unique solution,
which coincides with the vector of value functions (up to an exponential transformation).
Proof. See appendix A.

4.2.2 Linear Cost Structure, Single Player

For the one player case with linear cost structure, we have an explicit solution:
Corollary 4.5. Let N = 1 and g(z) = z. Then the Cauchy problem (4.11) admits a unique
solution, which can be given in closed form.

Proof. The maximizer in (4.11) is

c

=

X

=

 2 v~p

and the Cauchy problem (4.13) turns into

0

=

v~t

+

1 2

2v~pp

+

2 - 1 2 4 2

v~p2

with terminal condition v~(T , p) = H (p). This is Burgers' equation. Its explicit solution is given
in Lemma 4.3.

4.2.3 Numerical Illustrations
Let us conclude this section with numerical illustrations. We simulated the system (4.10) for
two players. Figure 5 shows the aggregate optimal trading speed and the surpluses vj (0, p) - E uj (H (PT )) |P0 = p for time t = 0 and dierent spot prices p  [95, 105] for the European Call option H (PT ) = (PT - K )+; we assume that Player 1 (blue) is the option writer and Player 2 (red) the option issuer. We chose the strike K = 100, maturity T = 1, volatility  = 2 and liquidity parameters  =  = 0.01 and risk aversion parameters 1 = 0.01, 2 = 0.01 (solid), respectively, 1 = 0.001, 2 = 0.1 (dashed). Since Player 1 has a long position in the option, she
has an incentive to buy the underlying; for the same reason Players 2 has an incentive to sell it
(Panel (b)). Our simulations suggest that the dependence of the equilibrium trading speed on the
agents' risk aversion is weak (Panels (b) and (c)) and that overall the option issuer is slightly more
active than the option writer. Furthermore, we see from Panel (d) that the issuer benets more
from reducing her loss than the writer benets from increasing her gains. This eect is due to the
concavity of the utility function and increases with the risk aversion.

18

Value Function at t 0
0.95

Trading Speed at t 0
1.0

96 98 1.05

SPOT 102 104

0.5
96 98 0.5

SPOT 102 104

1.10 (a)

1.0 (b)

Cumulated Trading Speed at t 0

96 98 0.002 0.004 0.006 0.008 0.010 0.012 0.014

102 104

(c)

SPOT

Surplus at t 0

0.0010

0.0005

96 98

(d)

102

SPOT 104

Figure 5: Value function, trading speed, aggregate trading speed and surplus for the writer (blue) and issuer (red) of a European Call option when both agents are risk averse. The solid (dashed) curves display the case where issuer is about as (more) risk averse than the option writer.

19

5 How to Avoid Manipulation

In the absence of market impact, manipulation does not occur, as we saw in Remark 3.1. In this section, we use the closed form solutions for risk neutral agents derived in subsection 4.1.2 to
illustrate how an option issuer may prevent4 other market participants from trading against her
by using their impact on the dynamics of the underlying. Some of our observations were already made in Kumar and Seppi (1992) for Futures in a two period model and in Gallmeyer and Seppi (2000) for Call options in a three period binomial model. We start with the simplest case of a zero-sum game.

Corollary 5.1. Let all players be risk neutral with osetting payos

aggregate trading speed is

N i=1

X i



0.

N i=1

H

i

=

0.

Then the

Proof. Consider the PDE (4.5) for the aggregate value function with terminal condition zero and

the characterization (4.3) of the aggregate trading speed. X  =

N i=1

X i



0

and

v

=

N i=1

vi



0

is the unique solution to this coupled system.

In a zero-sum game, if all option traders are risk neutral and willing to move the market in their favor, their combined eect cancels. We note that this is no longer true for general utility functions, as illustrated in gure 5 for the CARA case.
In reality, some (or all) of the investors might not want to manipulate, e.g. for legal reasons5.
This is why we now look at the following asymmetric situation: The option issuer, Player 0,
does not trade the underlying; her competitor, Player 1, owns the payo H 1 = 0 and intends to move the stock price to her favor. In addition, there are N - 1 informed investors without option
endowment in the market. They are predators that may supply liquidity and thus reduce the rst player's market impact, cf. Carlin, Lobo, and Viswanathan (2007) and Schied and Schöneborn (2007). Note that Corollaries 5.3 and 5.2 are only valid for the linear cost function, as the proofs hinge on the closed form solution obtained in Corollary 4.2. The following result states that the aggregate trading speed is decreasing in the number of players. The more liquidity suppliers, the less market manipulation. If the number of players goes to innity, manipulation vanishes.

Corollary 5.2. Let g(z) = z. Let H1  Cb2 be nondecreasing and Hi = 0 for i = 2, ..., N . Then

the aggregate trading speed

N i=1

X ti

is

decreasing

in

N

and

N

lim
N 

X ti = 0.

i=1

Proof. See appendix B.
4Let us emphasize again that our results only apply to the practice of punching the close, i.e. manipulating the
stock price in order to increase a given option payo. There are other types of market manipulation not covered by our setup, such as market corners, short squeezes, the use of private information or false rumours. We refer the interested reader to Jarrow (1994) and Kyle and Viswanathan (2008).
5A discussion of legal issues is beyond the scope of this paper, but see the discussion in Kyle and Viswanathan
(2008)

20

cumulated Trading Speed at t 0
0.5

cumulated Trading Speed at t 0
0.20

0.4 0.15
0.3 0.10
0.2
0.05 0.1

SPOT 98 100 102 104
(a) Call

98 100 102 (b) Digital

SPOT 104

Figure 6: Aggregate trading speed X  at time t = 0 for N = 1 (black), 10 (blue), 100 (red) players each holding 1/N shares of a Call (left) and Digital (right) option with strike K = 100. The more agents, the less aggregate manipulation.

Let us modify the preceding setting a little. Again, Player 0 issues a product H and does not

intend to manipulate the underlying, while her competitors do. More precisely, assume that player

0 splits the product H into pieces and sells them to N risk neutral competitors, such that each of

them

gets

1 N

H

.

We

nd

that

their

aggregate

trading

speed

N i=1

X

i

is

decreasing

in

the

number

of competitors N . Consequently, the option issuer should sell her product to as many investors as

possible in order to avoid being outsmarted. We illustrate this result in gure 6, which shows the
aggregate trading speed at time t = 0 of N players each holding 1/N option shares.

Corollary

5.3.

Let g(z) = z.

Let H

 Cb2

be nondecreasing and H i =

1 N

H

for i = 1, ..., N .

Then the aggregate trading speed

N i=1

X ti

is

decreasing

in

N

and

N

lim
N 

X ti = 0.

i=1

Proof. See appendix B.

The preceding results indicate how an option issuer can prevent her competitors from manipulation. One strategy is public announcement of the transaction: the more informed liquidity suppliers on the market, the smaller the impact on the underlying. A second strategy is splitting the product into pieces - the more option writers, the less manipulation. Let us conclude this section with a surprisingly simple way to avoid manipulation: using options with physical settlement.
Corollary 5.4. Calls, Puts and Forwards with physical settlement do not induce stock price ma-
nipulation.

21

Proof. Consider a risk neutral agent who owns  > 0 Call options with physical settlement and strike K . As above, we denote by X her strategy in the underlying. At maturity, she exercises 0     of her Call options. The optimization problem is

sup E
X X,0

T
-X tP~tdt + (XT + )
0

PT

-

1 2 (XT

+

)

- K

where the rst term represents the expected trading costs in [0, T ], the second term describes the liquidation value of  + XT stock shares in [T , ) under innitely slow liquidation (cf. Almgren and Chriss (2001)) and K is the exercise price of  Call options. Using (2.1), (2.2) and X0 = 0,
it can be shown that this equals

sup E
X X,0

T 0

-X tg(X t)dt

+

P0

+

BT

-

1 2 2

-

K

.

The cost term

T 0

X tg(X t)dt

is

nonnegative,

so

the

optimal

trading

strategy

in

the

stock

is

clearly

X = 0. A similar argument holds true for Put options and Forward options with physical settle-

ment.

At rst glance, Corollary 5.4 might contradict Pirrong (2001, p.1). He states that replacement of delivery settlement of futures contracts with cash settlement is frequently proposed to reduce the frequency of market manipulation. While his notion of market manipulation refers to market corners and short squeezes (see also Garbade and Silber (1983)), Corollary 5.4 shows that this is not always true for manipulation strategies in the sense of punching the close. The heuristic argument is the following: It is not benecial to drive up the stock price at maturity if the option is settled physically and the investor needs to liquidate the stocks she receives at maturity. Any price increase is outweighed by subsequent liquidation and has no positive eect, but it is costly. This conrms a claim made in Kumar and Seppi (1992, p.1497), who argue that whether futures contracts with a `physical delivery' option [are] also susceptible to liquidity-driven manipulation [...] depends on whether `osetting' trades can be used to unwind a futures position with little price impact.

6 Conclusion
We investigated the strategic behavior of option holders in illiquid markets. If trading the underlying has a permanent impact on the stock price, the possession of derivatives with cash settlement may induce market manipulation. We showed the existence and uniqueness of optimal trading strategies in continuous time and for a general cost function; in the one player framework for general utility functions, and in the multi-player case for risk neutral as well as CARA investors. Moreover, we showed how market manipulation can be reduced.
Our work may be extended in several directions. Foremost, we derived our results under Assumption 2.7. This assumption is only satised in the single-player risk-neutral case where the expected costs of buying a portfolio over a nite time interval under market impact equals its
22

expected liquidation value under innitely slow liquidation and does not hold in general. The problem of dening a proper notion of liquidation value under strategic interaction is important but was not our focus and is left for future research. Furthermore, it would be interesting to consider American or path-dependent options, more sophisticated market impact models such as Obizhaeva and Wang (2005) that account for resilience eects and, thirdly, trading strategies which allow for jumps.

A An Existence Result

In this section, we prove Theorems 4.1 and 4.4 where the PDE (4.4) in the risk neutral setting
is a special case of the system (4.11) for risk averse agents, with j = 0 for each j. In order to

establish our existence and uniqueness of equilibrium result, we adopt the proof of Proposition
15.1.1 in Taylor (1997) to our framework. After time inversion from t to T - t both systems of

PDEs are of the form

vt = Lv + F (vp)

(A.1)

for v

v1, ..., vN , where L is the Laplace-operator

L

=

1 2

2

2 p2

and F = F 1, ..., F N is of the form

F

j

(vp)

=

-

1 2

2j

vpj 2 + 

X 

-

g(X ) g (X )

vpj

+

g(X )2 g (X )

.

Here X  = X (vp) is given implicitly by (4.3). The initial condition is v(0, p) = H(p) = H1, ..., HN .

(A.2)

We rewrite (A.1) in terms of an integral equation as
t
v(t) = etL + e(t-s)LF (vp(s))ds v(t).
0
and seek a xed point of the operator  on the following set of functions:
X = Cb1(R, RN ) v  C 1(R, RN ) | v, vp bounded

(A.3)

equipped with the norm

v
X

v  + vp  .

We set Y Cb. Note that X and Y are Banach spaces and the semi-group etL associated with the

Laplace operator is strongly continuous on X, sends Y on X and satises

etL L (Y,X)  Ct-

23

for some C > 0,  < 1 and t  1. Furthermore, the nonlinearity F is locally Lipschitz and belongs to C . Indeed, if we apply the implicit function theorem to X  given by (4.3), we see that the map a  X (a) is C  with rst derivative

 vp

X

(vp)

=

(N

+ 1)g

 (X (vp)) + X (vp)g

(X (vp))

where the denominator is positive due to Assumption 2.3. The cost function g is C  by assump-

tion. In particular, the assumptions of Proposition 15.1.1 in Taylor (1997) are satised.
Before we proceed, we need the following lemma. It states that the value function6 satises
V j  K for each j  J and some constant K , so it suces to construct a solution in the
X following set:
XK {v  X | v X  K} .
Lemma A.1. There is a constant K such that V j  K for each j  J . X

Proof. We proof the assertion for risk neutral agents, the CARA case follows by the same argu-
ments. Our a priori estimates of Proposition 3.2 yield that X j is bounded for each j  J . By the denition of V j (t, p) = V j (t, p, 0), we get that V j is bounded. Equation (3.5) implies that vpj is bounded, since vrji = -1i=j and X j as well as X  are bounded.

We are now ready to prove existence and uniqueness of a solution to (A.3). In a nutshell, the argument is the following: Using Proposition 15.1.1 in Taylor (1997), we construct a solution to
(A.1)-(A.2) for a small time horizon [0,  ], with  > 0 specied below. The vector v coincides with
the vector of value functions by Theorem IV.3.1 in Fleming and Soner (1993), so by Lemma A.1
the constructed solution is in XK . We apply his argument recursively to extend the solution to [0, T ].
Proposition A.2. There is  > 0 such that for each n  N0, the PDE (A.3) with initial condition
(A.2) admits a unique classical, bounded solution in XK on the time horizon [0, n  T ]. This
solution coincides with the value function.

Proof.

1. For n = 0, there is nothing to prove. Pick n  N such that n < T . By induction,

we can assume that there is a solution v(n)  XK on the time horizon [0, n ]. In particular,

the initial condition for the next recursion step h(n) v(n)(n ) is in XK .

2. Fix  > 0. We construct a short time solution on the following set of functions:

Z (n+1)

v  C ([n, (n + 1) ], X) | v(n ) = h(n), v(t) - h(n)   t  [n, (n + 1) ] .
X

We rst show that  : Z (n+1)  Z (n+1) is a contraction, if  > 0 is chosen small enough. For this, let 1 be small enough such that for t  1 and any v  XK we have

etLv - v



1 .

X2

6By value function, we mean the function V j (t, p) = V j (t, p, 0), where is state variable r is dropped.

24

Here we used that etL is a continuous semigroup and v X  K . In particular, for v = h(n):

etLh(n) - h(n)



1 .

X2

For v  Z (n+1), the derivative vp is uniformly bounded in the sense

vp  

h(n) +  
X

K + . Hence, we only evaluate F on compact sets. By assumption, F is locally Lipschitz.

In particular, F is Lipschitz on compact sets. In other words, there is a constant K1 such that for any v, w  Z(n+1) we have

This implies, for w = h(n)

F (vp) - F (wp) Y  K1

v-w
X

F (vp) Y 

F (hp(n)) + K1 v - h(n)
YX

 K + K1 K2.

This, together with the boundedness assumption on etL, yields

t
e(t-y)LF (vp(y))dy
n X

 

This

quantity

is



1 2



if

t



2

1

 2C K2

1-
.

Finally, it follows that for v  Z (n+1) we have

t

etL

sup
n yt

F (vp(y)) Y

t1- CK2.

v - h(n)

 etLh(n) - h(n) +

XX



11  +  = .

22

t
e(t-y)LF (vp(y))dy
n X

This shows that  maps Z (n+1) into itself. It remains to show that  is a contraction. Let v, w  Z (n+1). Then

t

v(t) - w(t) =
X

e(t-y)L [F (vp(y)) - F (wp(y))] dy
n X



t etL

sup
n yt

F (vp(y)) - F (wp(y))

Y



t1-CK2 sup
n yt

v(y) - w(y)

X

The

quantity

t1- CK2

is



1 2

if

t



3

in Z (n+1), if  is small in the sense

1

1 2C K2

1- . This proofs that

is a contraction

0 <  min{1, 2, 3}. Note that the time step  does not depend on n. It is the same in every recursion step.

25

3. It follows that  has a unique x point v in Z (n+1). In other words, we constructed a function v  C ([n, (n + 1) ], X) = C 0,1[n, (n + 1) ] which solves the PDE (A.3) with initial condition v(s) = h(n) = v(n)(n ) on the time interval [n, (n + 1) ].

This solution is actually in C 1,2 (n, (n + 1) ] × R, RN , due to Proposition 15.1.2 in Taylor

(1997). Furthermore, v is bounded by construction. Indeed,

v 

h(n) +   K + .
X

We dene the new solution as

v(n+1) v(n)1{0tn } + v1{n <t(n+1) }.

By construction, v(n+1) solves (A.3) on the time horizon [0, (n + 1) ] and is bounded and in

C 1,2. Hence, we can apply the Verication Theorem IV.3.1 from Fleming and Soner (1993),

which yields that v(n+1) coincides with the vector of value functions (up to time reversal,

reintroducing rj and an exponential transformation, if j > 0). Due to Lemma A.1 we

have v(n+1)  XK . In particular,

v(n+1)((n + 1) )  K, which is necessary for the next
X

recursion step.

This completes the proof.

B Proof of Corollary 5.2 and Corollary 5.3

The argument is the same for both corollaries. Fix N  N. The aggregate trading speed for N
players is given from equation (4.7) as

X  =

N

X i

=

 

N

1 +

1 vp,

i=1

where the aggregate value function v =

N i=1

vi

from

(4.8)

solves

Burgers'

equation

0

=

vt

+

1 2

2

vpp

+

2 

(N

N +

1)2

vp2

(B.1)

with terminal condition v(T , p) =

N i=1

H i (p)

=

H 1 (p)

trading speed for N + 1 players is

H (p). On the other hand, the aggregate

Y



=

N +1
Y

i

=

 

N

1 +

2 wp,

i=1

where the aggregate value function w =

N +1 i=1

wi

solves

0

=

wt

+

1 2

2

wpp

+

2 

N +1 (N + 2)2

wp2

with terminal condition w(T , p) = H (p). We have to show that X   Y . To this end, let us

dene w~

N +1 (N +2)2

(N +1)2 N

w.

It

is

enough to

show that

vp

 w~p,

since

then

1 N +1

vp



1 N +1

w~p

and,

by

denition,

1 N +1

w~p



1 N +2

wp.

This

implies

X 

 Y .

26

To show vp  w~p, rst note that w~ is chosen such that it satises the same PDE (B.1) as v,

namely

0

=

w~t

+

1 2

2

w~pp

+

2 

(N

N +

1)2

w~p2

(B.2)

with

a

smaller

terminal

condition:

w~(T, p) =

N +1 (N +2)2

(N +1)2 N

H (p)

(B.1) and (B.2) are given in Lemma 4.3 as

(1 - )H (p). The solutions to

v(t, p) = c1 log exp (c2H(c3z)) dN (c4p, T - t)
R

and
w~(t, p) = c1 log exp (c2(1 - )H(c3z)) dN (c4p, T - t)
R
with constants c1, c2, c3, c4  R and   (0, 1). To verify vp  w~p, it is enough to show

 log
p

exp (G)

dN

(p,

1)



 p

log

exp ((1 - )G) dN (p, 1)

for an increasing function G  Cb2. This is equivalent to

(z - p)eGdN eGdN



(z - p)e(1-)GdN e(1-)GdN

or

zeG

e(1-)GdN e(1-)GdN



e(1-)GdN z e(1-)GdN

eG

e(1-)GdN e(1-)GdN

or
covQ id, eG  0

under the measure Q with dQ

e(1-)G dN e(1-)G dN

.

The

covariance of two

increasing

functions

is surely

nonnegative. This nally proofs the assertion X   Y .

It remains to show limN 

N i=1

X ti

= 0.

We

have

X (t, p) =

N

X ti

=

 

N

1 +

1 vp(t, p)

i=1

  1 2(N + 1)2

= p  N + 1

22N

log

exp

22N 2(N + 1)2 H(z)

dN

p ,T

-

t



  1 2(N + 1)2

22N

p

= p  N + 1

22N

log

exp

2(N + 1)2 H

z + 

dN (0, T - t)



1

1

Hp

z

+

p 

exp

2

22N (N +1)2

H

z

+

p 

dN (0, T - t)

=,

N +1

exp

2

22 (N

N +1)2

H

z

+

p 

dN (0, T - t)

27

where we used Lemma 4.3 in the second line. This expression is nonnegative, since Hp  0. Furthermore, we have Hp  <  by assumption. It follows that

0

N

X ti



 

N

1 +

1

1 

Hp  N- 0.

i=1

This completes the proof.

C The system of HJB PDEs without Assumption 2.7

In this section, we illustrate that the optimization problem under consideration becomes rather intractable without Assumption 2.7. In this case, problem (2.4) takes the form

sup E uj
Xj X

T
- X tj
0

Pt + g

N
X ti
i=1

dt + Hj(PT ) + LV j(XTj ) ,

where the rst term captures the trading costs (fundamental price plus liquidity costs) in [0, T ], the second term represents the option payo and the third term the liquidation value of XTj stock
shares at maturity. The dynamics of the state variables are

N



  

dPt

= dBt + 



X tidt,

  

i=1



P0 = p0

N

 

dRtj

=

X tj

Pt + g

X ti dt,

R0j = 0



 

i=1



  

dXtj

=

X tjdt,

X0j = 0.

The associated HJB equation for agent j  J is

0

=vtj

+

1 2

2vpjp

+

sup
cj R

(cj + X -j )vpj + cj vxjj +



+ X ivxji + cj p + g(cj + X -j) vrjj + X i p + g(cj + X -j) vrji  i=j i=j 

(C.1)

with terminal condition vj (T , p, r, x) = uj -rj + Hj (p) + LV j (xj ) . As above X -j = i=j X i
denotes the opponents' aggregate trading speed. In this general formulation it is not clear that the a priori estimates from Proposition 3.2 hold. Moreover, the PDE (C.1) is not uniformly parabolic, so the proof of Theorems 4.1 and 4.4 given in Appendix A is not valid. In particular, we cannot apply Proposition 15.1.2 of Taylor (1997).

References
Alfonsi, A., A. Fruth, and A. Schied (2010). Optimal execution strategies in limit order books with general shape functions. Quantitative Finance 10 (2), 143157.
28

Allen, F. and D. Gale (1992). Stock-price manipulation. Review of Financial Studies 5, 503529. Almgren, R. and N. Chriss (2001). Optimal execution of portfolio transactions. Journal of
Risk 3, 539. Back, K. (1992). Insider trading in continuous time. Review of Financial Studies 5, 387410. Back, K., H. Cao, and G. Willard (2000). Imperfect competition among informed traders.
Journal of Finance 55, 21172155. Brunnermeier, M. and L. Pedersen (2005). Predatory trading. Journal of Finance 60 (4), 1825
1863. Carlin, B. I., M. S. Lobo, and S. Viswanathan (2007). Episodic liquidity crises: Cooperative
and predatory trading. Journal of Finance 65 (5), 22352274. Çetin, U., R. Jarrow, and P. Protter (2004). Liquidity risk and arbitrage pricing theory. Finance
and Stochastics 8 (3), 311341. Chau, M. and D. Vayanos (2008). Strong-form eciency with monopolistic insiders. Review of
Financial Studies 21, 22752306. Dutt, H. R. and L. E. Harris (2005). Position limits for cash-settled derivative contracts. Journal
of Futures Markets 25 (10), 945965. Fleming, W. H. and H. M. Soner (1993). Controlled Markov Processes and Viscosity Solutions.
Springer Verlag, New York. Foster, F. D. and S. Viswanathan (1996). Strategic trading with when agents forecast the
forecasts of others. Journal of Finance 51, 14371478. Friedman, A. (1972). Stochastic dierential games. Journal of Dierential Equations 11, 79108. Gallmeyer, M. and D. Seppi (2000). Derivative security induced price manipulation. Working
paper, Carnegie Mellon University. Garbade, K. and W. Silber (1983). Cash settlement of futures contracts: An economic analysis.
Journal of Futures Markets 3, 451472. Guo, X. and H. Pham (2005). Optimal partially reversible investment with entry decision and
general production function. Stochastic Processes and Applications 115, 705736. Huberman, G. and W. Stanzl (2004). Price manipulation and quasi-arbitrage. Economet-
rica 72 (4), 12471275. Jarrow, R. (1994). Derivative security markets, market manipulation, and option pricing theory.
Journal of Financial and Quantitative Analysis 29 (2), 241261. Kraft, H. and C. Kühn (2009, October). Large traders and illiquid options: Hedging vs. manip-
ulation. Working Paper. Kumar, P. and D. Seppi (1992). Futures manipulation with cash settlement. Journal of Fi-
nance 47 (4), 14851502.
29

Kyle, A. and S. Viswanathan (2008). How to dene illegal price manipulation. American Economic Review 98, 274279.
Kyle, A. S. (1985). Continuous auctions and insider trading. Econometrica 53 (6), 13151335. Ladyzenskaja, O. A., V. A. Solonnikov, and N. N. Ural'ceva (1968). Linear and Quasi-linear
Equations of Parabolic Type. American Mathematical Society. Ly Vath, V., M. Mnif, and H. Pham (2007). A model of optimal portfolio selection under
liquidity risk and price impact. Finance and Stochastics 11, 5190. Obizhaeva, A. and J. Wang (2005). Optimal trading strategy and supply/demand dynamics.
Journal of Financial Markets . revised and resubmitted. Pirrong, C. (2001). Manipulation of cash-settled futures contracts. Journal of Business 74 (2),
221244. Rogers, L. C. G. and S. Singh (2008). The cost of illiquidity and its eects on hedging. to appear
in Mathematical Finance . Rosencrans, S. (1972). Derivation of the hopf-cole solution to burgers' equation by stochastic
integrals. Proc. Amer. Math. Soc 32, 147149. Schied, A. and T. Schöneborn (2007). Liquidation in the face of adversity: Stealth vs. sunshine
trading, predatory trading vs. liquidity provision. Working paper. Schied, A. and T. Schöneborn (2008). Risk aversion and the dynamics of optimal liquidation
strategies in illiquid markets. Finance and Stochastics 13 (2), 181204. Schönbucher, P. and P. Wilmott (2000). The feedback eect of hedging in illiquid markets.
SIAM Journal of Applied Mathematics 61, 232272. Taylor, M. E. (1997). Partial Dierential Equations. III. Nonlinear Equations. Springer Verlag,
New York. Vanden, J. M. (2005). Digital contracts and price manipulation. Journal of Business 78 (5),
18911916.
30

SFB 649 Discussion Paper Series 2010
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Volatility Investing with Variance Swaps" by Wolfgang Karl Härdle and Elena Silyakova, January 2010.
002 "Partial Linear Quantile Regression and Bootstrap Confidence Bands" by Wolfgang Karl Härdle, Ya'acov Ritov and Song Song, January 2010.
003 "Uniform confidence bands for pricing kernels" by Wolfgang Karl Härdle, Yarema Okhrin and Weining Wang, January 2010.
004 "Bayesian Inference in a Stochastic Volatility Nelson-Siegel Model" by Nikolaus Hautsch and Fuyu Yang, January 2010.
005 "The Impact of Macroeconomic News on Quote Adjustments, Noise, and Informational Volatility" by Nikolaus Hautsch, Dieter Hess and David Veredas, January 2010.
006 "Bayesian Estimation and Model Selection in the Generalised Stochastic Unit Root Model" by Fuyu Yang and Roberto Leon-Gonzalez, January 2010.
007 "Two-sided Certification: The market for Rating Agencies" by Erik R. Fasten and Dirk Hofmann, January 2010.
008 "Characterising Equilibrium Selection in Global Games with Strategic Complementarities" by Christian Basteck, Tijmen R. Daniels and Frank Heinemann, January 2010.
009 "Predicting extreme VaR: Nonparametric quantile regression with refinements from extreme value theory" by Julia Schaumburg, February 2010.
010 "On Securitization, Market Completion and Equilibrium Risk Transfer" by Ulrich Horst, Traian A. Pirvu and Gonçalo Dos Reis, February 2010.
011 "Illiquidity and Derivative Valuation" by Ulrich Horst and Felix Naujokat, February 2010.

