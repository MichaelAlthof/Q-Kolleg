BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2013-028
Analysis of Deviance in Generalized Partial Linear Models
Wolfgang Karl Härdle* Li-Shan Huang**
* Humboldt-Universität zu Berlin, Germany ** National Tsing Hua University, Taiwan
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

Analysis of Deviance in Generalized Partial Linear Models
Wolfgang Karl Ha¨rdle Center for Applied Statistics & Economics, Humboldt University, Berlin, GERMANY
and School of Business, Singapore Management University, SINGAPORE haerdle@wiwi.hu-berlin.de AND Li-Shan Huang1
Institute of Statistics, National Tsing Hua University, TAIWAN Lhuang@stat.nthu.edu.tw May 20, 2013
Abstract We develop analysis of deviance tools for generalized partial linear models based on local polynomial fitting. Assuming a canonical link, we propose expressions for both local and global analysis of deviance, which admit an additivity property that reduces to ANOVA decompositions in the Gaussian case. Chi-square tests based on integrated likelihood functions are proposed to formally test whether the nonparametric term is significant. Simulation results are shown to illustrate the proposed chi-square tests. The methodology is applied to German Bundesbank Federal Reserve data.
Keywords: ANOVA decomposition, Integrated likelihood, Link function, Local polynomial AMS 2000 subject classifications: Primary 62G08; secondary 62J12 JEL classification: C00, C14, C50, C58
acknowledgment: The work was conceived during the visit of the first author to the Humboldt University supported by CRC 649 "Economic Risk." The support is greatly appreciated. The first author was partially supported by National Science Council (NSC 101-2118-M-007-002-MY2) in Taiwan and both authors were partially supported by CRC 649 "Economic Risk."
1Corresponding author, address: No.101 Kuang-Fu Road, Section 2, Hsinchu City, TAIWAN 30013.
1

1 Introduction
Generalized linear models (GLMs) (McCullagh and Nelder, 1989) are a large class of statistical models for relating a response variable to linear combinations of predictor variables. The models allow the data to follow some probability distributions other than the Gaussian distribution in linear models, such as the Binomial and Poisson, etc. For example, logistic regression under the Binomial assumption is a subclass of GLMs and is commonly used to model the probability of events given a linear function of the explanatory variables. An example that we address in this paper is the probability of default (PD) for corporate bankruptcy prediction, known as rating or scoring, to estimate the financial situation of a company and the probability that a company defaults on its obligations within a certain period. A major disadvantage of this approach is that the prespecified linear form of predictors is too restrictive. Companies that grow too fast or too slow tend to have a higher probability of default and hence models allowing for nonlinear effects may be more appropriate.
Generalized partial linear models (GPLMs) (Green and Silverman, 1994; Carroll et al., 1997; Ha¨rdle et al., 2004) allow for a nonparametric component for a continuous covariate while retaining the ease of linear relationships for the remaining variables. It is more flexible than parametric GLMs and simpler than generalized additive models (GAMs) (Hastie and Tibshirani, 1990) which include multiple nonparametric components. In applying GPLMs to, e.g. PD data, inference tools to examine whether the nonparametric term is significant are of interest. Though Hastie and Tibshirani (1990) briefly discussed Analysis of Deviance (ANODev) for GPLMs, they note that "the distribution theory, however, is undeveloped" and "informal deviance tests with some heuristic justification" are adopted. Ha¨rdle et al. (1998) introduced a test statistic for testing linearity in GPLMs with an asymptotically normal distribution. Li and Liang (2008) address assessing significance of the nonparametric term for the GPLMs in the local polynomial settings by extending generalized likelihood ratio tests (Fan et al., 2001), which have asymptotic chi-square distributions. We note that testing in the GPLMs is relatively less developed as compared to the special case of partial linear models (PLMs) under Gaussian distributions (H¨ardle et al., 2004). Hence, there is a need for developing inference tools for applications of GPLMs, such as the PD data.
Based on the local polynomial approach (Fan and Gijbels, 1996) and assuming a canonical
2

link in GPLMs, we propose local and global expressions for ANODev, with the latter obtained by integrating the corresponding local likelihood quantities. This mimics the "integrated likelihood" approach discussed by Severini (2007) and Lehmann (2006). Though the idea of local likelihood for GLMs has been around for some time (Hastie and Tibshirani, 1987; Loader, 1999), to our knowledge, we are not aware of using the integrated likelihood approach to combine the information of local likelihood in the smoothing literature. In the case of the Gaussian distribution with an identity link, the proposed local and global ANODev becomes local and global analysis of variance (ANOVA) (Huang and Davidson, 2010) for PLMs and F -tests were justified between nested models, similar to classical ANOVA in linear models. Based on the proposed global ANODev, integrated likelihood ratio tests with asymptotic chisquare distributions are proposed for checking whether the nonparametric term is significant. Our work extends the classical ANODev for GLMs to GPLMs with theoretical justifications.
The organization of this paper is as follows. In Section 2, utilizing the ANODev for nested hypotheses in parametric GLMs by Simon (1973), we propose local and global ANODev for nonparametric GLMs in Theorem 1 for the simpler case with the nonparametric term as the only predictor. By combining local likelihood through integration, as a by-product, new estimators for the canonical parameter and response mean are given in equation (11), and Theorem 2 shows that the integrated likelihood quantities are asymptotically global likelihood quantities with the new estimator. Theorem 3 proposes a chi-square test based on integrated likelihood functions for testing whether the nonparametric term is significant. Section 3 presents an extension of Theorems 1-3 to Theorems 4 and 5 for GPLMs. In Section 4, we illustrate the potential usefulness of the new tests with simulation data and Section 5 applies the methodology to 2002 German Bundesbank Federal Reserve data.

2 Nonparametric Analysis of Deviance

Let (x1, y1), . . . , (xn, yn) be independent data pairs with the conditional density of Y given X = x from a one-parameter exponential family:

y - b()

L(y; ) = exp

+ c(y, ) ,

a()

(1)

3

where  is the canonical parameter, a(·) > 0, b(·) and c(·) are known functions, and  is

known or a nuisance parameter. We first briefly review parametric GLMs from McCullagh

and Nelder (1989), in which a transformation G(·) of µ(x) = E(Y |X = x) is modeled

parametrically via, e.g., a linear function, G{µ(x)} = b0 + b1x, and G(·) is called the "link" function. If G(·) = (b )-1(·), then G is the canonical link function that links  to the linear

predictor since b {(·)} = µ(·). Without loss of generality, we assume that G is the canonical

link function throughout the paper. Let (y, ) = log L(y, ), ^ denote the fitted value of  with corresponding y^, and ~ when

the fitted value equals to the observed y. The deviance D for a fitted parametric GLM is

defined as

D(y, y^) = 2 {yi(~i - ^i) - b(~i) + b(^i)},
i

(2)

where y = (y1, . . . , yn) and y^ = (y^1, . . . , y^n) . In the Gaussian case, G is the identity link

and D = i(yi - y^i)2. Hence the deviance quantity (2) in GLMs is analogous to the sum of

squares (SS) of residuals in linear models. Let  = (1, . . . , n) . Let us now turn to testing

hypotheses about . Assume that D1 = inf1 D and D2 the deviance for   2 with 2  1. In GLMs, ANODev usually refers to comparing two nested models and inference

may be based on the difference D2 - D1, which is simply the log likelihood ratio statistic

with an asymptotic 2 distribution. In the Gaussian case, ANODev becomes a comparison

of two residual SS. Note that the conventional ANODev is generally not parallel to ANOVA

in linear models, in the sense that ANODev does not have a complete set of SS quantities

(SS total = SS regression+ SS residuals).

An attempt to mimic ANOVA can be based on the Kullback-Leibler (KL) divergence of

two probability distributions with means µ1 and µ2:

KL(µ1, µ2) = 2Eµ1 {y, G-1(µ1)} - {y, G-1(µ2)} ,

(3)

where µ1 and µ2 are treated as fixed values and Eµ1 is expectation with respect to y when µ = µ1. For GLMs, Simon (1973) showed that for nested hypotheses 2  1  Rn with Rn corresponding to the parameter space with an exact fit of ~i and  parameterized linearly

in 1 and 2,

KL(y, µ2) = KL(y, µ1) + KL(µ1, µ2)

(4)

4

when plugging in the values of maximum likelihood (ML) estimates for µ1 and µ2. It is easy to see that (4) reduces to the ANOVA decomposition in linear models when µ1 and µ2 correspond to the linear or polynomial fit and the intercept-only model respectively, and the terms in (4) becomes SS total, SS residual, and SS regression respectively.
A linear or polynomial function of x may be restrictive and one may replace the linear dependence by a nonparametric function:

G{µ(x)} = m(x).

(5)

Fan et al. (1995) discussed estimating m(·) by maximizing a locally weighted likelihood
with a local polynomial approximation. Based on a Taylor's expansion at x, i  0 + 1(xi - x) + · · · + p(xi - x)p d=ef i(x). This local polynomial approximation is plugged in the locally weighted log-likelihood x(y, x) d=ef i {yi, i(x)}Kh(xi - x), where x = (1(x), . . . , n(x)) , and ^ = (^0, . . . , ^p) maximizing x(y, x) is solved. From the Taylor's expansion, j!^j estimates m(j)(x), j = 0, . . . , p, which is (j)(x) with the canonical link. Fan et al. (1995) derived asymptotic properties of ^j(x)'s and adopted G-1{^0(x)} as an
estimate for µ(x).
We will derive a local ANODev by adapting (4) for locally weighted likelihood. Define ^i(x) = ^0 + · · · + ^p(xi - x)p, an estimate of i at x, ^x = (^1(x), . . . , ^n(x)) , µ^x(xi) = G-1{^i(x)}, and µ^ x = (µ^x(x1), . . . , µ^x(xn)) . As the ^j's maximize x(y, x), the following equations hold:

yi(xi - x)jKh(xi - x) =
i
yi^i(x)Kh(xi - x) =
i

µ^x(xi)(xi - x)jKh(xi - x),
i
µ^x(xi)^i(x)Kh(xi - x).
i

j = 0, . . . , p, (6)

The last equation indicates that (y - µ^ x) is orthogonal to ^x in the locally weighted inner product space with weights Kh(xi - x). Hence the fact of residuals being orthogonal to fitted values in ordinary linear models now becomes the fact of local residuals (y - µ^ x) being orthogonal to locally fitted canonical parameters ^x. For x(y, ^x), an expression mimicking
(2) for local deviance at x is therefore:

dx(y, µ^ x) = 2{ x(y, ~) - x(y, ^x)} = 2 [yi{~i - ^i(x)} - b(~i) + b(^i(x))]Kh(xi - x). (7)
i

5

Though (7) is a natural definition from local likelihood, we are not aware of a similar quantity to (7) in the literature. Published works focused on global deviance by taking (2) with G-1{^0(xi)} as estimates. In comparison, the local deviance (7) makes use of all coefficients ^0, . . . , ^p and may be more sensible. Then (4) is adapted to form a local ANODev, and a global ANODev may be obtained by integrating local counterparts, as given in the following Theorem.

Theorem 1 (a) A local ANODev is

dx(y, y¯) = dx(y, µ^ x) + dx(µ^ x, y¯),

(8)

where y¯ is the sample mean of y, dx(y, y¯) is (7) with µ^ x and ^x replaced by y¯ and G(y¯) respectively, and

dx(µ^ x, y¯)  2Eµ^ x x(y, ^x) - x{y, G-1(y¯)} = 2 x(y, ^x) - x{y, G-1(y¯)} ,
with the last expression holds based on (6). (b) A global ANODev is obtained by integrating the counterparts in (8):

(9)

dx(y, y¯)dx = dx(y, µ^ x)dx + dx(µ^ x, y¯)dx,

(10)

and dx(y, y¯)dx = KL(y, y¯) = D(y, y¯) under a boundary condition that the weights Kh(xi - x)dx = 1 for all xi's.

It is easy to show (8) due to (9) and hence the proof is omitted. Alternatively the proof in Simon (1973) for (4) can be adapted with kernel weights to show (8). Note that the local ANODev (8) holds in finite-sample cases for local polynomial estimates, similar to (4). For the Normal distribution with an identity link, (8) and (10) become the local and global ANOVA decompositions respectively in Huang and Chen (2008). They demonstrate that it is necessary to utilize all coefficients ^j, j = 0, . . . , p, for the ANOVA decompositions to hold. Similarly, (8) and (10) hold with ^i(x) and µ^x(xi) based on the whole polynomial estimate, while most work in the literature focused only on ^0.
As a by-product, the above derivations give rise to new estimators for i's and µi's:

i = ^i(x)Kh(xi - x)dx and µi = G-1(i).

(11)

6

They are different from local estimates at xi: ^0(xi) and G-1{^0(xi)}. The asymptotic properties of i and µi for interior points xi with p = 1 and 3 are discussed in the following Remark. Remark 1: Suppose that conditions (A1)-(A4) in the Appendix hold. Assume that h  0 and nh3   as n  . We first define the "interior" and "boundary" points. For a kernel function defined on [-1, 1], if the support of xi's is [a, b], then define the interior region as [a + 2h, b - 2h]. See Huang and Chan (2013) for discussion on why the interior is not the conventional [a + h, b - h]. Then for interior points xi with p = 1 and 3, (a) the order of the asymptotic bias of i is smaller than the conventional order h(p+1); i.e., the h(p+1) term of the bias of i is zero; (b) the asymptotic variance of i is of order n-1h-1; (c) the asymptotic behavior of µi is analogous to i: the order of the bias is smaller than the conventional order h(p+1) and the asymptotic variance of µi is of order n-1h-1. See the Appendix for an outline of proofs. In the Gaussian case with an identity link, Huang and Chan (2013) show that the bias of i for interior points is of order h2(p+1) for p = 0, 1, 2, 3, which is consistent with intuition that the higher the p, the smaller the order of the bias. Since the second-order expansions of the bias of ^j(x) for GLMs have not been addressed in the literature, we choose not to derive explicit bias expressions of i in this paper. We thus focus on ANODev, while the issue of estimation may be studied in a future paper.
The following theorem concerns the asymptotic properties of integrated local likelihood x(y, ^x)dx.
Theorem 2 Suppose that conditions (A1)-(A4) in the Appendix hold. Assume that h  0 and nh3   as n  . For p = 1 and 3, (a) the integrated likelihood function is asymptotically

x(y, ^x)dx = (y, ) + O(h(p+1)),
where  = (1, . . . , n) with elements defined in (11); (b) the integrated deviance quantities are asymptotically

(12)

dx(y, µ^ x)dx = KL(y, µ) + O(h(p+1)) and

dx(µ^ x, y¯)dx = KL(µ, y¯) + O(h(p+1)),

(13)

where µ = (µ1, . . . , µn ) with elements defined in (11).

7

The proof for Theorem 2 is given in the Appendix. The term x(y, ^x)dx in (12) is a weighted integral of local likelihood with fitted local polynomials. In the literature, the idea of integrated likelihood was mentioned in Lehmann (2006), and Severini (2007) discussed integrated likelihood functions to eliminate nuisance parameters in parametric settings. To our knowledge, (12) has never been raised in the nonparametric regression literature, since the convention was to plug in ^0(xi) in (1) for i as an estimated likelihood function which ignores ^1, . . . , ^p. Theorem 2(b) together with Theorem 1(b) implies that
KL(y, y¯) = KL(y, µ) + KL(µ, y¯) + O(h(p+1)),

which shows that the classical ANODev holds asymptotically in the local polynomial settings with µ, and hence (10) is more suitable for a global ANODev as it holds in finite-sample cases. Based on integrated local likelihood, we next develop a chi-square test for examining significance of a nonparametric fit.

Theorem 3 Under the conditions of Theorem 2, for testing H0 : m(x) = a0 with a0 a

constant, versus Ha : m(x) is nonlinear and estimated by p-th order local polynomials with

p  0, the test statistic

2 x(y, ^x)dx - (y, a^0)

(14)

is asymptotically distributed according to a 2-distribution with a degree of freedom tr(Hp)-1, where a^0 is the ML estimate under H0 and Hp is the smoothing matrix for local p-th order polynomial regression defined in Huang and Chen (2008).

More explicitly, Hp depending only on xi's, bandwidth h, and the kernel function K(·), is

Hp = W Xp(Xp W Xp)-1Xp W dx,

(15)

where W is an n-dimensional diagonal matrix with Kh(xi - x) as its diagonal elements, and Xp is the n × (p + 1) design matrix with the (j + 1)-th column ((x1 - x)j, . . . , (xn - x)j) , j = 0, . . . , p. The dependence of W and Xp on x is suppressed and the integration in (15) is performed element by element in the resulting matrix product. Huang and Chan (2013) discuss various properties of Hp, including being symmetric and shrinking.

8

3 Analysis of Deviance for Partial Linear Models

We extend the nonparametric ANODev in Section 2 to GPLMs by allowing

G(µ) = z  + m(x),

(16)

where z is a K-dimensional covariate vector. Without loss of generality, the intercept is

embedded in m(·). When y is Gaussian, PLMs are a popular class of semiparametric models,

combining advantages of both linear and nonparametric regression. Huang and Davidson

(2010) discussed ANOVA for PLMs and provided explicit expressions of the ANOVA SS

quantities based on local polynomial regression. They showed that the SS residuals under

PLMs can be decomposed into non- and parametric parts and subsequently developed F -

tests using the differences in SS, similar to classical F -tests.

For GPLMs (16), if  is known or given, then the ANODev inference in Section 2 can

be extended straightforwardly. A local and a global ANODev can be constructed as (8)
and (10) with µ^^x(xi) = G-1{^^i(x)}, where ^^i(x) = zi  + ^^0 + · · · + ^^p(xi - x)p with local estimates ^^j's under (16). To avoid confusion with the notation in Section 2, from now on µ^^x(xi), ^^i(x), ^^x, µ^^ x, µ, and  denote the estimates under GPLMs (16). When  is

unknown, estimation of  can be done via a two-step ML procedure that updates the linear
and nonparametric estimates iteratively, as discussed in Carroll et al. (1997). Since ^^j's maximize the local likelihood, the equations in (6) continue to hold with ^^x and µ^^ x under (16). The interpretation that (y - µ^^ x) is orthogonal to ^^x in the locally weighted inner

product space with weights Kh(xi - x) continues to hold under GPLMs. For estimating ,

ML yields

yizik = zik µ^^x(xi)Kh(xi - x)dx,

k = 1, . . . , K,

ii

where zik denotes the value of the k-th covariate for the i-th observation.

(17)

Theorems 1 and 2 are extended to GPLMs in the following as Theorem 4(a) and 4(b)

respectively with µ^^x and µ when  is estimated by ML.

Theorem 4 (a) The local and global ANODev (8) and (10) respectively hold for GPLMs with µ^^x(xi) and µ^^ x when  is estimated by ML. (b) Under the conditions in Theorem 2 and Condition (A5) in the Appendix, assume that
 is estimated with a root-n rate by ML. For p = 1 or 3, the expression in (12) holds

9

with ^^x and  except the O(hp+1) term replaced by O(hp+1 + n-1/2). Similarly, (13) holds for GPLM with µ^^x and µ and the O(hp+1) terms replaced by O(hp+1 + n-1/2). Moreover
µ^^x(xi)Kh(xi - x)dx = µi  + O(hp+1 + n-1/2) and (y - µ) is asymptotically orthogonal to the column space spanned by z from (17).

(c) When the same kernel function and bandwidth are used in (5) and (16), the nonparametric

model (5) is nested in (16). Then the local residual deviance from fitting (16) when p  0

can be expressed as

dx(y, µ^^ x) = dx(y, µ^ x) - dx(µ^^ x, µ^ x).

(18)

The proof of Theorem 4(b) is analogous to Theorem 2 and is thus omitted. We briefly outline
the proof for Theorem 4(c). Based on (6) under GPLMs, we have i yi(xi - x)jKh(xi - x) = i µ^^x(xi)(xi - x)jKh(xi - x), j = 0, . . . , p. Then multiplying the j-th equation by ^j and
summing them up, i{yi - µ^^x(Xi))}^i(x)Kh(Xi - x) = 0 is obtained and (18) is proved.
Theorem 4(c) implies that the local residual deviance for a GPLM is the deviance for

fitting the nonparametric (5) minus a term due to the parametric component. That is, the

reduction of local deviance after adding the parametric component can be expressed explic-

itly. A similar interpretation holds at a global scale after integrating the local counterparts

of (18):

dx(y, µ^^ x)dx = dx(y, µ^ x)dx - dx(µ^^ x, µ^ x)dx.

(19)

Analogous to Theorem 3, testing whether m(·) is significantly different from a constant

may be based on the ratio of integrated local likelihoods.

Theorem 5 Under model (16), assume that Conditions (A) in the Appendix hold and the data matrix Z for covariates z is orthogonal to x = (x1, . . . , xn) and the intercept column. For testing H0 : m(x) = a0 with a0 a constant, versus Ha : m(x) is nonlinear and estimated by p-th order local polynomials with p  0, the test statistic

2 x(y, ^^x)dx - (y, ^ 0)

(20)

is asymptotically distributed according to a 2-distribution with degrees of freedom tr(Hp)-1, where ^ 0 = (a^0, ^ ) with a^0 and ^ the ML estimates under H0.

The assumption that Z is orthogonal to x in Theorem 5 is required, in the sense that the corresponding off-digonal elements of the local Fisher information is 0, for convenience

10

of deriving the asymptotic 2-distribution of the test statistic (20). The proposed tests in Theorems 3 and 5 will depend on the bandwidth h, like the other nonparametric tests. We remark that the proposed tests are different from those in Hastie and Tibshirani (1990). The proposed test statistics utilize integrated likelihood that combines all maximized local likelihoods with fitted local polynomials, while the existing methods use only G-1(^0)'s and the resulting expression is not based on maximized likelihood as ^1, . . . , ^p are ignored.
Some work in the literature, e.g. Ha¨rdle et al. (1998), has considered testing whether the estimate of m in (16) is significantly different from a linear trend, G(µ) = z  + a0 + a1x. However, the extension of Theorem 5 to testing a linear trend is non-trivial due to the fact that the variance function of y is allowed to be a function of the mean of y in GPLMs, which complicates the integrated likelihood term in (20). When the variance function of y is a constant, such as in classical linear models with the Gaussian assumption, an ANOVA-based F -type test is derived in Huang and Su (2009).

4 Simulation Results

We examine the empirical type-I error and power for the integrated likelihood ratio tests

in Theorems 3 and 5. The simulation study focuses on logistic regression as we want to

evaluate the proposed methods in order to analyze the German Bundesbank data. The

sample size is n = 200 and 500 simulated data sets are generated. Local linear smoothing

with the Epanechnikov kernel is used throughout this section. Critical values are taken from

the 2-distribution with 5% significance level.

Example 1:

logit(p) = -1.0 + ax2,

where a =0, -1, -1.5, -2, and x  U (0, 1). The values of bandwidth h =0.1, 0.15, 0.2, and 0.25 are used, which results in an average degrees of freedom 11.08, 7.69, 6.00, and 4.99 respectively. The proportion of rejection is given in Table 1. The type-I errors when a = 0 are below 0.05, indicating a reasonable approximation of the 2 distribution. When a > 0, we observe that the proportion of rejections increases as the value of the bandwidth increases Example 2:
logit(p) = -1.0 + a cos(2x),

11

where a = 0.5, 0.75, 1.0, x  U (0, 1). The degrees of freedom in this example are similar to

Example 1, as the same values of the bandwidth are used and the distribution of the design

points is identical to Example 1. This alternative family contains weak to strong nonlinear

components and the proportion of rejections is given in Table 2. The behavior that the

proportion of rejections increases as the value of the bandwidth increases under alternatives

is observed again here.

Next we examine the performance of (20) under GPLMs.

Example 3:

logit(p) = b1z1 + b2z2 + a exp(-16x2),

where z1 is first generated as binary taking values -1 and 1 with equal probabilities, z2  N (0, 0.52), and x  U (-0.5, 1). To satisfy the conditions in Theorem 5, z1 and z2 are then made orthogonal to x and the intercept vector by multiplying (I - P1) where P1 is the projection matrix for x and intercept. After the orthogonized z1 and z2 are obtained, b1 = 1, b2 = -1, and a = 0, 1, 2, 3. The average degrees of freedom corresponding to the values of h = 0.15, 0.2, and 0.25 are 11.17, 8.61, and 7.07 respectively. The proportion of rejections is given in Table 3. We observe that when a = 0 the type-I errors are below 5%, same as in Example 1. Table 3 shows satisfactory behavior of the proposed test for GPLMs. Example 4:
logit(p) = b1z1 + b2z2 + a cos(2x),

where the data generation of z1, z2, and x is identical to Example 3, b1 and b2 are the same as Example 3, and a = 1, 1.5, 2. The results in Table 4 confirms with previous examples that the integrated likelihood ratio test perform reasonably well and the asymptotic 2-distribution approximates well in finite-sample cases.

5 German Bundesbank Data
We apply the methodology in Section 3 to the German Bundesbank Data in year 2002, which was provided by CRC 649, Humboldt University, Berlin. The data contains 6123 firms in which 186 were insolvent. Each firm is described by a set of financial statement variables and those of insolvent firms are collected two years prior to insolvency. In accordance with literature, 28 ratios, x1, . . . , x28 have been selected for the bankruptcy analysis. To ensure
12

the value of some variables as the denominator when calculating the ratios should not be zero, 2079 firms were retained with 92 insolvent. See Chen et al. (2011) for detail descriptions about the data. Based on support vector machines, Chen et al. (2011) selected x24 (account payable turnover) as the best predictor, and subsequently selected x3 (OI/TA), x15 (CASH/TA), x12 (TL/TA), x26 (percentage of incremental inventories), x22 (inventory turnover), x5 (EBIT/TA), and x2 (net profit margin). We found x3 and x5 have a large sample correlation coefficient 0.95 and thus x5 is removed in our analysis and we further include x25 (firm size) as it is shown to be an important variable on the probability of bankruptcy in the literature. Among the 8 predictors, there are two activity ratios (x24 and x22), 2 profitability ratios (x3 and x2), one liquidity ratio (x15), one leverage ratio (x12), one percentage of change ratio (x26), and one size variable (x25).
Since x24 was selected as the most important predictor by Chen et al. (2011), we model its effects nonparametrically, while retaining linear trends for the remaining predictors in a logit model. Further examinations of x24 indicates that most values lie in [0, 0.5] with only 15 observations in (0.5, 20.52). In the region where data are sparse, smoothing methods will not be applicable. Thus we remove those 15 observations and the final sample size is 2064, in which 91 are insolvent. Local linear smoothing with the Epanechnikov kernel is used with h = 0.125, 0.1, and 0.075 corresponding to degrees of freedom 4.94, 5.92, and 7.59 respectively. The curves shown in Figure 1 clearly demonstrate a nonlinear trend of x24. When x24 < 0.3 approximately, the default probability increases as x24 increases. Then the probability decreases for 0.03 < x24 < 0.04, and increases again for x24 > 0.4. The proposed integrated likelihood ratio test gives p-values of 0.0045, 0.0072, and 0.015 respectively, indicating significance of this variable. Thus an interpretation in Chen et al. (2011) that a German firm is likely to go bankrupt when it has high turn over is not entirely correct; in our analysis, the effects of x24 on bankrupt probability is nonlinear.
In technical terms, accounts payable turnover ratio is an accounting liquidity metric that evaluates how fast a company pays off its creditors (suppliers). A high ratio means there is a relatively short time between purchase of goods and services and payment for them. Conversely, a lower accounts payable turnover ratio usually signifies that a company is slow in paying its suppliers. Since the y-axis in Figure 1 is in the negative range, it indicates that including x24 in the model has a protective effect. Taking the curve with h = 0.1 in Figure
13

1, when x24 increases from 0.1 to 0.3, the nonlinear estimate increases about 1.895, which means the odds ratio for a firm with x24 = 0.3 to become insolvent is exp(1.895) = 6.653 times relative to that for a firm with x24 = 0.1. On the other hand, between x24 = 0.3 and 0.4, the nonlinear estimate decreases by an amount of -0.607, implying that the odds ratio for a firm with x24 = 0.4 to become insolvent is exp(-0.607) = 0.545 times relative to that for a firm with x24 = 0.3. Thus our analysis gives new insight that a German firm is likely to go bankrupt when it has higher turnover for roughly 97.5% of firms (0.3 is approximately 97.5-percentile of x24), but for those firms with 0.3 < x24 < 0.4 (approximately 97.5- to 99-percentile), the default probability decreases as x24 increases.

Appendix
The following conditions are similar to those in Fan et al. (1995).
Conditions (A).

(A1). The kernel K(·) is a Lipschitz continuous, bounded and symmetric probability density function, having a support on a compact interval, say [-1, 1].

(A2). The function (2/x2) {y, (x)} < 0 for x  R and y in the range of the response variable.

(A3). The functions L , (p+1), b ((·))  V (·), V , and G(3) are continuous.

(A4). For each x in the support of {xi, i = 1, . . . , n}, V (x) and G (µ(x)) are nonzero.

(A5). For model (16), the covariate vector z is assumed to have a bounded support.

Proof of Remark 1: When p = 1, the bias of i is expressed as follows:
E (^0(x) + (xi - x)^1(x))Kh(xi - x)dx - i = E {(^0(x) - 0(x)) + (xi - x)(^1(x) - 1(x))}Kh(xi - x)dx- {2(x)(xi - x)2 + r(x, xi)}Kh(xi - x)dx ,

(21)

where r(x, xi) denotes the remainder terms. Plugging the first-order term of the asymptotic bias of ^0(x) (Fan et al. (1995) and Aerts and Claeskens (1997)) in (21), leads to cancellation

14

with the 2(x)-term in (21). The remaining term (xi - x)(^1(x) - 1(x))Kh(xi - x)dx is of order h4. Thus the h2-order term in (21) is zero. Similar arguments can be shown for p = 3.
Fan et al. (1995) and Aerts and Claeskens (1997) showed that the variance of ^j(x) is of order n-1h-2j-1 when p is odd. Then the variance of {^0(x) + (xi - x)^1(x)} is of order n-1h-1 and hence the variance of i is of order n-1h-1. Finally, it is straightforward to show (c) based on (a) and (b) since µi = G-1(i).
Proof of Theorem 2: We only need to show Theorem 2(a) while Theorem 2(b) follows directly from Theorem 2(a). For the left-hand side of (12), ignoring the c(y, ) and a() terms in (1) which is unrelated to x, the integrated likelihood is

x(y, ^x)dx =

yi ^i(x)Kh(xi - x)dx - b(^i(x))Kh(xi - x)dx .

i

By a Taylor's expansion,

b(^i(x)) = b(i) + b (i){^i(x) - i} + b (i){^i(x) - i}2/2 + ri(x),

where ri(x) denotes the remainder terms. Note that for the linear term, b (i)(^i(x) - i)Kh(xi - x)dx = b (i)(i - i) = 0.

The quadratic term (^i(x) - i)2Kh(xi - x)dx = ^i(x){^i(x) - i}Kh(xi - x)dx. For ^i(x) - i = (^i(x) - i) - (i - i), the first term ^i(x) - i = (^0 - 0) + (^1 - 1)(xi - x) + · · · + (^p - p)(xi - x)p + ri(x) by a Taylor's expansion of i, where ri(x) denotes the remainder terms. Then based on Theorem 1(a) of Fan et al. (1995), ^i(x) - i is of order
O(hp+1). For the second term i - i, it is of order O(h(p+1)) based on Remark 1. Thus b(^i(x))Kh(xi - x)dx = b(i) + O(h(p+1)) and (12) is proved.

Proof of Theorem 3: Let (yi, a0) be the likelihood corresponding to yi with i = a0.
Define x(y, a0) = i (yi, a0)Kh(xi - x), and it is clear that x(y, a0)dx = (y, a0). Recall ^ = (^0, . . . , ^p) maximizes local likelihood at x with local polynomial approximation. Expanding x(y, ^x), which is a function of ^ , around a (p+1)-length vector a0 = (a0, 0, . . . , 0) ,

x(y, ^x)- x(y, a0) =

 

x


(y,

a0)

(^ -a0)+

1 2

(^ -a0)

2 x 2

(y,

a0

 )(^ -a0)+Op( n-1h-1

).

(22)

15

Substituting the expansion

^

-

a0

=

ix(a0)-1

x 

(y,

a0)

+

 Op( n-1h-1),

where ix(a0) = E

-

2 x 2

(y,

)

(a0), we have for (22),

x 

(y,

a0)

ix(a0)-1

x 

(y,

a0)

+

1 2

x 

(y,

a0)

ix(a0

)-1

2 x 2

(y,

a0

)ix(a0)-1x

(y,

a0)

+Op( n-1h-1).

Since

2 x 2

(y,

a0)

=

 -ix(a0) + Op( nh),

it

follows

that

2{ x(y, ^x) - x(y, a0)}dx is

x 

(y,

a0)

ix(a0)-1

x 

(y,

a0)dx

=

i(a0)-1/2

 

(y,

a0

)

Hp

i(a0)-1/2

 

(y,

a0)

,

where

the

last

expression

is

obtained

by

plugging

in

the

explicit

expressions

of

x 

(y,

a0

)

and

ix(a0)-1, and i(a0) is the information matrix under H0.

By standard ML theory, 2{ (y, a^0) - (y, a0)} is asymptotically distributed according to

a 2 distribution with 1 degree of freedom. Hence the test statistic (14) becomes

i(a0)-1/2

 

(y,

a0)

{Hp - P0}

i(a0)-1/2

 

(y,

a0

)

,

where P0 is an n × n matrix with 1/n in all entries, i.e. the projection matrix from fitting a

constant. From Huang and Chen (2008), Hp is a symmetric and asymptotically idempotent

matrix. Note that

i(a0)-1/2




(y,

a0)

is asymptotically normally distributed with mean

vector 0 and identity covariance matrix. Since Huang and Chen (2008) have shown that

Hp-P0 is symmetric and asymptotically idempotent, the test statistic (14) has an asymptotic 2-distribution with degrees of freedom tr{(Hp) - 1}.

Proof of Theorem 5:

The proof is an extension from that of Theorem 3. Let 0 = (a0,  ) denote the param-

eter vector under H0 when i = a0 +  zi and (y, 0) be the corresponding likelihood.

Define local likelihood at x under H0 by x(y, 0) = i (yi, 0)Kh(xi - x) and hence

x(y, 0)dx = (y, 0). We consider

x(y, ^^x)dx - (y, 0) and { (y, ^ 0) - (y, 0)}

separately, whose difference becomes (14).

16

Let b = ( ,  ) be the parameter vector under H1. Expanding x(y, ^^x), which is a function of b^^ = (^^ , ^^ ) , around a (p + K + 1)-length vector a0 = (a0, 0, . . . , 0,  ) ,

x(y, ^^x)- x(y, a0) =

 

x
b

(y,

a0)

(b^^ -a0 )+

1 2

(b^^ -a0 )

2 x b2

(y,

a0 )(b^^ -a0 )+Op (n-1

h-1).

(23)

Substituting the expansion under H0

^^

-

a0

=

ix(a0)-1

x b

(y,

a0)

+

 Op( n-1h-1),

where ix(a0) = E

-

2 x
b2

(y,

)

(a0), we have for (23),

x b

(y,

a0)

ix(a0)-1

x b

(y,

a0)

+

1 2

x b

(y,

a0)

ix(a0

)-1

2 x b2

(y,

a0

)ix(a0)-1bx

(y,

a0)

+Op( n-1h-1).

Since

2 x
b2

(y,

a0)

=

 -ix(a0) + Op( nh)

under

H0,

it

follows

that

is asymptotically

2{ x(y, ^^x) - x(y, 0)}dx

 

x
b

(y,

a0

)

ix

(a0)-1

 

x
b

(y,

a0

)dx

=

i(0)-1/2

 

(y,

0

)

{Hp + Pz}

i(0

)-1/2

 

(y,

0

)

,

where Pz is the projection matrix for Z and i(0) is the information matrix under H0. The

last

expression

is

obtained

by

plugging

in

the

explicit

expressions

of

x
b

(y,

a0)

and

ix(a0)-1

and using the assumption that x and Z are orthogonal. From Huang and Davidson (2010),

{Hp + Pz} is a symmetric and asymptotically idempotent matrix.

For the other term, 2{ (y, ^0) - (y, 0)} is asymptotically distributed according to a

2-distribution with (K + 1) degree of freedom under H0 by standard ML theory. Hence the

test statistic (14) becomes

i(0)-1/2

 

(y,

0)

{Hp - P0}

i(0)-1/2

 

(y,

0)

,

where P0 is the same as in the proof of Theorem 3. Note that

i(0)-1/2




(y,

0)

is

asymptotically normally distributed with mean vector 0 and identity covariance matrix.

Hence the test statistic (14) has an asymptotic chi-square distribution with degrees of free-

dom tr{(Hp) - 1}.

17

References
Aerts, M., and Claeskens, G. (1997). Local polynomial estimation in multiparameter likelihood models. J. Amer. Statist. Assoc., 92, 1536-1545.
Carroll, R. J., Fan, J., Gijbels, I., and Wand, M. P. (1997). Generalized partially linear single-index models. J. Amer. Statist. Assoc. 92, 477-489.
Chen, S., H¨ardle, W., and Moro, R. (2011). Modeling default risk with support vector machines. Quantitative Finance, 11, 135-154.
Fan, J., and Gijbels, I. (1996). Local Polynomial Modelling and Its Applications, London: Chapman and Hall
Fan, J., Heckman, N. E., and Wand, M. P. (1995). Local Polynomial Kernel Regression for Generalized Linear Models and Quasi-Likelihood Functions. J. Amer. Statist. Assoc. 90, 141-150.
Fan, J., Zhang, C., and Zhang, J. (2001). Generalized likelihood ratio statistics and Wilks phenomenon. Ann. Statist., 29, 153-193.
Green, P. J., and Silverman, B. W. (1994). Nonparametric Regression and Generalized Linear Models: a Roughness Penalty Approach, London: Chapman and Hall.
Ha¨rdle, W., Mu¨ller, M., and Mammen, E. (1998). Testing Parametric Versus Semiparametric Modeling in Generalized Linear Models. J. Amer. Statist. Assoc., 93, 1461-1474.
Ha¨rdle, W. K., Mu¨ller, M., Sperlich, S., and Werwatz, A. (2004). Nonparametric and Semiparametric Models, Berlin: Springer.
Hastie, T. J., and Tibshirani, R. J. (1990). Generalized Additive Models, London: Chapman and Hall.
Hastie, T. J., and Tibshirani, R. J. (1987). Local likelihood estimation. J. Amer. Statist. Assoc., 82, 559-567.
Huang, L.-S., and Chan, K.-S. (2013). Local polynomial and penalized trigonometric series regression. Manuscript, submitted.
18

Huang, L.-S., and Chen, J. (2008). Analysis of Variance, Coefficient of Determination, and F-test for Local Polynomial Regression. Ann. Statist., 36, 2085-2109.
Huang, L.-S., and Davidson, P. W. (2010). Analysis of variance and F -tests for partial linear models with applications to environmental health data. J. Amer. Statist. Assoc., 105, 991-1004.
Huang, L.-S., and Su, H. (2009). Nonparametric F -tests for nested global and local polynomial models. J. Statist. Plann. Inference, 139, 1372-1380.
Lehmann, E. L. (2006). On likelihood ratio tests. Lecture Notes-Monograph Series Vol. 49, Optimality: The Second Erich L. Lehmann Symposium, 1-8. Institute of Mathematical Statistics.
Li, R., and Liang, H. (2008). Variable selection in semiparametric regression modeling. Ann. Statist., 36, 261-286.
McCullagh, P., and Nelder, J. A. (1989). Generalized Linear Models, 2nd Edition. London: Chapman and Hall.
Severini, T. A. (2007). Integrated likelihood functions for non-Bayesian inference. Biometrika, 94, 529-542.
Simon, G. (1973). Additivity of information in exponential family probability laws. J. Amer. Statist. Assoc., 68, 478-482.
19

Table 1: Proportion of rejections for Example 1

Proportion of rejection h = 0.1 h = 0.15 h = 0.2 h = 0.25

a=0

0.048 0.040 0.036 0.030

a = -1

0.244 0.282 0.320 0.334

a = -1.5

0.558 0.602 0.640 0.674

a = -2

0.800 0.858 0.906 0.932

Table 2: Proportion of rejections for Example 2

Proportion of rejection h = 0.1 h = 0.15 h = 0.2 h = 0.25

a = 0.5

0.286 0.348 0.370 0.384

a = 0.75

0.588 0.600 0.738 0.742

a = 1.0

0.892 0.926 0.946 0.946

20

Table 3: Proportion of rejections for Example 3

Proportion of rejection h = 0.15 h = 0.2 h = 0.25

a=0

0.034 0.026 0.022

a=1

0.132 0.150 0.150

a=2

0.620 0.654 0.682

a=3

0.926 0.946 0.952

Table 4: Proportion of rejections for Example 4

Proportion of rejection h = 0.15 h = 0.2 h = 0.25

a=1

0.306 0.332 0.360

a = 1.5

0.685 0.732 0.752

a=2

0.921 0.946 0.950

21

-5 -4 -3 -2 -1

0.0 0.1 0.2 0.3 0.4 0.5 x24 Account payable turnover
Figure 1: Plot of the nonlinear trends of x24 in predicting bankrupt probabilities with bandwidth h = 0.125 (solid line), h = 0.1 (dotdash line), and h = 0.075 (dashed line) for the 2002 German Bundesbank Data.
22

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.

001
002 003 004 005 006
007
008 009
010 011 012
013 014
015 016
017
018 019

"Functional Data Analysis of Generalized Quantile Regressions" by
Mengmeng Guo, Lhan Zhou, Jianhua Z. Huang and Wolfgang Karl Härdle, January 2013. "Statistical properties and stability of ratings in a subset of US firms" by
Alexander B. Matthies, January 2013. "Empirical Research on Corporate Credit-Ratings: A Literature Review" by Alexander B. Matthies, January 2013. "Preference for Randomization: Empirical and Experimental Evidence" by
Nadja Dwenger, Dorothea Kübler and Georg Weizsäcker, January 2013. "Pricing Rainfall Derivatives at the CME" by Brenda López Cabrera, Martin Odening and Matthias Ritter, January 2013. "Inference for Multi-Dimensional High-Frequency Data: Equivalence of
Methods, Central Limit Theorems, and an Application to Conditional Independence Testing" by Markus Bibinger and Per A. Mykland, January 2013.
"Crossing Network versus Dealer Market: Unique Equilibrium in the Allocation of Order Flow" by Jutta Dönges, Frank Heinemann and Tijmen R. Daniëls, January 2013. "Forecasting systemic impact in financial networks" by Nikolaus Hautsch,
Julia Schaumburg and Melanie Schienle, January 2013. "`I'll do it by myself as I knew it all along': On the failure of hindsightbiased principals to delegate optimally" by David Danz, Frank Hüber,
Dorothea Kübler, Lydia Mechtenberg and Julia Schmid, January 2013. "Composite Quantile Regression for the Single-Index Model" by Yan Fan, Wolfgang Karl Härdle, Weining Wang and Lixing Zhu, February 2013. "The Real Consequences of Financial Stress" by Stefan Mittnik and Willi
Semmler, February 2013. "Are There Bubbles in the Sterling-dollar Exchange Rate? New Evidence from Sequential ADF Tests" by Timo Bettendorf and Wenjuan Chen, February 2013.
"A Transfer Mechanism for a Monetary Union" by Philipp Engler and Simon Voigts, March 2013. "Do High-Frequency Data Improve High-Dimensional Portfolio
Allocations?" by Nikolaus Hautsch, Lada M. Kyj and Peter Malec, March 2013. "Cyclical Variation in Labor Hours and Productivity Using the ATUS" by Michael C. Burda, Daniel S. Hamermesh and Jay Stewart, March 2013.
"Quantitative forward guidance and the predictability of monetary policy ­ A wavelet based jump detection approach ­" by Lars Winkelmann, April 2013.
"Estimating the Quadratic Covariation Matrix from Noisy Observations: Local Method of Moments and Efficiency" by Markus Bibinger, Nikolaus Hautsch, Peter Malec and Markus Reiss, April 2013. "Fair re-valuation of wine as an investment" by Fabian Y.R.P. Bocart
and Christian M. Hafner, April 2013. "The European Debt Crisis: How did we get into this mess? How can we get out of it?" by Michael C. Burda, April 2013.

SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

SFB 649 Discussion Paper Series 2013
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
020 "Disaster Risk in a New Keynesian Model" by Maren Brede, April 2013. 021 "Econometrics of co-jumps in high-frequency data with noise" by Markus
Bibinger and Lars Winkelmann, May 2013. 022 "Decomposing Risk in Dynamic Stochastic General Equilibrium" by Hong
Lan and Alexander Meyer-Gohde, May 2013. 023 "Reference Dependent Preferences and the EPK Puzzle" by Maria Grith,
Wolfgang Karl Härdle and Volker Krätschmer, May 2013. 024 "Pruning in Perturbation DSGE Models - Guidance from Nonlinear Moving
Average Approximations" by Hong Lan and Alexander Meyer-Gohde, May 2013. 025 "The `Celtic Crisis': Guarantees, transparency, and systemic liquidity risk" by Philipp König, Kartik Anand and Frank Heinemann, May 2013. 026 "State Price Densities implied from weather derivatives" by Wolfgang Karl Härdle, Brenda López-Cabrera and Huei-Wen Teng, May 2013. 027 "Bank Lending Relationships and the Use of Performance-Sensitive Debt" by Tim R. Adam and Daniel Streitz, May 2013. 028 "Analysis of Deviance in Generalized Partial Linear Models" by Wolfgang Karl Härdle and Li-Shan Huang, May 2013.
SFB 649, Spandauer Straße 1, D-10178 Berlin http://sfb649.wiwi.hu-berlin.de
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".

