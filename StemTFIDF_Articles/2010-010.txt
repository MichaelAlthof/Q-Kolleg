BERLIN

SFB 6 4 9 E C O N O M I C R I S K

SFB 649 Discussion Paper 2010-010
On Securitization, Market Completion and
Equilibrium Risk Transfer
Ulrich Horst* Traian A. Pirvu** Gonçalo Dos Reis***
* Humboldt-Universität zu Berlin, Germany ** McMaster University Hamilton, Canada *** CMAP École Polytechnique Palaiseau Cedex, France
This research was supported by the Deutsche Forschungsgemeinschaft through the SFB 649 "Economic Risk".
http://sfb649.wiwi.hu-berlin.de ISSN 1860-5664
SFB 649, Humboldt-Universität zu Berlin Spandauer Straße 1, D-10178 Berlin

On Securitization, Market Completion and Equilibrium Risk Transfer

Ulrich Horst
Dept of Mathematics Humboldt University Berlin
Unter den Linden 6 10099 Berlin
horst@math.hu-berlin.de

Traian A. Pirvu
Dept of Mathematics & Statistics McMaster University 1280 Main Street West
Hamilton, ON, L8S 4K1 tpirvu@math.mcmaster.ca

Gon¸calo Dos Reis
CMAP E´cole Polytechnique
Route de Saclay 91128 Palaiseau Cedex dosreis@cmap.polytechnique.fr

March 6, 2010

Abstract We propose an equilibrium framework within which to price financial securities written on nontradable underlyings such as temperature indices. We analyze a financial market with a finite set of agents whose preferences are described by a convex dynamic risk measure generated by the solution of a backward stochastic differential equation. The agents are exposed to financial and non-financial risk factors. They can hedge their financial risk in the stock market and trade a structured derivative whose payoff depends on both financial and external risk factors. We prove an existence and uniqueness of equilibrium result for derivative prices and characterize the equilibrium market price of risk in terms of a solution to a non-linear BSDE.
AMS classification: 60G35, 60H20, 91B16, 91B70
JEL classification: G12, D52, C62, C68. Keywords: Backward stochastic differential equations, dynamic risk measures, partial equilibrium; equilibrium pricing; market completion

We thank Jaksa Cvitanic, Ivar Ekeland, Peter Imkeller, Frank Riedel, Nizar Touzi and seminar participants at various institutions for valuable comments and helpful discussions. Special thanks are due to an anonymous referee for his/her many suggestions that greatly helped to improve the presentation of the results. Horst and Pirvu gratefully acknowledge financial support through NSERC individual research grants and the Pacific Institute for the Mathematical Sciences (PIMS). Horst acknowledges financial support through the SFB 649 "Economic Risk". Dos Reis thanks the Portuguese Foundation for Science and Technology (FCT) and the AMaMeF program of the European Science Foundation (ESF) for financial support.

1 Introduction
In recent years there has been an increasing interest in derivative securities written on non-tradable underlyings. Weather derivatives and other financial products written on non-tradable (non-financial, external) underlyings such as temperature processes or precipitation indices are the end-product of a process called securitization which transforms non-tradable risk factors into tradable financial assets. Securitized derivatives provide new opportunities for hedging and risk-sharing. As such, they may contribute to a socially more efficient allocation of risk exposures, in particular in incomplete markets where not all the states of nature can be spanned by the existing assets. The potential benefits from creating and trading new securities has sparked a huge literature on financial innovation with a wide focus ranging from optimal security design, especially in the presence of asymmetric information (Allen & Gale, 1994), to endogenous financial market structures.1 While the focus of the financial innovation literature is on pricing endogenously created financial instruments, the GEI literature focuses on equilibrium properties of exogenously introduced securities. Dynamic GEI models in discrete time are well understood even beyond the expected utility framework; see Cheridito et al., 2009 and references therein. There is no unified framework for continuous time models, though. Much of the continuous time GEI literature is confined either to single agent models (He & Leland, 1993) or to multiple agent models of complete markets (see, e.g., Dana & Jeanblanc, 2002; Duffie & Huang, 1985; Karatzas, Lehoczky & Shreve, 1990 or Riedel, 2001).
In this paper we propose a framework within which to address the problem of equilibrium pricing of exogenously introduced derivative securities with a non-tradable underlying. The demand for the derivatives comes from agents whose income is exposed to two sources of uncertainty. Uncertainty is represented by two independent Brownian motions. We think of the first Brownian motion as a source of financial risk and of the second Brownian motion as a non-financial (external) risk factor. The agents can hedge their financial risk by trading a standard financial security ("stock"). Buying and selling the standard security is unrestricted. There is no cost of trading and the securities' price process is unaffected by the demand of the agents. The risk-free rate is also exogenous. This is a fairly good approximation if we think of the standard security as a liquidly traded stock and of the set of agents that are interested in trading the derivative as a small subset of an otherwise large set of financial investors.
The derivative is in fixed supply and priced to match demand and supply. We establish existence and characterization of equilibrium results when the agents' risk preferences are induced by dynamic convex risk measures generated by backward stochastic differential equations (BSDEs). Preferences induced by dynamic risk measures and BSDEs form subclasses of (generalized) stochastic differential utilities (Duffie & Epstein, 1992; Chen & Epstein, 2002; Lazrak & Quenez, 2003; Lazrak, 2004) and variational preferences (Maccheroni, Marinacci & Rustichini, 2006). They are translation invariant and strongly time-consistent. Translation invariance means that a cash amount added to a financial position reduces the risk by that amount. This assumption is appropriate if we think of the agents as financial institutions that evaluate their financial positions in terms of risk capital. For the special case of dynamic entropic risk measures and for market prices of financial risk that depend only on the external risk factor we prove the existence of a unique (in a certain class) equilibrium market price of (external) risk and characterize it in terms of a solution to a BSDE with quadratic growth. We also prove that the volatility of the equilibrium derivative price process can be represented in terms of a Lipschitz continuous function of the prevailing stock price
1See the summary articles by Duffie & Rahi (1995) and Tufano (2003) for a review of the financial innovation literature.
2

and the external risk process. This allows us to deduce market completeness in equilibrium.2 Market completeness in equilibrium is key. Our model comprises of two sources of uncertainties and
two assets. Hence it is potentially complete, but there is no a-priori reason to assume completeness in equilibrium3. The problem of dynamic completion of financial markets has recently been addressed by Anderson & Raimondo (2008). They provide a non-degeneracy condition on the terminal security dividends to insure completeness in equilibrium. Their results apply to a wider class of preferences, but their notion equilibrium in continuous time is weaker than ours. They first establish existence of equilibrium results in discrete time and then construct the information structure of the continuous time equilibrium by passing to the limit as the time between two consecutive trading dates tends to zero. Our equilibrium is constructed for exogenous information flows and sources of uncertainty. Further differences between their work and ours include: (i) we allow for more general risk processes and a dependence between them; (ii) we do not assume that the consumption processes (cash flows in our model) are bounded from below; (iii) we consider a partial equilibrium model which renders the technical analysis much more involved.4
In order to prove our existence and characterization of equilibrium result we first characterize the market prices of risk that are consistent with the assumption of no-arbitrage in the stock and derivative market. For any such market price of risk (MPR) we solve the agents' optimization problem under the assumption that the derivative completes the market. We show that the dynamic optimization problem can be reduced to static optimization problems and characterize the candidate optimal trading strategy in terms of an implicit equation that involves the driver of the BSDE associated with the agent's preferences. For the special case of expected exponential utility maximizing agents this provides an alternative - and perhaps more direct - approach to the problem of dynamic risk minimization than the martingale optimization argument of Hu, Imkeller & Mu¨ller (2005a).
Subsequently we determine the equilibrium market price of external risk. The key observation is that with our choice of preferences the problem of finding an equilibrium in an economy in which an arbitrary number of derivatives are available for trading can be rewritten as an equilibrium problem in which the derivative is in zero supply. This allows us to reduce the analysis of competitive equilibrium to an equilibrium problem of a representative agent economy. The application of the representative agent approach to equilibrium pricing in continuous time under translation invariant preferences is new to the best of our knowledge. Jouini, Schachermayer & Touzi (2005) and Filipovic & Kupper (2006) studied static models; Barrieu & El Karoui (2005, 2009) and Hu, Imkeller & Mu¨ller (2005b) considered dynamic models, but restricted themselves to the simpler problem of efficient risk sharing. For dynamic exponential utility functions and stock price processes that follow a simple geometric Brownian motion, an existence and uniqueness of equilibrium result similar to ours was established by Horst & Mu¨ller (2007). Their approach relied on the closed form representation of the optimal solution of an agent's optimization problem as computed by duality methods. This method does not carry over to more general utility functions and/or more general risk processes. It particular, it does not allow for a dependence of the market price of financial risk on the external risk factor. Allowing for such a feedback is one of the main contributions of this paper.
2The question of when trading in derivative securities completes the market has been addressed by many authors including Davis (2004), Davis & Obloj (2008) and Romano and Touzi (1997). In their models derivative prices are given as conditional expected payoff under an exogenous measure (usually the real-world measure) while in our model the pricing measure is derived endogenously by an equilibrium condition.
3See Pesendorfer (1995) for an example of a financial market model where redundancies arise in equilibrium when the financial market structure is endogenous.
4We show in Section 4.3.1 how the analysis simplifies in the case of full equilibrium.
3

We characterize simultaneously the candidate equilibrium market price of external risk and the representative agent's optimal utility as a solution to a BSDE. The technical difficulty is then to verify that the candidate equilibrium MPR that comes out of this BSDE defines a pricing measure under which market completeness prevails. Verifying market completeness in equilibrium is hard so most authors assume completeness - either right away (Duffie & Huang, 1985; Dana & Jeanblanc, 2002) or in equilibrium (Riedel, 2001). Within our general framework we do the same. We verify completeness for the special case where the agents evaluate their risk using entropic dynamic risk measures. We show that the equilibrium market price of external risk can be characterized in terms of a BSDE with quadratic growth and that it can be represented in terms of a Lipschitz continuous functions of the underlying risk processes. Applying the Clark-Haussmann formula (Clark, 1970; Haussmann, 1979) we obtain an explicit representation of the equilibrium derivative price volatility from which we deduce that the market is indeed complete in equilibrium if the derivative's payoff function is monotone in the external risk factor. A similar condition has been derived by Horst & Mu¨ller (2007) for constant market prices of financial risk using PDE methods. Our approach via the Clark-Haussmann formula is more direct, requires weaker conditions and allows the market prices of financial risk to depend on the external risk factor.
For the case of dynamic entropic preferences the BSDE representation of the equilibrium dynamics yields closed form expressions for the dependence of the equilibrium market price of risk on the agents' risk tolerance and the number of derivatives that are available for trading. We show that the market price of risk increases (decreases) with the number of derivatives if the derivative's payoff increases (decreases) in the external risk factor. The intuition comes from the usual "in-equilibrium-the-spot-price-densityequals-the-representative-agent's-marginal-utility" condition together with the fact that our agents have translation invariant preferences. In fact, if the risk factors were constant, then translation invariance would imply that the marginal utility from giving an extra derivative to the representative agent would simply be the derivative's payoff. When the risk factors are stochastic, the marginal utility is obtained by first differentiating the agent's endowment with respect to the number of derivatives and the state of the risk process and then taking an expectation with respect to the equilibrium pricing measure.
Our model lends itself to efficient numerical computations so all our theoretical results are accompanied by simulation results. Specifically, we simulate equilibrium derivative prices and illustrate the correlation between the risk factors and the equilibrium MPR. We also illustrate the dependence of equilibrium prices on the agents' tolerance towards risk and show that the equilibrium prices are sub-linear in the derivative's payoff structure. This confirms a result of Chen (1995). Finally, we illustrate the positive effects of financial innovation in our model. To this end, we benchmark our model against an incomplete market model in which the derivative is not available for trading. Our simulations suggest that the overall risk exposure in a model with the derivative is lower than in a model without the derivative and that the derivative's total payoff is an important determinant of the degree of risk reduction.
The remainder of this paper is organized as follows. We specify our microeconomic setup in Section 2 and lay out the general structure of our partial equilibrium model with translation invariant preferences in Section 3. The specific case of entropic utilities is studied in detail in Section 4. Numerical simulations of equilibrium prices and optimal risk exposures for entropic risk measures are reported in Section 5. Section 6 concludes. A technical appendix summarizes some of our notation and reviews important existence and uniqueness results for BSDEs with quadratic growth, the link between dynamic risk measures and BSDEs and Malliavin differentiability of BSDEs.
4

2 The microeconomic setup

We consider a partial equilibrium model with a finite set A of agents. The agents are endowed with uncertain payoffs. They can lend and borrow from the money money account at the same exogenous risk-free rate which we assume for simplicity to be equal to zero. The agents' goal is to hedge their risk exposures at a terminal time T <  by trading continuously in the financial market. The financial market comprises a stock and a structured security ("derivative"). Stock prices are unaffected by the agents' demand and follow some exogenous diffusion process. By contrast, the derivative is in fixed supply, traded only by the agents that belong to the set A and priced to match supply and demand. We think of the derivative as being issued by an agency like an insurance company or investment bank with the goal of transferring non-financial risk to the capital market. The agency may or may not belong to the set A, so the derivative may or may not be in zero net supply.

Risk processes
There are two sources of randomness in our model. They are represented by a 2-dimensional standard Brownian motion W = (W S, W R) defined on a filtered probability space (, F , (Ft)Tt=0, P). Here (Ft) denotes the filtration generated by W augmented by the P-null sets and F = FT . We view the Brownian motion W R as a source of non-financial risk. It drives an external risk process (Rt) such as a temperature process or precipitation index. For analytical convenience we assume that (Rt) follows a Brownian motion with time-dependent deterministic drift function a : [0, T ]  R and constant volatility b > 0, i.e.,

dRt = atdt + bdWtR (R0 = r0).

(1)

Most of our results carry over to mean-reverting Ornstein-Uhlenbeck processes, though. The Brownian motion W S describes a source of financial risk and drives the stock price process (St). Specifically,

dSt St

=

µSt dt + tS dWtS

(S0 = s0)

(2)

for (Ft)-adapted coefficients µS, S :  × [0, T ]  R, with S > 0. Our focus will be on coefficients that depend on the external risk process.

Preferences
The agents evaluate their risk exposure using a dynamic convex risk measure generated by a BSDE. This
means that the evolution of the risk which the agent a  A associates with an F-measurable random payoff a is described by an (Ft)-adapted stochastic process (Yta) that is given by the first component of a solution (Y, Z) to a BSDE

-dYta = ga(t, Zta)dt - ZtadWt with terminal condition YT = a.
Here ga : [0, T ] × R2  R is a deterministic continuous function and z  ga(·, z) is continuously differentiable and strictly convex. In particular, the agents' risk preferences are strongly time consistent and translation invariant.5 Furthermore, all properties of the preferences are coded in the driver ga. A standard
5Preferences are called translation invariant if they can represented by a family of utility functions Ut : L(FT )  L(Ft) (t  [0, T ]) that satisfy the translation property Ut( + Z) = Ut() + Z for all   L(FT ) and Z  L(Ft). In our case, the utility function of the agent a  A at time t  [0, T ] is given by Uta = -Yta. The connection between BSDEs and dynamic translation invariant preferences is reviewed in the appendix.

5

example that fits in this framework is the dynamic entropic risk measure with risk tolerance parameter a.

In this case

Yta = -a log E

exp

-

1 a

a

| Ft

and

ga(t, z)

=

1 2a

z

2,

where · stands for the Euclidean norm. Other examples include g-expectations (see Gianin (2006) and

Peng (2004)). For a more detailed discussion of the link between strongly time-consistent and translation

invariant preference functionals and backward stochastic equations we refer to the recent work of Cheridito

et al. (2009) for the time discrete case and Delbaen et al. (2009) for continuous time.

Derivative payoffs and endowments The derivative pays a yield at a rate D and a lump sum amount hD at maturity6. The payoffs may depend on both risk factors. Since the risk-free rate is zero the accumulated payoff HD up to maturity is given by
T
HD = hD(T, ST , RT ) + D(u, Su, Ru) du.
0
The income Ha of the agent a  A may also be exposed to financial and external risk. Specifically,
T
Ha = ha(T, ST , RT ) + a(u, Su, Ru)du.
0
We assume throughout that all the payoff functions are uniformly bounded. Some (though not all) of our results will require additional Lipschitz properties with respect to the R-variable. To simplify the exposition we therefore introduce the following standing assumption.
Standing Assumption The functions, hD, ha, D, a are uniformly bounded, continuously differentiable with uniformly bounded derivatives. The derivatives are uniformly Lipschitz w.r.t the external risk factor.
We will also assume that all payoffs are made at the terminal time T . This assumption can be made without loss of generality, due to the translation invariance of the risk preferences and because the risk free rate is zero. Shifting all payoffs to the terminal date affects an agent's utility, but not her trading decision. We further comment on this in Remark 3.7 below.

3 The general structure of the equilibrium dynamics

The derivative is in fixed supply and priced to match demand and supply. In order to identify and

characterize an equilibrium pricing rule we recall that any linear pricing scheme on L2(P), the set of square

integrable random variables with respect to P, can be identified with a 2-dimensional predictable process

 that makes the process (Zt) defined by

Zt = exp

-

t 0

sdWs

-

1 2

t
s 2ds
0

(3)

a uniformly integrable martingale; see, e.g. Horst & Mu¨ller (2007). For any such process we denote by P

a probability measure equivalent to P with density ZT and introduce the P-Brownian motion
t
Wt = Wt + s ds.
0

6Many weather derivatives such as HDD and CDD pay "dividends" at a temperature dependent rate. The lump sum

payment at maturity allows us to include European derivatives on the stock, for instance.

6

Remark 3.1. The density process (Zt) is a uniformly integrable martingale if, for instance, the process  satisfies Novikov's condition or, more generally, if it belongs to the class of P-BMO processes. We refer to
Kazamaki (1994) for an extensive discussion of BMO-martingales.

Following Horst & Mu¨ller (2007) we refer to the first component S of the vector  = (S, R) as the market price of financial risk. It is exogenously given by

tS

=

µSt tS

.

The process R will be called the market price of external risk; it will be derived endogenously by an equilibrium condition.

3.1 The individual optimization problem

In this section we study the optimization problem of an individual agent for a given market price of risk .7 In the absence of arbitrage opportunities the derivative price process (Bt) under the pricing measure P is given by
T
Bt = E hD(T, ST , RT ) + D(s, Ss, Rs)ds | Ft
0
where E denotes the expectation with respect to P. This expression makes sense because all payoff functions are bounded. Representing the random variables Bt as stochastic integrals with respect to the P-Brownian motion W  yields a 2-dimensional adapted process  = (,S, ,R) such that

Bt = E[HD] + = E[HD] +

t
s dWs
0 t
s,S (dWsS + sS ds) +
0

t
s,R(dWsR + sRds).
0

(4)

For the optimization problem to have a solution, we assume that fluctuations in the external risk process translate into fluctuations of derivative prices, i.e., that the volatility ,R does not vanish.8 For the rest of this section we therefore work under the following assumption.

Assumption 3.2. The derivative completes the market, i.e., the volatility process (t ,R) is almost surely different from zero.

We denote the holdings of the agent a  A in the stock and derivative at time t  [0, T ] by ta,1 and ta,2 respectively. Her gains from trading up to time t  [0, T ] under the pricing measure P using a self-financing strategy a = (a,1, a,2) that requires zero initial capital are given by

tt

Vta,(a) =

sa,1dSs +

sa,2 dBs .

00

7Later we use the results of this section in order to obtain an equilibrium in terms of a solution to a BSDE. 8In the jargon of Duffie (1986) we need to guarantee that (ST , HD) forms a fundamental dividend process under P. Under standard conditions this assumption can easily be verified under P using Malliavin calculus. The difficulty is to verify the
condition under an equivalent measure. We notice that in Duffie's Section 4 it is enough to have some (not necessarily the
same) fundamental dividend process for an equivalent measure. In our model the candidate fundamental dividend process is
the same for any possible pricing measure.

7

Thus, the risk process associated with the self-financing strategy a evolves according to the BSDE

-dYta(a) = ga(t, Zta(a))dt - Zta(a)dWt with YTa = -(Ha + VTa,(a)).

(5)

In what follows we restrict our analysis to admissible trading strategies. Admissibility guarantees that the preceding BSDE has a unique solution.

Definition 3.3. A strategy a is called admissible with respect to the market price of risk  if the BSDE (5) has a unique solution in HT1 (R, P) × HT2 (R2, P) (the spaces are defined in the appendix) and

E[ V a,(a) T ] < 

(6)

where V a,(a) denotes the quadratic variation of (V a,(a)t). The set of all admissible trading strategies with respect to  is denoted by S.

Uniqueness of solutions of the BSDE (5) can be guaranteed under growth conditions on ga, growth conditions on the derivative gza of ga respect to the z-variable and integrability conditions on the terminal wealth from trading (Kobylanski (2000), Briand & Hu (2008), Briand & Confortola (2008)). Since the
specific integrability condition often depends on the driver, a universal definition of admissibility that applies to all drivers is unnecessarily restrictive. It is more reasonable to define the set S on a case-bycase basis. For the moment we thus leave the exact specification of S open and clarify instead the general
structure of the equilibrium dynamics.

3.1.1 Minimizing (residual) risk The optimization problem of the agent a  A under the pricing measure P is given by

min
a S 

Y0a(a).

In order to obtain first order conditions for optimality it will be convenient to rewrite the agent's optimization problem in terms of a BSDE with terminal condition -Ha. To this end, we observe that

T

Yta(a) = - Ha + Vta,(a) +

ga(s, Zsa(a)) - sa,1sS SssS - sa,2s · s ds

t

T
- Zsa(a) + sa,1
t

sS Ss 0

+ sa,2

s,S s,R

dWs,

where s · s stands for the Euclidean inner product of the 2-dimensional vectors  and . Since the preferences are translation invariant, past gains from trading are not important. They do not affect future

optimal trading strategies. Hence minimizing the risk is equivalent to minimizing the residual risk, i.e.,

the risk less past trading gains. Specifically, the residual risk Y¯ta(a) at time t  [0, T ] associated with a

trading strategy a is defined by

Y¯ta(a) = Yta(a) + Vta,(a).

(7)

With the change of variables

Z¯sa(a) = Zsa(a) + sa,1

sS Ss 0

+ sa,2s

(8)

8

the dynamics of the residual risk process associated with a is captured by the BSDE

TT

Y¯ta(a) = -Ha +

Ga(s, sa, Z¯sa(a)) ds -

Z¯sa(a) dWs

tt

with terminal condition -Ha and driver

(9)

Ga(s, , z) = ga s, z - 1

sS Ss 0

- 2s - 1sS SssS - 2s · s.

(10)

Remark 3.4. We notice that the driver (, z)  Ga(·, , z) : R2 × R2  R is a random function of the independent variables  and z. Any solution the "risk BSDE" (5) yields a solution to the "residual risk BSDE" (9) via (7) and (8) and vice versa.

From now on, we assume that the goal of agent a  A is to minimize the residual risk and denote by (Y¯ a(a), Z¯a(a)) the unique solution of the BSDE (9) associated with an admissible trading strategy a.

3.1.2 The first order conditions and a sufficient condition for optimality

A candidate optimal trading strategy is given by the pointwise (with respect to z and ) minimizer

ta(z,

)

=

arg

min
R2

Ga(t,

,

z)

of the driver   Ga(t, , z) (assuming the minimum is attained).9 The minimizer is a 2-dimensional vector a(z, ) = (a,1(z, ), a,2(z, )) and is implicitly defined through the first order conditions (FOC)

gza1 s, z - as,1(z, )

sS Ss 0

- sa,2(z, )s = -sS

(11)

and

s,S gza1 s, z - as,1(z, )

sS Ss 0

- as,2(z, )s + sS

+ s,R gza2 s, z - as,1(z, )

sS Ss 0

- sa,2(z, )s + sR = 0.

Here gzai denotes the derivative of ga(t, z) with respect to the corresponding entry of the vector z = (z1, z2). In the light of (11) and Assumption 3.2 the last equation is equivalent to

gza2 s, z - as,1(z, )

sS Ss 0

- sa,2(z, )s = -sR.

(12)

Let us now assume that the BSDE with driver Ga(t, ta(z, ), z) and terminal condition -Ha has a unique solution (Y~ a, Z~a). In this case
~ta = ta(Z~ta, )
turns out to be optimal if the BSDEs associated with an agent's risk minimization problem satisfy a comparison principle in the sense of the following definition.10
9We write ta(·, ) to indicate the dependence of the minimizer on the random stock prices and volatilities. 10Our definition of a comparison principle is motivated by Theorem 2.6 and Remark 2.7 of Kobylanski (2000).

9

Definition 3.5. The BSDEs associated with an agent's risk minimization problem satisfy a comparison principle if for any admissible trading strategy a with associated solution (Y¯ a(a), Z¯a(a)) of the BSDE (9) the following holds: The inequality
Ga(t, at (Z¯ta(a), ), Z¯ta(a))  Ga(t, ta, Z¯ta(a)) P  -a.s.,
(where  denotes the Lebesgue measure) implies that the residual risk associated with the strategy a is no smaller than the residual risk associated with a(Z~a, ) at time zero, that is,
Y~0a  Y¯0a(a).
We are now ready to state the main result of this section. It clarifies under what conditions an agent's optimization problem has a solution under a given pricing measure. All the assumptions of the following proposition are satisfied for the case of entropic preferences discussed in Section 4 below.
Proposition 3.6. Let P be a pricing measure such that Assumption 3.2 is satisfied and assume that the following conditions hold:
(i) The first order conditions (11) and (12) have a solution, denoted ta(z, ). (ii) The BSDE with driver Ga(t, at (z, ), z) and terminal condition -Ha has a unique solution (Y~ a, Z~a)
and the trading strategy ~ta = at (Z~ta, ) is admissible. (iii) The BSDEs associated with an agent's optimization problem satisfy the comparison principle of Def-
inition 3.5. Then the optimization problem of any agent a  A has a solution, given by ~ta = ta(Z~ta, ). Proof. By Assumption 3.2 the first order conditions (11) and (12) along with condition ii) give a candidate solution for the agent's optimization problem. Strict convexity of the driver z  ga(·, z) implies strict convexity of   Ga(·, , ·) which in turn guarantees that ta(z, ) = arg minR2 Ga(t, , z). In order to see that the candidate is indeed optimal, let a be any other admissible trading strategy. The associated residual risk process is given by the first component of the unique solution (Y¯ a(a), Z¯a(a)) of the BSDE with driver Ga(t, ta, z). By condition iii) ~a is indeed an optimal trading strategy because
Y~0a  Y¯0a(a).
Remark 3.7. The preceding arguments show that all payoffs can indeed be made at the terminal time T . All payoffs made prior to time t0 do not affect an agent's trading decisions at or after time t0 because of translation invariance. All payoffs made after time t0 can be shifted to T without altering the FOCs for optimality.
From now on we assume the agents' optimization problems have a solution so that it makes sense to introduce the notion of equilibrium.
10

3.2 Equilibrium and the representative agent
We assume that n  0 derivatives are available for trading; the case n = 0 covers the traditional case of the derivative security being in zero net supply. In this case at least one agent holds a short position in equilibrium.
Definition 3.8. A market price of external risk R which, together with the process S makes the density process in (3) a uniformly integrable martingale is an equilibrium market price of external risk if there exists optimal admissible trading strategies ~a (a  A) such that
~ta,2  n P  -a.s.
aA
The process  = (S, R) will be called an equilibrium market price of risk (equilibrium MPR).

3.2.1 Reduction to zero net supply
With our choice of preferences the equilibrium problem when an arbitrary number n of derivatives is available for trading can be rewritten as an equilibrium problem in which the derivative is in zero supply, i.e., when n = 0. The idea is to make the derivatives part of the agents' endowments and to look for a market price of risk such that the agents' optimal demand for the derivative add up to zero. Such an approach is typically not possible when the preferences are not translation invariant. For preferences coming from BSDEs the approach is justified by the following lemma. It shows that if the endowment of some agent is increased by HD for some   R, then her optimal trading strategy in the derivative will decrease by .

Lemma 3.9. For a given MPR , consider the residual risk BSDE

-dY¯ta(a) = Ga(t, ta, Z¯ta(a))dt - Z¯ta(a)dWt associated with the preferences of the agent a  A and an admissible trading strategy a.
(i) If ~a = (~a,1, ~a,2) is optimal for the above BSDE with terminal condition

(13)

-H a ,

then ^a = (~a,1, ~a,2 - ) is optimal given the terminal condition

-(Ha + HD).

(ii) If ~a = (~a,1, ~a,2) is optimal for the above BSDE with terminal condition -(Ha + HD),
then ^a = (~a,1, ~a,2 + ) is optimal given the terminal condition -H a .

11

Proof. In order to prove the first assertion we assume that the BSDE (13) with terminal condition -Ha yields an optimal trading strategy ~a = (~a,1, ~a,2). In particular,

Y¯0a(~a)  Y¯0a(a) for every a  S.

(14)

Let us now introduce the trading strategies

a = a - (0, ) and ^a = ~a - (0, ).

In view of the representation

T

HD = E[HD] +

s dWs

0

TT

= E[HI ] +

s,S (dWsS + sS ds) +

s,R(dWsR + sRds)

00

TT

= Bt +

s,S (dWsS + sS ds) +

s,R(dWsR + sRds),

tt

a direct calculation shows that the process

(Y a(a), Za(a)) = (Y¯ a(a) - B, Z¯a(a) - )

solves the BSDE
TT
Yta(a) = -(Ha + HD) + Ga(s, a, Zsa(a)) ds - Zsa(a) dWs.
tt
In the light of (14) this yields
Y0a(a) = Y¯0a(a) - B0  Y¯0a(~a) - B0 = Y0a(^a).
This shows that ^a = ~a - (0, ) is indeed optimal given the terminal condition -(Ha + HD). The second assertion follows similarly.

The preceding lemma shows that the equilibrium market prices of risk (if they exist) of the following two models are the same:

· Model I: Each agent a  A is initially endowed with a random payoff Ha and the equilibrium

condition reads

~ta,2  n.
a

· Model II: Each agent a  A is endowed with a random payoff Ha + aHD such that

and the equilibrium condition reads

~ta,2  0.
a

a a = n

From now on we assume that the derivative payoff is equally split among the agents at time t = 0 and work with the second model; it turns out to be more convenient for our analysis of equilibrium. Hence the risk assessment of agent a  A when she follows an admissible trading strategy a is captured by the BSDE

-dYta(a) = ga(t, Zta(a))dt - Zta(a)dWt

with

YTa(a) = -

Ha

+

n |A|

H

D

+

VTa, (a )

.

12

In the next section we are going to characterize a candidate equilibrium market price of external risk in terms of a solution of a BSDE using a representative agent approach. To simplify the exposition we restrict ourselves to an economy of two agents, A = {a, b}; the general case follows from straightforward modifications.

3.2.2 The representative agent: preferences and optimization problem

There are many results in the literature on general equilibrium in complete markets that link competitive equilibria to equilibria of a representative agent's economy. The preferences of the representative agent are usually given by a weighted average of the individual agents' utility functions with the weights depending on the competitive equilibrium to be supported by the representative agent. This dependence results in a complex fixed point problem which renders the analysis and computation of equilibria quite cumbersome. The many results on risk sharing under translation invariant preferences, in particular Barrieu & El Karoui (2005), Jouini, Schachermayer & Touzi (2007) and Filipovic & Kupper (2008), suggest that when the preferences are translation invariant, then all the weights are equal. Motivated by these papers our approach is therefore to consider an agent whose risk assessments evolve according to the process

Y0ab

=

inf
F

Y0a (H a

+

n 2

H

D

-

F)

+

Y0b (H b

+

n 2

H

D

+

F)

.

(15)

Here Hi denotes the initial endowment of the agent i  {a, b}, Y i(·) (with some abuse of notation) stands for the first component of the solution to the BSDE with driver gi as a function of the terminal condition (see also proposition A.3 in the appendix), and the infimum is taken over a suitable (square integrable or bounded) subset of FT -measurable random variables. It has been shown by Barrieu & El Karoui (2005) that the risk preferences induced by (15) can be represented by the solution of a BSDE with driver

gab(t, z) = inf{ga(t, z - x) + gb(t, x)}
x

(16)

and terminal condition -(Ha + Hb + nHD). In particular, only the agents' aggregate endowment is important. In order to solve the representative agent's optimization problem we assume that the following condition holds.

Assumption 3.10. The mapping z  gab(·, z) is strictly convex and the infimum is attained.

The convexity condition on z  gab(·, z) guarantees that the first order conditions associated with the representative agent's optimization problem have a solution. Sufficient conditions in terms of the individual agents' preferences are given in Barrieu & El Karoui (2005).

Remark 3.11. The minimizer x, of the mapping x  ga(t, z - x) + gb(t, x) is characterized by the

equations

gzai (t, z - x) = gzbi (t, x) (i = 1, 2).

This means that

gab(t, z) = ga(t, x) + gb(t, y)

if and only if

gzai (t, x) = gzbi (t, y) and x + y = z.

We shall use this characterization later in order to state sufficient conditions for the existence of equilibria.

13

For a given admissible trading strategy ab of the representative agent her residual risk follows the backward dynamics

-dY¯tab(ab) = Gab(t, tab, Z¯tab(ab))dt - Z¯tab(ab)dWt with Y¯Tab() = -(Ha + Hb + nHD)

(17)

where the driver Gab is defined in terms of gab by analogy to (10). The agent's goal is to minimize her

risk over the set of admissible trading strategies. Arguing as in the case of the single agent, the convexity

condition on the driver gab yields the following characterization of the optimal strategy ~ab for a given

MPR  = (S, R):

gza1b s, Zsab - ~sab,1

S Ss 0

- ~sab,2s = -sS ,

(18)

and

gza2b s, Zsab - ~sab,1

S Ss 0

- ~sab,2s = -sR.

(19)

Thus, if the BSDEs with driver Gab and terminal condition -(Ha + Hb + nHD) satisfy a comparison principle and if the trading strategy ~ab defined implicitly by the first order conditions (18) and (19) is admissible, then the representative agent's optimization problem has a solution.
Our goal is now twofold. First, we identify a market price of risk  of the representative agent economy,
i.e., a MPR such that the representative agent's optimal demand for the derivative is zero at any point in time. Then we prove that  is an equilibrium MPR of the original model.

3.2.3 Equilibria of the representative agent economy

We are now going to identify an equilibrium of the representative agent's economy. This is achieved using the first order conditions. The idea is to first set ~ab,2 equal to zero in (18) and (19), then derive the optimal
strategy in the stock market from (18), plug this strategy into (19) and to finally define the desired market price of external risk by the left hand side of (19). For this it is important that we can work with Model II where the derivative is in zero outside net supply: setting ~ab,2 equal to zero in (18) and (19) eliminates the dependence of the FOCs on the (yet to be determined) quantity .

Proposition 3.12. Assume that Assumption 3.10 is satisfied, and that there exists a unique solution (Y¯ ab, Z¯ab) of the BSDE

with driver

TT

Y¯tab = -(Ha + Hb + nHD) +

G¯ab(s, Z¯sab, ) ds -

Z¯sab dWs,

tt

G¯ab(s, z, ) = gab s, z - asb,1(z, )

sS Ss 0

- sab,1(z, )sS SssS ,

where sab,1(z, ) is a solution of the equation in x

gza1b s, z - x

sS Ss 0

= -sS.

(20)

14

Assume further that the trading strategy ~tab = (tab,1(Z¯tab, ), 0) is admissible, and that the representative agent's BSDE (17) satisfies the comparison principle of Definition 3.5 . If the process R defined by

-sR := gza2b s, Z¯sab - sab,1(Z¯sab, )

sS Ss 0

(21)

along with the market price of financial risk S makes the density process in (3) a uniformly integrable martingale and if Assumption 3.2 holds under  = (S, R) then R is an equilibrium market price of external risk of the representative agent's economy.
Proof. For the market price of external risk R defined through (21), the trading strategy ~ab = (~ab,1, 0) = (ab,1(Z¯ab, ), 0) is admissible and satisfies the FOCs for optimality. Since Assumption 3.10 is satisfied, the optimality of ~ab under the pricing measure P follows from Proposition 3.6.

We notice that the solution of the BSDE (20) describes simultaneously a candidate equilibrium market
price of external risk and the equilibrium utility of the representative agent. Whether or not the candidate process R defined through (21) makes the process Z given by (3) a uniformly integrable martingale
needs to be checked on a case-by-case basis.

3.2.4 Equilibria of the competitive economy

We are now ready to prove our existence and characterization of equilibrium result. It states that the equilibrium market price of external risk R of the representative agent economy is also an equilibrium market price of external risk of the underlying competitive economy.

Theorem 3.13. Under the assumptions of Proposition 3.12 the process R is an equilibrium market price of external risk.

Proof. For the choice of R in (21) it follows that ~ab = (~ab,1, 0) given in Proposition 3.12 is optimal for the representative agent optimization problem

min
 ab S 

Y¯0ab(ab),

where Y¯0ab(ab) is given by the BSDE

-dY¯tab(ab) = Gab(t, tab, Z¯tab(ab))dt - Z¯tab(ab)dWt with Y¯Tab(ab) = -(Ha + Hb + nHD).

(22)

We denote the individual agents' optimal trading strategies coming from the FOC

gzi1 s, Z~si - ~si,1

sS Ss 0

- ~si,2s = -sS ,

i  {a, b}

and

gzi2 s, Z~si - ~si,1

sS Ss 0

- ~si,2s = -sR,

i  {a, b}

associated with the market price of external risk R by ~a and ~b, respectively. In order to prove that

~ab = ~a + ~b,

15

we recall from Remark 3.11 the following link between the drivers ga, gb and gab:

ga s, Z~sa - ~sa,1

sS Ss 0

- ~sa,2s + gb s, Z~sb - ~sb,1

sS Ss 0

= gab s, Z~sa + Z~sb - (~sa,1 + ~sb,1)

sS Ss 0

- (~sa,2 + ~sb,2)s .

- ~sb,2s

Thus the process

Y~ta + Y~tb, Z~ta + Z~tb ,

is a solution of the BSDE (22) associated with the trading strategy

ab := ~a + ~b.

By the Envelope Theorem it follows that

gza1b s, Z~sa + Z~sb - (~a,1 + ~b,1)

sS Ss 0

- (~a,2 + ~b,2)s = -sS ,

and

gza2b s, Z~sa + Z~sb - (~a,1 + ~b,1)

sS Ss 0

- (~a,2 + ~b,2)s = -sR.

Thus the strategy ~a+~b satisfies the representative agent's first order conditions. Recall now that (~ab,1, 0) also satisfies the representative agent's first order conditions. Since strict convexity of   Ga(·, , ·) implies that the first order conditions have a unique solution it follows that

~a,2 + ~b,2  0.

3.3 Delineation against time-additive preferences

Let us briefly benchmark our BSDE approach against the traditional approach of establishing the existence of stochastic equilibria in pure exchange economies with time additive preferences. To this end, we consider a model in which agents maximize expected utility from consuming a perishable good. The agent a  A is characterized by her initial endowment ea and a von-Neumann-Morgenstern expected utility function

T

U a(c) = E

ua(t, ct)dt

0

defined on some set of stochastic consumption processes c = (ct) and their goal is to maximize the utility from consumption subject to a budget constraint. The aggregate output of the economy follows an exoge-

nous It^o process K = (Kt). The agents can invest in a risky asset that pays K, lend and borrow funds at a short rate process r = (rt) and their goal is to maximize utility subject to their budget constraints; see, e.g., Riedel (2001) for further model details. In such a model the representative agent's instantaneous

utility function is given by

v(t, k) = sup

aua(t, ca)

a ca=k a

16

for weights (a) and the equilibrium state-price deflator t at time t  [0, T ] is obtained by evaluating the representative agent's marginal utility function at the exogenous supply Kt. That is:

t = vk(t, Kt).

In our model the consumption good is money and due to the assumption of translation invariance,

all payoffs (and hence consumption) can be shifted to the terminal date. This is not possible when the

consumption good is perishable as it is typically assumed with time-additive utility functions. Furthermore,

in our model there is no budget constraint. We assume that the risk-free rate is exogenous and that

borrowing is unrestricted. In this case translation invariance guarantees that borrowing a certain amount

of money just reduces the agents' utilities by that amount at the terminal time. In order to clarify some of

the more technical differences between our model the time-additive case, let us assume for simplicity that the agents can only trade the derivative, but not the stock. In this case the driver G¯ab of the BSDE (20)

is given by

gab(t, z) = inf

ga(t, za)

za=z a

and the candidate equilibrium MPR is given implicitly via the derivative of gab with respect to z. The key observation from (21) is that this derivative is to be evaluated at an endogenous process, namely Z¯ab, to

obtain the equilibrium MPR. Thus, the main technical difference between our model and the time-additive

case is that in our case the equilibrium MPR is given in terms of the derivative of the instantaneous utility function gab evaluated at the endogenous process Z¯ab while for time-additive preferences, the equilibrium

state price deflator is given by the derivative of the instantaneous utility function v evaluated at the

exogenous supply process (Kt).

4 An example with entropic utilities

In this section we consider an example which lends itself to a complete analysis of the equilibrium dynamics. We assume throughout that the agents are expected exponential utility maximizers, i.e., that the driver of the BSDE associated with the preferences of the agent a  A is given by

ga(t, z)

=

1 2a

||z||2

.

Furthermore, we assume that the following technical conditions hold.

Assumption 4.1. (i) The market price of financial risk is of the form:

(tS)2 = (t, Rt)
for a uniformly bounded non-negative function . Moreover, x  (·, x) has uniformly bounded 1st and 2nd derivative.

(ii) The payoff functions hD(T, S, R) and D(t, S, R) are increasing in the R-variable and strictly increasing on a set of positive measure.11

We are now ready to formulate the main result of this section.
11The same result holds for (strictly) decreasing functions.

17

Theorem 4.2. Let n be the number of derivatives and assume that the agents are expected exponential utility maximizers. Under Assumption 4.1 the following holds:

(i) There exists a unique solution (Y, Z)  HT(R, P) × HT2 (R2, P) of the BSDE

Yt = Hrep -

T t

ZsdWs

+

1 2

T
[-(zs2)2 + (sS)2 - 2sSzs1] ds
t

(23)

with terminal condition

H rep

:=

Ha

+

Hb + R

nH D

where

R = a + b.

The second component of the integrand part Z = (z1, z2) of the solution (Y, Z) defines an equilibrium market price of external risk R, i.e.,
tR = zt2.

(ii) The market price of external risk can be represented in terms of a uniformly (in the time variable) bounded Lipschitz continuous function v¯(t, ·) of the process (ln S, R):

zt2 = v¯(t, ln St, Rt).

(24)

(iii) The random variables zt2 are almost surely differentiable with respect to R and n. The derivative nzt2 of zt2 with respect to n is strictly positive:
sign(nzt2) = 1 P-a.s.
That is, the equilibrium market price of risk decreases with the number of available derivatives.

(iv) The model is complete in equilibrium.

Outline of the proof The theorem is proven in several steps. In Section 4.1 we derive the optimal trading strategy for a given pricing measure assuming that Assumption 3.2 holds. Section 4.2 characterizes the dynamics of the equilibrium market price of external risk:
· in Subsection 4.2.1 we use the specific structure of the candidate optimal trading strategy of Section 4.1 together with Theorem 3.13 in order to derive the equilibrium BSDE.
· in Subsection 4.2.2 we show that the candidate equilibrium market price of external risk R is bounded and carry out the sensitivity analysis with respect to n and R.
· in Subsection 4.2.3 we show that R can be written as a Lipschitz continuous function of the process (ln S, R).
The latter result allows us to prove that Assumption 3.2 is indeed satisfied; this proof is carried out in Section 4.2.4. In Section 4.3.1 we illustrate how the analysis can be simplified in the case of full equilibrium. Finally, we show how our methodology extends to a more general class of preferences.

18

4.1 The individual optimization problem

Our goal is to establish the existence of a bounded equilibrium market price of external risk. Since the market price of financial risk is bounded by assumption it is thus enough to consider the individual optimization problems only for bounded . Using the same argument as in Example 1 of Kobylanski (2000) one can show that if a trading strategy belongs to the set

a | E exp(-kVTa,(a)) <  for some k > 0

then the BSDE (5) has a unique solution. In order to guarantee that the solution belongs to the right space and that the comparison principle holds we require the exponential moment condition also for -k and chose the set of admissible trading strategies to be

S = a | E exp(±kVTa,(a)) <  for some k > 0 and (6) holds .

(25)

Lemma 4.3. If a  S, then the unique solutions of BSDE (5) belongs to HT1 (R, P) × HT2 (R2, P).
Proof. Let us assume for simplicity that a = 1 (this can be achieved by a rescaling argument). Then with the usual exponential change of variables

a = -(Ha + VTa,(a)), yt = exp (Yta(a)), zt = ytZta(a),

our BSDE (5) becomes
T
yt = exp (a) - zsdWs,
t
for process (y, z)  HT2 (R, P) × HT2 (R2, P). In particular, yt = E[exp (a)|Ft]. Now, let
mt = E[exp (-a)|Ft].

The Cauchy-Schwarz inequality for conditional expectations yields

ytmt = E[exp (a)|Ft] E[exp (-a)|Ft]  1.

Thus

mt



1 yt

.

(26)

By the definition of S the random variable exp (-a) has finite moments. Hence, the martingale repre-

sentation theorem and the Burkholder-Davis-Gundy inequality imply that

2
E sup mt < .
0tT

(27)

Recall that

||Zta(a)||

=

||zt|| yt



||zt||mt,

where the inequality comes from (26). This and (27) will yield via Cauchy-Schwarz inequality that

1

1

T2

T2

E

||Zta(a)||2dt

 E  sup mt

||zt||2dt 

0

0tT

0

1
22

T

1 2

 E sup mt

E

||zt||2dt

< .

0tT

0

19

The Burkholder-Davis-Gundy inequality in turn gives

t

E sup

Zsa(a)dWs  K E

0tT 0

1
T2
||Zta(a)||2dt < .
0

As a consequence, the process

· 0

Zta(a)dWt

is

a

true

martingale.

From

BSDE

(5)

it

follows

that

1 2

T 0

Zta(a) 2dt = Y0a(a) - a +

T
Zta(a)dWt
0

By applying the expectation operator to (29) we get that Za(a)  HT2 (R, P). Since

Yta(a)

=

Y0a(a)

-

1 2

t
(Zua(a))2du +
0

t
Zua(a)dWu,
0

from (28) it follows that E sup0tT |Yta(a)| < . Therefore Y a(a)  HT1 (R, P).

(28) (29)
2

4.1.1 The candidate strategy

In order to obtain a candidate optimal strategy for the individual agents we apply the change of variables (8) to the driver ga. From (12) we derive that

~sa,2

= as,2(Z~sa, )

=

asR + z~sa,2 s,R

.

Plugging this into (11) the optimal trading strategy in the stock market is calculated as

~sa,1

=

as,1(Z~sa, )

=

a[sS s,R

- sRs,S ] + z~sa,1s,R sS Sss,R

- z~sa,2s,S .

Here Z~a = (z~a,1, z~a,2) is the integrand part of the unique solution to the BSDE with terminal condition -Ha and linear driver

Ga(s, sa(Z, ),

Z)

=

-z1sS

-

z2sR

-

a 2

[(sS )2

+

(sR)2].

(30)

Up to an additive constant the terminal wealth associated with ~a is calculated as

T

-Ha + a

uS

0

dWuS

+

1 2

uS

du

T

+ a

uR

0

dWuR

+

1 2

uR

du

.

Since  is assumed to be bounded this shows that ~a belongs to (25). Hence ~a it is indeed admissible.

4.1.2 Optimality
In order to establish optimality of ~a we apply Proposition 3.6. The conditions (i) and (ii) have already been verified. In order to prove that the BSDE associated with the agent's utility optimization problem

20

satisfies a comparison principle we compare the solution (Y~ a, Z~a) associated with the strategy ~a with the solution Y¯ a(a), Z¯a(a) coming from another admissible strategy a. Then

TT

Y~ta - Y¯ta(a) = - (Z~sa - Z¯sa(a)) dWs +

Ga(s, a(Z~sa, ), Z~sa) - Ga(s, sa, Z¯sa(a)) ds

tt

TT

= - (Z~sa - Z¯sa(a)) dWs +

Ga(s, a(Z~sa, ), Z~sa(a)) - Ga(s, a(Z¯sa(a), ), Z¯sa(a))

tt

+ Ga(s, a(Z¯sa(a), ), Z¯sa(a)) - Ga(s, sa, Z¯sa(a)) ds.

Since ta(z, ) = arg minR2 Ga(t, , z) it follows that Ga(s, a(Z¯sa(a), ), Z¯sa(a)) - Ga(s, sa, Z¯sa(a))  0.

Furthermore, in view of (30) we have

Ga(s, a(Z~sa, ), Z~sa) - Ga(s, a(Z¯sa(a), ), Z¯sa(a)) = -(Z~sa - Z¯sa(a)) · s.

In particular we get

Y~0a - Y¯0a(a)  - =-

T
(Z~sa - Z¯sa(a)) dWs -
0 T
(Z~sa - Z¯sa(a)) dWs,
0

T
(Z~sa - Z¯sa(a)) · s ds
0

(31)

where Wt = Wt +

t 0

sds.

Next

we

argue

that

the

process

· 0

(Z~sa

- Z¯sa(a)) dWs

is

a

(true)

martingale.

Indeed the integrability condition (6) along with equation (8) and Lemma 4.3 show that

T
E ||Z~sa - Z¯sa(a)||2 ds < .
0
Furthermore since the process  is bounded, the density process (Zt) of (3) has finite moments of any order. Therefore Burkholder-Davis-Gundy and Cauchy-Schwarz inequalities in turn give

t

E sup

Z~sa - Z¯sa(a) dWs

0tT 0

 K E  K¯ E

T1
||Zta(a) - Z¯sa(a)||2dt 2
0

T
||Z~sa - Z¯sa(a)||2 ds
0

1 2
< ,

and this guarantees that the process with respect to which Wt = Wt +

t 0

· 0

Z~sa

sds

- is

Z¯sa(a) dWs is a 2-dimensional

a (true) martingale standard Brownian

under the measure P motion. Thus, taking

conditional expectation of (31) under the measure P we get

Y~0a  Y¯0a(a).
This shows that the comparison principle of Definition 3.5 holds, so ~a is an optimal trading strategy by Proposition 3.6.

21

4.2 Equilibrium dynamics
In this section we derive the BSDE that characterizes the candidate equilibrium market price of external risk (assuming that market completeness prevails in equilibrium) and establish the differentiability properties of the candidate equilibrium MPR.

4.2.1 The equilibrium BSDE

In view of Proposition 3.12 and Theorem 3.13 a candidate equilibrium MPR is obtained by first calculating the driver gab and then showing that the BSDE (20) with driver G¯ab has a unique solution. The candidate

MPR is then given by equation (21). Direct calculations show that in our setting the driver gab defined in

(16) is given by

gab(t, z)

=

1 2R

||z||2

with

R = a + b,

that the function z  at b,1(z, ) of Proposition 3.12 equals

asb,1(z, )

=

z1

+ RsS sSs

,

and the candidate equilibrium market price of external risk of equation (21) is given by

R

=

-

z2 R

where z2 comes from the integrand part of the solution to the BSDE (20) with driver

G¯ab(s, z, )

=

1 2R

(z2)2

-

sS z1

-

R 2

(sS

)2

and

terminal

condition

H rep ;

see

also

the

results

of

Section

4.1.1.

Multiplying

this

BSDE

by

-

1 R

we

see

that R is given by the second component of the integrand part Z = (z1, z2) of the solution of the BSDE

Yt = Hrep -

T t

ZsdWs

+

1 2

T
[-(zs2)2 + (sS)2 - 2sSzs1] ds.
t

Theorem 4.4. The equilibrium BSDE (23) has a unique solution in HT(R, P) × HT2 (R2, P).

(32)

Proof. Since the market price of financial risk and the terminal condition are bounded, the assertion

follows from Kobylanski (2000).

2

The preceding considerations show that we have identified an equilibrium MPR if we can show that the
process z2 is bounded and that Assumption 3.2 holds under P with  = (S, z2). To this end, we start with some preliminaries. First, we observe that there exists an equivalent measure P~ with respect to which

t
W~ tS = WtS + uS du and W~ tR = WtR
0
are independent Brownian motions with respect to the filtration (Ft); for reasons that will later become clear we shall actually work under P~. Second, for our analysis of equilibrium we only need to consider S,

22

not the specific drift or the volatility coefficients. For the equilibrium analysis we may thus with no loss of generality normalize the stock price volatility to one and assume from now on that

dSt St

=

tS dt + dWtS

=

dW~ tS.

Furthermore, we shall restrict ourselves to the case a = b = 0, hence Hrep is of the form (with some

abuse of notation)

Hrep = Hrep(ST , RT ).

The general case follows from straightforward modifications.

4.2.2 A BSDE representation of the equilibrium market price of risk
Let (Y, Z) be the unique solution of the BSDE (32). The general BSDE theory suggests that z2 can be obtained in terms of the Malliavin derivatives of Y with respect to the Brownian motion W R. Since S depends on the external risk factor it is not convenient, though, to differentiate the BSDE (32) under P. The reason is the product term -2tSzt2 whose Malliavin derivative depends on the derivative of S. It is more convenient to "hide" this term in the equivalent change of measure from P to P~ and to derive the representation (24) of z2 under P~.12 Under the measure P~ the BSDE (23) takes the more convenient form

Yt = Hrep(ST , RT ) -

T t

ZsdW~ s

+

1 2

T
[-(zs2)2 + (sS)2] ds.
t

(33)

Let D~ R be the Malliavin derivative operator with respect to the Brownian motion W~ R. Since the change of measure does not affect W R, it coincides with the Malliavin operator DR with respect to W R.
It follows from the results of Ankirchner, Imkeller & Dos Reis (2007) and Horst & Mu¨ller (2007) that the derivative processes (D~uRYt)Tt=u and (D~uRZt)tT=u of the process Y and Z at time u  [0, T ] with respect to Brownian motion W~ R exist and that zt2 is a version of D~tRYt and it is uniformly bounded. More precisely, the following holds.

Proposition 4.5. There exists a unique solution (Y, Z) to the BSDE (33). The Malliavin derivatives D~uRYt and D~uRZt exist for any u  [0, T ] and satisfy the linear BSDE

D~ uRYt = D~ uRHrep(ST , RT ) +

T t

1 2

bx(s,

Rs)

ds

-

T
D~ uRZsdW~ s -
t

T
zs2D~ uRzs2ds,
t

(34)

where x denotes the derivative with respect to x of the function (s, x). Furthermore, the process (zt2) is uniformly bounded and a version of (D~tRYt).

In preparation for the proof of differentiability z2 we are now going to show how the preceding proposition can be applied to characterize z2 in terms of a BSDE. To this end, we denote by Hxr2ep the derivative with respect to x2 of the function Hrep(x1, x2), and introduce a probability measure P by

dP dP~

:=

E

T
-
0

0 zu2

dW~ u .

12This is possible because v¯ is deterministic. Loosely speaking we change the distribution of the process (S, R), but not the set of possible trajectories.

23

Since the external risk process (Rt) follows a Brownian motion with drift D~ 0RHrep(ST , RT ) = D~ uRHrep(ST , RT ) = bHxr2ep(ST , RT ) (0  u  T ).
Applying conditional expectation to (34) under the measure P for u = 0 and u = t yields

D0RY~t = EP

b Hxr2ep(ST , RT ) +

T t

1 2

bx(s,

Rs)

ds

|

Ft

= DtRY~t = zt2

(0  t  T ).

In particular, we see from (34) that the pair of processes (z2, D~0RZ) solves the BSDE

dMt

=

[MtNt2

-

1 2

bx(t,

Rt)]dt

+

NtdW~ t

where N = (N 1, N 2) and the terminal condition is given by

MT = bHxr2ep(ST , RT ).

We are now ready to prove differentiability of the candidate equilibrium market price of risk.

(35)

Theorem 4.6. The random variables zt2 for t  [0, T ] are almost surely differentiable with respect to R and n. The derivative nzt2 of zt2 with respect to n is strictly positive:
sign(nzt2) = 1.

Proof. We recall from Proposition 4.5 that z2 is given by the first component of a solution (M, N ) of the BSDE

Mt = bHxr2ep(ST , RT ) +

t

T

[-MsNs2

+

1 2

bx(s,

Rs)

-

sS Ns1]ds

-

T
NsdWs.
t

(36)

Furthermore,

that

· 0

Ns

Ws

(Mt) is bounded. Thus, since S, x and Hxre2p is a BMO martingale. From here, we proceed

are also bounded, in two steps.

standard

calculations

yield

(i) First, we formally differentiate BSDE (36) with respect to   {R, n} from which we obtain

Mt = bHxr2ep(ST , RT ) -

T
NsdWs +

T
[-Ns2Ms - MsNs2 - sS Ns1]ds.

tt

(37)

Since

(Mt)

is

bounded

and

(

· 0

NsdWs)

is

a

BMO

martingale,

Theorem

10

in

Briand

&

Hu

(2008)

yields that the above BSDE has a unique solution. Now, arguments similar to those used in the proof

of Theorem 12 in Briand & Hu (2008) suffice to show that the solution of the BSDE (37) is indeed

the derivative of the solution of BSDE (36). Without going into further detail, the arguments consist

in comparing difference quotients of (M, N ) in the parameter  against (M, N ) and then taking the limit in the appropriate norm.

(ii) In order to establish the sign property we perform a change of measure to the measure P with respect to which dWt = dWt - (tS, Mt)dt is a Brownian motion. This simplifies the BSDE (37) to

Mt = bnHxr2ep(ST , RT ) -

T
NsdWs +

T
[-Ns2Ms]ds.

tt

24

Moreover

nHxr2ep(ST , RT ) = HxD2 (ST , RT ).

Our goal is now to express the process (nMt) in terms of the derivative HxD2 . This can be achieved by eliminating the Lebesgue integral. To this end, we define a stochastic process (et)Tt=0 by

t
et := exp - Ns2ds
0

and apply It^o's formula to (etnMt) in order to obtain

T

etMt = b eT HxD2 (ST , RT ) -

esMsdWs.

t

Taking conditional expectations with respect to P yields

etnMt = EP eT b HxD2 (ST , RT ) Ft . Since (et) and b are strictly positive it follows from Assumption 4.1(ii) that

sign nMt = 1.

4.2.3 Lipschitz continuity of the equilibrium market price of risk

Using the link between backward stochastic and partial differential equations we can now prove that z2

can be represented in terms of a Lipschitz continuous function of the forward process. To this end, we first

recall that we are currently working under the probability measure P~ with respect to which the forward

process (St, Rt) is given by

eW~ tS

-

t 2

,

Rt

for a P~-Brownian motion W~ . For reasons that will become clear

later it is more convenient to work with the forward process

Xt

=

(Xt1,

Xt2)

=

(ln St,

Rt)

=

(W~ tS

-

t 2

,

Rt).

and the correspondingly transformed payoff functions

H¯ j(x1, x2) := Hj (ex1 , x2) for j  {a, b, D, rep}.
We notice that by assumption the mapping H¯xj2 inherits uniform Lipschitz continuity from Hxj2 . We further notice that the preceding transformation does not affect the representation of equilibrium dynamics. In particular, the candidate equilibrium MPR is still given by the first component M of the solution (M, N ) of the BSDE (35). Since M is bounded conditions (H4) and (H5) of Kobylanski (2000) are satisfied so by her Theorem 3.8 the process (D~0RYt) can be represented as a continuous function v¯ of the forward process X. Specifically (with our choice of transformation) v¯ is a viscosity solution of the PDE

with terminal condition

-v¯t + Lv¯ - F (t, x, v¯,  · xv¯) = 0 v¯(T, ·) = bH¯xr2ep(·, ·)

25

where the operator L is defined by

Lv¯

=

-

1 2

v¯x1

x1

-

b2 2

v¯x2

x2

+

t 2

v¯x1

-

atv¯x2

and

F

(t,

x,

y,

z)

=

-yz2

+

b 2

x(t,

x2).

Here v¯x1x1 , v¯x2x2 , v¯x1 , v¯x2 are partial derivatives of the function v¯(t, x1, x2).

Lemma 4.7. The function v¯(t, ·) is Lipschitz continuous uniformly on compact time intervals.

Proof. Our proof is based on Theorem 3.3 (b) of Jakobsen & Karlsen (2002). In their notation we

have that

tr[A(t, x, Dv¯)D2v¯]

=

1 2

v¯x1

x1

+

b2 2

v¯x2

x2

and

f (t, x, r, p, X)

=

rp2

+

t 2

p1

-

atp2

-

b 2

x

(t,

x2).

Hence conditions (C1), (C2), (C3), (C6) and (C8) of Jakobsen & Karlsen (2002) (page 505) are satisfied. For condition (C2) notice now that

f (t, x, r, p, X) - f (t, x, s, p, X)  ¯R(r - s),

where

¯R := p21{p20}.

Conditions (C3) and (C8) are obviously satisfied and (C6) follows from at being bounded, and from x(t, x2) being Lipschitz. Thus, our assertion follows from their result since the terminal function is Lipschitz

continuous.

2

The preceding lemma immediately yields the following corollary and hence finishes the proof of Theorem 4.2 provided that Assumption 3.2 holds.

Corollary 4.8. The process z2 satisfies

zt2 = v¯(t, ln St, Rt)

where v¯(t, ·) is a Lipschitz continuous uniformly on compact time intervals. This representation holds under any probability measure that is equivalent to P~.

4.2.4 A representation of the equilibrium derivative price volatility
In a final step we are going to verify that the equilibrium volatility ,R is P-a.s. strictly positive. For this, we shall use the Clark-Haussmann formula for diffusion forward processes. The mentioned forward process is Xt := (Xt1, Xt2) = (ln St, Rt). By Corollary 4.8, under P the forward process satisfies13
dXt = f (t, Xt)dt + g(t, Xt)dWt ,
13Here it is convenient to work with logarithmic stock prices. The formula becomes much more cumbersome when working with the actual stock price process.

26

where

f (t, x) =

-

1 2

t

at - v¯(t, x)

and g(t, x) = 1 0 . 0b

Let us now denote by (s, t) the solution of the following first variation equation associated with Xt:

d(t, s) = fx(t, Xt)(t, s)dt + gx(t, Xt)(t, s)dWt (t > s), (t, t) = I2,

where

fx =

00 -v¯x1 -v¯x2

and gx =

0 0

are the generalized derivatives. From this we see that 1,2(t, s)  0 because 1,2(t, t) = 0 so

d22(t, s) = [-22(t, s)v¯x2 (t, Xt)]dt, 22(s, s) = 1.

Hence 22(t, s) is positive. Since the transformed payoff function H¯ D(x1, x2) := HD (ex1 , x2)
is differentiable, the Clark-Haussmann formula shows that the process ,R in (4) can be represented as

t,R = bE [t|Ft],

where

TT

t =

H¯xD2 (ln Ss, Rs)22(s, t) ds =

HxD2 (Ss, Rs)22(s, t) ds.

tt

Hence ,R is positive because the payoff HD is increasing in the external risk factor by assumption.

4.3 Extensions and modifications
We close this section with some comments on how the analysis simplifies in the case of full equilibrium and how our methodology carries over to more general preferences functionals and

4.3.1 Full equilibrium

Our analysis can be simplified when both assets are priced in equilibrium. In order to see this, let us

consider the benchmark case where W R is the only source of uncertainty and put b = 1 and at = 0. This is essentially the framework of Anderson & Raimondo (2008) for a single risk factor; extending our arguments

to multiple risk factors is straightforward. If W R is the only source of uncertainty, then the equilibrium

BSDE is given by

Yt = Hrep(RT ) -

T t

ZsdWsR

-

1 2

T
Zs2ds
t

where Zt is a one-dimensional process. Using the exponential change of variables y = exp(Y ) this equation can be transformed into the linear BSDE

yt = eHrep(RT ) -

T
zsdWsR.

t

27

Such a transformation is not possible for the BSDE (23) where only the second component of Z appears quadratically. The unique solution of the preceding equation is given by

yt = EP eHrep(RT ) | Ft

and zt = EP Hxrep(RT )eHrep(RT ) | Ft ,

where Hxrep denotes the first order derivative of the function Hrep(x). In particular, yt = u(t, WtR) and

zt = v(t, WtR) where

u(t, x) := EP eHrep(RT ) | WtR = x

and v(t, x) is the derivative of u(t, x) with respect to the space variable:

v(t, x) := EP Hxrep(RT )eHrep(RT ) | WtR = x .

Under our assumption on the payoff functions the mappings u, v : [0, T ] × R  R are uniformly bounded and u is uniformly bounded away from zero. If the second derivative Hxrxep is also bounded, then the

function

vx(t, x) = EP Hxrxep(RT )eHrep(RT ) + Hxrep(RT ) 2eHrep(RT ) | WtR = x

is bounded and z can be represented as a smooth function with bounded derivative of the forward process W R. Since the solution (Y, Z) of the non-linear BSDE is given by

Yt = ln(yt)

and

Zt

=

zt yt

a direct calculation using the smoothness properties of u and v shows that Zt can be expressed in terms of a Lipschitz continuous function of W R. Hence we can again apply the Haussmann formula (which now

simplifies to a one-dimensional ODE) to establish market completeness in equilibrium.

4.3.2 Semi-Entropic Utilities

Our methodology carries over to the case where the driver of the BSDE associated with agent a  A is

given by

ga(t, z)

=

-aS z1

+

1 2a

(1 - a)(z1)2 + (z2)2

for a  {0, 1}.

For a = 0 this is the standard dynamic entropic risk measure. We refer to the case a = 1 as the semi-entropic case. A direct calculation shows that for a, b  {0, 1} the representative agent driver gab
defined in (16) is given by

gab(t, z)

=

-

a

a

(1 2

-

b) (tS )2

-

bb(1 - 2

a) (tS )2

-

tS z1(a

+

b

-

ab)

+ (1

-

a)(1 2R

-

b) |z1|2

+

1 2R

|z2|2.

For semi-entropic utilities we will not have uniqueness of the optimal trading strategy for the individual

agent risk minimization problem. In fact any position in stocks may lead to an optimal strategy. However

for a given position in stock the optimal strategy in the derivative market is unique. This observation

shows that the equilibrium market price of external risk is given by the second component of the integrand part Z = (z1, z2) of the solution (Y, Z) of the BSDE

Yt = Hrep -

t

T

ZsdWs

+

1 2

T
[-(zs2)2 + (sS)2 - 2sSzs1] ds.
t

28

Here



=

0

corresponds

to

the

case

where

both

agents

have

semi-entropic

preferences;



=

a a +b

if

agent b has semi-entropic preferences while agent a has entropic preferences and  = 1 when both agents

are entropic.

5 A Numerical Example
The BSDE characterization of the equilibrium market price of risk makes our analysis easily amenable to an efficient numerical analysis. In this section we report some simulations for a benchmark model with two agents. We assume that (Rt) describes the dynamics of a temperature process in California during the summer months May, June, July and view (St) as the share price of some energy provider.

5.1 Forward dynamics and payoffs
We consider the time interval [0, T ] with T = 1.5 where each 0.5 time units represents one month and assume the temperature process follows the dynamics

Rt = R0 + 4t + 2Wt.
This model captures seasonal variations in average daytime temperatures for the months of May, June and July.14 The model is a simple linear approximation of the data presented in the link, centered around 18 degrees Celsius. In our analysis we shall give special attention to R0  [-4, 7] corresponding to a variation of 14 to 25 degrees Celsius.

2.5 6

5

Stock Price Temperature

4 2
3

2
1.5 1

0

1 0 0.5 1 Time

-1 0 0.5 1 Time

Figure 1: Typical trajectories of the forward processes.

5.1.1 Stock prices
The stock price process (St) follows a diffusion of the form (2). Following the arguments given above we normalize the stock price volatility without loss of generality to one. The market price of financial risk
14see http://www.wrcc.dri.edu/cgi-bin/cliMONtavt.pl?casjos

29

(the drift under our normalization condition) is chosen as a bounded, smooth function that increases with

the temperature. The latter reflects the idea that the demand for energy increases with the temperature

as a result of an increasing use of air conditioners which leads to higher revenues and hence higher stock

prices. Specifically, we chose

(tS)2 = (t, Rt) = 8

arctan(Rt)

+

 2

but our numerical method would work with alternative models as well.

5.1.2 Payoffs

The energy provider hedges its exposure to the temperature risk by issuing a weather derivative that pays

a yield D which decreases with the expected daytime temperature which is 4t at time t  [0, T ]. That

is, the energy provider pays less "interest" in periods where the expected demand for energy and hence

expected revenues are low and more when temperatures and expected revenues are high. Specifically, we

choose the payoff rate

D(t, St, Rt) = exp -M (4t - Rt)+

(M > 0).

The demand for the weather derivatives comes from an orange farmer ("agent a") and the owner of a
golf resort ("agent b"). The agents have entropic risk preferences with risk tolerance coefficients a = 1.0 and b = 2.0, respectively. They are endowed with ci (i  {a, b}) shares of the stock and their income rates are exposed to temperature risk. The orange farmer prefers seasonal temperatures around 22 C corresponding to the benchmark value Ra = +4 in our temperature model. For the owner of the golf resort we choose 17 C (i.e. Rb = -1) as the reference temperature reflecting the fact that turf grass optimal growth temperature belongs to the interval15 [15.6 C, 23.9 C]. Specifically, we model their incomes by

T
Hi = ciST + exp{-M i(Rt - Ri)2}dt (i  {a, b})
0
for positive constants ca, cb, M a, M b  R+. The following table summarizes our choice of parameters:
a b R M M a M b ca cb Ra Rb 1.0 2.0 3.0 2.0 0.5 0.5 0.5 0.5 4.0 -1.0

5.2 Solver methodology
In order to simulate our model we compute enough trajectories of the forward process (S, R) using the Euler method. Subsequently we simulate the equilibrium market price of external risk using the representative agent BSDE and then use the trajectories of R to solve the BSDEs for the derivative price process and equilibrium risk exposure. Although the BSDE for the representative agent is of quadratic type we have shown the quadratic term is indeed bounded (see Theorem 4.2) so we can use any existing numerical scheme for Lipschitz BSDEs. Our method of choice is a modification of the algorithm by Bender & Denk (2007). For a given equidistant partition  = {0, h, 2h, ..., T - h, T } of the time interval [0, T ] and the corresponding discretization Xh and Hh of the forward process and payoff functions, respectively, we set
15http://www.nmmastergardeners.org/Manual%20etc/other%20references/turfgrasses.htm

30

(Y (0,h), Z(0,h)) = 0 and define the processes Y (m,h) and Z(m,h) recursively by

M -1

Yi(hm,h) = E Hh - h

f (ih, Xjhh, Zj(hm-1,h)) Fih ,

j=i

Zi(hm,h)

=

E

Wih h

M -1

Hh - h

f (ih, Xjhh, Zj(hm-1,h))

Fih ,

j=i+1

(38)

where Wih = W(i+1)h - Wih denotes a Brownian increment. We take advantage of the fact that the driver does not depend on the process Y , since only Y0 is needed the independence of the driver on Y allows us to ignore (38) until the last iteration. Because the scheme is explicit we are able to update the iteration sequence as we go and so the scheme converges in one iteration. To improve the stability of the algorithm we inject the a priori results concerning the boundedness of the several processes into the numerical method. We employ as well several known BSDE heuristics on how to choose base functions or how to stabilize the results for the linear growth BSDEs. The results were obtained by using about 200000 paths simulations, a time partition of 31 to 51 points and for the conditional expectation we employed the usual projection techniques on polynomial bases.

5.3 Results
Unless otherwise stated or the corresponding parameter varying, all the plots of this section are obtained by choosing (a, b) = (1.0, 2.0), (s0, r0) = (1.0, 1.0) and n = 1, i.e., for one share of the derivative.
5.3.1 Sample path prices and strategies

Marke Price of External Risk Derivative price

0.45 0.4
0.35 0.3
0.25 0.2
0.15 0.1
0.05 0 0 0.5 1 Time (a) Sample path of external MPR.

3.6 3.4 3.2
3 2.8 2.6 2.4 2.2
2 0 0.5 1 Time
(b) Sample path of the derivative price.

Figure 2: Sample path of market price of external risk (left) and derivative price (right).

In Figure 2 we display the paths of the external equilibrium MPR (left) and the derivative price process (right) that correspond to the sample trajectories of Figure 1. We see that the derivative price increases as the market price of risk decreases. This is intuitive in equilibrium: when the MPR decreases, the agents demand a lower risk premium so the derivative price increases. Figure 3 shows the corresponding

31

Holdings in the Derivative

trading strategies in the derivative. The dashed line is the sum of the agents' demand; it clearly matches the equilibrium condition. The owner of the golf resort (agent b) initially holds a long position in the derivative and then unwinds her position as the temperature increases. Given the agent's payoff function, the derivative provides a better hedge against temperature fluctuations when the temperature is low. When the temperature increases, the exposure of the orange farmer to temperature risk dominates the exposure of the golf resort owner to the same source of risk so the derivative is more valuable for the orange farmer. This explains the increase in the orange farmer's holdings and the decrease in the position of the golf resort owner. Close to maturity the strategies are more unstable. It could be that the orange farmer unwinds his position in reaction to the drop in the temperature and the resulting decrease in the derivative's payoff.
4  2,a
3  2,b 2  2,a+ 2,b
1
0
-1
-2
-3 0 0.5 1 Time
Figure 3: Sample path of the agents' positions in the derivative.
Figure 4 displays the equilibrium derivative prices as a function of the starting point of the forward process (left) and the aggregate risk tolerance (right) when both agents have entropic utility functions. The increasing derivative price in the temperature reflects the fact that the yield curve increases in the external risk component. The equilibrium price decreases with the overall tolerance towards risk; the less risk averse the agents are, the less they are ready to invest into a hedge against the external risk factor.
5.3.2 The benefits of financial innovation
Figure 5 illustrates the benefits of financial innovation in our model. The left plot shows the risk in equilibrium when the agent b can trade one unit of the derivative (dark color) and her risk in a benchmark model where no derivatives are available for trade (light color).16
If the derivative is not available for trading the agents cannot hedge their exposure to temperature risk and face an incomplete market situation. Although the risk pattern is the same in both cases the risk is lower when the agent has more assets available for trading and hence more hedging opportunities. This effect is more visible when we look at the relative rather than absolute reduction in her risk exposure. The
16Notice that since we measure risk negative numbers indicate high utility.
32

6.5

Derivative price

6

4

2

0 06

14

2 3
Stock S
0

2

0

-2 4 -4

Temp. R
0

(a) Derivative price as a function of spot prices and temperatures

Derivative Price

6
5.5
5
4.5
4 0 2 4 6 8
R
(b) Derivative price as a function of the risk tolerance (cf. Theorem 4.6).

Figure 4: Derivative price as a function of model parameters.

Residual Risk

-2
-3 0
-4 2
-4 -2 0 2 4 6 4 Stock S Temp. R
0
(a) Risk in model with one derivative (dark) and in a model without derivative (light)

10

0

% Residual Risk

-10

-20

-30

-40

-50 0

1

2

3 4 -4 -2 0

2

4

Stock S

Temp. R

00

6

(b) Risk in a model with one derivative as a percentage of the risk in a model with none.

Figure 5: Risk reduction: the benefits of financial innovation (for agent b).

plot on the right shows that the risk is 2% to 8% lower in a model with one derivative issued. A similar pattern can be observed for agent a. The effects of financial innovation become even more evident if the derivative accounts for a higher proportion of the overall wealth. When the number of available derivatives is increased to n = 6, for instance, we observe a risk reduction of up to 65% (Figure 6).
5.3.3 Further results
We also studied the dependence of equilibrium risk exposure on preferences and risk tolerances. Figure 7(a) shows the representative agent's risk for the entropic and semi-entropic risk measures. The risk perception is lower for the entropic case. This is intuitive as the agents overall risk aversion is larger in the entropic case. Figure 7(b) displays the representative agent's risk as a function of the overall risk tolerance.

33

Residual Risk % Residual Risk

-1

-2

-3

-4

-5

-6 0

-7 2

-4 -2

0

2

4

6

4 Stock S

0

Temp. R

0

0 -20 -40 -60 -80 -100
0

2

Stock S 4 -4
0

-2

02 Temp. R
0

4

6

(a) Risk in model with 6 derivative (dark) and in a model without derivatives (light)

(b) Risk in a model with 6 derivative as a percentage of the risk in a model with none.

Figure 6: Risk reduction: the benefits of many derivatives (for agent b)

Residual Risk Residual Risk

0 -2 -4 -6 -8 -10 -12 -14 -4 -2

024 Temp. R
0

6

4

0 2 Stock S
0

(a) Risk for entropic (dark) and semientropic (light) preferences.

0

-2

-4

-6 -8 -10
1

2 3

b

4

3

2

1

4


a

(b) Risk in the entropic case as a function of risk tolerance.

Figure 7: Representative agents' risk for (semi-) entropic preferences.

Finally, we plot the price of one share (unit) of the derivative as a function of the number of shares

issued and the corresponding revenues in Figure 8.

The left plot shows the quantities

B0(n) n

where B0(n)

denotes the equilibrium derivative price for the yield curve n · D. The unit price is decreasing in n, i.e.,

the price of one share decreases with the number of shares issued. The associated revenues are displayed

in the right plot. We see that for our choice of payoff profiles the revenues are maximal if the issuer sells

about 6 units of the derivative. A theoretical analysis of the issuer's optimal policy is beyond the scope of

this paper and left for future research.

34

Price per drivative Revenues

2.5 2
1.5 1
0.5 0 0

2468 Number of Derivatives

10

6 5.5
5 4.5
4 3.5
3 2.5
2 13579 Number of Derivatives

Figure 8: Price per share and revenues as a function of the number of shares issued.

6 Conclusion
In this paper we provided a general framework within which to price financial securities written on nontradable (external) risk factors. In addition, there is an exogenously priced security whose market price of risk depends on the external risk factor so we have a partial equilibrium model.
We assumed that the agents' risk preferences can be described by a dynamic convex risk measure generated by a backward stochastic differential equation. We solved the individual and representative agents' optimization problems and characterized a certain class of equilibrium market prices of risk in terms of a solution to a BSDE. For the specific case of entropic risk measures we solve the optimization problem in closed form. The equilibrium market price of external risk was characterized in this case by the unique solution of a quadratic BSDE. In turn this gives the equilibrium price process via a linear BSDE. The BSDE approach gave us insight on the structure of the equilibria. In particular, we identified the sign of the derivatives of the market price of risk with respect to the number of available derivatives. Numerical simulations revealed more properties of the equilibria. For instance, a significant reduction in risk achieved by the issuance of the derivative.
Our main goal was to extend the standard representative approach of general equilibrium theory to monetary utility functions and to allow for certain classes of market prices of financial risk that depend on an external risk factor. Many avenues are still open for future research. The applicability of our results in general and the characterization of equilibrium results in particular are limited "only" by the lack of existence, uniqueness and differentiability results for solution of BSDEs beyond the quadratic case. This is a field of active research; a major contribution to this theory was well beyond the scope of this paper. It would also be interesting to consider the problem of optimal derivative design. The simulations of Section 5 can be viewed as a first quantitative step in that direction. Our Figure 5 suggests that for a given payoff profile there exists a revenue maximizing number of shares. Finally, we did not consider models where the assumption of market completion is violated so our method does not cover the incomplete markets.

35

A Notation, BSDEs and Malliavin derivatives

In this appendix we summarize some of our notation and briefly review some results on backward stochastic differential equations, the link between BSDEs and dynamic monetary risk measures, and the notion of Malliavin derivatives. Throughout this paper we use the following notation:

· For a vector x = (xi)ni=1  Rn we denote by x =

ni=1(xi)2 its Euclidean norm.

· The inner product of x, y  Rn is denoted x · y =

n i=1

xiyi

.

Furthermore, we introduce the following spaces of stochastic processes:

· HTp (Rm, P) the space of all progressively measurable processes (Xt)0tT with values in Rm such

that

EP[(

T 0

||Xs||2ds)p/2] < .

· HT(Rm, P) the space of all progressively measurable processes (Xt)0tT with values in Rm which are P-a.s. bounded for almost every t.

A.1 BSDEs

Definition A.1. (i) A backward stochastic differential equation is an equation of the form

TT
Yt = H - ZsdWs + F (s, Ys, Zs)ds (0  t  T )
tt

(39)

where W is a standard n-dimensional Brownian motion on a probability space (, F, P) equipped with the standard Brownian filtration (Ft). The time T is called the terminal time, while the random function F and the FT -measurable random variable H are referred to as the driver and terminal condition, respectively.

(ii) A solution consists of an adapted process Y and an adapted integrand Z that satisfy the integral equation (39).

Existence and uniqueness of solution results for BSDEs in the space HT(R, P) × HT2 (R2, P) have been established for one-dimensional equations under a quadratic growth condition in z:

|F (t, y, z)|  c0 + c1 z 2,

and under integrability conditions under the terminal value H. We refer to the seminal paper by Kobylanski (2000) for existence results for bounded terminal values and to Ankirchner, Imkeller & Dos Reis (2007) or Briand & Confortola (2008) for BSDEs with random Lipschitz coefficients. Comparison results for BSDEs with quadratic growth are also available in the literature (see, e.g., Theorem 2.6 in Kobylanski (2000)). They give sufficient conditions on the drivers F 1 and F 2 of the BSDEs

TT
Yti = Hi - ZsidWs + F i(s, Ysi, Zsi)ds
tt

(i = 1, 2)

such that H1  H2 and F 1(t, Y 1, Z1)  F 2(t, Y 1, Z1) a.s. implies Yt1  Yt2 a.s.

36

Definition A.2. A forward-backward stochastic differential equation (FBSDE) is a system of the form

tt
Xt = X0 + f (s, Xs)ds + g(s, Xs)dWs (0  t  T )
00
TT
Yt = H - ZsdWs + F (s, Xs, Ys, Zs)ds (0  t  T )
tt

(40) (41)

A.2 Dynamic risk measures and BSDEs

There is a strong connection between time-consistent translation invariant utility functions and BSDE. The following is based on Barrieu & El Karoui (2009). Let (, F, (Ft), P) be a filtered probability space and L(Ft) be a subset (essentially bounded, square integrable) of the set of Ft-measurable random variables. A (strongly) time-consistent dynamic convex risk measure is a family of convex risk measures ( t)0tT where
t : L(FT )  L(Ft)
such that such that for all times t, t + s  [0, T ] the time-t risk t(X) of a position X  X is obtained by evaluating the time-(t + s) risk of X from the point of view of time t, i.e.,

t(X) = t ( t+s(X)) .
It has been shown by Barrieu & El Karoui (2005) that solutions to BSDEs whose driver is independent of Y give rise to a rather large class of dynamic convex risk measures. More precisely, they proved the following:

Proposition A.3. Let (Y (H), Z(H)) be the unique (or maximal) solution to a BSDE
TT
Yt(H) = H - F (s, Zs)ds - ZsdWs
tt
and assume that the driver F depends in a convex manner on Z. Then the process (Yt) has all the properties of a dynamic convex risk measure. That is:

· For all m  R it holds that Yt(H + m) = Yt(H) - m. · The process (Yt(H)) is strongly time-consistent: Yt(H) = Yt (Yt+s(H)). · For all H1, H1  X and   [0, 1] we have

Yt (H1 + (1 - )H2)  Yt(H1) + (1 - )Yt(H2).

To date it is an open question if any strongly time-consistent dynamic risk measure can be represented by a BSDE. In discrete time where uncertainty is generated by a family of independent Brownian motions, this is in fact true, as has been shown in a recent paper by Cheridito et al. (2009).

37

A.3 Malliavin derivatives

For completeness we also review the notion of Malliavin derivatives; for details we refer to the textbook

of Nualart (1995). We denote by W be an d-dimensional Brownian motion and introduce the space of

random variables

S= :=F

TT
hd1dWt, . . . , hdddWt
00

where F : Rn  Rd is has bounded partial derivatives of all orders and hi  L2([0, T ]; Rd). For any such

random variable the d-dimensional operator D : S  L2( × [0, T ])d is defined by

Di 

=

d j=1

F xi,j

TT

hd1dWt, . . . ,

hdddWt hi,j

00

and for p > 1 the norm  1,p is defined by 
 1,p = E ||p +

T
|D  |2
0

p/21/p  .

The operator D has a closed extension to the space D1,p, the closure of S with respect to · 1,p. Let us now consider the diffusion process (Mt) defined by the SDE

dMt = b(t, Mt)dt + (t, Mt)dWt

where b(t, ·)  Rd and (t, ·) = diag(1(t, ·), . . . , d(t, ·)) is a diagonal matrix. We assume that the diffusion coefficients are differentiable in x with bounded derivatives and fix a differentiable function g : Rd  R.

With

i,t := exp

t
xi (s, Msi)dWsi +
0

t 0

bix(s, Msi)

-

1 2

(xi

)2

(s,

Msi)

ds

the Malliavin derivative Dui g(Mt) of g(Mt) at time u with respect to the i-th Wiener process is given by

Dui g(Mt) = 1{tu}gxi (Mt)(u, Mu)i,ti-,u1.

For our external risk process R of Section 2 (see equation (1)) this means that

Du2 Rt = 1{tu}b

A.3.1 Malliavin derivatives of BSDEs with drivers of quadratic growth
Let us conclude with the Malliavin differentiability of quadratic forward-backward SDEs. The following was first proved in Ankirchner, Imkeller & Dos Reis (2007) and further extended in Dos Reis (2009). It gives sufficient conditions on the driver F and terminal condition H such that the solution (X, Y, Z) of the FBSDE system (40), (41) is Malliavin differentiable. More precisely suppose that the following holds:
· Let f and g be deterministic continuously differentiable functions with bounded derivatives.
· H is a bounded continuously differentiable function and its derivative grows at most linearly in x. F is a deterministic function, continuously differentiable in (x, y, z) and for some C > 0 satisfies |F (t, x, y, z)|  C(1 + |y| + |z|2),
|Fx(t, x, y, z)|  C(1 + |y| + |z|2) , |Fy(t, x, y, z)|  C, and |Fz(t, x, y, z)|  C(1 + |z|).

38

Then (X, Y, Z)  L1,2(0, T ; (D1,2)n×d × (D1,2)d × (D1,2)d×d). A version of (Di Yt, Di Zt); 0  , t  T } is given, for each 1  i  d, by

Di Xt = 0,

Di Yt = 0,

Di Zt = 0,

0  t <   T;

and for 0    t  T

tt

Di Xt = g(, X) + f (s, Xs)DXsds + g(s, Xs)DXsdWs


TT

Di Yt = Di H -

Di Zs dWs + (F )(s, Xs, Ys, Zs) · (Di Xs, Di Ys, Di Zs)ds.

tt

Moreover {DtYt; 0  t  T } is a version of {Zt; 0  t  T }.

References
[1] Allen, G. & Gale, D. (1994) Financial innovation and risk sharing, MIT Press, Cambridge, MA.
[2] Anderson R.M. & Raimondo, C.R. (2008) Equilibrium in continuous-time financial markets: endogenously dynamically complete market, Econometrica, 76, 841-907.
[3] Ankirchner, S., Imkeller, P. & Dos Reis, G. (2007) Classical and variational differentiability of BSDEs with quadratic growth, Electronic Journal of Probability, 12, 1418-1453.
[4] Bahlali, K., Mezerdi, B. & Ouknine, Y. (2002) A Haussmann-Clark-Ocone formula for functionals of diffusion processes with Lipschitz coefficients, Journal of Applied Mathematics and Stochastic Analysis, 15, 357-370.
[5] Barrieu, P. & El Karoui, N. (2005) Inf-convolution of risk measures and optimal risk transfer, Finance & Stochastics 9, 269-298.
[6] Barrieu, P. & El Karoui, N. (2009) Pricing, hedging and optimally designing derivatives via minimization of risk measures. Volume on Indifference Pricing (ed: Rene Carmona) Princeton University Press.
[7] Bender, C. & Denk, R. (2007) Forward simulation of backward SDEs. Stochastic Processes and their Applications, 117 (12) 1793-1812.
[8] Briand, P. & Hu, Y. (2008) Quadratic BSDEs with convex generators and unbounded terminal conditions, Probability Theory and Related Fields 141 (3-4) 543-567.
[9] Briand, P. & Confortola, F. (2008) BSDEs with stochastic Lipschitz condition and quadratic PDEs in Hilbert spaces. Stochastic Processes and their Applications, 118, 818-838.
[10] Chen, Z. (1995) Financial innovation and arbitrage pricing in frictional economies. Journal of Economic Theory, 65(1) 117-135.
[11] Chen, Z. & Epstein, L. (2002) Ambiguity, risk and asset returns in continuous time, Econometrica, 70, 1403-1443.

39

[12] Cheridito, P., Horst, U., Kupper, M. & Pirvu, T.A. (2009) Equilibrium in incomplete markets under translation invariant preferences, Working Paper.
[13] Clark, J.M.C. (1970) The representation of functionals of Brownian motion by stochastic integrals, Annals of Mathematical Statistics, 41, 1282-1295.
[14] Dana, R.A. & Jeanblanc, M. (2002) Financial markets in continuous time, Springer-Verlag, Berlin.
[15] Davis, M.H.A. (2004) Complete-market models of stochastic volatility, Proceedings of The Royal Society of London. Series A. Mathematical, Physical and Engineering Sciences, 460, 11-26.
[16] Davis, M.H.A. & Obloj, J. (2008) Market completion using options, Working paper.
[17] Delbaen, F., Peng, S. & Rosazza-Gianin, E. (2009) Representation of the penalty term of dynamic concave utilities, Working paper.
[18] Dos Reis, G. (2009) On some properties of solutions of quadratic growth BSDE and applications in finance and insurance, PhD Thesis, Humboldt University, In preparation
[19] Duffie, D. (1986) Stochastic equilibria: existence, spanning number, and the "no expected financial gain from trade" hypothesis, Econometrica, 54, 1161-1183.
[20] Duffie, D. (1986) Competitive equilibria in general choice spaces, J. Math. Econom., 15, 1-23.
[21] Duffie, D. & Epstein, L. (1992) Stochastic differential utility, Econometrica, 60, 353-394.
[22] Duffie, D. & Huang, C.F. (1985) Implementing Arrow-Debreu equilibria by continuous trading of few long-lived securities, Econometrica, 53, 1337-1356.
[23] Duffie, D. & Rahi, R. (1985) Financial market innovation and security design; Journal of Economic Theory, 64 (1) 1-42.
[24] Filipovic, D. & Kupper, M. (2008) Equilibrium prices for monetary utility functions; International Journal of Theoretical and Applied Finance, 11 (3) 325-343.
[25] Gianin, E. R. (2006) Risk measures via g-expectations, Insurance: Mathematics and Economics, 39, 19-34.
[26] Haussmann, U. (1979) On the integral representation of functionals of It^o processes, Stochastics, 13, 17-27.
[27] He, H. & Leland, H. (1993) On equilibrium asset price processes, Review of Financial Studies, 6(3), 593-617.
[28] Horst, U. & Mu¨ller, M. (2007) On the spanning property of risk bonds priced by equilibrium, Mathematics of Operations Research, 32, 784-807.
[29] Hu, Y., Imkeller, P & Mu¨ller, M. (2005a): Utility optimization in incomplete markets, Annals of Applied Probability, 15 (3) 1691-1713.
40

[30] Hu, Y., Imkeller, P & Mu¨ller, M. (2005b): Partial equilibrium and market completion, International Journal of Theoretical & Applied Finance, 8 (4) 483-508.
[31] Jakobsen, E. & Karlsen, K. (2002) Continuous dependence estimates for viscosity solutions of fully nonlinear degenerate parabolic equations, Journal of Differential Equations, 183, 497-525.
[32] Jouini, E., Schachermayer, W. & Touzi, N. (2006) Law invariant risk measures have the Fatou property, Advances in Mathematical Economics, 9 , 49-71, Springer-Verlag, Berlin.
[33] Karatzas I. & Shreve, S. E. (1991) Brownian motion and stochastic calculus, second ed., Graduate Texts in Mathematics, vol. 113, Springer-Verlag, New York.
[34] Karatzas, I., Lehoczky, J.P. & Shreve, S.E. (1990) Existence and uniqueness of multi-agent equilibrium in a stochastic, dynamic consumption/investment model, Mathematics of Operations Research, 15, 80­128.
[35] Kazamaki, N. (1994) Continuous exponential martingales and BMO, Lecture Notes in Mathematics, Vol. 1579, Springer-Verlag, Berlin.
[36] Kobylanski, M. (2000) Backward stochastic differential equations and partial differential equations with quadratic growth, Annals of Probability, 28, 558-602.
[37] Lazrak, A. (2004) Generalized stochastic differential utility and preference for information, Annals of Applied Probability, 14, 2149-2175.
[38] Lazrak, A. & Quenez, M.C. (2003) A generalized stochastic differential utility, Mathematics of Operations Research, 28, 154-180.
[39] Maccheroni, F., Marinacci, M. & Rustichini, A. (2006) Ambiguity aversion, robustness and the variational representation of preferences. Econometrica, 74, 1447-1498.
[40] Nualart, D. (1995) The Malliavin calculus and related topics. Springer-Verlag, Berlin.
[41] Peng, S. (2004) Nonlinear Expectations, Nonlinear Evaluations and Risk Measures, Lecture Notes in Mathematics, Springer.
[42] Pesendorfer, W. (1995) Financial innovation in a general equilibrium model, Journal of Economic Theory, 65(1), 79-116.
[43] Riedel, F. (2001) Existence of Arrow-Radner equilibrium with endogenously complete markets with incomplete information, Journal of Economic Theory, 97, 109-122.
[44] Romano, M. & Touzi, N. (1997) Contingent claims and market completeness in a stochastic volatility model, Mathematical Finance, 7, 399-4112.
[45] Tufano, P. (2003) Financial innovation, In: Handbook of the Economics of Finance, Ed. G.M. Constantinides, M. Harris, R. Stulz, Elsevier.
41

SFB 649 Discussion Paper Series 2010
For a complete list of Discussion Papers published by the SFB 649, please visit http://sfb649.wiwi.hu-berlin.de.
001 "Volatility Investing with Variance Swaps" by Wolfgang Karl Härdle and Elena Silyakova, January 2010.
002 "Partial Linear Quantile Regression and Bootstrap Confidence Bands" by Wolfgang Karl Härdle, Ya'acov Ritov and Song Song, January 2010.
003 "Uniform confidence bands for pricing kernels" by Wolfgang Karl Härdle, Yarema Okhrin and Weining Wang, January 2010.
004 "Bayesian Inference in a Stochastic Volatility Nelson-Siegel Model" by Nikolaus Hautsch and Fuyu Yang, January 2010.
005 "The Impact of Macroeconomic News on Quote Adjustments, Noise, and Informational Volatility" by Nikolaus Hautsch, Dieter Hess and David Veredas, January 2010.
006 "Bayesian Estimation and Model Selection in the Generalised Stochastic Unit Root Model" by Fuyu Yang and Roberto Leon-Gonzalez, January 2010.
007 "Two-sided Certification: The market for Rating Agencies" by Erik R. Fasten and Dirk Hofmann, January 2010.
008 "Characterising Equilibrium Selection in Global Games with Strategic Complementarities" by Christian Basteck, Tijmen R. Daniels and Frank Heinemann, January 2010.
009 "Predicting extreme VaR: Nonparametric quantile regression with refinements from extreme value theory" by Julia Schaumburg, February 2010.
010 "On Securitization, Market Completion and Equilibrium Risk Transfer" by Ulrich Horst, Traian A. Pirvu and Gonçalo Dos Reis, February 2010.

